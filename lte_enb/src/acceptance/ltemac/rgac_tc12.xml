#
#/********************************************************************20**
#
#     Name:    LTE-MAC 
#
#     Type:    XML Test File
#
#     Desc:    XML Based Test Cases For DLFS Scheduler
#
#     File:    rgac_tc12.xml
#
#     Sid:     rgac_tc12.xml@@/main/1 - Thu Mar 26 01:11:03 2009
#
#     Prg:     sd 
#
#*********************************************************************21*/

# DO NOT DELETE THIS LINE -- TC number generation script depends on it.
# xyzabcstart=1:hn:rgac_tc12.xml

#
#
#       Test:    12.1
#
#       Desc:   "To test the successful DL path for a UE with UE configured to 
#                report CQI in periodic mode 1-0 for a frequency selective cell."
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.1">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a UE in frequency selective cell and periodic
         CQI report for mode 1-0.
      </tapa.desc>

      <tapa.longdesc>
         Testing that UE recieves DL data successfully on reporting CQI through
         periodic CQI reporting mode 1-0 in a frequency selective cell.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="25" thresholdCqi= "5"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueCatEnum="1" prdModeEnumPres="TRUE" 
         prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      # Send CQI indication for periodic mode 1-0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="0" cqiIdx="10"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="120"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="0:1" chkGrant="TRUE" use="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.2
#
#       Desc:   "To test the successful DL path for a MAC PDU for a frequency 
#                selective cell with UE configured to report CQI through
#                periodic mode 2-0"
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.2">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a UE in frequency selective cell and periodic
         CQI report for mode 2-0.
      </tapa.desc>

      <tapa.longdesc>
         Testing that UE recieves DL data successfully on reporting CQI through
         periodic CQI reporting mode 2-0 in a frequency selective cell.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

   # Guarded the Test case with TFU_UPGRADE Flag
     <tapa.ifndef>
      <tapa.flag id="TFU_UPGRADE"/>
      </tapa.ifndef>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="50" thresholdCqi= "5"/>

      # UE Creation with periodic mode 2-0
      <tapa.rg.UeInit ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      <tapa.send>
         # Send a 6 Tti before sending wide-band CQI for the UE
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      
      # Send wideband CQI indication for periodic mode 2-0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="TRUE"
              wbCqi="6" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a 2 Tti before sending sub-band CQI for the BP Index = 0
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for first sub-band of
      # BP index = 0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
              sbCqi="10" label="0"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a 2 Tti before sending sub-band CQI for the BP Index = 1
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for second sub-band of
      # BP index = 1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
              sbCqi="5" label="2"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a 2 Tti before sending sub-band CQI for the BP Index = 2
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for third sub-band of
      # BP index = 2
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
              sbCqi="14" label="2"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      #Darshan - Changed BO from 280 to 200  
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="200"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Note: allocSbIds indicate the probable sub-band indices of the allocation 
      # They are the best sub-bands since they should be available
   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="16:0:1" chkGrant="TRUE" use="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
      
      <tapa.send>
         # Send a 1 Tti before sending wide-band CQI for second cycle of
         # reporting
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Send wideband CQI indication for periodic mode 2-0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="TRUE"
              wbCqi="8" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a Np = 2 Tti before sending sub-band CQI for the BP Index = 0
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for first sub-band of
      # BP index = 0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
              sbCqi="7" label="1"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a Np = 2 Tti before sending sub-band CQI for the BP Index = 1
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for second sub-band of
      # BP index = 1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
              sbCqi="10" label="0"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a Np = 2 Tti before sending sub-band CQI for the BP Index = 2
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for second sub-band of
      # BP index = 2
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
              sbCqi="13" label="1"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="200"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="2" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="14:15:6:7" chkGrant="TRUE" use="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.3
#
#       Desc:   "To test the successful DL path for a MAC PDU for a frequency 
#                selective cell with UE configured to report through aperiodic mode
#                2-0"
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.3">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a UE in frequency selective cell and aperiodic
         CQI report for mode 2-0.
      </tapa.desc>

      <tapa.longdesc>
         Testing that UE recieves DL data successfully on reporting CQI through
         aperiodic CQI reporting mode 2-0 in a frequency selective cell.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="100" thresholdCqi= "5"/>

      # UE Creation with aperiodic mode 2-0
      <tapa.rg.UeInit ueCatEnum="1" aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      # TODO: This should be sent only after request for aperiodic CQI
      # Send CQI indication for aperiodic mode 2-0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="FALSE" cqiMode="1" wbCqi="8" cqiIdx="10"
            numOfSubbands = "5" rbStartLst = "0:12:80:16:60" numRbLst =
            "4:4:4:4:4" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="120"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="0:3:20:4:15" chkGrant="TRUE" use="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#       Test:    12.4
#
#       Desc:   "To test the successful DL path for a MAC PDU for a frequency 
#                selective cell with UE configured to report through aperiodic mode
#                3-0"
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.4">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a UE in frequency selective cell and aperiodic
         CQI report for mode 2-0.
      </tapa.desc>

      <tapa.longdesc>
         Testing that UE recieves DL data successfully on reporting CQI through
         aperiodic CQI reporting mode 2-0 in a frequency selective cell.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="30" thresholdCqi= "5"/>

      # UE Creation with aperiodic mode 2-0
      <tapa.rg.UeInit ueCatEnum="1" 
         aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      # TODO: This should be sent only after request for aperiodic CQI
      # Send CQI indication for aperiodic mode 3-0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="FALSE" cqiMode="3" wbCqi="8"
            numOfSubbands = "4" rbStartLst = "0:4:8:12" numRbLst =
            "4:4:4:3" cqiIdxLst="11:12:8:7"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="120"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="0:1:2:3" chkGrant="TRUE" use="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.5
#
#       Desc:   "To test the DL path for a re-tx UE with UE configured to 
#                report CQI in periodic mode 1-0 for a frequency selective cell."
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.5">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a re-tx UE in frequency selective cell and periodic
         CQI report for mode 1-0.
      </tapa.desc>

      <tapa.longdesc>
         Testing that re-tx UE recieves DL data successfully on reporting CQI through
         periodic CQI reporting mode 1-0 in a frequency selective cell.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="25" thresholdCqi= "5"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueCatEnum="1" prdModeEnumPres="TRUE" 
         prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      # Send CQI indication for periodic mode 1-0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="0" cqiIdx="10"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="120"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="0:1:2:3:4:5:6:7:8:9:10:11:12:13" chkGrant="TRUE" use="1" saveTo="2"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
   
   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 

   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 

   <tapa.expset>
       # Expect PDU from MAC to PHY. 
       #ccpu00119023 MOD changed added retx parameters for validation
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req validate = "TRUE" use="1" saveTo="3"
           vldtRetx="TRUE" vldtHqId="TRUE"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req validate="TRUE" use="3" vldtSbAlloc="TRUE"
            allocSbIds="0:1:2:3:4:5:6:7:8:9:10:11:12:13" chkSdu="TRUE" lcId="1"
            isRetx="TRUE" retxUse="2" vldtRetx="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.6
#
#       Desc:   "To test the successful DL path for a re-tx UE for a frequency 
#                selective cell with UE configured to report CQI through
#                periodic mode 2-0"
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.6">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a re-tx UE in frequency selective cell and periodic
         CQI report for mode 2-0.
      </tapa.desc>

      <tapa.longdesc>
         Testing that re-tx UE recieves DL data successfully on reporting CQI through
         periodic CQI reporting mode 2-0 in a frequency selective cell.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

   # Guarded the Test case with TFU_UPGRADE Flag
     <tapa.ifndef>
      <tapa.flag id="TFU_UPGRADE"/>
      </tapa.ifndef>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="75" thresholdCqi= "5"/>

      # UE Creation with periodic mode 2-0
      <tapa.rg.UeInit ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      <tapa.send>
         # Send a 9 Tti before sending wide-band CQI index to comply with the
         # comfigured periodicity
         <tapa.tfu.tti.ind numTti="9"/>
      </tapa.send>
      
      # Send wideband CQI indication for periodic mode 2-0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="TRUE"
              wbCqi="8" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a 2 Tti before sending sub-band CQI for the BP Index = 0
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for third sub-band of
      # BP index = 0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
              sbCqi="10" label="2"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a 2 Tti before sending sub-band CQI for the BP Index = 1
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for second sub-band of
      # BP index = 1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
              sbCqi="5" label="1"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a 2 Tti before sending sub-band CQI for the BP Index = 2
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for first sub-band of
      # BP index = 2
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
              sbCqi="14" label="0"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a 2 Tti before sending sub-band CQI for the BP Index = 3
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for first sub-band of
      # BP index = 3
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
              sbCqi="7" label="0"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="300"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="12:13:4:5:15:14:1:0:2:3" chkGrant="TRUE" use="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

    <tapa.send>
       # Send a 4 TTIs to get the harqrecpRequest from MAC
       <tapa.tfu.tti.ind numTti="4"/>
    </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

    <tapa.send>
       # Send a 2 TTIs to Send the HARQ ACK Indication
       <tapa.tfu.tti.ind numTti="3"/>
    </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
      
     <tapa.send>
        # Send a 3 Tti before sending wide-band CQI for second cycle of
        # reporting
        <tapa.tfu.tti.ind numTti="3"/>
     </tapa.send>

     # Send wideband CQI indication for periodic mode 2-0
     <tapa.send>
        <tapa.tfu.dlcqi.ind>
          <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="TRUE"
             wbCqi="6" />
        </tapa.tfu.dlcqi.ind>
     </tapa.send>
     
     <tapa.send>
        # Send  2 Ttis before sending sub-band CQI for the BP Index = 0
        <tapa.tfu.tti.ind numTti="2"/>
     </tapa.send>
     
     # Send sub-band CQI indication for periodic mode 2-0 for second sub-band of
     # BP index = 0
     <tapa.send>
        <tapa.tfu.dlcqi.ind>
          <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
             sbCqi="7" label="1"/>
        </tapa.tfu.dlcqi.ind>
     </tapa.send>
     
     <tapa.send>
        # Send a 2 Tti before sending sub-band CQI for the BP Index = 1
        <tapa.tfu.tti.ind numTti="2"/>
     </tapa.send>
     
     # Send sub-band CQI indication for periodic mode 2-0 for third sub-band of
     # BP index = 1
     <tapa.send>
        <tapa.tfu.dlcqi.ind>
          <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
             sbCqi="10" label="2"/>
        </tapa.tfu.dlcqi.ind>
     </tapa.send>
     
     <tapa.send>
        # Send a 2 Tti before sending sub-band CQI for the BP Index = 2
        <tapa.tfu.tti.ind numTti="2"/>
     </tapa.send>
     
     # Send sub-band CQI indication for periodic mode 2-0 for second sub-band of
     # BP index = 2
     <tapa.send>
        <tapa.tfu.dlcqi.ind>
          <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
             sbCqi="13" label="1"/>
        </tapa.tfu.dlcqi.ind>
     </tapa.send>
     
     <tapa.send>
        # Send a 2 Tti before sending sub-band CQI for the BP Index = 3
        <tapa.tfu.tti.ind numTti="2"/>
     </tapa.send>
     
     # Send sub-band CQI indication for periodic mode 2-0 for second sub-band of
     # BP index = 3
     <tapa.send>
        <tapa.tfu.dlcqi.ind>
          <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
             sbCqi="4" label="1"/>
        </tapa.tfu.dlcqi.ind>
     </tapa.send>

     <tapa.send>
        # Send BO for the created logical channel on RGU. 
        <tapa.rgu.dstarsp lcId="1" lcType="5" bo="500"/>
     </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="2" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="14:15:10:11" chkGrant="TRUE" use="2"
           saveTo="3"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
   
   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 

   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 

   <tapa.expset>
      # Expect PDU from MAC to PHY. 
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req validate = "TRUE" saveTo="4" use="2" 
           vldtRetx="TRUE"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req validate = "TRUE" use="4" retxUse="3" chkSdu="FALSE"
          vldtSbAlloc="TRUE" allocSbIds="14:15:10:11" lcId="1" isRetx="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.7
#
#       Desc:   "To test the successful DL path for a UE with no CQI reporting
#       configured for the UE in a frequency selective cell."
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.7">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a UE in frequency selective cell with no
         reporting mode configured for the UE.
      </tapa.desc>

      <tapa.longdesc>
         Testing that UE recieves DL data successfully without reporting any CQI
         value.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="25" thresholdCqi= "5"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueCatEnum="1" prdModeEnumPres="FALSE"
         aprdModeEnumPres="FALSE" />
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="80"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="0:1:2:3:4:5:6:7:8:9:10:11:12:13" chkGrant="TRUE" use="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.8
#
#       Desc:   "To test the successful DL path for a MAC PDU for a frequency 
#                selective cell with UE configured to report through aperiodic mode
#                2-0 and wideband CQI less than threshold CQI while sub-band CQI
#                > threshold CQI"
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.8">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a UE in frequency selective cell and aperiodic
         CQI report for mode 2-0 and wideband CQI less than threshold CQI 
         while sub-band CQI > threshold CQI
      </tapa.desc>

      <tapa.longdesc>
         Testing that UE recieves DL allocation on reported sub-bands only when
         wideband CQI is less than the threshold CQI.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="50" thresholdCqi= "8"/>

      # UE Creation with aperiodic mode 2-0
      <tapa.rg.UeInit ueCatEnum="1" aprdModeEnumPres = "TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      # TODO: This should be sent only after request for aperiodic CQI
      # Send CQI indication for aperiodic mode 2-0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="FALSE" cqiMode="1" wbCqi="7" cqiIdx="10"
            numOfSubbands = "4" rbStartLst = "3:12:18:48" numRbLst =
            "3:3:3:3" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="400"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     # Expect staInd from MAC to RLC for remaining Data
     <tapa.rgu.dstaind lchTb1Data="1" />
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="1:4:6:16" chkGrant="TRUE" use="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      # Send remaining data for the logical channel 
      <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
   </tapa.send>
   
   <tapa.send>
      # Send DL_DELTA Ttis to get the MAC PDU at PHY.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>
      
   # Expect remaining Data from MAC to PHY
   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="1:4:6:16" chkGrant="TRUE" use="2"/>
     </tapa.tfu.dat.req>
   </tapa.expset>
   

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.9
#
#       Desc:   "To test the successful DL path for a MAC PDU for a frequency 
#                selective cell with UE configured to report through aperiodic mode
#                2-0 and wideband CQI less than threshold CQI, sub-band CQI
#                less than threshold CQI"
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.9">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a UE in frequency selective cell and aperiodic
         CQI report for mode 2-0 and wideband CQI less than threshold CQI 
         and sub-band CQI less than threshold CQI
      </tapa.desc>

      <tapa.longdesc>
         Testing that UE recieves no DL allocation when CQI is less than
         threshold CQI.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
         <tapa.flag id="DLFS_INV"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="50" thresholdCqi= "8"/>

      # UE Creation with aperiodic mode 2-0
      <tapa.rg.UeInit ueCatEnum="1" aprdModeEnumPres = "TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      # TODO: This should be sent only after request for aperiodic CQI
      # Send CQI indication for aperiodic mode 2-0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="FALSE" cqiMode="1" wbCqi="7" cqiIdx="6"
            numOfSubbands = "4" rbStartLst = "3:12:18:48" numRbLst =
            "3:3:3:2" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="700"/>
      </tapa.send>

      <tapa.send>
         # Send Ttis to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="10"/>
      </tapa.send>
      
      #Expect no scheduling by DLFS and so no allocation to the UE.

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.10
#
#       Desc:   "To test the successful DL path for a UE on cell reconfiguration
#       from frequency non-selective cell to a frequency selective cell."
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.10">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a UE on cell re-configuration from frequency
         non-selective cell to frequency selective cell.
      </tapa.desc>

      <tapa.longdesc>
         Testing that UE recieves DL data successfully on cell re-configuration
         from frequency non-selective cell to frequency selective cell.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="DLFS_INV"/>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="0" dlTotalBw="50"/>

      # UE Creation with aperiodic mode 2-0
      <tapa.rg.UeInit ueCatEnum="1" aprdModeEnumPres = "TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="120"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>
      
         # Cell reconfiguration to enable frequency selective cell
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" isDlFreqSel="1" 
            thresholdCqi= "5" recfgType="512"/>
      </tapa.send>
      
      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.rgr.cfgCfm instId="5" />
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

    # Send CQI indication for aperiodic mode 2-0
    <tapa.send>
     <tapa.tfu.dlcqi.ind>
       <tapa.tfu.dlcqi isPucchInfo="FALSE" cqiMode="1" wbCqi="7" cqiIdx="12"
        numOfSubbands = "4" rbStartLst = "3:12:18:48" numRbLst =
        "3:3:3:2" />
     </tapa.tfu.dlcqi.ind>
    </tapa.send>
      
    <tapa.send>
       # Send BO for the created logical channel on RGU. 
       <tapa.rgu.dstarsp lcId="1" lcType="5" bo="80"/>
    </tapa.send>

    <tapa.send>
       # Send a Tti to get the transmission scheduled. 
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

    <tapa.expect>
       # Expect staInd from MAC to RLC for Msg4 
       <tapa.rgu.dstaind lchTb1Data="1" />
    </tapa.expect>

    <tapa.send>
       # Send data with size less than the allocated on RGU. 
       # if we can send less data from TA or to report a BO which
       # will surely result in padding 
       <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
    </tapa.send>
   
   <tapa.send>
      # Send DL_DELTA Ttis to get the MAC PDU at PHY.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="1:4:6:16" chkGrant="TRUE" use="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 3 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   # Cell reconfiguration to change the threshold value for a
   # frequency-selective cell
   <tapa.send>
      <tapa.rgr.cfgreq.recfg.cell instId="5" isDlFreqSel="1" 
         recfgType="512" thresholdCqi="8"/>
   </tapa.send>
   
    <tapa.send>
       # Send a 1 TTIs to get the reconfiguration confirmation
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

    <tapa.expect>
       <tapa.rgr.cfgCfm instId="5" />
    </tapa.expect>

    # Send CQI indication for aperiodic mode 2-0 with CQI value less than
    # threshold value
    <tapa.send>
     <tapa.tfu.dlcqi.ind>
       <tapa.tfu.dlcqi isPucchInfo="FALSE" cqiMode="1" wbCqi="7" cqiIdx="7"
        numOfSubbands = "4" rbStartLst = "3:12:18:48" numRbLst =
        "3:3:3:2" />
     </tapa.tfu.dlcqi.ind>
    </tapa.send>

    <tapa.send>
       # Send BO for the created logical channel on RGU. 
       <tapa.rgu.dstarsp lcId="1" lcType="5" bo="120"/>
    </tapa.send>
    
    <tapa.send>
       # Send a 4 TTIs to ensure that no scheduling is done for the UE
       since CQI is less than the threshold CQI.
       <tapa.tfu.tti.ind numTti="4"/>
    </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#       Test:    12.11
#
#       Desc:   "To test the successful DL path for a UE on cell reconfiguration
#       from frequency selective cell to a frequency non-selective cell."
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.11">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a UE on cell re-configuration from frequency
         selective cell to frequency non-selective cell.
      </tapa.desc>

      <tapa.longdesc>
         Testing that UE recieves DL data successfully on cell re-configuration
         from frequency selective cell to frequency non-selective cell.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="DLFS_INV"/>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="50" thresholdCqi="7"/>

      # UE Creation with aperiodic mode 2-0
      <tapa.rg.UeInit ueCatEnum="1" aprdModeEnumPres = "TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="80"/>
      </tapa.send>

    # Send CQI indication for aperiodic mode 2-0
      <tapa.send>
       <tapa.tfu.dlcqi.ind>
         <tapa.tfu.dlcqi isPucchInfo="FALSE" cqiMode="1" wbCqi="7" cqiIdx="12"
          numOfSubbands = "4" rbStartLst = "3:12:18:48" numRbLst =
          "3:3:3:2" />
       </tapa.tfu.dlcqi.ind>
      </tapa.send>
    
      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>
      
         # Cell reconfiguration to disable frequency selective cell
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" isDlFreqSel="0" 
          recfgType="512"/>
      </tapa.send>
      
      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.rgr.cfgCfm instId="5" />
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="1:4:6:16" chkGrant="TRUE" use="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      
    <tapa.send>
       # Send BO for the created logical channel on RGU. 
       <tapa.rgu.dstarsp lcId="1" lcType="5" bo="120"/>
    </tapa.send>

    <tapa.send>
       # Send a Tti to get the transmission scheduled. 
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

    <tapa.expect>
       # Expect staInd from MAC to RLC for Msg4 
       <tapa.rgu.dstaind lchTb1Data="1" />
    </tapa.expect>

    <tapa.send>
       # Send data with size less than the allocated on RGU. 
       # if we can send less data from TA or to report a BO which
       # will surely result in padding 
       <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
    </tapa.send>
   
   <tapa.send>
      # Send DL_DELTA Ttis to get the MAC PDU at PHY.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" use="2"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
   

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#       Test:    12.12
#
#       Desc:   "To test the successful DL path for a UE post UE reconfiguration
#       for a frequency selective cell."
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.12">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a UE post UE re-configuration.
      </tapa.desc>

      <tapa.longdesc>
         Testing that UE recieves DL data successfully post UE re-configuration
         of the reporting mode.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="50" thresholdCqi="7"/>

      # UE Creation with aperiodic mode 2-0
      <tapa.rg.UeInit ueCatEnum="1" 
         aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="80"/>
      </tapa.send>

    # Send CQI indication for aperiodic mode 2-0
      <tapa.send>
       <tapa.tfu.dlcqi.ind>
         <tapa.tfu.dlcqi isPucchInfo="FALSE" cqiMode="1" wbCqi="7" cqiIdx="12"
          numOfSubbands = "4" rbStartLst = "3:12:18:48" numRbLst =
          "3:3:3:2" />
       </tapa.tfu.dlcqi.ind>
      </tapa.send>
    
      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>
      
         # UE reconfiguration to re-configure UE's aperiodic and periodic mode
         # reporting configuration
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.ue cellId="3" oldUeId="0" newcrnti="11" UeReCfgType="6"
            prdModeEnumPres="TRUE" prdModeEnum = "RGAC_RGR_PRD_CQI_MOD20"
            aprdModeEnumPres="TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30"/>
      </tapa.send>
      
      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.rgr.cfgCfm instId="5" />
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="1:4:6:16" chkGrant="TRUE" use="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
      
   # Send CQI for aperiodic mode 3-0
   <tapa.send>
      <tapa.tfu.dlcqi.ind>
        <tapa.tfu.dlcqi isPucchInfo="FALSE" cqiMode="3" wbCqi="8"
         numOfSubbands = "9" rbStartLst = "0:6:12:18:24:30:36:42:48" numRbLst =
         "6:6:6:6:6:6:6:6:2" cqiIdxLst="11:12:8:7:14:13:2:10:5"/>
      </tapa.tfu.dlcqi.ind>
   </tapa.send>
   
    <tapa.send>
       # Send BO for the created logical channel on RGU. 
       <tapa.rgu.dstarsp lcId="1" lcType="5" bo="120"/>
    </tapa.send>

    <tapa.send>
       # Send a Tti to get the transmission scheduled. 
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

    <tapa.expect>
       # Expect staInd from MAC to RLC for Msg4 
       <tapa.rgu.dstaind lchTb1Data="1" />
    </tapa.expect>

    <tapa.send>
       # Send data with size less than the allocated on RGU. 
       # if we can send less data from TA or to report a BO which
       # will surely result in padding 
       <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
    </tapa.send>
   
   <tapa.send>
      # Send DL_DELTA Ttis to get the MAC PDU at PHY.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="8:9:10:11:14:15" chkGrant="TRUE" use="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   # UE reconfiguration to re-configure UE's aperiodic and periodic mode
   # reporting configuration to no reporting mode 
   <tapa.send>
      <tapa.rgr.cfgreq.recfg.ue cellId="3" oldUeId="0" newcrnti="11"
       UeReCfgType="6" aprdModeEnumPres="FALSE" prdModeEnumPres="FALSE"/>
   </tapa.send>
   
   <tapa.send>
      # Send DL_DELTA Ttis to get the MAC PDU at PHY.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5" />
   </tapa.expect>
   
   # UE reconfiguration to re-configure UE's periodic reporting mode to mode 2-0
   <tapa.send>
      <tapa.rgr.cfgreq.recfg.ue cellId="3" oldUeId="0" newcrnti="11"
         UeReCfgType="6" aprdModeEnumPres="FALSE" prdModeEnumPres="TRUE" 
         prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"/>
   </tapa.send>
   
   <tapa.send>
      # Send DL_DELTA Ttis to get the MAC PDU at PHY.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5" />
   </tapa.expect>

   # UE reconfiguration to re-configure UE's periodic reporting mode to mode 1-0
   <tapa.send>
      <tapa.rgr.cfgreq.recfg.ue cellId="3" oldUeId="0" newcrnti="11"
         UeReCfgType="6" aprdModeEnumPres="FALSE" prdModeEnumPres="TRUE" 
         prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>
   </tapa.send>
   
   <tapa.send>
      # Send DL_DELTA Ttis to get the MAC PDU at PHY.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5" />
   </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.13
#
#       Desc:   "To test the DL path for a re-tx UE with UE configured to 
#                report CQI in periodic mode 1-0 for a frequency selective cell.
#                and reported Wb cqi and sub-band cqi less than threshold cqi."
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.13">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Unsuccessful DL path for a re-tx UE in frequency selective cell and periodic
         CQI report for mode 1-0 when reported wideband CQI and sub-band CQI is less than
         threshold CQI.
      </tapa.desc>

      <tapa.longdesc>
         Testing that re-tx UE does not recieve DL data successfully on 
         reporting CQI through periodic CQI reporting mode 1-0 in a frequency
         selective cell when reported wideband CQI and sub-band CQI 
         is less than threshold CQI.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="15" thresholdCqi= "7"/>

      # UE Creation with aperiodic mode 3-0 and periodic mode 1-0
      <tapa.rg.UeInit ueCatEnum="1" aprdModeEnumPres = "TRUE"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      # Send CQI indication for periodic mode 1-0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="0" cqiIdx="10"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="120"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>

      # Send CQI indication for aperiodic mode 3-0 with wideband and sub-band
      # CQI greater than threshold CQI
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="FALSE" cqiMode="3" wbCqi="8"
            numOfSubbands = "4" rbStartLst = "0:4:8:12" numRbLst =
            "4:4:4:3" cqiIdxLst="7:6:9:4"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" vldtSbAlloc="TRUE"
           allocSbIds="0:1:2:3:4:5:6:7:8" chkGrant="TRUE" use="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 3 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      # Send CQI indication for aperiodic mode 3-0 with wideband and sub-band
      # CQI less than threshold CQI
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="FALSE" cqiMode="3" wbCqi="6"
            numOfSubbands = "4" rbStartLst = "0:4:8:12" numRbLst =
            "4:4:4:3" cqiIdxLst="2:5:6:7"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
   
   <tapa.send>
      # Send multiple Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      # Nothing is recieved since overall CQI is less than threshold CQI.
      # Not sufficient good sub-bands are available
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send> 

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.14
#
#       Desc:   "To test the successful DL path for a MAC PDU for a frequency 
#                selective cell (DL BW = 6 Rbs) with UE configured to report CQI 
#                through periodic mode 2-0"
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.14">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a UE in frequency selective cell (DL BW = 6) 
         and periodic CQI report for mode 2-0.
      </tapa.desc>

      <tapa.longdesc>
         Testing that UE recieves DL data successfully on reporting CQI through
         periodic CQI reporting mode 2-0 in a frequency selective cell (DL BW =
         6).
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="6" thresholdCqi= "5"/>

      # UE Creation with periodic mode 2-0
      <tapa.rg.UeInit ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"
         maxDlHqTx="1"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      <tapa.send>
         # Send a 6 Tti before sending wide-band CQI for the UE
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      
      # Send wideband CQI indication for periodic mode 2-0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="TRUE"
              wbCqi="6" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a 2 Tti before sending sub-band CQI for the BP Index = 0
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for first sub-band of
      # BP index = 0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="TRUE"
              wbCqi="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a 2 Tti before sending sub-band CQI for the BP Index = 1
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for second sub-band of
      # BP index = 1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="TRUE"
              wbCqi="4"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a 2 Tti before sending sub-band CQI for the BP Index = 2
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for second sub-band of
      # BP index = 2
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="TRUE"
              wbCqi="10"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="70"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  validate="TRUE" chkGrant="TRUE" use="1"
           vldtSbAlloc="TRUE" allocSbIds="0:1:2:3:4:5"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
      
      <tapa.send>
         # Send a 1 Tti before sending wide-band CQI for second cycle of
         # reporting
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Send wideband CQI indication for periodic mode 2-0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="TRUE"
              wbCqi="8" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a Np = 2 Tti before sending sub-band CQI for the BP Index = 0
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for first sub-band of
      # BP index = 0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="TRUE"
              wbCqi="7"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a Np = 2 Tti before sending sub-band CQI for the BP Index = 1
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for second sub-band of
      # BP index = 1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="TRUE"
              wbCqi="9"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a Np = 2 Tti before sending sub-band CQI for the BP Index = 2
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # Send sub-band CQI indication for periodic mode 2-0 for second sub-band of
      # BP index = 2
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="TRUE" cqiMode="2" isWideband="TRUE"
              wbCqi="10"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="70"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="2" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req  use="2" validate="TRUE"
           vldtSbAlloc="TRUE" allocSbIds="0:1:2:3:4:5"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.15
#
#       Desc:    Successful data path on BCCH-DLSCH, PCCH channels and a TX UE for a
#       frequency selective cell.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.15">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Successful data path on BCCH-DLSCH, PCCH channels with one UE to be
         scheduled in DL" 
      </tapa.desc>

      <tapa.longdesc>
         "Successful data path on BCCH-DLSCH, PCCH channels with one UE to be
         scheduled in DL" 
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      # Modified for SI Enhancement*/
      <tapa.ifndef>
         <tapa.flag id="RGR_SI_SCH"/>
         <tapa.flag id="LTEMAC_HDFDD"/>
      </tapa.ifndef>
   
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      # TODO: remove explicit CQI value
      # 16 RBs are needed by common channels in this TC
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="25"
         thresholdCqi= "5" dlCcchCqi="3"/>

      # UE Creation with aperiodic mode 2-0
      <tapa.rg.UeInit ueCatEnum="1" aprdModeEnumPres = "TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # This TTI is a must that initializes the test frame info
      # This sets the cell frame info to {0, 0}
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send BO for BCCH-DLSCH logical channel on RGU.
         # BCCH on DLSCH is configured with lcId as 2
         # Data is requested to be scheduled at {0, 5}
         <tapa.rgu.cstarsp lcId="2" lcType="1" bo="55" sfOffset="5"/>
      </tapa.send>

      <tapa.send>
         # Send BO for PCCH logical channel on RGU.
         # Data is requested to be scheduled at {0, 5}
         <tapa.rgu.cstarsp lcId="3" lcType="2" bo="32" sfOffset="5"/>
      </tapa.send>

      # The data is given out 2 subframes in advance when time is {0, 3}
      # StaInd goes to RLC 3 subframes in advance at {0, 2}
      # Send 2 Ttis to get the transmission scheduled.
      # Send them individually so that if staInd comes in between, it will
      # fail. 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Send CQI indication for aperiodic mode 2-0
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi isPucchInfo="FALSE" cqiMode="1" wbCqi="8" cqiIdx="10"
            numOfSubbands = "5" rbStartLst = "0:12:16:20:24" numRbLst =
            "2:2:2:2:1" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
   
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="1" lcType="5" bo="120"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for common channels 
         <tapa.rgu.cstaind lcId="3" boSatisfied="TRUE" maxRb="3" saveTransId="1"/>
         <tapa.rgu.cstaind lcId="2" boSatisfied="TRUE" maxRb="3" saveTransId="2"/>
         # Expect staInd from MAC to RLC for UE 
         <tapa.rgu.dstaind lchTb1Data="1" />
      </tapa.expset>

      <tapa.send>
         # Send BCCH-DLSCH data to MAC on RGU. 
         <tapa.rgu.cdatreq lcId="2" lcType="1" use="1" bcchIdx="1"/>
      </tapa.send>

      <tapa.send>
         # Send PCCH data to MAC on RGU. 
         <tapa.rgu.cdatreq lcId="3" lcType="2" use="2" bcchIdx="2"/>
      </tapa.send>

      <tapa.send>
         # Send data with size less than the allocated on RGU. 
         # if we can send less data from TA or to report a BO which
         # will surely result in padding 
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1" lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect PDUs from MAC to PHY.
        <tapa.tfu.dat.req datReqs="2">
           <tapa.tfu.pdsch.dat.req  use="1" lcId="2" bcchIdx="1"/>
           <tapa.tfu.pdsch.dat.req use="2" lcId="3" bcchIdx="2"/>
           <tapa.tfu.pdsch.dat.req  use="3" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="0:6:8:10:12"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req  saveTo="1"/>
           <tapa.tfu.pdcch.cntrl.req  saveTo="2"/>
           <tapa.tfu.pdcch.cntrl.req  saveTo="3"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.recp.req numRntis="1" spId="1">
           <tapa.tfu.hq.recp.req ueId="0"/>
        </tapa.tfu.recp.req>   
      </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      <tapa.send>
        <tapa.tfu.hq.ind hqInds="1">
           <tapa.tfu.hq ueId="0"/>
        </tapa.tfu.hq.ind>   
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

      # Layer Manager ShutDown

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.16
#
#       Desc:   "To test Msg4 Re-tx handling in a frequency selective cell"
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.16">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Handling of NACK for Msg4"
      </tapa.desc>

      <tapa.longdesc>
         "Order in which msgs are received: Msg3, Msg4 and then NACK for Msg4"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration with maximum msg4 transmissions = 2
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="25"
         thresholdCqi= "5" dlCcchCqi="3" maxMsg4HqTx="2"/>
      <tapa.rg.dbgDeInitAll/>
      #<tapa.rg.dbgInitAll/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      # Send RaReqInd for one rapId 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="8" numRapId="1" rapIds="1" timingAdvs="3"
                                   tpcs="1" cqiPres="TRUE" cqis="4" ueId="0"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      # Assuming start of this step we are at (0,0)
      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # The number of subframes to wait for receiving the RA RSP is maximum of
      # RA RSP window and the scheduling delta RG_DL_DELTA (=3) minus the 
      # TFU_DELTA (=2) from the next TTI. This makes the number of TTIs 2 (3 - 2
      # + 1).
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      # At start of this step, we are at (0,1)
      # Expect RaResp for the rapId sent in RaReq. Validate the RAR Pdu
      # creation as well
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="8" vldtRar="TRUE" saveTo="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      # At start of this step, we are at (0,1)
      # Counting the TTIs, RA RSP was received by PHY at sf = (0,2). PHY tranmits
      # the RA RSP in sf = (0, 4). UE will transmit the MSG3 at sf = (1, 0). We 
      # must receive data reception request at sf = (0, 8). Current TTI = (0, 2)
      # and hence we must send 6 TTIs.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>

      # At start of this step, we are at (0,7)
      # Expect Message3 reception req. Validation against the grant given in
      # raResp shall be done
      <tapa.expect>
         <tapa.tfu.recp.req numRntis="1">
            <tapa.tfu.msg3.recp.req/>
         </tapa.tfu.recp.req>
      </tapa.expect>

      # At start of this step, we are at (0,7)
      # Send (TFU_DELTA(=2) + TFU_UL_DELTA(=1)) TTIs
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
   #Send CRC for Msg3
   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect HARQ ACK in PHICH For MSG3
   <tapa.expect>
      <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>
      
      # At start of this step, we are at (1,0)
      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat isCcchSdu="TRUE" sduSize="6" ueId="0"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

      # At start of this step, we are at (1,0)
      # Expect Message3 datInd on CCCH at RGU.
      <tapa.expect>
         <tapa.rgu.cdatind ueId="0" lcId="4"/>
      </tapa.expect>

      # At start of this step, we are at (1,0)
      # Send TTI to apply the config
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # At start of this step, we are at (1,1)
      # Send BO for Msg4 on RGU. 
      <tapa.send>
         <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10"/>
      </tapa.send>

      # At start of this step, we are at (1,1)
      # Send a Tti to get Msg4 transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
   
      # At start of this step, we are at (1,2)
      # Expect staInd from MAC to RLC for Msg4 
      <tapa.expect>
         <tapa.rgu.cstaind lcId="4"/>
      </tapa.expect>

      # At start of this step, we are at (1,2)
      # Send Msg4 on RGU. 
      <tapa.send>
         <tapa.rgu.cdatreq ueId="0" lcId="4" lcType="3" />
      </tapa.send>

      # At start of this step, we are at (1,2)
      # Send 1 TTI to get MSG4 at PHY
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # At start of this step, we are at (1,3)
      # Expect Msg4 from MAC to PHY
   <tapa.expset>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req validate="TRUE" chkCcchSh="TRUE"/>
     </tapa.tfu.dat.req>   
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req/>
     </tapa.tfu.cntrl.req>
   </tapa.expset>
      
      # At start of this step, we are at (1,3)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="0" op="RG_ACC_PLUS" numTfuDelta="1"/>
      </tapa.send>
      
      # At start of this step, we are at (1,5)
      # Send 2 more TTI before HARQ reception request
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # At start of this step, we are at (1,7)
      # Expect harq ack reception request for HARQ ACK for Msg4.
   <tapa.expect>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req/>
     </tapa.tfu.recp.req>   
   </tapa.expect>
      
      # At start of this step, we are at (1,7)
      # Send TTIs = (TFU_DELTA(=2) + TFU_UL_DELTA(=1)) before sending HARQ ACK
      # to MAC
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3" />
      </tapa.send>
      
      # At start of this step, we are at (2,0)
      # Send NACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
      
      # At start of this step, we are at (2,1)
      # Send 2 TTIs(SCHEDULING_RETX(=1) + RG_DL_DELTA(=3) - TFU_DELTA(=2)) before expecting 
      # Pdcch request and data request for Msg4 re-transmission.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # At start of this step, we are at (2,3)
      # Expecting a pdcch request and data request for MSG4 re-transmission.
   <tapa.expset>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req validate="TRUE" chkCcchSh="TRUE"/>
     </tapa.tfu.dat.req>   
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req/>
     </tapa.tfu.cntrl.req>
   </tapa.expset>      

      # At start of this step, we are at (2,3)
      # Send 4 TTIs before expecting a HARQ reception request for MSG4
      # re-transmission.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      
      # At start of this step, we are at (2,7)
      # Expect harq ack reception request for HARQ ACK for Msg4.
   <tapa.expect>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

      # At start of this step, we are at (2,7)
      # Send 3 TTIs before expecting a HARQ feedback for MSG4
      # re-transmission.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      
      # At start of this step, we are at (3,0)
      # Send final NACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
      
      # At start of this step, we are at (3,0)
      # Send 1 TTI for NACK processing
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1" />
      </tapa.send>

      # RG_MAX_RA_PRC_FRM from 6 to 10 
      # At start of this step, we are at (3,1)
      # Send 69 TTIs to delete raCb after 
      # raPrcFrm number of TTIs (raPrcFrm = RG_MAX_RA_PRC_FRM = 150)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1500" />
      </tapa.send>

      # At start of this step, we are at (10,0)
      # Send UE config request from RRC when MSG4 is finally NACKED
      <tapa.send>
         <tapa.crg.cfgreq.cfg.ue ueId="0"/>
      </tapa.send>

      # At start of this step, we are at (10,1)
      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Send UE config request from RRC when MSG4 is finally NACKED
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.ue ueId="0" instId="5"/>
      </tapa.send>

      # At start of this step, we are at (10,0)
      # Send TTI to apply the config
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # At start of this step, we are at (10,1)
      # Expect failure in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0" instId="5"/>
      </tapa.expect>

      # LTE-MAC layer shutdown
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.17
#
#       Desc:   "Verify that, among GBR channels, channels with
#                higher priority (lower priority value) are
#                satisfied first by PFS for 2 UEs and the requirement is 
#                honoured by DLFS in repective best available sub-bands
#                [Good sub-bands for the UE partially coincide]."
#
#       Notes:   None
#
#       Module:  "PFS"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.17">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that, among GBR channels, channels with
          higher priority (lower priority value) are
          satisfied first by PFS for 2 UEs and the requirement is 
          honoured by DLFS in UEs' respective best sub-bands for partially
          coinciding best sub-bands."
      </tapa.desc>

      <tapa.longdesc>
         "Verify that, among GBR channels, channels with
          higher priority (lower priority value) are
          satisfied first and the requirement is 
          honoured by DLFS in UEs' respective best sub-bands for partially
          coinciding best sub-bands."
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="DLFS_INV"/>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="25"
         thresholdCqi= "5" maxDlBwPerUe="25" dlSchdType="1"/>

      # UEs Creation
      <tapa.rg.2UeInit ueCatEnum="1" aprdModeEnumPres = "TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a DTCH at MAC (not scheduler) for UE 0
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="1"
            dir="3" lcType="4"/>
      </tapa.send>

      # Configure a DTCH at MAC (not scheduler) for UE 1
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="4" lcgId="1"
            dir="3" lcType="4"/>
      </tapa.send>

      # Configure DTCH (GBR) with priority 1 (QCI 1) for UE 0 (RGR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" dlQci="1"
            dlGbr="2000" dlMbr="7000" lcType="4" instId="5"/>
      </tapa.send>

      # Configure DTCH (GBR) with priority 2 (QCI 2) for UE 1 (RGR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="4" dir="1" dlQci="5"
            dlGbr="2000" dlMbr="7000" lcType="4" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect the successful confirms
      <tapa.expset>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send enough BO for lower priority channel first,
      # and then for the higher priority one
      # (Actually, any order is ok. But this order
      # tends to be better for testing.)
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="3" bo="400"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="4" bo="400"/>
      </tapa.send>
      
      # Send CQI indication for aperiodic mode 2-0 for first UE
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="0" isPucchInfo="FALSE" cqiMode="1" wbCqi="8" cqiIdx="10"
            numOfSubbands = "5" rbStartLst = "0:12:16:20:24" numRbLst =
            "2:2:2:2:1" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send CQI indication for aperiodic mode 2-0 for second UE
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="1" isPucchInfo="FALSE" cqiMode="1" wbCqi="8" cqiIdx="12"
            numOfSubbands = "5" rbStartLst = "10:12:8:2:24" numRbLst =
            "2:2:2:2:1" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect staInds from MAC
      <tapa.expset>
         <tapa.rgu.dstaind ueId="1" lchTb1Data="4"/>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="3"/>
      </tapa.expset>

      # Send data corresponding to staInds
      <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="3" ueId="0" lcId="3"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="4" ueId="1" lcId="4"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA(3) - TFU_DELTA(2) Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.cntrl.req numCntrlReq="2">
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
            <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="2">
            <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="0:6:8:10:12"/>
            <tapa.tfu.pdsch.dat.req ueId="1" use="2" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="5:6:4:1:12"/>
         </tapa.tfu.dat.req>
      </tapa.expset>

      # Not sending data for DTCH anymore, ending TC here
      #<tapa.send>
      #   <tapa.rgu.ddatreq lchTb1Data="1" ueId="1" lcId="3"/>
      #</tapa.send>

   </tapa.test>
   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.18
#
#       Desc:   "To test successful DL path for RR scheduler with 2 UEs and DLFS
#       shall satisfy the requested allocation in the respective best available
#       sub-bands for the UE [Good sub-bands of the UEs fully coincide].
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.18">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To test successful DL path for RR scheduler with 2 UEs and DLFS
          shall satisfy the requested allocation in the respective best available
          sub-bands for the UE with fully coinciding best sub-bands."
      </tapa.desc>

      <tapa.longdesc>
         "To test successful DL path for RR scheduler with 2 UEs and DLFS
          shall satisfy the requested allocation in the respective best available
          sub-bands for the UE with fully coinciding best sub-bands."
      </tapa.longdesc>

   </tapa.doc>


   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="50"
         thresholdCqi= "5" dlSchdType="2"/>

      # UE Creation
      <tapa.rg.2UeRrInit ueCatEnum="1" aprdModeEnumPres = "TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      #UE1 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      #UE2 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send CQI indication for aperiodic mode 2-0 for first UE
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="0" isPucchInfo="FALSE" cqiMode="1" wbCqi="8" cqiIdx="10"
            numOfSubbands = "5" rbStartLst = "0:9:15:45:48" numRbLst =
            "3:3:3:3:2" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send CQI indication for aperiodic mode 2-0 for second UE
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="1" isPucchInfo="FALSE" cqiMode="1" wbCqi="6" cqiIdx="12"
            numOfSubbands = "4" rbStartLst = "0:9:15:45" numRbLst =
            "3:3:3:3" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      #Send BO for UE1
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="50"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="2" bo="25"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" bo="20"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="4" bo="30"/>
      </tapa.send>

      #Send BO for UE2
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="1" bo="30"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="2" bo="30"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="3" bo="30"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="4" bo="30"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind ueId="1" numLchTb1="4" lchTb1Data="1:2:3:4" />
         <tapa.rgu.dstaind ueId="0" numLchTb1="4" lchTb1Data="1:2:3:4" />
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE1 
         <tapa.rgu.ddatreq ueId="0" numLchTb1="4" lchTb1Data="1,0,1:2,0,1:3,0,1:4,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DDatReq for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="4" lchTb1Data="1,0,1:2,0,1:3,0,1:4,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="16"/>
        <tapa.tfu.pdsch.dat.req ueId="1" use="2" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="0:3:5:15"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expect>
     <tapa.tfu.recp.req numRntis="2" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind>
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.19
#
#       Desc:   "To test successful DL path for SC1 scheduler with 3 UEs and DLFS
#       shall satisfy the requested allocation in the respective best available
#       sub-bands for the UE [Good sub-bands of the UEs fully coincide].
#
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.19">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To test successful DL path for SC1 scheduler with 3 UEs and DLFS
          shall satisfy the requested allocation in the respective best available
          sub-bands for the UE with fully coinciding best sub-bands."
      </tapa.desc>

      <tapa.longdesc>
         "To test successful DL path for SC1 scheduler with 3 UEs and DLFS
          shall satisfy the requested allocation in the respective best available
          sub-bands for the UE with fully coinciding best sub-bands."
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="50" maxDlUeNewTxPerTti="4" maxUePerDlSf="4" maxUlUeNewTxPerTti="4" maxUePerUlSf="4"
         thresholdCqi= "5" dlSchdType="0"/>

      # UE Creation
      <tapa.rg.3UeDlfsInit ueCatEnum="1"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      #UE1 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      #UE2 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      #UE3 configuration
      <tapa.rg.dbgInitAll/>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="2" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="2" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>
      
      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      
      # Send CQI indication for aperiodic mode 2-0 for first UE
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="0" isPucchInfo="FALSE" cqiMode="1" wbCqi="8" cqiIdx="10"
            numOfSubbands = "5" rbStartLst = "0:9:15:45:48" numRbLst =
            "3:3:3:3:2" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send CQI indication for aperiodic mode 2-0 for second UE
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="1" isPucchInfo="FALSE" cqiMode="1" wbCqi="7" cqiIdx="12"
            numOfSubbands = "4" rbStartLst = "0:9:15:45" numRbLst =
            "3:3:3:3" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send CQI indication for aperiodic mode 3-0 for third UE
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="2" isPucchInfo="FALSE" cqiMode="3" wbCqi="6"
            numOfSubbands = "9" rbStartLst="0:6:12:18:24:30:36:42:48" numRbLst =
            "6:6:6:6:6:6:6:6:2" cqiIdxLst="7:14:13:8:3:5:9:12:11" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      #Send BO for UE1
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="2" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="4" bo="64"/>
      </tapa.send>

      #Send BO for UE2
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="2" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="3" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="4" bo="64"/>
      </tapa.send>

      #Send BO for UE3
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="2" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="2" lcId="2" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind ueId="2" numLchTb1="2" lchTb1Data="1:2" />
         <tapa.rgu.dstaind ueId="1" numLchTb1="4" lchTb1Data="1:2:3:4" />
         <tapa.rgu.dstaind ueId="0" numLchTb1="4" lchTb1Data="1:2:3:4" />
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE1 
         <tapa.rgu.ddatreq ueId="0" numLchTb1="4" lchTb1Data="1,0,1:2,0,1:3,0,1:4,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DDatReq for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="4" lchTb1Data="1,0,1:2,0,1:3,0,1:4,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DDatReq for UE3
         <tapa.rgu.ddatreq ueId="2" numLchTb1="2" lchTb1Data="1,0,1:2,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
        <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="3"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="16"/>
        <tapa.tfu.pdsch.dat.req ueId="1" use="2" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="0:3:5:15"/>
        <tapa.tfu.pdsch.dat.req ueId="2" use="3" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="2:3:4:5:14:15"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expect>
     <tapa.tfu.recp.req numRntis="2" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
        <tapa.tfu.hq.recp.req ueId="2"/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind>
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
        <tapa.tfu.hq ueId="2"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.20
#
#       Desc:   "To test handling of multiple RA-RNTIs in a frequency selective
#       cell." 
#
#       Notes:   None
#              
#       Module:  "Random Access Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.20">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Successful handling of multiple simultaneous random access procedures
- different RA-RNTIs in a frequency selective cell."
      </tapa.desc>

      <tapa.longdesc>
         "Two RA-RNTIs in two different random access request indications shall
         be handled in a frequency selective cell."
      </tapa.longdesc>

   </tapa.doc>
  #ccpu00117281- removes SSI_DEBUG_LEVEL1 dependency
  #changed dlTotalBw to 21 and bcchPchCodeRate to 256 and bo to 79
   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      # Modified for SI Enhancement*/
      <tapa.ifndef>
         <tapa.flag id="RGR_SI_SCH"/>
         <tapa.flag id="LTEMAC_HDFDD"/>
      </tapa.ifndef>
   
      <tapa.mode mode="single"/>
   
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      # Configure minimum possible dlBW so that it will be occupied in the
      # first scheduling subframe completely by BCCH and PCCH data!
      <tapa.rg.cellInit isDlFreqSel="1" thresholdCqi= "5" dlSchdType="0"
         dlTotalBw="21" cfi="3" bcchPchCodeRate="256"
         dlCcchCqi="3"/>
      <tapa.rg.dbgDeInitAll/>
      #<tapa.rg.dbgInitAll/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      
      # At start of this step, we are at (0,0)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      #Darshan - changed bo to 75 from 79
      # At start of this step, we are at (0,0)
      # Send BO for BCCH on DLSCH
      <tapa.send>
         <tapa.rgu.cstarsp lcId="2" lcType="1" bo="75" sfOffset="6" />
      </tapa.send>

      # At start of this step, we are at (0,0)
      # Send BO for PCCH
      <tapa.send>
         <tapa.rgu.cstarsp lcId="3" lcType="2" bo="75" sfOffset="6" />
      </tapa.send>
      
      # At start of this step, we are at (0,0)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # At start of this step, we are at (0,2)
      # Send RaReqInd for one raRnti = 1
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="1" numRapId="2" rapIds="18:35"
               timingAdvs="2:3" tpcs="1:2" cqiPres="TRUE:TRUE"
               cqis="12:13"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      # At start of this step, we are at (0,2)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # At start of this step, we are at (0,3)
      # At the end of first TTI, expect CstaInd for BCCH on DLSCH and PCCH.
      <tapa.expset>
         <tapa.rgu.cstaind lcId="3"/>
         <tapa.rgu.cstaind lcId="2"/> 
      </tapa.expset>
      
      # At start of this step, we are at (0,3)
      # Send BCCH and PCCH data on RGU. 
      <tapa.send>
         <tapa.rgu.cdatreq bcchIdx="0" lcId="2" lcType="1" bufSize="41"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgu.cdatreq bcchIdx="1" lcId="3" lcType="2" bufSize="41"/>
      </tapa.send>

      # At start of this step, we are at (0,3)
      # Send RaReqInd for second raRnti = 2
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="2" numRapId="1" rapIds="22"
               timingAdvs="3" tpcs="3" cqiPres="TRUE" cqis="12"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>
      
      # At start of this step, we are at (0,4)
      # Send 1 TTI to get BCCH and PCCH data at PHY
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # At start of this step, we are at (0,5)
      # Expect BCCH and PCCH data from MAC to PHY
   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req saveTo="2"/>
        <tapa.tfu.pdcch.cntrl.req saveTo="3"/>
     </tapa.tfu.cntrl.req>
   # Expect Msg4 from MAC to PHY.
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req bcchIdx="0" ueId="0" use="2"/>
        <tapa.tfu.pdsch.dat.req bcchIdx="1"  ueId="1" use="3"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      # At start of this step, we are at (0,4)
      # Send 1 TTI before expecting Random access response 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # At start of this step, we are at (0,5)
      # UE1 starts expecting random access response at raRnti(=2) +
      # NumberofRaSubframes(=1) + RaRsp(=3) = 6 subframes after raReq
      # transmission
      # MAC shall send response delayed by 1 TTI and so after 3 TTIs(6 - TFU_UL_DELTA(=1)
      # - RG_DL_DELTA(=2)), MAC shall send it to PHY
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="2">
           <tapa.tfu.rarsp.req  raRnti="1" expectAll="TRUE" vldtRar="TRUE"/>
           <tapa.tfu.rarsp.req raRnti="2" expectAll="TRUE" vldtRar="TRUE"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req/>
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      # At start of this step, we are at (0,5)
      # Counting the TTIs, RA RSP was received by PHY at sf = (0,2). PHY tranmits
      # the RA RSP in sf = (0, 4). UE will transmit the MSG3 at sf = (1, 0). We 
      # must receive data reception request at sf = (0, 8). Current TTI = (0, 2)
      # and hence we must send 6 TTIs.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>

      # At start of this step, we are at (0,7)
      # Expect Message3 reception req. Validation against the grant given in
      # raResp shall be done
      <tapa.expect>
         <tapa.tfu.recp.req numRntis="3">
            <tapa.tfu.msg3.recp.req vldtMsg3Grant="TRUE" ueId="0"/>
            <tapa.tfu.msg3.recp.req vldtMsg3Grant="TRUE" ueId="1"/>
            <tapa.tfu.msg3.recp.req vldtMsg3Grant="TRUE" ueId="2"/>
         </tapa.tfu.recp.req>
      </tapa.expect>

      # At start of this step, we are at (0,7)
      # Send (TFU_DELTA(=2) + TFU_UL_DELTA(=1)) TTIs
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      
         #Send CRC for Msg3
   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         <tapa.tfu.crc ueId="2" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect HARQ ACK in PHICH For MSG3
   <tapa.expect>
      <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE" ueId="0"/>
         <tapa.tfu.phich.cntrl.req isAck="TRUE" ueId="1"/>
         <tapa.tfu.phich.cntrl.req isAck="TRUE" ueId="2"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

      # At start of this step, we are at (1,0)
      # Send Message3 after receiving Message3 reception req.
      # Send CCCH SDU
      <tapa.send>
       <tapa.tfu.dat.ind datInds="3">
          <tapa.tfu.dat isCcchSdu="TRUE" sduSize="2" ueId="0"/>
          <tapa.tfu.dat isCcchSdu="TRUE" sduSize="2" ueId="1"/>
          <tapa.tfu.dat isCcchSdu="TRUE" sduSize="2" ueId="2"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

      # At start of this step, we are at (1,0)
      # Expect Message3 datInd on CCCH at RGU.
      <tapa.expset>
         <tapa.rgu.cdatind ueId="0" lcId="4"/>
         <tapa.rgu.cdatind ueId="1" lcId="4"/>
         <tapa.rgu.cdatind ueId="2" lcId="4"/>
      </tapa.expset>

      # At start of this step, we are at (1,0)
      # Send 1 TTI to process Msg3 data indication
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # At start of this step, we are at (1,1)
      # Send BO for Msg4 on RGU. 
      <tapa.send>
         <tapa.rgu.cstarsp lcId="4" lcType="3" bo="2" ueId ="0"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgu.cstarsp lcId="4" lcType="3" bo="2" ueId ="1"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgu.cstarsp lcId="4" lcType="3" bo="2" ueId ="2"/>
      </tapa.send>


      # At start of this step, we are at (1,1)
      # Send a Tti to get Msg4 transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
   
      # At start of this step, we are at (1,2)
      # Expect staInd from MAC to RLC for Msg4 
      <tapa.expset>
         <tapa.rgu.cstaind lcId="4" ueId="0"/>
         <tapa.rgu.cstaind lcId="4" ueId="1"/>
         <tapa.rgu.cstaind lcId="4" ueId="2"/>
      </tapa.expset>

      # At start of this step, we are at (1,2)
      # Send Msg4 on RGU. 
      <tapa.send>
         <tapa.rgu.cdatreq bcchIdx="1" ueId="0" lcId="4" lcType="3" />
      </tapa.send>
      <tapa.send>
         <tapa.rgu.cdatreq bcchIdx="2" ueId="1" lcId="4" lcType="3" />
      </tapa.send>
      <tapa.send>
         <tapa.rgu.cdatreq bcchIdx="3" ueId="2" lcId="4" lcType="3" />
      </tapa.send>

      # At start of this step, we are at (1,2)
      # Send 1 TTI to get MSG4 at PHY
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # At start of this step, we are at (1,3)
      # Expect Msg4 from MAC to PHY
   <tapa.expset>
     <tapa.tfu.dat.req datReqs="3">
        <tapa.tfu.pdsch.dat.req  use="1" bcchIdx="1" validate="TRUE" chkCcchSh="TRUE" ueId="0"/>
        <tapa.tfu.pdsch.dat.req use="2" bcchIdx="2" validate="TRUE" chkCcchSh="TRUE" ueId="1"/>
        <tapa.tfu.pdsch.dat.req use="3" bcchIdx="3" validate="TRUE" chchkCcchSh="TRUE" ueId="2"/>
     </tapa.tfu.dat.req>   
     <tapa.tfu.cntrl.req numCntrlReq="3">
        <tapa.tfu.pdcch.cntrl.req  saveTo="1" ueId="0"/>
        <tapa.tfu.pdcch.cntrl.req saveTo="2" ueId="1"/>
        <tapa.tfu.pdcch.cntrl.req saveTo="3" ueId="2"/>
     </tapa.tfu.cntrl.req>
   </tapa.expset>
      
      # Send 2 TTI to get data reception request for MSG3 re-transmission
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # At start of this step, we are at (1,5)
      # Send 2 more TTI before HARQ reception request
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      # At start of this step, we are at (1,7)
      # Expect harq ack reception request for HARQ ACK for Msg4.
   <tapa.expect>
     <tapa.tfu.recp.req numRntis="3">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
        <tapa.tfu.hq.recp.req ueId="2"/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

      # At start of this step, we are at (1,7)
      # Send TTIs = (TFU_DELTA(=2) + TFU_UL_DELTA(=1)) before sending HARQ ACK
      # to MAC for ueId=0 and ueId=1
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3" />
      </tapa.send>
      
      # At start of this step, we are at (2,0)
      # Send ACK as feedback for Msg4 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="3">
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
        <tapa.tfu.hq ueId="2"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      # At start of this step, we are at (2,0)
      # Send TTI to validate that there are no pending messages at MAC 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # At start of this step, we are at (2,1)
      # Send UE config request from RRC for ueId=0
      # Send UE reconfig request from RRC for ueId=1
      <tapa.send>
         <tapa.crg.cfgreq.cfg.ue ueId="0"/>
      </tapa.send>
      <tapa.send>
         <tapa.crg.cfgreq.cfg.ue ueId="1"/>
      </tapa.send>
      <tapa.send>
         <tapa.crg.cfgreq.recfg.ue oldUeId="3" newUeId="2"/>
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.ue ueId="0" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.ue ueId="1" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.ue oldUeId="3" newUeId="2" instId="5"/>
      </tapa.send>
      # At start of this step, we are at (2,1)
      # Send TTI to apply the config
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # At start of this step, we are at (2,2)
      # Expect success in cfg cfm for ueId=0
      # Expect failure in cfg cfm for ueId=1
      <tapa.expset>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm status="15"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm status="15" instId="5"/>
      </tapa.expset>

      # At start of this step, we are at (2,1)
      # Send TTI to check if the are no pending msgs at MAC 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # LTE-MAC layer shutdown
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.21
#
#       Desc:   "To test successful DL path for SC1 scheduler with 8 UEs and DLFS
#       shall satisfy the requested allocation in the respective best available
#       sub-bands for the UE. The UEs to be scheduled shall be mix of
#       transmitting and re-transmitting Ues.
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.21">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To test successful DL path for SC1 scheduler with 8 UEs and DLFS
         shall satisfy the requested allocation in the respective best available
         sub-bands for the UE. The UEs to be scheduled shall be mix of
         transmitting and re-transmitting Ues.
      </tapa.desc>

      <tapa.longdesc>
         To test successful DL path for SC1 scheduler with 8 UEs and DLFS
         shall satisfy the requested allocation in the respective best available
         sub-bands for the UE. The UEs to be scheduled shall be mix of
         transmitting and re-transmitting Ues.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
         <tapa.flag id="LTEMAC_RGU_PAD"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="60" maxDlUeNewTxPerTti="4" maxUePerDlSf="4" maxUlUeNewTxPerTti="4" maxUePerUlSf="4"
         thresholdCqi= "5" dlSchdType="0"/>

      # UE Creation
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" aprdModeEnumPres = "TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"/>
      
      <tapa.rg.UeInit ueId="1" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"/>
      
      <tapa.rg.UeInit ueId="2" ueCatEnum="1" aprdModeEnumPres="TRUE"
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30"/>
      
      <tapa.rg.UeInit ueId="3" ueCatEnum="1" cqiPmiCfgIdx="1" k="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>
      
      <tapa.rg.UeInit ueId="4" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"/>
      
      <tapa.rg.UeInit ueId="5" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"/>
      
      <tapa.rg.UeInit ueId="6" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>
      
      <tapa.rg.UeInit ueId="7" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      #UE1 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="3" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="4" lcId="5" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="5" lcId="6" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="6" lcId="7" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="7" lcId="8" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="2" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="3" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>
      
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="4" lcId="5" dir="1" lcType="4" instId="5" />
      </tapa.send>
      
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="5" lcId="6" dir="1" lcType="4" instId="5" />
      </tapa.send>
      
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="6" lcId="7" dir="1" lcType="4" instId="5" />
      </tapa.send>
      
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="7" lcId="8" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Current SFN = 18 sf = 3

      # Send CQI indication for aperiodic mode 2-0 for UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="0" isPucchInfo="FALSE" cqiMode="1" wbCqi="8" cqiIdx="10"
            numOfSubbands = "5" rbStartLst = "0:6:12:21:27" numRbLst =
            "3:3:3:3:2" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send CQI indication for aperiodic mode 3-0 for UE3
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="2" isPucchInfo="FALSE" cqiMode="3" wbCqi="7"
            numOfSubbands = "9" rbStartLst="0:6:12:18:24:30:36:42:48" numRbLst =
            "6:6:6:6:6:6:6:6:2" cqiIdxLst="7:14:13:8:3:5:9:12:11" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for aperiodic mode 2-0 for UE5
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="4" isPucchInfo="FALSE" cqiMode="1" wbCqi="9" cqiIdx="11"
            numOfSubbands = "5" rbStartLst = "0:9:15:45:48" numRbLst =
            "3:3:3:3:2" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for aperiodic mode 3-0 for UE6
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="5" isPucchInfo="FALSE" cqiMode="3" wbCqi="6"
            numOfSubbands = "9" rbStartLst="0:6:12:18:24:30:36:42:48" numRbLst =
            "6:6:6:6:6:6:6:6:2" cqiIdxLst="12:11:7:10:8:9:15:4:4" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for aperiodic mode 2-0 for UE7
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="6" isPucchInfo="FALSE" cqiMode="1" wbCqi="8"
              cqiIdx="8"
            numOfSubbands = "5" rbStartLst = "0:9:15:45:48" numRbLst =
            "3:3:3:3:2" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for aperiodic mode 3-0 for UE8
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="7" isPucchInfo="FALSE" cqiMode="3" wbCqi="6"
            numOfSubbands = "9" rbStartLst="0:6:12:18:24:30:36:42:48" numRbLst =
            "6:6:6:6:6:6:6:6:2" cqiIdxLst="7:14:13:8:3:5:9:12:4" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      #Send sub-band CQI for periodic mode 2-0 for UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
              sbCqi="5" label="2"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      #Send wide-band CQI for periodic mode 1-0 for UE4 
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="3" isPucchInfo="TRUE" cqiMode="0" cqiIdx="5"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      #Send BO for UE1
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="80"/>
      </tapa.send>

      #Send BO for UE2
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="2" bo="40"/>
      </tapa.send>

      #Send BO for UE3
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="2" lcId="3" bo="100"/>
      </tapa.send>

      #Send BO for UE4
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="3" lcId="4" bo="79"/>
      </tapa.send>

      #Send BO for UE5
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="4" lcId="5" bo="160"/>
      </tapa.send>

      #Send BO for UE6
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="5" lcId="6" bo="140"/>
      </tapa.send>
      
      #Send BO for UE7
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="6" lcId="7" bo="100"/>
      </tapa.send>
      
      #Send BO for UE8
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="7" lcId="8" bo="54"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for Msg4 
         # The priority of the UEs as selected by DLFS is same as this
         <tapa.rgu.dstaind ueId="7" numLchTb1="1" lchTb1Data="8" />
         <tapa.rgu.dstaind ueId="2" numLchTb1="1" lchTb1Data="3" />
         <tapa.rgu.dstaind ueId="5" numLchTb1="1" lchTb1Data="6" />
         <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="2" />
         <tapa.rgu.dstaind ueId="4" numLchTb1="1" lchTb1Data="5" />
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="1" />
         <tapa.rgu.dstaind ueId="6" numLchTb1="1" lchTb1Data="7" />
         <tapa.rgu.dstaind ueId="3" numLchTb1="1" lchTb1Data="4" />
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE1 
         <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DDatReq for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="2,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DDatReq for UE3
         <tapa.rgu.ddatreq ueId="2" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE4
         <tapa.rgu.ddatreq ueId="3" numLchTb1="1" lchTb1Data="4,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE5
         <tapa.rgu.ddatreq ueId="4" numLchTb1="1" lchTb1Data="5,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE6
         <tapa.rgu.ddatreq ueId="5" numLchTb1="1" lchTb1Data="6,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE7
         <tapa.rgu.ddatreq ueId="6" numLchTb1="1" lchTb1Data="7,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE8
         <tapa.rgu.ddatreq ueId="7" numLchTb1="1" lchTb1Data="8,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
        <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="3"/>
        <tapa.tfu.pdcch.cntrl.req ueId="3" saveTo="4"/>
        <tapa.tfu.pdcch.cntrl.req ueId="4" saveTo="5"/>
        <tapa.tfu.pdcch.cntrl.req ueId="5" saveTo="6"/>
        <tapa.tfu.pdcch.cntrl.req ueId="6" saveTo="7"/>
        <tapa.tfu.pdcch.cntrl.req ueId="7" saveTo="8"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="0:2:4:7:9"/>
        <tapa.tfu.pdsch.dat.req ueId="1" use="2" validate="TRUE"
              vldtSbAlloc="TRUE"
              allocSbIds="0:1:2:3:4:5:6:7:8:9:10:11:12:13:14:15:16"/>
        <tapa.tfu.pdsch.dat.req ueId="2" use="3" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="2:3:4:5:14:15:16:6:7"/>
        <tapa.tfu.pdsch.dat.req ueId="3" use="4" validate="TRUE"
              vldtSbAlloc="TRUE"
              allocSbIds="0:1:2:3:4:5:6:7:8:9:10:11:12:13:14:15:16"/>
        <tapa.tfu.pdsch.dat.req ueId="4" use="5" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="0:3:5:15:16"/>
        <tapa.tfu.pdsch.dat.req ueId="5" use="6" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="0:1:2:3:12:13"/>
        <tapa.tfu.pdsch.dat.req ueId="6" use="7" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="0:3:5:15:16"/>
        <tapa.tfu.pdsch.dat.req ueId="7" saveTo="1" use="8" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="2:3:4:5:14:15"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expect>
     <tapa.tfu.recp.req numRntis="8" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
        <tapa.tfu.hq.recp.req ueId="2"/>
        <tapa.tfu.hq.recp.req ueId="3"/>
        <tapa.tfu.hq.recp.req ueId="4"/>
        <tapa.tfu.hq.recp.req ueId="5"/>
        <tapa.tfu.hq.recp.req ueId="6"/>
        <tapa.tfu.hq.recp.req ueId="7"/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind>
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
        <tapa.tfu.hq ueId="2"/>
        <tapa.tfu.hq ueId="3"/>
        <tapa.tfu.hq ueId="4"/>
        <tapa.tfu.hq ueId="5"/>
        <tapa.tfu.hq ueId="6"/>
        <tapa.tfu.hq ueId="7" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   #Send BO for UE4
     <tapa.send>
        # Send BO for the created logical channel on RGU. 
        <tapa.rgu.dstarsp ueId="3" lcId="4" bo="89"/>
     </tapa.send>
     
     #Send wide-band CQI for periodic mode 1-0 for UE4 with CQI less than
     threshold CQI
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="3" isPucchInfo="TRUE" cqiMode="0" cqiIdx="5"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 

   <tapa.expect>
      <tapa.rgu.dstaind ueId="3" numLchTb1="1" lchTb1Data="4" />
   </tapa.expect>

   <tapa.send>
      # Send DDatReq for UE4
      <tapa.rgu.ddatreq ueId="3" numLchTb1="1" lchTb1Data="4,0,1"/>
   </tapa.send>

   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 

   <tapa.expset>
      # Expect PDU from MAC to PHY. 
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req  ueId="7" validate = "TRUE" saveTo="2" 
           use="8" vldtRetx="TRUE"/>
        <tapa.tfu.pdcch.cntrl.req ueId="3" saveTo="3"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req validate="TRUE" ueId="7"
           use="2" retxUse="1" chkSdu="FALSE"
           lcId="8" isRetx="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="3" use="3" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      # Send a 4 TTIs to expect harqReception request 
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   <tapa.expect>
     <tapa.tfu.recp.req numRntis="2" spId="1">
        <tapa.tfu.hq.recp.req ueId="3"/>
        <tapa.tfu.hq.recp.req ueId="7"/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

   <tapa.send>
     <tapa.tfu.hq.ind>
        <tapa.tfu.hq ueId="3"/>
        <tapa.tfu.hq ueId="7"/>
     </tapa.tfu.hq.ind>
  </tapa.send>

   </tapa.test>
   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#       Test:    12.22
#
#       Desc:   "To verify if throughput is raised due to frequency selective RB
#       alloction for SC1 scheduler with 8 UEs in a frequency selective cell.
#       DLFS shall satisfy the requested allocation in the respective best 
#       available sub-bands for the UE. The UEs to be scheduled shall be mix of
#       transmitting and re-transmitting Ues.
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc12.xml
#
#
<tapa.testcase id="12.22">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify if throughput is raised due to frequency selective RB
         alloction for SC1 scheduler with 8 UEs in a frequency selective cell.
         DLFS shall satisfy the requested allocation in the respective best 
         available sub-bands for the UE. The UEs to be scheduled shall be mix of
         transmitting and re-transmitting Ues.
      </tapa.desc>

      <tapa.longdesc>
         To verify if throughput is raised due to frequency selective RB
         alloction for SC1 scheduler with 8 UEs in a frequency selective cell.
         DLFS shall satisfy the requested allocation in the respective best 
         available sub-bands for the UE. The UEs to be scheduled shall be mix of
         transmitting and re-transmitting Ues.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="DLFS_INV"/>
         <tapa.flag id="RG_PHASE2_SCHED"/>
         <tapa.flag id="LTEMAC_RGU_PAD"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="1" dlTotalBw="100"
         thresholdCqi= "5" dlSchdType="0"/>

      # UE Creation
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" aprdModeEnumPres = "TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"/>
      
      <tapa.rg.UeInit ueId="1" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"/>
      
      <tapa.rg.UeInit ueId="2" ueCatEnum="1" aprdModeEnumPres="TRUE"
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30"/>
      
      <tapa.rg.UeInit ueId="3" ueCatEnum="1" cqiPmiCfgIdx="1" k="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>
      
      <tapa.rg.UeInit ueId="4" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"/>
      
      <tapa.rg.UeInit ueId="5" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"/>
      
      <tapa.rg.UeInit ueId="6" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>
      
      <tapa.rg.UeInit ueId="7" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      #UE1 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="3" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="4" lcId="5" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="5" lcId="6" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="6" lcId="7" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="7" lcId="8" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="2" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="3" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>
      
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="4" lcId="5" dir="1" lcType="4" instId="5" />
      </tapa.send>
      
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="5" lcId="6" dir="1" lcType="4" instId="5" />
      </tapa.send>
      
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="6" lcId="7" dir="1" lcType="4" instId="5" />
      </tapa.send>
      
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="7" lcId="8" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Current SFN = 18 sf = 3

      # Send CQI indication for aperiodic mode 2-0 for UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="0" isPucchInfo="FALSE" cqiMode="1" wbCqi="8" cqiIdx="10"
            numOfSubbands = "5" rbStartLst = "0:6:12:21:27" numRbLst =
            "3:3:3:3:2" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send CQI indication for aperiodic mode 3-0 for UE3
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="2" isPucchInfo="FALSE" cqiMode="3" wbCqi="7"
            numOfSubbands = "9" rbStartLst="0:6:12:18:24:30:36:42:48" numRbLst =
            "6:6:6:6:6:6:6:6:2" cqiIdxLst="7:14:13:8:3:5:9:12:11" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for aperiodic mode 2-0 for UE5
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="4" isPucchInfo="FALSE" cqiMode="1" wbCqi="9" cqiIdx="11"
            numOfSubbands = "5" rbStartLst = "0:9:15:45:48" numRbLst =
            "3:3:3:3:2" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for aperiodic mode 3-0 for UE6
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="5" isPucchInfo="FALSE" cqiMode="3" wbCqi="6"
            numOfSubbands = "9" rbStartLst="0:6:12:18:24:30:36:42:48" numRbLst =
            "6:6:6:6:6:6:6:6:2" cqiIdxLst="12:11:7:10:8:9:15:4:4" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for aperiodic mode 2-0 for UE7
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="6" isPucchInfo="FALSE" cqiMode="1" wbCqi="8"
              cqiIdx="8"
            numOfSubbands = "5" rbStartLst = "0:9:15:45:48" numRbLst =
            "3:3:3:3:2" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for aperiodic mode 3-0 for UE8
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="7" isPucchInfo="FALSE" cqiMode="3" wbCqi="6"
            numOfSubbands = "9" rbStartLst="0:6:12:18:24:30:36:42:48" numRbLst =
            "6:6:6:6:6:6:6:6:2" cqiIdxLst="7:14:13:8:3:5:9:12:6" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      #Send sub-band CQI for periodic mode 2-0 for UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="2" isWideband="FALSE"
              sbCqi="5" label="2"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      #Send wide-band CQI for periodic mode 1-0 for UE4 
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="3" isPucchInfo="TRUE" cqiMode="0" cqiIdx="5"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      #Send BO for UE1
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="400"/>
      </tapa.send>

      #Send BO for UE2
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="2" bo="50"/>
      </tapa.send>

      #Send BO for UE3
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="2" lcId="3" bo="120"/>
      </tapa.send>

      #Send BO for UE4
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="3" lcId="4" bo="69"/>
      </tapa.send>

      #Send BO for UE5
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="4" lcId="5" bo="160"/>
      </tapa.send>

      #Send BO for UE6
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="5" lcId="6" bo="400"/>
      </tapa.send>
      
      #Send BO for UE7
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="6" lcId="7" bo="200"/>
      </tapa.send>
      
      #Send BO for UE8
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="7" lcId="8" bo="200"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind ueId="7" numLchTb1="1" lchTb1Data="8" />
         <tapa.rgu.dstaind ueId="2" numLchTb1="1" lchTb1Data="3" />
         <tapa.rgu.dstaind ueId="5" numLchTb1="1" lchTb1Data="6" />
         <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="2" />
         <tapa.rgu.dstaind ueId="4" numLchTb1="1" lchTb1Data="5" />
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="1" />
         <tapa.rgu.dstaind ueId="6" numLchTb1="1" lchTb1Data="7" />
         <tapa.rgu.dstaind ueId="3" numLchTb1="1" lchTb1Data="4" />
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE1 
         <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DDatReq for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="2,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DDatReq for UE3
         <tapa.rgu.ddatreq ueId="2" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE4
         <tapa.rgu.ddatreq ueId="3" numLchTb1="1" lchTb1Data="4,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE5
         <tapa.rgu.ddatreq ueId="4" numLchTb1="1" lchTb1Data="5,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE6
         <tapa.rgu.ddatreq ueId="5" numLchTb1="1" lchTb1Data="6,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE7
         <tapa.rgu.ddatreq ueId="6" numLchTb1="1" lchTb1Data="7,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE8
         <tapa.rgu.ddatreq ueId="7" numLchTb1="1" lchTb1Data="8,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req ueId="7" saveTo="8"/>
        <tapa.tfu.pdcch.cntrl.req ueId="5" saveTo="6"/>
        <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="3"/>
        <tapa.tfu.pdcch.cntrl.req ueId="4" saveTo="5"/>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        <tapa.tfu.pdcch.cntrl.req ueId="6" saveTo="7"/>
        <tapa.tfu.pdcch.cntrl.req ueId="3" saveTo="4"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
     </tapa.tfu.cntrl.req>
         <tapa.rgu.dstaind ueId="5" numLchTb1="1" lchTb1Data="6" />
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req ueId="1" use="2" validate="TRUE"
              vldtSbAlloc="TRUE"
              allocSbIds="2:2:2:3:4:5:6:7:8:10:12:13:14:15:16:15:24"/>
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="0:1:3:5:6"/>
        <tapa.tfu.pdsch.dat.req ueId="2" use="3" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="0:1:3:4:6:7:9:10:12"/>
        <tapa.tfu.pdsch.dat.req ueId="3" use="4" validate="TRUE"
              vldtSbAlloc="TRUE"
              allocSbIds="0:1:2:3:4:5:6:7:8:9:10:11:12:13:14:15:16"/>
        <tapa.tfu.pdsch.dat.req ueId="4" use="5" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="0:2:3:11:12"/>
        <tapa.tfu.pdsch.dat.req ueId="5" use="6" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="0:1:3:4:6:7:9:10:12"/>
        <tapa.tfu.pdsch.dat.req ueId="6" use="7" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="0:2:3:11:12"/>
        <tapa.tfu.pdsch.dat.req ueId="7" saveTo="1" use="8" validate="TRUE"
              vldtSbAlloc="TRUE" allocSbIds="0:1:2:4:6:6:8:8:12"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE6
         <tapa.rgu.ddatreq ueId="5" numLchTb1="1" lchTb1Data="6,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req ueId="5" saveTo="6"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req ueId="5" use="6" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.expect>
     <tapa.tfu.recp.req numRntis="8" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
        <tapa.tfu.hq.recp.req ueId="2"/>
        <tapa.tfu.hq.recp.req ueId="3"/>
        <tapa.tfu.hq.recp.req ueId="4"/>
        <tapa.tfu.hq.recp.req ueId="5"/>
        <tapa.tfu.hq.recp.req ueId="6"/>
        <tapa.tfu.hq.recp.req ueId="7"/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

   # Ending TC here: further processing not needed
   
   </tapa.test>
   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    12.23
#
#       Desc:   "To verify if the retransmission allocation if failing for
#                  particular HARQ process continously the release the HARQ 
#                  process and removed the node from the retransmission list"
#
#       Notes:   None
#
#       Module:  "PFS"
#
#       File:    rgac_tc14.xml
#
#
<tapa.testcase id="12.23">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
      "To verify if the retransmission allocation if failing for
      particular HARQ process continously the release the HARQ 
      process and removed the node from the retransmission list"
      </tapa.desc>

      <tapa.longdesc>
      "To verify if the retransmission allocation if failing for
      particular HARQ process continously the release the HARQ 
      process and removed the node from the retransmission list"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="15" maxDlBwPerUe="10" maxDlRetxBw="10" maxDlUeNewTxPerTti="4" maxUePerDlSf="4" maxUlUeNewTxPerTti="4" maxUePerUlSf="4"
         dlSchdType="0" raWinSize="5"/>

      # UEs Creation
      <tapa.rg.UeInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         # Configure a GBR DTCH at MAC (not scheduler) for UE 0
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0"
            dir="3" lcType="4"/>
      </tapa.send>

            # Configure GBR DTCH (RGR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            dlQci="1" instId="5"/>
      </tapa.send>

            # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect the successful confirms
      <tapa.expset>
         <tapa.crg.cfgcfm/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Set good CQIs intially (later we worsen it so that
      # the two retx procs cannot go toghether)
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" cqiIdx="12"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send BOs. Note that BOs should be sent such
      # that they are completely satisfied without
      # leaving a lot of buffer in the bandwidth.
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="3" bo="500"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect staInd from MAC to RLC for both DCCH and DTCH
      <tapa.expset>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="3"/>
      </tapa.expset>

      <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="3" ueId="0" lcId="3"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA(3) - TFU_DELTA(2) Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="1">
            <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="3" validate="TRUE"/>
         </tapa.tfu.dat.req>
      </tapa.expset>

      # Send 4 TTIs to get the harqrecpRequest from MAC
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req numRntis="1" spId="1">
            <tapa.tfu.hq.recp.req ueId="0"/>
         </tapa.tfu.recp.req>
      </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs (TFU_DELTA) + 1 TTI (TFU_UL_DELTA) before
         # sending the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      # NACK both the transmissions
      <tapa.send>
         <tapa.tfu.hq.ind hqInds="1">
            <tapa.tfu.hq ueId="0" isAck="FALSE"/>
         </tapa.tfu.hq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="10" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="1" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>


      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="10" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="2" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="1" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="3" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="2" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="4" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="3" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>


      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="5" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="4" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="6" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="5" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
 
       <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="7" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="6" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
 
        <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="8" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="7" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
           
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="9" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="8" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="10" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
        <tapa.tfu.cntrl.req/>
      </tapa.expset>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>




<!--
 Write your test cases here
 -->


 
#/********************************************************************30**
#
#         End of file:     rgac_tc12.xml@@/main/1 - Thu Mar 26 01:11:03 2009
#
#*********************************************************************31*/
#/**********************************************************************
#        Revision History:
#
#**********************************************************************/
#/********************************************************************90**
# 
#     ver       pat    init                  description
#------------ -------- ---- ----------------------------------------------
#/main/1      ---     sd   1. Initial Release.
#$SID$         ---     sm   1. Initial Release.
#             rg004.201 rnt  1. Modified for SI Enhancement
#$SID$        ---     gvj  1. LTE MAC 3.1 Release
#$SID$        rg001.301     nudupi 1.Added the chabges for the CR ccpu00119023
#$SIS$        rg002.301 av   changes for ccpu00109543
#$SID$      ---      rt    1. LTE MAC 4.1 Release
