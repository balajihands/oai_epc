#
#/********************************************************************20**
#
#     Name:    LTE-MAC 
#
#     Type:    XML Test File
#
#     Desc:    XML Based Test Cases For Max C/I Scheduler
#
#     File:    rgac_tc13.xml
#
#     Sid:      rgac_tc13.xml@@/main/1 - Thu Mar 26 01:11:03 2009
#
#     Prg:     ns 
#
#*********************************************************************21*/

# DO NOT DELETE THIS LINE -- TC number generation script depends on it.
# xyzabcstart=1:hn:rgac_tc13.xml


#
#
#       Test:    13.1
#
#       Desc:   "To test the successful DL path for a Tx UE with UE configured to 
#                report CQI in periodic mode 1-0 using MAX C/I scheduling for
#                GBR/NON-GBR/AMBR services."
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.1">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a Tx UE using MAX C/I scheduling and periodic
         CQI report for mode 1-0 for GBR/NON-GBR/AMBR services.
      </tapa.desc>

      <tapa.longdesc>
         Testing that Tx UE recieves DL data successfully on reporting CQI through
         periodic CQI reporting mode 1-0 using MAX C/I scheduler for
         GBR/NON-GBR/AMBR services.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="75" dlSchdType="3"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"
         dlAmbr="15000"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel (DCCH) for the UE1  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure a GBR dedicated logical channel (DTCH) for the UE1 
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="5" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure an AMBR dedicated logical channel (DTCH) for the UE1 
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="6" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure an non-ambr dedicated logical channel (DTCH) for the UE2
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DCCH on RGR for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>
      
      # Configure a GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 1 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="5" dir="1" lcType="4"
            dlQci="1" instId="5" />
      </tapa.send>
      
      # Configure an AMBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 7 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="6" dir="1" lcType="4"
            dlQci="7" instId="5" />
      </tapa.send>

      # Configure an Non-AMBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 7 for UE2
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" dir="1" lcType="4"
            dlQci="7" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      
      # Send CQI indication for periodic mode 1-0 for UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="10"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the DCCH on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" lcType="5" bo="120"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="5" lcType="4" bo="900"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the AMBR DTCH on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="6" lcType="4" bo="80"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the Non-AMBR DTCH on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="3" lcType="4" bo="450"/>
      </tapa.send>
      
      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for DCCH and DTCH 
         <tapa.rgu.dstaind ueId="0" numLchTb1="3" lchTb1Data="1:5:6" />
         <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="3" />
      </tapa.expset>

      <tapa.send>
         # Send data for UE1
         <tapa.rgu.ddatreq ueId="0" numLchTb1="3" lchTb1Data="1,0,1:5,0,1:6,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send data for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="1" use="2" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="2" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 3 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.2
#
#       Desc:   "To test the successful DL path for a Re-Tx UE with UE configured to 
#                report CQI in periodic mode 1-0 using MAX C/I scheduling for
#                GBR/NON-GBR/AMBR services."
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.2">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a Re-Tx UE using MAX C/I scheduling and periodic
         CQI report for mode 1-0 for GBR/NON-GBR/AMBR services.
      </tapa.desc>

      <tapa.longdesc>
         Testing that Re-Tx UE recieves DL data successfully on reporting CQI through
         periodic CQI reporting mode 1-0 using MAX C/I scheduler for
         GBR/NON-GBR/AMBR services.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="75" dlSchdType="3" maxDlRetxBw="75"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"
         dlAmbr="15000"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel (DCCH) for the UE1  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure a GBR dedicated logical channel (DTCH) for the UE1 
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="5" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure an AMBR dedicated logical channel (DTCH) for the UE1 
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="6" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure an non-ambr dedicated logical channel (DTCH) for the UE2
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DCCH on RGR for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>
      
      # Configure a GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 1 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="5" dir="1" lcType="4"
            dlQci="1" instId="5" />
      </tapa.send>
      
      # Configure an AMBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 7 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="6" dir="1" lcType="4"
            dlQci="7" instId="5" />
      </tapa.send>

      # Configure an Non-AMBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 7 for UE2
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" dir="1" lcType="4"
            dlQci="7" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      
      # Send CQI indication for periodic mode 1-0 for UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="10"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the DCCH on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" lcType="5" bo="120"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="5" lcType="4" bo="900"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the AMBR DTCH on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="6" lcType="4" bo="80"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the Non-AMBR DTCH on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="3" lcType="4" bo="400"/>
      </tapa.send>
      
      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for DCCH and DTCH 
         <tapa.rgu.dstaind ueId="0" numLchTb1="3" lchTb1Data="1:5:6" />
         <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="3" />
      </tapa.expset>

      <tapa.send>
         # Send data for UE1
         <tapa.rgu.ddatreq ueId="0" numLchTb1="3" lchTb1Data="1,0,1:5,0,1:6,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send data for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="3" validate="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="1" use="2" saveTo="4" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="2" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
        <tapa.tfu.hq ueId="1" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 
   
   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 
   
   <tapa.expset>
      # Expect PDU from MAC to PHY. 
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req ueId="0" validate = "TRUE" use="1" saveTo="5"
           vldtRetx="TRUE"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" validate = "TRUE" use="1" saveTo="6"
           vldtRetx="TRUE"/>
     </tapa.tfu.cntrl.req>
     #TODO: Set chkSdu="TRUE"
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req ueId="0" validate="TRUE" 
           use="5" retxUse="3" chkSdu="FALSE" lcId="1:5:6" isRetx="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="1" validate="TRUE" 
           use="6" retxUse="4" chkSdu="FALSE" lcId="3" isRetx="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.3
#
#       Desc:   "To verify that UE with best CQI gets priority over other UEs
#       in 3 UE scenario"
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.3">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify UE with best CQI gets priority over others in a 3 UE
         scenario.
      </tapa.desc>

      <tapa.longdesc>
         To verify UE with best CQI gets priority over others in a 3 UE
         scenario.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="50" dlSchdType="3" maxDlBwPerUe="20"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>
      <tapa.rg.UeInit ueId="2" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      <tapa.send>
         # Configure a GBR dedicated logical channel (DTCH) for the UE1 
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure a GBR dedicated logical channel (DTCH) for the UE2
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="4" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure a GBR dedicated logical channel (DTCH) for the UE3
         <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="5" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 1 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            dlQci="1" instId="5" />
      </tapa.send>
      
      # Configure a Non-GBR dedicated logical channel (DTCH) for the 
      # created UE with QCI = 1 for UE2
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="4" dir="1" lcType="4"
            dlQci="1" instId="5" />
      </tapa.send>

      # Configure a GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 3 for UE3
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="2" lcId="5" dir="1" lcType="4"
            dlQci="3" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Send CQI indication for periodic mode 1-0 for UE1 = 8
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for periodic mode 1-0 for UE2 =14
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="15"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send CQI indication for periodic mode 1-0 for UE3 = 10
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="2" isPucchInfo="TRUE" cqiMode="0" cqiIdx="12"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE1. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="400"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE2. 
         <tapa.rgu.dstarsp ueId="1" lcId="4" lcType="4" bo="800"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE3. 
         <tapa.rgu.dstarsp ueId="2" lcId="5" lcType="4" bo="300"/>
      </tapa.send>
      
      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for UE2 and UE3 
         <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="4" />
         <tapa.rgu.dstaind ueId="2" numLchTb1="1" lchTb1Data="5" />
      </tapa.expset>

      <tapa.send>
         # Send data for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="4,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send data for UE3
         <tapa.rgu.ddatreq ueId="2" numLchTb1="1" lchTb1Data="5,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1"/>
        <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req ueId="1" use="1" validate="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="2" use="2" validate="TRUE"/>
     </tapa.tfu.dat.req>
     # Now UE1 will also get scheduled
     <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
   </tapa.expset>

   # Ending TC here: further processing not needed
   
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.4
#
#       Desc:   "Verify that a UE with DCCH data pending would be scheduled prior to a UE with better
#                CQI but DTCH data only in a 2 UE scenario.
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.4">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Verify that a UE with DCCH data pending would be scheduled prior to a UE with better
         CQI but DTCH data only in a 2 UE scenario.
      </tapa.desc>

      <tapa.longdesc>
         Verify that a UE with DCCH data pending would be scheduled prior to a UE with better
         CQI but DTCH data only in a 2 UE scenario.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="45" dlSchdType="3" maxDlBwPerUe="45"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      <tapa.send>
         # Configure a GBR dedicated logical channel (DTCH) for the UE1 
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure a SRB (DCCH) for the UE2
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="5"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure a GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 3 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            dlQci="3" instId="5" />
      </tapa.send>
      
      # Configure a SRB (DCCH) for UE2 on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         # Send a Tti to apply the configuration
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      
      # Send CQI indication for periodic mode 1-0 for UE1 = 14
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="14"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for periodic mode 1-0 for UE2 = 8
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE1. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="480"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the DCCH on RGU for UE2. 
         <tapa.rgu.dstarsp ueId="1" lcId="1" lcType="5" bo="480"/>
      </tapa.send>
      
      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for SRB of UE2
         <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="1" />
      </tapa.expset>

      <tapa.send>
         # Send data for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     # Now UE1 will also get scheduled
     <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3"/>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="1" use="1" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   # Ending TC here: further processing not needed
   
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.5
#
#       Desc:   "Verify that for Ues with same CQI, scheduling would be in a round robin manner.
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.5">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
        Verify that for UEs with same CQI, scheduling is done in round robin
        manner.
      </tapa.desc>

      <tapa.longdesc>
        Verify that for UEs with same CQI, scheduling is done in round robin
        manner.
      </tapa.longdesc>


   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="25" dlSchdType="3" maxDlBwPerUe="25"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      <tapa.send>
         # Configure a GBR DTCH for the UE1 
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure a GBR DTCH for the UE2
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="4" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure a GBR DTCH with QCI = 3 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            dlQci="3" instId="5" />
      </tapa.send>
      
      # Configure a GBR DTCH for UE2 with QCI=2 on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="4" dir="1" lcType="5"
           dlQci="2" instId="5" />
      </tapa.send>

      <tapa.send>
         # Send a Tti to apply the configuration
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      
      # Send CQI indication for periodic mode 1-0 for UE1 with cqi = 8
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for periodic mode 1-0 for UE2 with cqi = 8
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # ccpu00109543 and ccpu00117606 Efficiency table derivation changes
      # Adjusted BO for UE 0 and UE 1 from 2280 to 1500
      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE1. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="1400"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE2. 
         <tapa.rgu.dstarsp ueId="1" lcId="4" lcType="5" bo="1400"/>
      </tapa.send>
      
      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for DTCH of UE1
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
      </tapa.expset>

      <tapa.send>
         # Send data for UE1
         <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="4"/>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

    <tapa.send>
       # Send data for UE2
       <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="4,0,1"/>
    </tapa.send>

  <tapa.send>
     # Send DL_DELTA Ttis to get the MAC PDU at PHY.
     <tapa.tfu.tti.ind numTti="1"/>
  </tapa.send>

   <tapa.expset>
     <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3"/>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="1" use="1" validate="TRUE"/>
     </tapa.tfu.dat.req>
     # Now UE1 will also get scheduled
   </tapa.expset>

    <tapa.send>
       # Send data for UE1
       <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="3,0,1"/>
    </tapa.send>
    
  <tapa.send>
     # Send DL_DELTA Ttis to get the MAC PDU at PHY.
     <tapa.tfu.tti.ind numTti="1"/>
  </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"/>
     </tapa.tfu.dat.req>
     # Now UE2 will get scheduled again
     <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="4"/>
   </tapa.expset>
   
    <tapa.send>
       # Send data for UE2
       <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="4,0,1"/>
    </tapa.send>

  <tapa.send>
     # Send DL_DELTA Ttis to get the MAC PDU at PHY.
     <tapa.tfu.tti.ind numTti="1"/>
  </tapa.send>

   <tapa.expset>
     # Now UE1 will get scheduled again
     <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3"/>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="1" use="1" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   # Ending TC here: further processing not needed
   
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.6
#
#       Desc:   "Verify that Retransmissions are scheduled prior to normal transmissions
#                through a 2 UE scenario"
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.6">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Verify that Retransmissions are scheduled prior to normal transmissions
         through a 2 UE scenario
      </tapa.desc>

      <tapa.longdesc>
         Verify that Retransmissions are scheduled prior to normal transmissions
         through a 2 UE scenario
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="50" dlSchdType="3" maxDlBwPerUe="50"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
    <tapa.send>
       # Configure a GBR DTCH for the UE1 
       <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4"/>
    </tapa.send>

    <tapa.expect>
       # Expect success in cfg cfm
       <tapa.crg.cfgcfm/>
    </tapa.expect>
    
    <tapa.send>
       # Configure a GBR DTCH for the UE2
       <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="4" lcgId="0" dir="3" lcType="4"/>
    </tapa.send>

    <tapa.expect>
       # Expect success in cfg cfm
       <tapa.crg.cfgcfm/>
    </tapa.expect>
    
    # Configure a GBR DTCH with QCI = 3 for UE1
    <tapa.send>
       <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
          dlQci="3" instId="5" />
    </tapa.send>
    
    # Configure a GBR DTCH for UE2 with QCI=2 on RGR
    <tapa.send>
       <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="4" dir="1" lcType="4"
         dlQci="2" instId="5" />
    </tapa.send>

    <tapa.send>
       # Send a Tti to apply the configuration
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>
    
    <tapa.expset>
       # Expect success in cfg cfm
       <tapa.rgr.cfgCfm instId="5"/>
       <tapa.rgr.cfgCfm instId="5"/>
    </tapa.expset>
    
    # Send CQI indication for periodic mode 1-0 for UE1 with cqi = 8
    <tapa.send>
       <tapa.tfu.dlcqi.ind>
          <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
       </tapa.tfu.dlcqi.ind>
    </tapa.send>
    
    # Send CQI indication for periodic mode 1-0 for UE2 with cqi = 12
    <tapa.send>
       <tapa.tfu.dlcqi.ind>
          <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="12"/>
       </tapa.tfu.dlcqi.ind>
    </tapa.send>

    <tapa.send>
       # Send BO for the GBR DTCH on RGU for UE1. 
       <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="580"/>
    </tapa.send>

    <tapa.send>
       # Send a Tti to get the transmission scheduled. 
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

    <tapa.expect>
       # Expect staInd from MAC to RLC for DTCH of UE1
       <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
    </tapa.expect>

    <tapa.send>
       # Send data for UE1
       <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="3,0,1"/>
    </tapa.send>

    <tapa.send>
       # Send DL_DELTA Ttis to get the MAC PDU at PHY.
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="2" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      # Send a 4 TTIs to get the harqrecpRequest from MAC
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      # Send a 3 TTIs to Send the HARQ ACK Indication
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
   
   <tapa.send>
      # Send BO for the GBR DTCH on RGU for UE2. 
      <tapa.rgu.dstarsp ueId="1" lcId="4" lcType="4" bo="680"/>
   </tapa.send>
      
   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 
   
   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      # UE2 gets scheduled here.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 
   

   <tapa.expset>
      # Expect PDU from MAC to PHY. 
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" validate = "TRUE" use="1" saveTo="3"
           vldtRetx="TRUE"/>
     </tapa.tfu.cntrl.req>
     # TODO: Set chkSdu="TRUE" 
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" validate="TRUE" 
           use="3" retxUse="2" chkSdu="FALSE" lcId="3" isRetx="TRUE"/>
     </tapa.tfu.dat.req>
      <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="4" />
   </tapa.expset>

   <tapa.send>
      # Send data for UE2
      <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="4,0,1"/>
   </tapa.send>

   # Ending TC here: further processing not needed
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>
#
#
#       Test:    13.7
#
#       Desc:   "Verify that GBR Services are scheduled prior to Non-GBR
#                services through 1 UE scenario"
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.7">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Verify that GBR services are scheduled prior to Non-GBR service
         through 1 UE scenario.
      </tapa.desc>

      <tapa.longdesc>
         Verify that GBR services are scheduled prior to Non-GBR service
         through 1 UE scenario.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="25" dlSchdType="3" maxDlBwPerUe="25"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
    <tapa.send>
       # Configure a GBR DTCH for the UE1 
       <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4"/>
    </tapa.send>

    <tapa.expect>
       # Expect success in cfg cfm
       <tapa.crg.cfgcfm/>
    </tapa.expect>
    
    <tapa.send>
       # Configure a Non-GBR DTCH for the UE1
       <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="4" lcgId="0" dir="3" lcType="4"/>
    </tapa.send>

    <tapa.expect>
       # Expect success in cfg cfm
       <tapa.crg.cfgcfm/>
    </tapa.expect>
    
    # Configure a GBR DTCH with QCI = 3 for UE1
    <tapa.send>
       <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
          dlQci="3" instId="5" />
    </tapa.send>
    
    # Configure a Non-GBR DTCH for UE1 with QCI=7 on RGR
    <tapa.send>
       <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="4" dir="1" lcType="4"
         dlQci="7" instId="5" />
    </tapa.send>

    <tapa.send>
       # Send a Tti to apply the configuration
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>
    
    <tapa.expset>
       # Expect success in cfg cfm
       <tapa.rgr.cfgCfm instId="5"/>
       <tapa.rgr.cfgCfm instId="5"/>
    </tapa.expset>
    
    # Send CQI indication for periodic mode 1-0 for UE1 with cqi = 8
    <tapa.send>
       <tapa.tfu.dlcqi.ind>
          <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
       </tapa.tfu.dlcqi.ind>
    </tapa.send>
    
    <tapa.send>
       # Send BO for the GBR DTCH on RGU for UE1. 
       <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="700"/>
    </tapa.send>

   <tapa.send>
      # Send BO for the Non-GBR DTCH on RGU for UE2. 
      <tapa.rgu.dstarsp ueId="0" lcId="4" lcType="4" bo="1800"/>
   </tapa.send>
      
    <tapa.send>
       # Send a Tti to get the transmission scheduled. 
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

    <tapa.expect>
       # Expect staInd from MAC to RLC for GBR DTCH of UE1
       <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
    </tapa.expect>

    <tapa.send>
       # Send data for UE1
       <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="3,0,1"/>
    </tapa.send>

    <tapa.send>
       # Send DL_DELTA Ttis to get the MAC PDU at PHY.
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" numLchTb1="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
         <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="2" validate="TRUE"
             numLchTb1="1"/>
     </tapa.tfu.dat.req>
     #Non-GBR service will get scheduled now
     <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="4" />
   </tapa.expset>

   <tapa.send>
      # Send data for Non-GBR DTCH
      <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="4,0,1"/>
   </tapa.send>

   # Ending TC here: further processing not needed
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>
#
#
#       Test:    13.8
#
#       Desc:   "Verify that AMBR is not applicable for SRBs 
#                through 1 UE scenario"
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.8">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Verify that AMBR is not applicable for SRBs
         through 1 UE scenario.
      </tapa.desc>

      <tapa.longdesc>
         Verify that AMBR is not applicable for SRBs
         through 1 UE scenario.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="50" dlSchdType="3" maxDlBwPerUe="25"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" dlAmbr="500"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
    <tapa.send>
       # Configure a DCCH for the UE1 
       <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5"/>
    </tapa.send>

    <tapa.expect>
       # Expect success in cfg cfm
       <tapa.crg.cfgcfm/>
    </tapa.expect>
    
    # Configure a DCCH for UE1
    <tapa.send>
       <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5"
            instId="5" />
    </tapa.send>
    
    <tapa.send>
       # Send a Tti to apply the configuration
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>
    
    <tapa.expect>
       # Expect success in cfg cfm
       <tapa.rgr.cfgCfm instId="5"/>
    </tapa.expect>
    
    # Send CQI indication for periodic mode 1-0 for UE1 with cqi = 8
    <tapa.send>
       <tapa.tfu.dlcqi.ind>
          <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
       </tapa.tfu.dlcqi.ind>
    </tapa.send>
    
    <tapa.send>
       # Send BO for the DCCH on RGU for UE1 with bo > ambr
       <tapa.rgu.dstarsp ueId="0" lcId="1" lcType="5" bo="580"/>
    </tapa.send>

    <tapa.send>
       # Send a Tti to get the transmission scheduled completely 
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

    <tapa.expect>
       # Expect staInd from MAC to RLC for GBR DTCH of UE1
       <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="1" />
    </tapa.expect>

    <tapa.send>
       # Send data for UE1
       <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="1,0,1"/>
    </tapa.send>

    <tapa.send>
       # Send DL_DELTA Ttis to get the MAC PDU at PHY.
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="2" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      # Send a 4 TTIs to get the harqrecpRequest from MAC
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      # Send a 3 TTIs to Send the HARQ ACK Indication
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="TRUE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>
#
#
#       Test:    13.9
#
#       Desc:   "Verify that GBR services get allocation only till MBR cap 
#                through 1 UE scenario"
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.9">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Verify that GBR services get allocation only till MBR cap
         through 1 UE scenario.
      </tapa.desc>

      <tapa.longdesc>
         Verify that  GBR services get allocation only till MBR cap
         through 1 UE scenario.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="25" dlSchdType="3" maxDlBwPerUe="25"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
    <tapa.send>
       # Configure a GBR DTCH for the UE1 
       <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4"/>
    </tapa.send>

    <tapa.expect>
       # Expect success in cfg cfm
       <tapa.crg.cfgcfm/>
    </tapa.expect>
    
    # Configure a GBR DTCH for UE1 with dlQci=2
    <tapa.send>
       <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            instId="5" dlMbr="500" dlQci="2" dlGbr="300"/>
    </tapa.send>
    
    <tapa.send>
       # Send a Tti to apply the configuration
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>
    
    <tapa.expect>
       # Expect success in cfg cfm
       <tapa.rgr.cfgCfm instId="5"/>
    </tapa.expect>
    
    # Send CQI indication for periodic mode 1-0 for UE1 with cqi = 8
    <tapa.send>
       <tapa.tfu.dlcqi.ind>
          <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
       </tapa.tfu.dlcqi.ind>
    </tapa.send>
    
    <tapa.send>
       # Send BO for the DTCH on RGU for UE1 with bo > mbr
       <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="600"/>
    </tapa.send>

    <tapa.send>
       # Send a Tti to get the transmission scheduled till mbr limit 
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

    <tapa.expect>
       # Expect staInd from MAC to RLC for GBR DTCH of UE1
       <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
    </tapa.expect>

    <tapa.send>
       # Send data for UE1
       <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="3,0,1"/>
    </tapa.send>

    <tapa.send>
       # Send DL_DELTA Ttis to get the MAC PDU at PHY.
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="2" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      # Send a 4 TTIs to get the harqrecpRequest from MAC
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      # Send a 3 TTIs to Send the HARQ ACK Indication
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="TRUE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

    <tapa.send>
       # Send Ttis to expire the refresh timer
       <tapa.tfu.tti.ind numTti="288"/>
    </tapa.send>
    
    <tapa.expect>
       # Expect staInd from MAC to RLC for GBR DTCH of UE1 for remaining bo
       <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
    </tapa.expect>

    <tapa.send>
       # Send data for UE1
       <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="3,0,1"/>
    </tapa.send>

    <tapa.send>
       # Send DL_DELTA Ttis to get the MAC PDU at PHY.
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="2" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      # Send a 4 TTIs to get the harqrecpRequest from MAC
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      # Send a 3 TTIs to Send the HARQ ACK Indication
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="TRUE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   <tapa.send>
      # Send TTIs to ensure there are no pending messages
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>
#
#
#       Test:    13.10
#
#       Desc:   "Verify that NON-GBR services get allocation only till AMBR cap 
#                through 1 UE scenario with AMBR configured"
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.10">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Verify that NON-GBR services get allocation only till AMBR cap
         through 1 UE scenario with AMBR configured for the UE.
      </tapa.desc>

      <tapa.longdesc>
         Verify that NON-GBR services get allocation only till AMBR cap
         through 1 UE scenario with AMBR configured for the UE.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="40" dlSchdType="3" maxDlBwPerUe="40"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" dlAmbr="792"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
    <tapa.send>
       # Configure a NON-GBR DTCH for the UE1 
       <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4"/>
    </tapa.send>

    <tapa.expect>
       # Expect success in cfg cfm
       <tapa.crg.cfgcfm/>
    </tapa.expect>
    
    # Configure a NON-GBR DTCH for UE1 with dlQci=7
    <tapa.send>
       <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            instId="5" dlQci="7"/>
    </tapa.send>
    
    <tapa.send>
       # Send a Tti to apply the configuration
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>
    
    <tapa.expect>
       # Expect success in cfg cfm
       <tapa.rgr.cfgCfm instId="5"/>
    </tapa.expect>
    
    # Send CQI indication for periodic mode 1-0 for UE1 with cqi = 8
    <tapa.send>
       <tapa.tfu.dlcqi.ind>
          <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
       </tapa.tfu.dlcqi.ind>
    </tapa.send>
    
    <tapa.send>
       # Send BO for the DTCH on RGU for UE1 with bo > ambr
       <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="1000"/>
    </tapa.send>

    <tapa.send>
       # Send a Tti to get the transmission scheduled till AMBR limit 
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

    <tapa.expect>
       # Expect staInd from MAC to RLC for GBR DTCH of UE1
       <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
    </tapa.expect>

    <tapa.send>
       # Send data for UE1
       <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="3,0,1"/>
    </tapa.send>

    <tapa.send>
       # Send DL_DELTA Ttis to get the MAC PDU at PHY.
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="2" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      # Send a 4 TTIs to get the harqrecpRequest from MAC
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      # Send a 3 TTIs to Send the HARQ ACK Indication
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="TRUE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

    <tapa.send>
       # Send Ttis to expire the refresh timer
       <tapa.tfu.tti.ind numTti="288"/>
    </tapa.send>
    
    <tapa.expect>
       # Expect staInd from MAC to RLC for GBR DTCH of UE1 for remaining bo
       <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
    </tapa.expect>

    <tapa.send>
       # Send data for UE1
       <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="3,0,1"/>
    </tapa.send>

    <tapa.send>
       # Send DL_DELTA Ttis to get the MAC PDU at PHY.
       <tapa.tfu.tti.ind numTti="1"/>
    </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="2" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      # Send a 4 TTIs to get the harqrecpRequest from MAC
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      # Send a 3 TTIs to Send the HARQ ACK Indication
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="TRUE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   <tapa.send>
      # Send TTIs to ensure there are no pending messages
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.11
#
#       Desc:   "Verify that TA receives higher priority than
#                signaling (DCCH)"
#
#       Notes:   None
#              
#       Module:  "PFS"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.11">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that TA receives higher priority than signaling (DCCH)"

      </tapa.desc>

      <tapa.longdesc>
         "Verify that TA receives higher priority than signaling (DCCH)"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlSchdType="3" dlTotalBw="25"/>

      # UEs Creation
      <tapa.rg.2UeInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         # Configure a DCCH at MAC (not scheduler) for UE 0
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0"
            dir="3" lcType="5"/>
      </tapa.send>

      # Configure DCCH (RGR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send TA for UE and BO for the DTCH on RGU. 
      <tapa.send>
         <tapa.tfu.timingadv.ind>
            <tapa.tfu.timingadv ueId="0" timingAdv="3"/>
         </tapa.tfu.timingadv.ind>
      </tapa.send>
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="1000"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for both DCCH
         <tapa.rgu.dstaind ueId="0" lchTb1Data="1"/>
      </tapa.expset>

      <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="1" ueId="0" lcId="1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA(3) - TFU_DELTA(2) Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="1">
            <tapa.tfu.pdsch.dat.req ueId="0" chkTA="TRUE" taVal="3"
               validate="TRUE" chkSdu="TRUE" lcId="1"/>
         </tapa.tfu.dat.req>
         # Scheduler meanwhile would have scheduled for DTCH
         <tapa.rgu.dstaind ueId="0" lchTb1Data="1"/>
      </tapa.expset>

      # Not sending data for DTCH anymore, ending TC here
      #<tapa.send>
      #   <tapa.rgu.ddatreq lchTb1Data="1" ueId="1" lcId="3"/>
      #</tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.12
#
#       Desc:    To verify that re-tx SRB HARQ procs get higher priority over
#       re-transmitting DRB HARQ procs through a 2 UE scenario.
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.12">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify that re-tx SRB HARQ procs get higher priority over
         re-transmitting DRB HARQ procs through a 2 UE scenario.
      </tapa.desc>

      <tapa.longdesc>
         To verify that re-tx SRB HARQ procs get higher priority over
         re-transmitting DRB HARQ procs through a 2 UE scenario.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="35" dlSchdType="3" maxDlBwPerUe="35" 
         maxDlRetxBw="25"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"
         dlAmbr="15000"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel (DCCH) for the UE1  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure an non-ambr dedicated logical channel (DTCH) for the UE2
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DCCH on RGR for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>
      
      # Configure a GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 3 for UE2
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" dir="1" lcType="4"
            dlQci="3" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      
      <tapa.send>
         # Send BO for the DCCH on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" lcType="5" bo="420"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="3" lcType="4" bo="420"/>
      </tapa.send>
      
      # Send CQI indication for periodic mode 1-0 for UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send CQI indication for periodic mode 1-0 for UE2
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC for DCCH 
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="1" />
      </tapa.expect>

      <tapa.send>
         # Send data for UE1
         <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="3" />
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="3" validate="TRUE"/>
        </tapa.tfu.dat.req>
        <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="3" />
        # Now DTCH of UE2 shall get scheduled
      </tapa.expset>

      <tapa.send>
         # Send data for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send a TTI to get the PDCCH for UE2
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req ueId="1" use="2" saveTo="4" validate="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 1 TTIs to get HARQ reception request for UE2
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 3 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 
   
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="1" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
   
   # Send CQI indication for periodic mode 1-0 for UE2
   <tapa.send>
      <tapa.tfu.dlcqi.ind>
         <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="10"/>
      </tapa.tfu.dlcqi.ind>
   </tapa.send>

   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 
   
   <tapa.expset>
      # Expect PDU from MAC to PHY. 
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" validate = "TRUE" use="1" saveTo="5"
           vldtRetx="TRUE"/>
     </tapa.tfu.cntrl.req>
     #TODO: Set chkSdu="TRUE"
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" validate="TRUE" 
           use="5" retxUse="3" chkSdu="FALSE" lcId="1" isRetx="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      # Send 1 Tti (to get data for re-tx DRB of UE2)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 
   
   <tapa.expset>
      # Expect PDU from MAC to PHY. 
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req ueId="1" validate = "TRUE" use="1" saveTo="6"
           vldtRetx="TRUE"/>
     </tapa.tfu.cntrl.req>
     #TODO: Set chkSdu="TRUE"
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req ueId="1" validate="TRUE" 
           use="6" retxUse="4" chkSdu="FALSE" lcId="3" isRetx="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   #Ending TC here: further processing not needed

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.13
#
#       Desc:    To verify BO update = 0 handling for transmitting and
#       re-transmitting UEs.
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.13">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify BO update = 0 handling for transmitting and
         re-transmitting UEs.
      </tapa.desc>

      <tapa.longdesc>
         To verify BO update = 0 handling for transmitting and
         re-transmitting UEs.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="50" dlSchdType="3" maxDlBwPerUe="25" 
         maxDlRetxBw="25"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"
         dlAmbr="15000"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel (DCCH) for the UE1  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure a dedicated logical channel (DTCH) for the UE1  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure an non-ambr dedicated logical channel (DTCH) for the UE2
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DCCH on RGR for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>
      
      # Configure a Non-GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 7 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            dlQci="7" instId="5" />
      </tapa.send>

      # Configure a GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 3 for UE2
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" dir="1" lcType="4"
            dlQci="3" instId="5" />
      </tapa.send>
      

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      
      <tapa.send>
         # Send BO for the DCCH on RGU for UE1 
         <tapa.rgu.dstarsp ueId="0" lcId="1" lcType="5" bo="800"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE1
         <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="580"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE2
         <tapa.rgu.dstarsp ueId="1" lcId="3" lcType="4" bo="540"/>
      </tapa.send>
      
      # Send CQI indication for periodic mode 1-0 for UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send CQI indication for periodic mode 1-0 for UE2
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send BO=0 for the DCCH on RGU for UE1 
         <tapa.rgu.dstarsp ueId="0" lcId="1" lcType="5" bo="0"/>
      </tapa.send>

      <tapa.send>
         # Send BO=0 for the GBR DTCH on RGU for UE1
         <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="0"/>
      </tapa.send>
      
      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
        # Now DTCH of UE2 shall get scheduled
        <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="3" />
      </tapa.expect>

      <tapa.send>
         # Send data for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send a TTI to get the PDCCH for UE2
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1"/>
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req ueId="1" use="1" saveTo="2" validate="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 3 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="1" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
   
   # Send CQI indication for periodic mode 1-0 for UE2
   <tapa.send>
      <tapa.tfu.dlcqi.ind>
         <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="10"/>
      </tapa.tfu.dlcqi.ind>
   </tapa.send>
     
   <tapa.send>
    # Send BO = 0 for the GBR DTCH on RGU for UE2
       <tapa.rgu.dstarsp ueId="1" lcId="3" lcType="4" bo="0"/>
   </tapa.send>

   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 
   
   <tapa.send>
      # Send 1 Tti (to get data for re-tx DRB of UE2)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 

   #Expect re-tx scheduling inspite of bo=0
   <tapa.expset>
      # Expect PDU from MAC to PHY. 
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="1" validate = "TRUE" use="1" saveTo="3"
           vldtRetx="TRUE"/>
     </tapa.tfu.cntrl.req>
     #TODO: Set chkSdu="TRUE"
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="1" validate="TRUE" 
           use="3" retxUse="2" chkSdu="FALSE" lcId="3" isRetx="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   #Ending TC here: further processing not needed

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.14
#
#       Desc:    To verify successful UE delete for UEs pending with
#       transmissions or re-transmissions through 2 UE scenario.
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.14">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify successful UE delete for UEs pending with transmissions or
         re-transmissions through 2 UE scenario.
      </tapa.desc>

      <tapa.longdesc>
         To verify successful UE delete for UEs pending with transmissions or
         re-transmissions through 2 UE scenario.
      </tapa.longdesc>

   </tapa.doc>
   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="50" dlSchdType="3" maxDlBwPerUe="25" 
         maxDlRetxBw="25"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"
         dlAmbr="15000"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel (DCCH) for the UE1  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure a dedicated logical channel (DTCH) for the UE1  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure an non-ambr dedicated logical channel (DTCH) for the UE2
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DCCH on RGR for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>
      
      # Configure a GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 3 for UE2
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" dir="1" lcType="4"
            dlQci="3" instId="5" />
      </tapa.send>
      
      # Configure a Non-GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 7 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            dlQci="7" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      
      <tapa.send>
         # Send BO for the DCCH on RGU for UE1 
         <tapa.rgu.dstarsp ueId="0" lcId="1" lcType="5" bo="800"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE1
         <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="580"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE2
         <tapa.rgu.dstarsp ueId="1" lcId="3" lcType="4" bo="540"/>
      </tapa.send>
      
      # Send CQI indication for periodic mode 1-0 for UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="6"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send CQI indication for periodic mode 1-0 for UE2
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send UE Delete Request for the same UE created above at CRG.
      <tapa.send>
         <tapa.crg.cfgreq.del  cellId="3" ueId="0" DelType="2"/>
      </tapa.send>
      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Send UE Delete Request for the same UE created above at RGR.
      <tapa.send>
         <tapa.rgr.cfgreq.del instId="5"  cellId="3" ueId="0" DelType="2"/>
      </tapa.send>
      
      # Send TTI to Scheduler
      # Expect config confirm 
      # Expect staInd for UE2
      <tapa.send>
        <tapa.tfu.tti.ind  />
      </tapa.send>
      
      #Expect positive Configuration Confirm from Scheduler
      <tapa.expect>
         <tapa.rgr.cfgCfm/>
      </tapa.expect>

      <tapa.expect>
        # Now DTCH of UE2 shall get scheduled
        <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="3" />
      </tapa.expect>

      <tapa.send>
         # Send data for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send a TTI to get the PDCCH for UE2
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1"/>
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req ueId="1" use="1" saveTo="2" validate="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 3 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="1" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
   
      # Send UE Delete Request for the same UE created above at CRG.
      <tapa.send>
         <tapa.crg.cfgreq.del  cellId="3" ueId="1" DelType="2"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Send UE Delete Request for the same UE created above at RGR.
      <tapa.send>
         <tapa.rgr.cfgreq.del instId="5"  cellId="3" ueId="1" DelType="2"/>
      </tapa.send>

    <tapa.send>
       # Send 2 Ttis (one for scheduling, one for retransmission,
       # if scheduled and hence NACK is successfully handled)
       # Expect config confirm 
       <tapa.tfu.tti.ind numTti="1"/>
     </tapa.send> 
   
      #Expect positive Configuration Confirm from Scheduler
      <tapa.expect>
         <tapa.rgr.cfgCfm/>
      </tapa.expect>

      # Send TTIs to Scheduler
      # No other pending data is expected
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

<!--
 Write your test cases here
 -->


###############################################################################
#
#       Test:    13.15
#
#       Desc:    To validate that for Uplink scheduling MAX CI chooses a UE with
#       higher wideband CQI.
#
#       Notes:   None
#              
#       Module:  uplink.datapath
#
#       File:    rgac_tc13.xml
#
#
###############################################################################
<tapa.testcase id="13.15">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="uplink.datapath"/>

      <tapa.desc>
         "To validate that for Uplink scheduling MAX CI chooses a UE with
         higher wideband CQI."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="20" ulSchdType="3"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0" ueBr="2000"/>
      <tapa.rg.UeInit ueId="1" ueBr="2000"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 

      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="1" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure bi-directional DTCH for default UE 1
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="2" lcgId="1" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm ueId="1"/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="1" instId="5"/>
      </tapa.send>
      
      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="1" instId="5"/>
      </tapa.send>


      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm ueId="1" instId="5"/>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.ulcqi.ind>
            <tapa.tfu.ulcqi ueId="0" isWideBand="TRUE" wideCqi="6" /> 
            <tapa.tfu.ulcqi ueId="1" isWideBand="TRUE" wideCqi="8" /> 
         </tapa.tfu.ulcqi.ind>
      </tapa.send>
      
      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="4"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" ueId="0" addShortBsr="TRUE" lcgId="1" bsr="50"/>
          <tapa.tfu.dat use="4" ueId="1" addShortBsr="TRUE" lcgId="1" bsr="50"/>
       </tapa.tfu.dat.ind>
      </tapa.send>
      
      # Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>


   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


###############################################################################
#
#       Test:    13.16
#
#       Desc:    To validate that for Uplink scheduling MAX CI chooses a UE with
#       lcg0 data even if it has a lower wideband CQI.
#
#       Notes:   None
#              
#       Module:  uplink.datapath
#
#       File:    rgac_tc13.xml
#
#
###############################################################################
<tapa.testcase id="13.16">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="uplink.datapath"/>

      <tapa.desc>
         "To validate that for Uplink scheduling MAX CI chooses a UE with
         lcg0 data even if it has a lower wideband CQI."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="20" ulSchdType="3"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0"/>
      <tapa.rg.UeInit ueId="1"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 

      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="1" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure bi-directional DTCH for default UE 1
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="2" lcgId="1" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm ueId="1"/>
      </tapa.expect>
      
      # Configure bi-directional DTCH for default UE 1
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm ueId="1"/>
      </tapa.expect>



      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="1" instId="5"/>
      </tapa.send>
      
      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="1" instId="5"/>
      </tapa.send>
      
      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="0" instId="5"/>
      </tapa.send>



      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm ueId="1" instId="5"/>
         <tapa.rgr.cfgCfm ueId="1" instId="5"/>
      </tapa.expset>

      # Send UL CQI such that ue2 has a lower CQI 
      <tapa.send>
         <tapa.tfu.ulcqi.ind>
            <tapa.tfu.ulcqi ueId="0" isWideBand="TRUE" wideCqi="9" /> 
            <tapa.tfu.ulcqi ueId="1" isWideBand="TRUE" wideCqi="6" /> 
         </tapa.tfu.ulcqi.ind>
      </tapa.send>
      
      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="4"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant Send LCG0 for
      # ue2
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" ueId="0" addShortBsr="TRUE" lcgId="1" bsr="50"/>
          <tapa.tfu.dat use="4" ueId="1" addShortBsr="TRUE" lcgId="0" bsr="50"/>
       </tapa.tfu.dat.ind>
      </tapa.send>
      
      # Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>


   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


###############################################################################
#
#       Test:    13.17
#
#       Desc:    To validate that for Uplink scheduling MAX CI Changes the
#       priority of UEs as soon as the UL CQI indication is received.
#
#       Notes:   None
#              
#       Module:  uplink.datapath
#
#       File:    rgac_tc13.xml
#
#
###############################################################################
<tapa.testcase id="13.17">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="uplink.datapath"/>

      <tapa.desc>
         "To validate that for Uplink scheduling MAX CI Changes the
         priority of UEs as soon as the UL CQI indication is received."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="20" ulSchdType="3"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0" ueBr="2000"/>
      <tapa.rg.UeInit ueId="1" ueBr="2000"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 

      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="1" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure bi-directional DTCH for default UE 1
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="2" lcgId="1" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm ueId="1"/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="1" instId="5"/>
      </tapa.send>
      
      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="1" instId="5"/>
      </tapa.send>


      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm ueId="1" instId="5"/>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.ulcqi.ind>
            <tapa.tfu.ulcqi ueId="0" isWideBand="TRUE" wideCqi="6" /> 
            <tapa.tfu.ulcqi ueId="1" isWideBand="TRUE" wideCqi="8" /> 
         </tapa.tfu.ulcqi.ind>
      </tapa.send>
      
      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="4"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" ueId="0" addShortBsr="TRUE" lcgId="1" bsr="50"/>
          <tapa.tfu.dat use="4" ueId="1" addShortBsr="TRUE" lcgId="1" bsr="50"/>
       </tapa.tfu.dat.ind>
      </tapa.send>
      
      # Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.ulcqi.ind>
            <tapa.tfu.ulcqi ueId="0" isWideBand="TRUE" wideCqi="9" /> 
            <tapa.tfu.ulcqi ueId="1" isWideBand="TRUE" wideCqi="6" /> 
         </tapa.tfu.ulcqi.ind>
      </tapa.send>
 
      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      # Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.18
#
#       Desc:    To validate if UL QoS requirement of ueBr configured per UE
#                is satisfied by the MAX C/I scheduler.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.18">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
         "To validate if UL QoS requirement of ueBr configured per UE
         is satisfied by the MAX C/I scheduler."
      </tapa.desc>

      <tapa.longdesc>
         "To validate that the scheduler doesnt exceed ueBr in its ulGrant.
         Verify that for a BS larger than ueBr, scheduler shall partially allocate
         grant after the bsr report till the ueBr is expired. And then the remaining 
         BS is satisfied only after ueBr is refreshed accross refresh Cycle."
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>
<!--
      <tapa.rg.dbgInitErr/>
      <tapa.rg.dbgInitParm/>
      <tapa.rg.dbgInitInfo/>
-->
      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit ulSchdType="3" ulTotalBw="90"/>
      #Initialize UE
      <tapa.rg.UeInit ueCatEnum="CM_LTE_UE_CAT_2" ueBr="3000" prdBsrTmr="65535" />

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      # Configure bi-directional DTCH for default UE (non-GBR) 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="1" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="5" lcgId="2" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="6" lcgId="3" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
      </tapa.expset>

      # Configure bi-directional DTCH for default UE (non-GBR) 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="4" lcgId="1" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="5" lcgId="2" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="6" lcgId="3" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="1" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="2" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="3" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>
      
      # Send one TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

     <tapa.send>
        <tapa.tfu.dat.ind datInds="1">
           <tapa.tfu.dat  use="2" lcId="3" addShortBsr="TRUE" lcgId="2" bsr="33"/>
        </tapa.tfu.dat.ind>
     </tapa.send>

      <tapa.expect>
         # Expect DatInd at RLC
         <tapa.rgu.ddatind lchTb1Data="3,1"/>
      </tapa.expect>

      # Send one TTI  (4 (TTIs to get the feedback) - TFU_DELTA (=2) - 1
      # (TFU_UL_DELTA that elapsed in giving datInd to MAC from PHY)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      <!--
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      -->
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      
      <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="3"/>
       </tapa.tfu.recp.req>        
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      <!--
      <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" saveTo="4"/>
       </tapa.tfu.recp.req>        
      </tapa.expect>
      -->
      # Ideally, a datInd should be sent in this TTI based on the allocation.
      # But as it is not sent expect a harq NACK in next TTI (as UL DELTA is
      # also considered)

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      <!--
      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
      -->
      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
      <!-- 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
      -->

    <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" lcId="3"/>
       </tapa.tfu.dat.ind>
    </tapa.send>

      <tapa.expect>
         # Expect DatInd at RLC
         <tapa.rgu.ddatind lchTb1Data="3,1"/>
      </tapa.expect>

      # Separated TTI processing for DL and UL.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="280"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="1"/>
         </tapa.tfu.cntrl.req>
       </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
     <!--
      <tapa.expset>
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="2"/>
         </tapa.tfu.cntrl.req>
       </tapa.expset>
      -->
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="3"/>
       </tapa.tfu.recp.req>        
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

     <!--
      <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" saveTo="4"/>
       </tapa.tfu.recp.req>        
      </tapa.expect>
      -->
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" lcId="3"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="3,1" vldtBuf="TRUE"/>
      </tapa.expect>
      <!--
      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
      
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="4" lcId="3"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="3,1" vldtBuf="TRUE"/>
      </tapa.expect>
      
      -->      
      # see no further grant
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
     <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    13.19
#
#       Desc:    To verify successful UE reset for UEs pending with
#       transmissions or re-transmissions through 2 UE scenario.
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.19">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify successful UE reset for UEs pending with transmissions or
         re-transmissions through 2 UE scenario.
      </tapa.desc>

      <tapa.longdesc>
         To verify successful UE reset for UEs pending with transmissions or
         re-transmissions through 2 UE scenario.
      </tapa.longdesc>

   </tapa.doc>
   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="50" dlSchdType="3" maxDlBwPerUe="25" 
         maxDlRetxBw="25"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"
         dlAmbr="15000"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel (DCCH) for the UE1  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure a dedicated logical channel (DTCH) for the UE1  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure an non-ambr dedicated logical channel (DTCH) for the UE2
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DCCH on RGR for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>
      
      # Configure a GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 3 for UE2
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" dir="1" lcType="4"
            dlQci="3" instId="5" />
      </tapa.send>
      
      # Configure a Non-GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 7 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            dlQci="7" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      
      <tapa.send>
         # Send BO for the DCCH on RGU for UE1 
         <tapa.rgu.dstarsp ueId="0" lcId="1" lcType="5" bo="800"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE1
         <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="580"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE2
         <tapa.rgu.dstarsp ueId="1" lcId="3" lcType="4" bo="540"/>
      </tapa.send>
      
      # Send CQI indication for periodic mode 1-0 for UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="10"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send CQI indication for periodic mode 1-0 for UE2
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send UE Reset Request for the same UE created above at CRG.
      <tapa.send>
         <tapa.crg.cfgreq.UeReset  cellId="3" ueId="0"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Send UE Reset Request for the same UE created above at RGR.
      <tapa.send>
         <tapa.rgr.cfgreq.UeReset instId="5"  cellId="3" ueId="0"/>
      </tapa.send>
      
      #Expect positive Configuration Confirm from Scheduler
      <tapa.expect>
         <tapa.rgr.cfgCfm/>
      </tapa.expect>

      # Send TTI to Scheduler
      # Expect staInd for UE2
      <tapa.send>
        <tapa.tfu.tti.ind  />
      </tapa.send>
      

      <tapa.expect>
        # Now DTCH of UE2 shall get scheduled
        <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="3" />
      </tapa.expect>

      <tapa.send>
         # Send data for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send a TTI to get the PDCCH for UE2
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1"/>
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req ueId="1" use="1" saveTo="2" validate="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 3 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="1" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
   
      # Send UE Reset Request for the same UE created above at CRG.
      <tapa.send>
         <tapa.crg.cfgreq.UeReset  cellId="3" ueId="1"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Send UE Reset Request for the same UE created above at RGR.
      <tapa.send>
         <tapa.rgr.cfgreq.UeReset instId="5"  cellId="3" ueId="1"/>
      </tapa.send>
      
      #Expect positive Configuration Confirm from Scheduler
      <tapa.expect>
         <tapa.rgr.cfgCfm/>
      </tapa.expect>

      # Send TTIs to Scheduler
      # No other pending data is expected
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.20
#
#       Desc:   "Verify that for UEs' downlink transmission priority changes based on the CQI
#                through a 2 UE scenario"
#           
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.20">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
        Verify that for UEs' downlink transmission priority changes based on the
        CQI through a 2 UE scenario.
      </tapa.desc>

      <tapa.longdesc>
        Verify that for UEs' downlink transmission priority changes based on the
        CQI through a 2 UE scenario.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="30" dlSchdType="3" maxDlBwPerUe="30"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      <tapa.send>
         # Configure a GBR DTCH for the UE1 
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure a GBR DTCH for the UE2
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="4" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure a GBR DTCH with QCI = 3 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            dlQci="3" instId="5" dlMbr="10000" dlGbr="5000"/>
      </tapa.send>
      
      # Configure a GBR DTCH for UE2 with QCI=2 on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="4" dir="1" lcType="5"
           dlQci="2" instId="5" dlMbr="10000" dlGbr="5000"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to apply the configuration
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      
      # Send CQI indication for periodic mode 1-0 for UE1 with cqi = 8
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for periodic mode 1-0 for UE2 with cqi = 10
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="10"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE1. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="9500"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE2. 
         <tapa.rgu.dstarsp ueId="1" lcId="4" lcType="5" bo="9500"/>
      </tapa.send>
      
      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for DTCH of UE2
         <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="4"/>
      </tapa.expset>

      <tapa.send>
         # Send data for UE2
       <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="4,0,1"/>
      </tapa.send>

      # Send CQI indication for periodic mode 1-0 for UE1 with cqi = 10
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="10"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for periodic mode 1-0 for UE2 with cqi = 8
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="1" use="1" validate="TRUE"/>
     </tapa.tfu.dat.req>
     # Now UE1 will get scheduled
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
   </tapa.expset>

    <tapa.send>
       # Send data for UE1
         <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="3,0,1"/>
    </tapa.send>
    
      # Send CQI indication for periodic mode 1-0 for UE1 with cqi = 9
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="9"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for periodic mode 1-0 for UE2 with cqi = 7
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="7"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
  <tapa.send>
     # Send DL_DELTA Ttis to get the MAC PDU at PHY.
     <tapa.tfu.tti.ind numTti="1"/>
  </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"/>
     </tapa.tfu.dat.req>
     # Now UE1 will get scheduled again
     <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3"/>
   </tapa.expset>

    <tapa.send>
       # Send data for UE1
       <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="3,0,1"/>
    </tapa.send>
    
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="7"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
    # Send CQI indication for periodic mode 1-0 for UE2 with cqi = 10 
    # CQI is greater than UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="10"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
  <tapa.send>
     # Send DL_DELTA Ttis to get the MAC PDU at PHY.
     <tapa.tfu.tti.ind numTti="1"/>
  </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"/>
     </tapa.tfu.dat.req>
     # Now UE2 will get scheduled again due to higher CQI
     <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="4"/>
   </tapa.expset>
   
    <tapa.send>
       # Send data for UE2
       <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="4,0,1"/>
    </tapa.send>

  <tapa.send>
     # Send DL_DELTA Ttis to get the MAC PDU at PHY.
     <tapa.tfu.tti.ind numTti="1"/>
  </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="1" use="1" validate="TRUE"/>
     </tapa.tfu.dat.req>
     # Now UE2 will get scheduled again due to higher CQI
     <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="4"/>
   </tapa.expset>

   # Ending TC here: further processing not needed
   
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>
#
#       Test:    13.21
#
#       Desc:   "Verify that for UEs' downlink re-transmission priority changes
#                based on the CQI through a 2 UE scenario"
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.21">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
      Verify that for UEs' downlink re-transmission priority changes
      based on the CQI through a 2 UE scenario.
      </tapa.desc>

      <tapa.longdesc>
      Verify that for UEs' downlink re-transmission priority changes
      based on the CQI through a 2 UE scenario.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="40" dlSchdType="3" maxDlRetxBw="25"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"
         dlAmbr="15000"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure an AMBR dedicated logical channel (DTCH) for the UE1 
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure an non-ambr dedicated logical channel (DTCH) for the UE2
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      
      # Configure an AMBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 7 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            dlQci="7" instId="5" />
      </tapa.send>

      # Configure an Non-AMBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 7 for UE2
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" dir="1" lcType="4"
            dlQci="7" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      
      # Send CQI indication for periodic mode 1-0 for UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="15"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for periodic mode 1-0 for UE2
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="15"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the AMBR DTCH on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="600"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the Non-AMBR DTCH on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="3" lcType="4" bo="600"/>
      </tapa.send>
      
      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for DCCH and DTCH 
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
         <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="3" />
      </tapa.expset>

      <tapa.send>
         # Send data for UE1
         <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send data for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="3" validate="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="1" use="2" saveTo="4" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="2" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
        <tapa.tfu.hq ueId="1" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
   
   # Send CQI indication for periodic mode 1-0 for UE1 with cqi=7
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="7"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

   # Send CQI indication for periodic mode 1-0 for UE2 with cqi=8
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE2
         <tapa.rgu.dstarsp ueId="1" lcId="3" lcType="4" bo="400"/>
      </tapa.send>
      
   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 
      
   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 
   
   <tapa.expset>
      # Expect PDU from MAC to PHY. 
      # UE 2 gets scheduled first as higher cqi
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req ueId="1" validate = "TRUE" use="1" saveTo="6"
           vldtRetx="TRUE"/>
        <tapa.tfu.pdcch.cntrl.req ueId="0" validate = "TRUE" use="1" saveTo="5"
           vldtRetx="TRUE"/>
     </tapa.tfu.cntrl.req>
     #TODO: Set chkSdu="TRUE"
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req ueId="1" validate="TRUE" 
           use="6" retxUse="4" chkSdu="FALSE" lcId="3" isRetx="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="0" validate="TRUE" 
           use="5" retxUse="3" chkSdu="FALSE" lcId="3" isRetx="TRUE"/>
     </tapa.tfu.dat.req>
     # StaInd recieved for new data of UE2
     <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="3" />
   </tapa.expset>

      <tapa.send>
         # Send data for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>

   # Send CQI indication for periodic mode 1-0 for UE1 with cqi=7
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="12"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

   <tapa.send>
      # Send 1 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      # UE1 will get scheduled
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="7"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="1" use="7" saveTo="8" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      # Send 1 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      # UE1 will get scheduled
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.22
#
#       Desc:   "To test successful DL path for MAX C/I scheduler with 8 UEs with 
#                different DL CQI values"
#       Notes:   None
#              
#       Module:  "DLFS Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.22">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To test successful DL path for MAX C/I scheduler with 8 UEs with different
         DL CQI values
      </tapa.desc>

      <tapa.longdesc>
         To test successful DL path for MAX C/I scheduler with 8 UEs with different
         DL CQI values
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit isDlFreqSel="0" dlTotalBw="50" dlSchdType="3"/>

      # UE Creation
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" aprdModeEnumPres = "TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"/>
      
      <tapa.rg.UeInit ueId="1" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"/>
      
      <tapa.rg.UeInit ueId="2" ueCatEnum="1" aprdModeEnumPres="TRUE"
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30"/>
      
      <tapa.rg.UeInit ueId="3" ueCatEnum="1" cqiPmiCfgIdx="1" k="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>
      
      <tapa.rg.UeInit ueId="4" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"/>
      
      <tapa.rg.UeInit ueId="5" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"/>
      
      <tapa.rg.UeInit ueId="6" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>
      
      <tapa.rg.UeInit ueId="7" ueCatEnum="1" cqiPmiCfgIdx="1" k="1"
         aprdModeEnumPres = "TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      #UE1 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="3" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="4" lcId="5" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="5" lcId="6" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="6" lcId="7" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="7" lcId="8" lcgId="1" dir="3" lcType="4" />
      </tapa.send>
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="2" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="3" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>
      
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="4" lcId="5" dir="1" lcType="4" instId="5" />
      </tapa.send>
      
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="5" lcId="6" dir="1" lcType="4" instId="5" />
      </tapa.send>
      
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="6" lcId="7" dir="1" lcType="4" instId="5" />
      </tapa.send>
      
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="7" lcId="8" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Current SFN = 18 sf = 3

      # Send CQI indication for aperiodic mode 2-0 for UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="0" isPucchInfo="FALSE" cqiMode="1" wbCqi="11" cqiIdx="10"
            numOfSubbands = "5" rbStartLst = "0:6:12:21:27" numRbLst =
            "3:3:3:3:2" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send CQI indication for aperiodic mode 3-0 for UE3
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="2" isPucchInfo="FALSE" cqiMode="3" wbCqi="13"
            numOfSubbands = "9" rbStartLst="0:6:12:18:24:30:36:42:48" numRbLst =
            "6:6:6:6:6:6:6:6:2" cqiIdxLst="7:14:13:8:3:5:9:12:11" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for aperiodic mode 2-0 for UE5
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="4" isPucchInfo="FALSE" cqiMode="1" wbCqi="9" cqiIdx="11"
            numOfSubbands = "5" rbStartLst = "0:9:15:45:48" numRbLst =
            "3:3:3:3:2" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for aperiodic mode 3-0 for UE6
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="5" isPucchInfo="FALSE" cqiMode="3" wbCqi="10"
            numOfSubbands = "9" rbStartLst="0:6:12:18:24:30:36:42:48" numRbLst =
            "6:6:6:6:6:6:6:6:2" cqiIdxLst="12:11:7:10:8:9:15:4:4" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for aperiodic mode 2-0 for UE7
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="6" isPucchInfo="FALSE" cqiMode="1" wbCqi="9"
              cqiIdx="8"
            numOfSubbands = "5" rbStartLst = "0:9:15:45:48" numRbLst =
            "3:3:3:3:2" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send CQI indication for aperiodic mode 3-0 for UE8
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="7" isPucchInfo="FALSE" cqiMode="3" wbCqi="8"
            numOfSubbands = "9" rbStartLst="0:6:12:18:24:30:36:42:48" numRbLst =
            "6:6:6:6:6:6:6:6:2" cqiIdxLst="7:14:13:8:3:5:9:12:4" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      #Send wide-band CQI for periodic mode 2-0 for UE1
      #Note: This might be the wrong timing to send Wide-band CQI
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="2" isWideband="TRUE"
              wbCqi="14" label="2"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      #Send wide-band CQI for periodic mode 1-0 for UE4 
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="3" isPucchInfo="TRUE" cqiMode="0" cqiIdx="12"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      #Send BO for UE1
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="100"/>
      </tapa.send>

      #Send BO for UE2
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="2" bo="50"/>
      </tapa.send>

      #Send BO for UE3
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="2" lcId="3" bo="120"/>
      </tapa.send>

      #Send BO for UE4
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="3" lcId="4" bo="89"/>
      </tapa.send>

      #Send BO for UE5
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="4" lcId="5" bo="200"/>
      </tapa.send>

      #Send BO for UE6
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="5" lcId="6" bo="160"/>
      </tapa.send>
      
      #Send BO for UE7
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="6" lcId="7" bo="120"/>
      </tapa.send>
      
      #Send BO for UE8
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="7" lcId="8" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for Msg4 
         # The priority of the UEs as selected by MAX C/I is same as this
         # SRBs or UE1 and UE2 get priority over others 
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="1" />
         <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="2" />
         # UEs get priority in the order of the CQIs 
         <tapa.rgu.dstaind ueId="2" numLchTb1="1" lchTb1Data="3" />
         <tapa.rgu.dstaind ueId="3" numLchTb1="1" lchTb1Data="4" />
         <tapa.rgu.dstaind ueId="5" numLchTb1="1" lchTb1Data="6" />
         # UE5 and UE7 are at the same CQI and served in round-robin manner 
         <tapa.rgu.dstaind ueId="4" numLchTb1="1" lchTb1Data="5" />
         <tapa.rgu.dstaind ueId="6" numLchTb1="1" lchTb1Data="7" />
         # UE8 gets the lowest priority due to the lowest CQI value
         <tapa.rgu.dstaind ueId="7" numLchTb1="1" lchTb1Data="8" />
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE1 
         <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DDatReq for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="2,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DDatReq for UE3
         <tapa.rgu.ddatreq ueId="2" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE4
         <tapa.rgu.ddatreq ueId="3" numLchTb1="1" lchTb1Data="4,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE5
         <tapa.rgu.ddatreq ueId="4" numLchTb1="1" lchTb1Data="5,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE6
         <tapa.rgu.ddatreq ueId="5" numLchTb1="1" lchTb1Data="6,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE7
         <tapa.rgu.ddatreq ueId="6" numLchTb1="1" lchTb1Data="7,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DDatReq for UE8
         <tapa.rgu.ddatreq ueId="7" numLchTb1="1" lchTb1Data="8,0,1"/>
      </tapa.send>
      
      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
        <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="3"/>
        <tapa.tfu.pdcch.cntrl.req ueId="3" saveTo="4"/>
        <tapa.tfu.pdcch.cntrl.req ueId="4" saveTo="5"/>
        <tapa.tfu.pdcch.cntrl.req ueId="5" saveTo="6"/>
        <tapa.tfu.pdcch.cntrl.req ueId="6" saveTo="7"/>
        <tapa.tfu.pdcch.cntrl.req ueId="7" saveTo="8"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="1" use="2" validate="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="2" use="3" validate="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="3" use="4" validate="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="4" use="5" validate="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="5" use="6" validate="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="6" use="7" validate="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="7" saveTo="1" use="8" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expect>
     <tapa.tfu.recp.req numRntis="8" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
        <tapa.tfu.hq.recp.req ueId="2"/>
        <tapa.tfu.hq.recp.req ueId="3"/>
        <tapa.tfu.hq.recp.req ueId="4"/>
        <tapa.tfu.hq.recp.req ueId="5"/>
        <tapa.tfu.hq.recp.req ueId="6"/>
        <tapa.tfu.hq.recp.req ueId="7"/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind>
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
        <tapa.tfu.hq ueId="2"/>
        <tapa.tfu.hq ueId="3"/>
        <tapa.tfu.hq ueId="4"/>
        <tapa.tfu.hq ueId="5"/>
        <tapa.tfu.hq ueId="6"/>
        <tapa.tfu.hq ueId="7" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   #Send BO for UE4
     <tapa.send>
        # Send BO for the created logical channel on RGU. 
        <tapa.rgu.dstarsp ueId="3" lcId="4" bo="89"/>
     </tapa.send>
     
     #Send wide-band CQI for periodic mode 1-0 for UE4 with CQI less than
     threshold CQI
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="3" isPucchInfo="TRUE" cqiMode="0" cqiIdx="5"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 

   <tapa.expect>
      <tapa.rgu.dstaind ueId="3" numLchTb1="1" lchTb1Data="4" />
   </tapa.expect>

   <tapa.send>
      # Send DDatReq for UE4
      <tapa.rgu.ddatreq ueId="3" numLchTb1="1" lchTb1Data="4,0,1"/>
   </tapa.send>

   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 

   <tapa.expset>
      # Expect PDU from MAC to PHY. 
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req  ueId="7" validate = "TRUE" saveTo="2" 
           use="8" vldtRetx="TRUE"/>
        <tapa.tfu.pdcch.cntrl.req ueId="3" saveTo="3"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req validate="TRUE" ueId="7"
           use="2" retxUse="1" chkSdu="FALSE"
           lcId="8" isRetx="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="3" use="3" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      # Send a 4 TTIs to expect harqReception request 
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   <tapa.expect>
     <tapa.tfu.recp.req numRntis="2" spId="1">
        <tapa.tfu.hq.recp.req ueId="3"/>
        <tapa.tfu.hq.recp.req ueId="7"/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

   <tapa.send>
     <tapa.tfu.hq.ind>
        <tapa.tfu.hq ueId="3"/>
        <tapa.tfu.hq ueId="7"/>
     </tapa.tfu.hq.ind>
  </tapa.send>

   </tapa.test>
   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.23
#
#       Desc:   "Verify that DCCH retx gets priority over DTCH retx
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.23">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Verify that DCCH re-tx get priority over DTCH re-tx
      </tapa.desc>

      <tapa.longdesc>
         Verify that DCCH re-tx get priority over DTCH re-tx
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="25" dlSchdType="3" maxDlBwPerUe="25"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      <tapa.send>
         # Configure a GBR dedicated logical channel (DTCH) for the UE1 
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure a SRB (DCCH) for the UE1
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure a GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 3 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            dlQci="3" instId="5" />
      </tapa.send>
      
      # Configure a SRB (DCCH) for UE1 on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         # Send a Tti to apply the configuration
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      
      # Send CQI indication for periodic mode 1-0 for UE1 = 14
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="14"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE1. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="800"/>
      </tapa.send>
      
      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC for SRB of UE1
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
      </tapa.expect>

      <tapa.send>
         # Send BO for the DCCH on RGU for UE1
         <tapa.rgu.dstarsp ueId="0" lcId="1" lcType="5" bo="780"/>
      </tapa.send>

      <tapa.send>
         # Send DTCH data for UE1
         <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DTCH data at PHY from MAC
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"
              saveTo="2"/>
        </tapa.tfu.dat.req>
        # Now DCCH of UE1 will also get scheduled
        <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="1"/>
      </tapa.expset>

      <tapa.send>
         # Send DCCH data for UE1
         <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send 1 TTI to get the DTCH data from MAC to PHY
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect DCCH data at PHY from MAC
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="3"/>
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req ueId="0" use="3" saveTo="4" validate="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>
      
      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC for DTCH
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

     # Expect harq reception request at MAC for DTCH
   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC for DCCH
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

     # Expect harq reception request at MAC for DCCH
   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send 3 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      # Send HARQ ACK indication = FALSE for DTCH
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 

   # Send NACK for DCCH data
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
   
   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 
   
   <tapa.expset>
      # Expect retx of DTCH data from MAC to PHY. 
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req ueId="0" validate = "TRUE" use="1" saveTo="5"
           vldtRetx="TRUE"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req ueId="0" validate="TRUE" 
           use="5" retxUse="2" chkSdu="FALSE" lcId="3" isRetx="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 

   <tapa.expset>
      # Expect retx of DCCH data from MAC to PHY. 
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req ueId="0" validate = "TRUE" use="3" saveTo="6"
           vldtRetx="TRUE"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req ueId="0" validate="TRUE" 
           use="6" retxUse="4" chkSdu="FALSE" lcId="3" isRetx="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>
   
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


###############################################################################
#
#       Test:    13.24
#
#       Desc:    To validate that for Uplink scheduling MAX CI chooses a UEs with
#       same wideband CQI in a RR manner.
#
#       Notes:   None
#              
#       Module:  uplink.datapath
#
#       File:    rgac_tc13.xml
#
#
###############################################################################
<tapa.testcase id="13.24">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="uplink.datapath"/>

      <tapa.desc>
         "To validate that for Uplink scheduling MAX CI chooses a UEs with
         same wideband CQI in a RR manner."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="30" maxUlUeNewTxPerTti="4" ulSchdType="3"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0" ueCatEnum="CM_LTE_UE_CAT_4" ueBr="5000" prdBsrTmr="65535" />
      <tapa.rg.UeInit ueId="1" ueCatEnum="CM_LTE_UE_CAT_4" ueBr="5000" prdBsrTmr="65535"/>
      <tapa.rg.UeInit ueId="2" ueCatEnum="CM_LTE_UE_CAT_4" ueBr="5000" prdBsrTmr="65535"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 

      # Configure bi-directional DTCH for default UE0 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="1" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="1" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="3" lcgId="1" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
      </tapa.expset>

      # Configure bi-directional DTCH for default UE0 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="1" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="1" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="2" lcId="3" lcgId="1" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="1" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="1" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="2" lcgId="1" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Indicate the same CQI for both
      <tapa.send>
         <tapa.tfu.ulcqi.ind>
            <tapa.tfu.ulcqi ueId="0" isWideBand="TRUE" wideCqi="12" /> 
            <tapa.tfu.ulcqi ueId="1" isWideBand="TRUE" wideCqi="12" /> 
            <tapa.tfu.ulcqi ueId="2" isWideBand="TRUE" wideCqi="12" /> 
         </tapa.tfu.ulcqi.ind>
      </tapa.send>
      
      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
           <tapa.tfu.sr ueId="2"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="3" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="4"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="5"/>
        <tapa.tfu.pusch.recp.req ueId="2" use="3" vldtDatRecp="TRUE" saveTo="6"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="2" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="2" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="4" ueId="0" addShortBsr="TRUE" lcgId="1" bsr="50"/>
          <tapa.tfu.dat use="5" ueId="1" addShortBsr="TRUE" lcgId="1" bsr="50"/>
          <tapa.tfu.dat use="6" ueId="2" addShortBsr="TRUE" lcgId="1" bsr="50"/>
       </tapa.tfu.dat.ind>
      </tapa.send>
      
      # Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      # Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
     </tapa.expset>

     # Send a TTI to schedule BSR
     <tapa.send>
        <tapa.tfu.tti.ind numTti="1"/>
     </tapa.send>

     # Expect DCI format 0 and do basic validations of the grant
     <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
     </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


###############################################################################
#
#       Test:    13.25
#
#       Desc:    To validate that for Uplink scheduling MAX CI chooses a UEs with
#       different wideband CQI such that the UE with the best CQI gets
#       allocations ahead of other UEs. (LONG BSR)
#
#       Notes:   None
#              
#       Module:  uplink.datapath
#
#       File:    rgac_tc13.xml
#
#
###############################################################################
<tapa.testcase id="13.25">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="uplink.datapath"/>

      <tapa.desc>
         "To validate that for Uplink scheduling MAX CI chooses a UEs with
         different wideband CQI such that the UE with the best CQI gets
         allocations ahead of other UEs."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="30" maxUlUeNewTxPerTti="4" ulSchdType="3"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0" ueCatEnum="CM_LTE_UE_CAT_4" ueBr="15000"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="CM_LTE_UE_CAT_4" ueBr="15000"/>
      <tapa.rg.UeInit ueId="2" ueCatEnum="CM_LTE_UE_CAT_4" ueBr="15000"/>
      <tapa.rg.UeInit ueId="3" ueCatEnum="CM_LTE_UE_CAT_4" ueBr="15000"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 

      # Configure bi-directional DTCH for default UE0 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="1" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="1" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>

      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="3" 
            lcgId="1" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>

      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="3" lcId="3" 
            lcgId="1" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
      </tapa.expset>

      # Configure bi-directional DTCH for default UE0 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="1" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="1" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="2" lcId="3" lcgId="1" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="3" lcId="3" lcgId="1" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="1" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="1" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="2" lcgId="1" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="3" lcgId="1" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Indicate the same CQI for both
      <tapa.send>
         <tapa.tfu.ulcqi.ind>
            <tapa.tfu.ulcqi ueId="0" isWideBand="TRUE" wideCqi="12" /> 
            <tapa.tfu.ulcqi ueId="1" isWideBand="TRUE" wideCqi="6" /> 
            <tapa.tfu.ulcqi ueId="2" isWideBand="TRUE" wideCqi="5" /> 
            <tapa.tfu.ulcqi ueId="3" isWideBand="TRUE" wideCqi="8" /> 
         </tapa.tfu.ulcqi.ind>
      </tapa.send>
      
      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
           <tapa.tfu.sr ueId="2"/>
           <tapa.tfu.sr ueId="3"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="4">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="3" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="3" saveTo="4" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="5"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="6"/>
        <tapa.tfu.pusch.recp.req ueId="2" use="3" vldtDatRecp="TRUE" saveTo="7"/>
        <tapa.tfu.pusch.recp.req ueId="3" use="4" vldtDatRecp="TRUE" saveTo="8"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="2" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="3" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="2" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="3" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="5" ueId="0" addLongBsr="TRUE" bsr0="0" bsr1="50" 
             bsr2="0" bsr3="0"/>
          <tapa.tfu.dat use="6" ueId="1" addLongBsr="TRUE" bsr0="0" bsr1="50" 
             bsr2="0" bsr3="0"/>
          <tapa.tfu.dat use="7" ueId="2" addLongBsr="TRUE" bsr0="0" bsr1="50" 
             bsr2="0" bsr3="0"/>
          <tapa.tfu.dat use="8" ueId="3" addLongBsr="TRUE" bsr0="0" bsr1="50" 
             bsr2="0" bsr3="0"/>
       </tapa.tfu.dat.ind>
      </tapa.send>
      
      # Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      # Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
     </tapa.expset>

     # Send a TTI to schedule BSR
     <tapa.send>
        <tapa.tfu.tti.ind numTti="1"/>
     </tapa.send>

     # Expect DCI format 0 and do basic validations of the grant
     <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
     </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

###############################################################################
#
#       Test:    13.26
#
#       Desc:    To validate that for Uplink scheduling MAX CI Changes the
#       priority of UEs as soon as the UL CQI indication is received.
#
#       Notes:   None
#              
#       Module:  uplink.datapath
#
#       File:    rgac_tc13.xml
#
#
###############################################################################
<tapa.testcase id="13.26">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="uplink.datapath"/>

      <tapa.desc>
         "To validate that for Uplink scheduling MAX CI Changes the
         priority of UEs as soon as the UL CQI indication is received."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="20" ulSchdType="3"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0" ueBr="2000"/>
      <tapa.rg.UeInit ueId="1" ueBr="2000"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 

      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="1" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure bi-directional DTCH for default UE 1
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="2" lcgId="1" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm ueId="1"/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="1" instId="5"/>
      </tapa.send>
      
      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="1" instId="5"/>
      </tapa.send>


      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm ueId="1" instId="5"/>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.ulcqi.ind>
            <tapa.tfu.ulcqi ueId="0" isWideBand="TRUE" wideCqi="6" /> 
            <tapa.tfu.ulcqi ueId="1" isWideBand="TRUE" wideCqi="8" /> 
         </tapa.tfu.ulcqi.ind>
      </tapa.send>
      
      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="4"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" ueId="0" addTruncBsr="TRUE" lcgId="1" bsr="50"/>
          <tapa.tfu.dat use="4" ueId="1" addTruncBsr="TRUE" lcgId="1" bsr="50"/>
       </tapa.tfu.dat.ind>
      </tapa.send>
      
      # Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.ulcqi.ind>
            <tapa.tfu.ulcqi ueId="0" isWideBand="TRUE" wideCqi="9" /> 
            <tapa.tfu.ulcqi ueId="1" isWideBand="TRUE" wideCqi="6" /> 
         </tapa.tfu.ulcqi.ind>
      </tapa.send>
 
      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      # Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.27
#
#       Desc:   "To verify that contention resolution is accorded higher
#                priority over signaling."
#
#       Notes:   None
#              
#       Module:  "MAX-CI"
#
#       File:    rgac_tc14.xml
#
#
<tapa.testcase id="13.27">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To verify that contention resolution is accorded higher
         priority over signaling."
         "Successful scenario of C-RNTI based contention resolution"
      </tapa.desc>

      <tapa.longdesc>
         "To verify that contention resolution is accorded higher
         priority over signaling."
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit ulSchdType="3"/>

      # UE Configuration
      <tapa.rg.2UeInit/>

      <tapa.rg.dbgDeInitAll/>
      <tapa.rg.dbgInitAll/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 

      # Configure a DTCH for UE 1
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3"
            lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="0" instId="5"/>
      </tapa.send>

      # Send RaReqInd for one rapId 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            # This tmp crnti would get updated in ueId="2", since ueId="1" is
            # the last one being used.
            <tapa.tfu.rareq raRnti="10" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.crg.cfgcfm/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      # Assuming start of this step we are at (0,0) 
      # UeInit takes 20 subframes
      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # The number of subframes to wait for receiving the RA RSP is maximum of
      # RA RSP window and the scheduling delta RG_DL_DELTA (=3) minus the 
      # TFU_DELTA (=2) from the next TTI. This makes the number of TTIs 2 (3 - 2
      # + 1).
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # At start of this step, we are at (0,1)
      # Expect RaResp for the rapId sent in RaReq. Validate the RAR Pdu
      # creation as well. Expect confirmation for Logical channel configuration
      <tapa.expset>
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req/>
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="1">
            <tapa.tfu.rarsp.req raRnti="10" vldtRar="TRUE" saveTo="1"/>
         </tapa.tfu.dat.req>
      </tapa.expset>

      # At start of this step, we are at (0,1)
      # Counting the TTIs, RA RSP was received by PHY at sf = (0,2). PHY tranmits
      # the RA RSP in sf = (0, 4). UE will transmit the MSG3 at sf = (1, 0). We 
      # must receive data reception request at sf = (0, 8). Current TTI = (0, 2)
      # and hence we must send 6 TTIs.

      # However, meanwhile let us start SR + allocation cycle for the
      # other UE.

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Send SR Indication
      <tapa.send>
         <tapa.tfu.sr.ind>
            <tapa.tfu.sr ueId="1"/>
         </tapa.tfu.sr.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect dci format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE"
              vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # At start of this step, we are at (0,7)
      # Expect Message3 reception req. Validation against the grant given in
      # raResp shall be done
      <tapa.expect>
         <tapa.tfu.recp.req numRntis="1">
            <tapa.tfu.msg3.recp.req ueId="2" vldtDatRecp="TRUE"/>
            <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE"
               saveTo="3"/>
         </tapa.tfu.recp.req>
      </tapa.expect>

      # At start of this step, we are at (0,7)
      # Send (TFU_DELTA + TFU_UL_DELTA) TTIs
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="2" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="2" spId="1">
            <tapa.tfu.phich.cntrl.req ueId="2" isAck="TRUE"/>
            <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>

      # At start of this step, we are at (1,0)
      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
         <tapa.tfu.dat.ind datInds="2">
            <tapa.tfu.dat sduSize="20" crnti="0" ueId="2" addCrnti="TRUE"/>
            <tapa.tfu.dat use="3" ueId="1" addShortBsr="TRUE"
               lcgId="0" bsr="35" lcId="1"/>
         </tapa.tfu.dat.ind>      
      </tapa.send>   

      <tapa.expset>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="1"/>
      </tapa.expset>

      <tapa.expect>
          <tapa.rgr.uestaind/>
      </tapa.expect>

      # At start of this step, we are at (1,0)
      # Send 1 TTI for scheduling grant for CRNTI based contention resolution
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # At start of this step, we are at (1,1)
      # Send TTIs for to expect PDCCH for the scheduled grant 
      # NumTti = RG_UL_SCHED_DELTA (=2) - TFU_DELTA(=2)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="0"/>
      </tapa.send>

      # At start of this step, we are at (1,1).
      # Expect PDCCH for DCI format 0.
      <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="2">
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE"
               vldtGrant="TRUE" vldtTx="TRUE"/>
            <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE"
               vldtGrant="TRUE" vldtTx="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expset>      

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Remaining allocation for second UE
      <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="3" isUlGrant="TRUE"
               vldtGrant="TRUE" vldtTx="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expset>      

      # Need not finished the flow. End TC here.

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

# Test case is added to test the functionality of DTX
</tapa.testcase>

#
#
#       Test:    13.28
#
#       Desc:    To Verify that UE receiving - Transmitting IMCS and 
#                 rvIndex = 0 or not for the first ReTx if the UE reports DTX.
#
#       Notes:   None
#              
#       Module:  "MAX C/I Module"
#
#       File:    rgac_tc28.xml
#
#
<tapa.testcase id="13.28">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         Successful DL path for a DTX UE using MAX C/I scheduling and periodic
         CQI report for mode 1-0 for GBR/NON-GBR/AMBR services.
      </tapa.desc>

      <tapa.longdesc>
         Testing that DTx UE recieves DL data successfully on reporting CQI through
         periodic CQI reporting mode 1-0 using MAX C/I scheduler for
         GBR/NON-GBR/AMBR services.
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="75" dlSchdType="3" maxDlRetxBw="75"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"
         dlAmbr="15000"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel (DCCH) for the UE1  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure a GBR dedicated logical channel (DTCH) for the UE1 
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="5" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure an AMBR dedicated logical channel (DTCH) for the UE1 
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="6" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure DCCH on RGR for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>
      
      # Configure a GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 1 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="5" dir="1" lcType="4"
            dlQci="1" instId="5" />
      </tapa.send>
      
      # Configure an AMBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 7 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="6" dir="1" lcType="4"
            dlQci="7" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      
      # Send CQI indication for periodic mode 1-0 for UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="15"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the DCCH on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" lcType="5" bo="120"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="5" lcType="4" bo="1000"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the AMBR DTCH on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="6" lcType="4" bo="80"/>
      </tapa.send>
      
      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for DCCH and DTCH 
         <tapa.rgu.dstaind ueId="0" numLchTb1="3" lchTb1Data="1:5:6" />
      </tapa.expset>

      <tapa.send>
         # Send data for UE1
         <tapa.rgu.ddatreq ueId="0" numLchTb1="3" lchTb1Data="1,0,1:5,0,1:6,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"  
           vldRvIdx="TRUE" rvIdx="0" vldImcs="TRUE" iMcs="26"
           vldaggrLvl="TRUE" aggrLvl="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="3" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="TFU_HQ_DTX"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 
   
   <tapa.send>
      # Send 2 Ttis (one for scheduling, one for retransmission,
      # if scheduled and hence NACK is successfully handled)
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send> 
   
   <tapa.expset>
      # Expect PDU from MAC to PHY. 
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" validate = "TRUE" use="1" saveTo="5"
           vldtRetx="TRUE" vldRvIdx="TRUE" rvIdx="0" vldImcs="TRUE" iMcs="26"
           vldaggrLvl="TRUE" aggrLvl="3"/>
     </tapa.tfu.cntrl.req>
     #TODO: Set chkSdu="TRUE"
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" validate="TRUE" 
           use="5" retxUse="3" chkSdu="FALSE" lcId="1:5:6" isRetx="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    13.29
#
#       Desc:   "To verify if the retransmission allocation if failing for
#                  particular HARQ process continously the release the HARQ 
#                  process and removed the node from the retransmission list"
#
#       Notes:   None
#
#       Module:  "PFS"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="13.29">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
      "To verify if the retransmission allocation if failing for
      particular HARQ process continously the release the HARQ 
      process and removed the node from the retransmission list"
      </tapa.desc>

      <tapa.longdesc>
      "To verify if the retransmission allocation if failing for
      particular HARQ process continously the release the HARQ 
      process and removed the node from the retransmission list"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="15" maxDlBwPerUe="10" maxDlRetxBw="10"
         dlSchdType="3" raWinSize="5"/>

      # UEs Creation
      <tapa.rg.UeInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         # Configure a GBR DTCH at MAC (not scheduler) for UE 0
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0"
            dir="3" lcType="4"/>
      </tapa.send>

            # Configure GBR DTCH (RGR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            dlQci="1" instId="5"/>
      </tapa.send>

            # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect the successful confirms
      <tapa.expset>
         <tapa.crg.cfgcfm/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Set good CQIs intially (later we worsen it so that
      # the two retx procs cannot go toghether)
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" cqiIdx="12"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send BOs. Note that BOs should be sent such
      # that they are completely satisfied without
      # leaving a lot of buffer in the bandwidth.
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="3" bo="500"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect staInd from MAC to RLC for both DCCH and DTCH
      <tapa.expset>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="3"/>
      </tapa.expset>

      <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="3" ueId="0" lcId="3"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA(3) - TFU_DELTA(2) Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="1">
            <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="3" validate="TRUE"/>
         </tapa.tfu.dat.req>
      </tapa.expset>

      # Send 4 TTIs to get the harqrecpRequest from MAC
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req numRntis="1" spId="1">
            <tapa.tfu.hq.recp.req ueId="0"/>
         </tapa.tfu.recp.req>
      </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs (TFU_DELTA) + 1 TTI (TFU_UL_DELTA) before
         # sending the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      # NACK both the transmissions
      <tapa.send>
         <tapa.tfu.hq.ind hqInds="1">
            <tapa.tfu.hq ueId="0" isAck="FALSE"/>
         </tapa.tfu.hq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="10" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="1" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>


      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="10" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="2" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="1" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="3" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="2" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="4" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="3" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>


      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="5" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="4" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="6" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="5" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
 
       <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="7" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="6" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
 
        <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="8" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="7" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
           
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="9" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="8" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="10" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
        <tapa.tfu.cntrl.req/>
      </tapa.expset>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>



#/********************************************************************30**
#
#         End of file:     rgac_tc13.xml@@/main/1 - Thu Mar 26 01:11:03 2009
#
#*********************************************************************31*/
#/**********************************************************************
#        Revision History:
#
#**********************************************************************/
#/********************************************************************90**
# 
#     ver       pat    init                  description
#------------ -------- ---- ----------------------------------------------
#/main/1      ---     sm   1. Initial Release.
#$SID$         ---     sm   1. Initial Release.
#$SID$         rg007.201   ap  1. Increased cqi value/expeced aggr 
                                      value/iMcs value for MIMO upgradation.
#$SID$        ---     gvj  1. LTE MAC 3.1 Release
#$SID$        rg002.301 av  1.changes for CR ccpu00109543
#$SID$      ---       rt   1. LTE MAC 4.1 Release
#*********************************************************************91*/
