#
#/********************************************************************20**
#
#     Name:    LTE-MAC 
#
#     Type:    XML Test File
#
#     Desc:    XML Based Test Cases For RR Scheduler
#
#     File:    rgac_tc15.xml
#
#     Sid:      rgac_tc15.xml@@/main/1 - Thu Mar 26 01:11:03 2009
#
#     Prg:     ns 
#
#*********************************************************************21*/

# DO NOT DELETE THIS LINE -- TC number generation script depends on it.
# xyzabcstart=1:hn:rgac_tc15.xml


#
#
#       Test:    15.1
#
#       Desc:   Verify that RR schedules a single UE. 
#
#       Notes:   None
#              
#       Module:  RR SCH
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.1">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that RR schedules a single UE." 
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>

      # UE Creation
      <tapa.rg.UeInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="2" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="4" bo="64"/>
      </tapa.send>

     <tapa.send>
        <tapa.tfu.dlcqi.ind>
           <tapa.tfu.dlcqi ueId="0" cqiIdx="15"/>
        </tapa.tfu.dlcqi.ind>
     </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind ueId="0" numLchTb1="4" lchTb1Data="1:2:3:4" />
      </tapa.expect>

      <tapa.send>
         # Send DDatReq 
         <tapa.rgu.ddatreq ueId="0" numLchTb1="4" lchTb1Data="1,0,1:2,0,1:3,0,1:4,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req ueId="0" use="2" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expect>
     <tapa.tfu.recp.req spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind>
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.2
#
#       Desc:    Verify that RR schedules a single UE 
#
#       Notes:   None
#              
#       Module:  RR SCH
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.2">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that RR schedules a single UE"
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>
      #Initialize UE
      <tapa.rg.UeInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 

      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      <tapa.send>
         <tapa.tfu.ulcqi.ind> 
            <tapa.tfu.ulcqi ueId="0" isWideBand="TRUE" wideCqi="9"/>
         </tapa.tfu.ulcqi.ind>
      </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req>
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="2"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat ueId="0" use="2" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.3
#
#       Desc:    Verify that UEs are scheduled in the reported BO order 
#
#       Notes:   None
#              
#       Module:  "RR SCH"
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.3">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that UEs are scheduled in the reported BO order" 
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>

      # UE Creation
      <tapa.rg.2UeRrInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      #UE1 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      #UE2 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      #Send BO for UE1
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="2" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="4" bo="64"/>
      </tapa.send>

      #Send BO for UE2
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="2" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="3" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="4" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind ueId="0" numLchTb1="4" lchTb1Data="1:2:3:4" />
         <tapa.rgu.dstaind ueId="1" numLchTb1="4" lchTb1Data="1:2:3:4" />
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE1 
         <tapa.rgu.ddatreq ueId="0" numLchTb1="4" lchTb1Data="1,0,1:2,0,1:3,0,1:4,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DDatReq for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="4" lchTb1Data="1,0,1:2,0,1:3,0,1:4,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="1" use="2" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expect>
     <tapa.tfu.recp.req spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind>
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.4
#
#       Desc:    Verify that in a multiple UE Scenario, the UEs shall be
#       scheduled in RR fashion based on SR 
#
#       Notes:   None
#              
#       Module:  RR SCH
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.4">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that in a multiple UE Scenario, the UEs shall be 
          scheduled in RR fashion based on SR"
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>
      #Initialize UE
      <tapa.rg.2UeRrInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      #UE1 Configuration
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      #UE2 Configuration
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req>
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="4"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat ueId="0" use="3" lcId="1"/>
          <tapa.tfu.dat ueId="1" use="4" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expset>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="1,1" vldtBuf="TRUE"/>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.5
#
#       Desc:    Verify that re-tx UEs are scheduled ahead of new-tx UEs 
#
#       Notes:   None
#              
#       Module:  "RR SCH"
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.5">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that re-tx UEs are scheduled ahead of new-tx UEs" 
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>

      # UE Creation
      <tapa.rg.2UeRrInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      #UE1 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      #UE2 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      #Send BO for UE1
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="2" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="4" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind ueId="0" numLchTb1="4" lchTb1Data="1:2:3:4" />
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE1 
         <tapa.rgu.ddatreq ueId="0" numLchTb1="4" lchTb1Data="1,0,1:2,0,1:3,0,1:4,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expect>
     <tapa.tfu.recp.req spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind>
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      #Send BO for UE2
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="2" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="3" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="4" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind ueId="1" numLchTb1="4" lchTb1Data="1:2:3:4" />
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="4" lchTb1Data="1,0,1:2,0,1:3,0,1:4,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="2"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="3"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req ueId="0"/>
        <tapa.tfu.pdsch.dat.req ueId="1" use="3" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expect>
     <tapa.tfu.recp.req spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind>
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.6
#
#       Desc:    Verify that in a multiple UE Scenario, the UEs shall be
#       scheduled in RR fashion based on Long BSR 
#
#       Notes:   None
#              
#       Module:  RR SCH
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.6">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that in a multiple UE Scenario, the UEs shall be 
            scheduled in RR fashion based on Long BSR"
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>
      #Initialize UE
      <tapa.rg.2UeRrInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      #UE1 Configuration
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      #UE2 Configuration
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req>
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="4"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat ueId="0" use="3" addLongBsr="TRUE" 
            bsr0="4" bsr1="0" bsr2="0" bsr3="0"/>
          <tapa.tfu.dat ueId="1" use="4" addLongBsr="TRUE"
            bsr0="9" bsr1="0" bsr2="0" bsr3="0"/>
       </tapa.tfu.dat.ind>
      </tapa.send>


      # Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="5" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req>
        <tapa.tfu.pusch.recp.req ueId="0" use="5" vldtDatRecp="TRUE" saveTo="7"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="6" vldtDatRecp="TRUE" saveTo="8"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH for BSR
      <tapa.expect>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send Data Indication using TB size recieved in the BSR grant
      <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat ueId="0" use="7" lcId="1"/>
          <tapa.tfu.dat ueId="1" use="8" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expset>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="1,1" vldtBuf="TRUE"/>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.7
#
#       Desc:    Verify that RR schedules a single UE with TA 
#
#       Notes:   None
#              
#       Module:  RR SCH 
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.7">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that RR schedules a single UE with TA" 
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
   
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>

      # UE configuration
      <tapa.rg.UeInit taTmrPres="TRUE" taTmr="30"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

     <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="5" dir="3"
            lcgId="0" ulQci="4" dlQci="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm status="0"/>
      </tapa.expect>

     <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="5" dir="3"
            lcgId="0" ulQci="4" dlQci="4" instId="5"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the configuration applied. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm status="0" instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send TA for UE
          <tapa.tfu.timingadv.ind>
             <tapa.tfu.timingadv ueId="0" timingAdv="3"  />
          </tapa.tfu.timingadv.ind>
      </tapa.send>

      <tapa.send>
         # Send 2 Ttis, one to schedule the TA and one to transmit the TA
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>


      <tapa.expset>
         # Expect datReq with TA
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req ueId="0" chkTa="TRUE" taVal="3"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req />
        </tapa.tfu.cntrl.req>
      </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

      # Layer Manager ShutDown

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.8
#
#       Desc:    Verify that RR schedules a single Contention Resolution UE. 
#
#       Notes:   None
#              
#       Module:  RR SCH
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.8">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that RR schedules a single Contention Resolution UE."
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>
      #Initialize UE
      <tapa.rg.2UeRrInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      #UE1 Configuration
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      #UE2 Configuration
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req>
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="4"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat ueId="0" use="3" lcId="1"/>
          <tapa.tfu.dat ueId="1" use="4" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expset>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="1,1" vldtBuf="TRUE"/>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq  numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      # Expect RaResp for the rapId sent in RaReq
      <tapa.expset>
        <tapa.tfu.dat.req>
           <tapa.tfu.rarsp.req />
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="6" TTI="100"/>
      </tapa.send>

      <tapa.expect>
         <tapa.tfu.recp.req spId="1" >
            <tapa.tfu.msg3.recp.req validate="FALSE"/>
         </tapa.tfu.recp.req>
      </tapa.expect>
   
   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send CRC for Msg3
   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="2" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect HARQ ACK in PHICH For MSG3
   <tapa.expect>
      <tapa.tfu.cntrl.req spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

   # Send Message3 after receiving Message3 reception req.
   <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat sduSize="20" crnti="0" ueId="2" addCrnti="TRUE"/>
       </tapa.tfu.dat.ind>      
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
          <tapa.rgr.uestaind/>
      </tapa.expect>


      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req>
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="2"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat ueId="0" use="2" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.9
#
#       Desc:    Verify that in a multiple UE Scenario, the UEs shall be
#       scheduled in RR fashion based on Short BSR 
#
#       Notes:   None
#              
#       Module:  RR SCH
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.9">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that in a multiple UE Scenario, the UEs shall be 
            scheduled in RR fashion based on Short BSR"
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>
      #Initialize UE
      <tapa.rg.2UeRrInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      #UE1 Configuration
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      #UE2 Configuration
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req>
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="4"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat ueId="0" use="3" lcId="1"/>
          <tapa.tfu.dat ueId="1" use="4" addShortBsr="TRUE" bsr="9" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expset>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="1,1" vldtBuf="TRUE"/>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expset>

      # Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req>
        <tapa.tfu.pusch.recp.req ueId="1" use="6" vldtDatRecp="TRUE" saveTo="8"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH for BSR
      <tapa.expect>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send Data Indication using TB size recieved in the BSR grant
      <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat ueId="1" use="8" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.10
#
#       Desc:    Verify that in a multiple UE Scenario, the UEs shall be
#       scheduled in RR fashion based on Trunc BSR 
#
#       Notes:   None
#              
#       Module:  RR SCH
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.10">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that in a multiple UE Scenario, the UEs shall be 
            scheduled in RR fashion based on Trunc BSR"
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>
      #Initialize UE
      <tapa.rg.2UeRrInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      #UE1 Configuration
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      #UE2 Configuration
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="1" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="0" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="1" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req>
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="4"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat ueId="0" use="3" lcId="1"/>
          <tapa.tfu.dat ueId="1" use="4" addTruncBsr="TRUE" bsr="9" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expset>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="1,1" vldtBuf="TRUE"/>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expset>

      # Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req>
        <tapa.tfu.pusch.recp.req ueId="1" use="6" vldtDatRecp="TRUE" saveTo="8"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH for BSR
      <tapa.expect>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send Data Indication using TB size recieved in the BSR grant
      <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat ueId="1" use="8" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    15.11
#
#       Desc:    Verify that RR does not schedule deleted LCs for the UE. 
#
#       Notes:   None
#              
#       Module:  "RR SCH"
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.11">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that RR does not schedule deleted LCs for the UE." 
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>

      # UE Creation
      <tapa.rg.UeInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="2" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="4" bo="64"/>
      </tapa.send>


      # Send LC Delete Request for the same LC created above at RGR.
      <tapa.send>
         <tapa.rgr.cfgreq.del instId="5"  DelType="3" cellId="3" 
                                       ueId="0" lcId="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send LC Delete Request for the same LC created above at RGR.
      <tapa.send>
         <tapa.rgr.cfgreq.del instId="5"  DelType="3" cellId="3" 
                                       ueId="0" lcId="2"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send LC Delete Request for the same LC created above at RGR.
      <tapa.send>
         <tapa.rgr.cfgreq.del instId="5"  DelType="3" cellId="3" 
                                       ueId="0" lcId="3"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send LC Delete Request for the same LC created above at RGR.
      <tapa.send>
         <tapa.rgr.cfgreq.del instId="5"  DelType="3" cellId="3" 
                                       ueId="0" lcId="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send LC Delete Request for the same LC created above at CRG. 
      <tapa.send>
         <tapa.crg.cfgreq.del  DelType="3" cellId="3" ueId="0" lcId="1" dir="3"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Send LC Delete Request for the same LC created above at CRG. 
      <tapa.send>
         <tapa.crg.cfgreq.del  DelType="3" cellId="3" ueId="0" lcId="2" dir="3"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Send LC Delete Request for the same LC created above at CRG. 
      <tapa.send>
         <tapa.crg.cfgreq.del  DelType="3" cellId="3" ueId="0" lcId="3" dir="3"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Send LC Delete Request for the same LC created above at CRG. 
      <tapa.send>
         <tapa.crg.cfgreq.del  DelType="3" cellId="3" ueId="0" lcId="4" dir="3"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    15.12
#
#       Desc:    Verify that RR does not schedule deleted UE. 
#
#       Notes:   None
#              
#       Module:  "RR SCH"
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.12">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that RR does not schedule deleted UE." 
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>

      # UE Creation
      <tapa.rg.UeInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="2" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="4" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="2" bo="0"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="4" bo="0"/>
      </tapa.send>

      # Send UE Delete Request for the same UE created above at CRG.
      <tapa.send>
         <tapa.crg.cfgreq.del  cellId="3" ueId="0" DelType="2"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Send UE Delete Request for the same UE created above at RGR.
      <tapa.send>
         <tapa.rgr.cfgreq.del instId="5"  cellId="3" ueId="0" DelType="2"/>
      </tapa.send>

      #Expect positive Configuration Confirm from Scheduler
      <tapa.expect>
         <tapa.rgr.cfgCfm/>
      </tapa.expect>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    15.13
#
#       Desc:    Verify that RR does not schedule deleted UE. 
#
#       Notes:   None
#              
#       Module:  RR SCH
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.13">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that RR does not schedule deleted UE."
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>
      #Initialize UE
      <tapa.rg.UeInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      #UE1 Configuration
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="0" instId="5"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req>
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat ueId="0" use="3" addShortBsr="TRUE" bsr="9" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expset>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expset>

      # Send UE Delete Request for the same UE created above at CRG.
      <tapa.send>
         <tapa.crg.cfgreq.del  cellId="3" ueId="0" DelType="2"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Send UE Delete Request for the same UE created above at RGR.
      <tapa.send>
         <tapa.rgr.cfgreq.del instId="5"  cellId="3" ueId="0" DelType="2"/>
      </tapa.send>

      #Expect positive Configuration Confirm from Scheduler
      <tapa.expect>
         <tapa.rgr.cfgCfm/>
      </tapa.expect>

      Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.14
#
#       Desc:    To test SI
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.14">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test SI"
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      # Modified for SI Enhancement*/
      <tapa.ifndef>
         <tapa.flag id="RGR_SI_SCH"/>
         <tapa.flag id="LTEMAC_HDFDD"/>
      </tapa.ifndef>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         # Send BO for BCCH-DLSCH logical channel on RGU.
         <tapa.rgu.cstarsp lcId="5" lcType="1" bo="32" 
            frameNum="0" subFrameNum="0"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
   
      <tapa.expect>
         # Expect staInd from MAC to RLC 
         <tapa.rgu.cstaind lcId="5" boSatisfied="TRUE" maxRb="3" saveTo="1"/>
      </tapa.expect>

      <tapa.send>
         # Send BCCH-DLSCH data to MAC on RGU. 
         <tapa.rgu.cdatreq bcchIdx="1" lcId="5" lcType="1" use="1"/>
         #<tapa.rgu.cdatreq lcId="5" lcType="1" use="1"/>
      </tapa.send>

      <tapa.send>
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req />
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req bcchIdx="1" vldtBcch="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req />
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req bcchIdx="1" vldtBcch="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.15
#
#       Desc:    To test SI
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.15">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test SI"
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef>
         <tapa.flag id="RGR_SI_SCH"/>
      </tapa.ifndef>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="11"/>
      </tapa.send>

      <tapa.send>
         # Send BO for BCCH-DLSCH logical channel on RGU.
         <tapa.rgu.cstarsp lcId="5" lcType="1" bo="32" 
            frameNum="0" subFrameNum="0" />
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.16
#
#       Desc:    To test SI
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.16">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test SI"
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      # Modified for SI Enhancement*/
      <tapa.ifndef>
         <tapa.flag id="RGR_SI_SCH"/>
         <tapa.flag id="LTEMAC_HDFDD"/>
      </tapa.ifndef>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         # Send BO for BCCH-DLSCH logical channel on RGU.
         <tapa.rgu.cstarsp lcId="2" lcType="1" bo="32" 
            frameNum="0" subFrameNum="5"/>
      </tapa.send>

      <tapa.send>
         # Send BO for BCCH-DLSCH logical channel on RGU.
         <tapa.rgu.cstarsp lcId="5" lcType="1" bo="32" 
            frameNum="0" subFrameNum="0"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC 
         <tapa.rgu.cstaind lcId="5" boSatisfied="TRUE" maxRb="3" saveTo="1"/>
      </tapa.expect>

      <tapa.send>
         # Send BCCH-DLSCH data to MAC on RGU. 
         <tapa.rgu.cdatreq bcchIdx="1" lcId="5" lcType="1" use="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
   

   # Separated TTI processing for DL and UL.
   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req />
     </tapa.tfu.cntrl.req>
      # Expect staInd from MAC to RLC 
     <tapa.rgu.cstaind lcId="2" boSatisfied="TRUE" maxRb="3" saveTo="2"/>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req bcchIdx="1" vldtBcch="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send BCCH-DLSCH data to MAC on RGU. 
         <tapa.rgu.cdatreq bcchIdx="2" lcId="2" lcType="1" use="2"/>
      </tapa.send>

      <tapa.send>
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req />
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req bcchIdx="2" vldtBcch="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req />
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req bcchIdx="1" vldtBcch="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.17
#
#       Desc:    Verify that RR does not schedule deleted UE. 
#
#       Notes:   None
#              
#       Module:  RR SCH
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.17">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that RR does not schedule deleted UE."
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>
      #Initialize UE
      <tapa.rg.UeInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      #UE1 Configuration
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="0" instId="5"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req>
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat ueId="0" use="3" addShortBsr="TRUE" bsr="0" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expset>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expset>

      # Send UE Delete Request for the same UE created above at CRG.
      <tapa.send>
         <tapa.crg.cfgreq.del  cellId="3" ueId="0" DelType="2"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Send UE Delete Request for the same UE created above at RGR.
      <tapa.send>
         <tapa.rgr.cfgreq.del instId="5"  cellId="3" ueId="0" DelType="2"/>
      </tapa.send>

      #Expect positive Configuration Confirm from Scheduler
      <tapa.expect>
         <tapa.rgr.cfgCfm/>
      </tapa.expect>

      Send a TTI to schedule BSR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.18
#
#       Desc:    Verify that RR schedules a single Contention Resolution UE. 
#
#       Notes:   None
#              
#       Module:  RR SCH
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.18">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that RR schedules a single Contention Resolution UE."
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>


      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2"/>
      #Initialize UE
      <tapa.rg.2UeRrInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      #UE1 Configuration
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      #UE2 Configuration
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req>
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="4"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat ueId="0" use="3" lcId="1"/>
          <tapa.tfu.dat ueId="1" use="4" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expset>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="1,1" vldtBuf="TRUE"/>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq  numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      # Expect RaResp for the rapId sent in RaReq
      <tapa.expset>
        <tapa.tfu.dat.req>
           <tapa.tfu.rarsp.req />
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>

      <tapa.expect>
         <tapa.tfu.recp.req spId="1" >
            <tapa.tfu.msg3.recp.req validate="FALSE"/>
         </tapa.tfu.recp.req>
      </tapa.expect>
   
   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send CRC for Msg3
   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="2" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect HARQ ACK in PHICH For MSG3
   <tapa.expect>
      <tapa.tfu.cntrl.req spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

   # Send Message3 after receiving Message3 reception req.
   <tapa.send>
       <tapa.tfu.dat.ind>
          <tapa.tfu.dat sduSize="20" crnti="0" ueId="2" addCrnti="TRUE"/>
       </tapa.tfu.dat.ind>      
   </tapa.send>

      # Send UE Delete Request for the same UE created above at CRG.
      <tapa.send>
         <tapa.crg.cfgreq.del  cellId="3" ueId="0" DelType="2"/>
      </tapa.send>

      <tapa.expect>
          <tapa.rgr.uestaind/>
      </tapa.expect>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Send UE Delete Request for the same UE created above at RGR.
      <tapa.send>
         <tapa.rgr.cfgreq.del instId="5"  cellId="3" ueId="0" DelType="2"/>
      </tapa.send>

      #Expect positive Configuration Confirm from Scheduler
      <tapa.expect>
         <tapa.rgr.cfgCfm/>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

# changed test case considering changed modPrd value
# Added for SI Enhancement*/
#
#
#       Test:    15.19
#
#       Desc:    To test SI Scheduling using SI Enhancement
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.19">

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test SI Scheduling using SI enhancement at RGR interface"
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef>
         <tapa.flag id="RGR_SI_SCH"/>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>
      <tapa.ifndef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="LTEMAC_HDFDD"/>
      </tapa.ifndef>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send lc="TRUE">
         <tapa.tfu.tti.ind numTti="620"/>
      </tapa.send>

      <tapa.send>
         # Send SI Configuration request for MIB
         <tapa.rgr.sicfgreq instId="5" bcchIdx="0" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_MIB" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send SI Configuration request for SIB1
         <tapa.rgr.sicfgreq instId="5" bcchIdx="5" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SIB1" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send SI Configuration request for SI1
         <tapa.rgr.sicfgreq instId="5" bcchIdx="4" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="1" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send SI Configuration request for SI2
         <tapa.rgr.sicfgreq instId="5" bcchIdx="3" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="2" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send SI Configuration request for SI3
         <tapa.rgr.sicfgreq instId="5" bcchIdx="2" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="3" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send SI Configuration request for SI4
         <tapa.rgr.sicfgreq instId="5" bcchIdx="1" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="4" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      #Do the cell reconfiguration
       <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" siWinSize="4"
          siRetxCnt="2" recfgType="2048" modPrd="64"/>
      </tapa.send>

       #SFN,SF is (62,0),giving TTI upto (62,3)
      <tapa.send lc="TRUE">
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expset>
        <tapa.rgr.cfgCfm instId="5" />
        <tapa.tfu.cntrl.req>
          <tapa.tfu.pdcch.cntrl.req />
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req>
          <tapa.tfu.pdsch.dat.req bcchIdx="5" vldtBcch="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

      #Modify the SI information
      <tapa.send>
         # Send SI Configuration request for SIB1
         <tapa.rgr.sicfgreq instId="5" bcchIdx="1" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SIB1" buffSz="32"/>
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send SI Configuration request for SI1
         <tapa.rgr.sicfgreq instId="5" bcchIdx="2" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="1" buffSz="37"/>
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>
      
      <tapa.send>
         # Send SI Configuration request for SI2
         <tapa.rgr.sicfgreq instId="5" bcchIdx="3" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="2" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send SI Configuration request for SI3
         <tapa.rgr.sicfgreq instId="5" bcchIdx="4" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="3" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send SI Configuration request for SI4
         <tapa.rgr.sicfgreq instId="5" bcchIdx="5" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="4" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

       #SFN,SF is (62,4), giving TTI upto (63,8)
      <tapa.send lc="TRUE">
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="15"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req>
          <tapa.tfu.pdcch.cntrl.req />
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req>
          <tapa.tfu.bch.dat.req />
          <tapa.tfu.pdsch.dat.req bcchIdx="2" vldtBcch="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>
   
      #SFN,SF is (63,9), giving TTI upto (64,0)
      <tapa.send lc="TRUE">
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expset>
        <tapa.tfu.cntrl.req>
          <tapa.tfu.pdcch.cntrl.req />
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req>
          <tapa.tfu.pdsch.dat.req bcchIdx="2" vldtBcch="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>


       #SFN,SF is (64,0), giving TTI upto (64,2)
      <tapa.send lc="TRUE">
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      
      <tapa.expset>
        <tapa.tfu.cntrl.req>
          <tapa.tfu.pdcch.cntrl.req />
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req>
          <tapa.tfu.pdsch.dat.req bcchIdx="3" vldtBcch="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

       #SFN,SF is (64,3), giving TTI upto (64,3)
      <tapa.send lc="TRUE">
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expset>
        <tapa.tfu.cntrl.req>
          <tapa.tfu.pdcch.cntrl.req />
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req>
          <tapa.tfu.pdsch.dat.req bcchIdx="1" vldtBcch="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

       #SFN,SF is (64,4), giving TTI upto (64,4)
      <tapa.send lc="TRUE">
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expset>
        <tapa.tfu.cntrl.req>
          <tapa.tfu.pdcch.cntrl.req />
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req>
          <tapa.tfu.pdsch.dat.req bcchIdx="3" vldtBcch="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

       #SFN,SF is (64,5) giving TTU upto (64,6)
      <tapa.send lc="TRUE">
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req>
         # ccpu00117423 - MOD - Added iMcs Validation
         <tapa.tfu.pdcch.cntrl.req vldImcs="TRUE" iMcs="10" />
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req>
          <tapa.tfu.pdsch.dat.req bcchIdx="4" vldtBcch="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

       #SFN,SF is (64,7) giving TTI upto (64,7)
      <tapa.send lc="TRUE">
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req>
         # ccpu00117423 - MOD - Added iMcs Validation
          <tapa.tfu.pdcch.cntrl.req vldImcs="TRUE" iMcs="10" />
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req>
          <tapa.tfu.pdsch.dat.req bcchIdx="4" vldtBcch="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

       #SFN,SF is (64,8) giving TTI upto (65,0)
      <tapa.send lc="TRUE">
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req>
         # ccpu00117423 - MOD - Added iMcs Validation
          <tapa.tfu.pdcch.cntrl.req vldImcs="TRUE" iMcs="11" />
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req>
          <tapa.tfu.pdsch.dat.req bcchIdx="5" vldtBcch="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

       #SFN,SF is (65,1) giving TTI upto (65,1)
      <tapa.send lc="TRUE">
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req>
         # ccpu00117423 - MOD - Added iMcs Validation
          <tapa.tfu.pdcch.cntrl.req vldImcs="TRUE" iMcs="11" />
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req>
          <tapa.tfu.pdsch.dat.req bcchIdx="5" vldtBcch="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

       #SFN,SF is (65,2) giving TTI upto (66,3)
      <tapa.send lc="TRUE">
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="12"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req>
          <tapa.tfu.pdcch.cntrl.req />
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req>
          <tapa.tfu.pdsch.dat.req bcchIdx="1" vldtBcch="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit.grp16/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

# Added for SI Enhancement*/
#
#
#       Test:    15.20
#
#       Desc:    To test SI Parameters Configuration
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.20">

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test SI Parameters Configuration in SI Cfg Req and Cell Cfg Req. Negative Scenearios test case."
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef>
         <tapa.flag id="RGR_SI_SCH"/>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>
      <tapa.ifndef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifndef>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Verify SI Configuration request for invalid CFG Type 
      <tapa.send>
         <tapa.rgr.sicfgreq instId="5" bcchIdx="0" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_INV" />
      </tapa.send>

      # Expect SI Cfg Cfm from MAC 
      <tapa.expect>
         <tapa.rgr.sicfgcfm status="0" instId="5"/>
      </tapa.expect>

      # Verify Cell Configuration request for invalid ReTxCnt 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.cell instId="5" siWinSize="4"
          siRetxCnt="5" />
      </tapa.send>

      <tapa.expect>
        <tapa.rgr.cfgCfm instId="5" status="15"/>
      </tapa.expect>

      # Verify SI Configuration request for invalid SI Id
      <tapa.send>
         <tapa.rgr.sicfgreq instId="5" bcchIdx="4" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="5" buffSz="47"/>
      </tapa.send>

      <tapa.expect>
      # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm status="15" instId="5"/>
      </tapa.expect>

      # Verify Cell Configuration request for invalid SI1 peridocity
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.cell instId="5" siWinSize="4"
          siRetxCnt="3" si1Prd="50"/>
      </tapa.send>

      <tapa.expect>
        <tapa.rgr.cfgCfm instId="5" status="15"/>
      </tapa.expect>

      #Verify SI-Reconfiguration scenario with a change in numSi value
      #Configure a valid SIs
      <tapa.send>
         # Send SI Configuration request for SI1
         <tapa.rgr.sicfgreq instId="5" bcchIdx="2" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="1" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send SI Configuration request for SI2
         <tapa.rgr.sicfgreq instId="5" bcchIdx="3" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="2" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send SI Configuration request for SI3
         <tapa.rgr.sicfgreq instId="5" bcchIdx="4" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="3" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send SI Configuration request for SI4
         <tapa.rgr.sicfgreq instId="5" bcchIdx="5" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="4" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

       #SFN,SF is (0,0),giving TTI upto (0,4)
      <tapa.send lc="TRUE">
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Do the cell reconfiguration
       <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" numSi="3"
           recfgType="2048" />
      </tapa.send>
 <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req />
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="1">
            <tapa.tfu.pdsch.dat.req />
         </tapa.tfu.dat.req>
      </tapa.expset>


       #SFN,SF is (0,5)
      <tapa.send lc="TRUE">
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expect>
     <tapa.rgr.cfgCfm instId="5" />
   </tapa.expect>

      #Re-Configure a valid SIs,with numSi set to 3
      <tapa.send>
         # Send SI Configuration request for SI1
         <tapa.rgr.sicfgreq instId="5" bcchIdx="2" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="1" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send SI Configuration request for SI2
         <tapa.rgr.sicfgreq instId="5" bcchIdx="3" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="2" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send SI Configuration request for SI3
         <tapa.rgr.sicfgreq instId="5" bcchIdx="4" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="3" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC 
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>


   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit.grp16/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    15.21
#
#       Desc:    To validate RR scheduling 
#
#       Notes:   None
#              
#       Module:  uplink.datapath
#
#       File:    rgac_tc5.xml
#
#
<tapa.testcase id="15.21">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="uplink.datapath"/>

      <tapa.desc>
         "To validate RR scheduling with two UEs"
      </tapa.desc>

      <tapa.longdesc>
         "Configure two UEs. Send the BSR for both UEs (with high BSR index value such as 20-25)
          in SF N so that all the grant to one UE cannot be accommodated in one TTI. 
          Verify if only UE1 is scheduled the complete bandwidth in SF N+1. Then in SF N+2 
          UE2 is being getting scheduled, followed by UE1 getting scheduled 
          at N+3 and UE2 at N+4. And so on"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgInitErr/>
      <tapa.rg.dbgInitParm/>
      <tapa.rg.dbgInitInfo/>
      #Initialize CELL (configure min bandwidth)
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2" numSubbands="2" ulTotalBw="25"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0" maxUlHqTx="4"/>
      <tapa.rg.UeInit ueId="1" maxUlHqTx="4"/>
      #Intialize 2 bi-directional DCCHs

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 

      # Configure bi-directional DTCH for default UE1 (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8" ueId="0"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure bi-directional DTCH for default UE2 (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8" ueId="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure bi-directional DTCH for default UE1 (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8"  instId="5" ueId="0"/>
      </tapa.send>

      # Configure UL LCG on RGR on UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5" ueId="0"/>
      </tapa.send>
      
      # Configure bi-directional DTCH for default UE2 (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8"  instId="5" ueId="1"/>
      </tapa.send>

      # Configure UL LCG on RGR on UE2
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5" ueId="1"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" 
            vldtTx="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" 
            vldtTx="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="4"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
     
      #Send CRC for Msg for UE 1
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
      
      #Send CRC for Msg for UE 2
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send data indication using TB size recieved in the grant
    <tapa.send>
       <tapa.tfu.dat.ind datInds="2">
          <tapa.tfu.dat ueId="0" use="3" lcId="3" addShortBsr="TRUE" bsr="45"/>
          <tapa.tfu.dat ueId="1" use="4" lcId="3" addShortBsr="TRUE" bsr="45"/>
       </tapa.tfu.dat.ind>
    </tapa.send>

      # Expect a DatInd at RLC
      <tapa.expset>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="3,1"/>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="3,1"/>
      </tapa.expset>

       # Send a TTI to schedule the BSR sent
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="2" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="3" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expect>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="4" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="5" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
      
      # Send a TTI to schedule the BSR sent
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="6" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="7" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expect>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="1" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="2" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      # Expect data reception request
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="10" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="11" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
        </tapa.tfu.cntrl.req>
        <tapa.tfu.recp.req numRntis="2">
          <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" ueId="0"/>
          <tapa.tfu.pusch.recp.req use="3" vldtDatRecp="TRUE" ueId="1"/>
        </tapa.tfu.recp.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect data reception request
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="11" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="12" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
        <tapa.tfu.recp.req numRntis="2">
          <tapa.tfu.pusch.recp.req use="4" vldtDatRecp="TRUE" ueId="0"/>
          <tapa.tfu.pusch.recp.req use="5" vldtDatRecp="TRUE" ueId="1"/>
        </tapa.tfu.recp.req>
      </tapa.expset>
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect data reception request
      <tapa.expset>
      <tapa.tfu.recp.req numRntis="2">
          <tapa.tfu.pusch.recp.req use="6" vldtDatRecp="TRUE" ueId="0"/>
          <tapa.tfu.pusch.recp.req use="7" vldtDatRecp="TRUE" ueId="1"/>
       </tapa.tfu.recp.req>        
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="13" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="14" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect data reception request
      <tapa.expset>
      <tapa.tfu.recp.req numRntis="2">
          <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" ueId="0"/>
          <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" ueId="1"/>
       </tapa.tfu.recp.req>        
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="15" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="16" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit.grp16/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.22
#
#       Desc:    To validate RR scheduling 
#
#       Notes:   None
#              
#       Module:  uplink.datapath
#
#       File:    rgac_tc5.xml
#
#
<tapa.testcase id="15.22">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="uplink.datapath"/>

      <tapa.desc>
         "To validate RR scheduling with three UEs"
      </tapa.desc>

      <tapa.longdesc>
         "Configure three UEs. Send the BSR for all three UEs (with high BSR index value such as 36)
          in SF N so that all the grant to one UE cannot be accommodated in one TTI. 
          Verify if only UE1 is scheduled the complete bandwidth in SF N+1. Then in SF N+2 
          UE2 is being getting scheduled, then in SF N+3 UE3 is being getting scheduled,
          followed by UE1 getting scheduled at N+4 and UE2 at N+5. And so on"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgInitErr/>
      <tapa.rg.dbgInitParm/>
      <tapa.rg.dbgInitInfo/>
      #Initialize CELL (configure min bandwidth)
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2" numSubbands="3" ulTotalBw="25" maxUlUeNewTxPerTti="3"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0" maxUlHqTx="4"/>
      <tapa.rg.UeInit ueId="1" maxUlHqTx="4"/>
      <tapa.rg.UeInit ueId="2" maxUlHqTx="4"/>
      #Intialize 2 bi-directional DCCHs

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 

      # Configure bi-directional DTCH for default UE1 (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8" ueId="0"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure bi-directional DTCH for default UE2 (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8" ueId="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure bi-directional DTCH for default UE2 (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8" ueId="2"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure bi-directional DTCH for default UE1 (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8"  instId="5" ueId="0"/>
      </tapa.send>

      # Configure UL LCG on RGR on UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5" ueId="0"/>
      </tapa.send>
      
      # Configure bi-directional DTCH for default UE2 (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8"  instId="5" ueId="1"/>
      </tapa.send>

      # Configure UL LCG on RGR on UE2
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5" ueId="1"/>
      </tapa.send>
      
      # Configure bi-directional DTCH for default UE3 (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8"  instId="5" ueId="2"/>
      </tapa.send>

      # Configure UL LCG on RGR on UE3
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5" ueId="2"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
           <tapa.tfu.sr ueId="2"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" 
            vldtTx="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" 
              vldtTx="TRUE" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req saveTo="3" isUlGrant="TRUE" vldtGrant="TRUE" 
              vldtTx="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
     </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="3">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="4"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="5"/>
        <tapa.tfu.pusch.recp.req ueId="2" use="3" vldtDatRecp="TRUE" saveTo="6"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
     
      #Send CRC for Msg for UE 1
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
      
      #Send CRC for Msg for UE 2
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
      
      #Send CRC for Msg for UE 3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="2" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="2" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send data indication using TB size recieved in the grant
    <tapa.send>
       <tapa.tfu.dat.ind datInds="3">
          <tapa.tfu.dat ueId="0" use="4" lcId="3" addShortBsr="TRUE" bsr="36"/>
          <tapa.tfu.dat ueId="1" use="5" lcId="3" addShortBsr="TRUE" bsr="36"/>
          <tapa.tfu.dat ueId="2" use="6" lcId="3" addShortBsr="TRUE" bsr="36"/>
       </tapa.tfu.dat.ind>
    </tapa.send>

      # Expect a DatInd at RLC
      <tapa.expset>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="3,1"/>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="3,1"/>
         <tapa.rgu.ddatind ueId="2" lchTb1Data="3,1"/>
      </tapa.expset>

       # Send a TTI to schedule the BSR sent
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="2" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="3" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="4" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expect>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="5" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="6" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="7" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
      
      # Send a TTI to schedule the BSR sent
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="0" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="1" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="2" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expect>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="5" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="6" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="7" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect data reception request
      <tapa.expset>
      <tapa.tfu.recp.req numRntis="3">
          <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" ueId="0"/>
          <tapa.tfu.pusch.recp.req use="3" vldtDatRecp="TRUE" ueId="1"/>
          <tapa.tfu.pusch.recp.req use="4" vldtDatRecp="TRUE" ueId="2"/>
       </tapa.tfu.recp.req>        
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="2" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="3" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="4" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect data reception request
      <tapa.expset>
      <tapa.tfu.recp.req numRntis="3">
          <tapa.tfu.pusch.recp.req use="5" vldtDatRecp="TRUE" ueId="0"/>
          <tapa.tfu.pusch.recp.req use="6" vldtDatRecp="TRUE" ueId="1"/>
          <tapa.tfu.pusch.recp.req use="7" vldtDatRecp="TRUE" ueId="2"/>
       </tapa.tfu.recp.req>        
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="2" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="3" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="4" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect data reception request
      <tapa.expset>
      <tapa.tfu.recp.req numRntis="3">
          <tapa.tfu.pusch.recp.req use="0" vldtDatRecp="TRUE" ueId="0"/>
          <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" ueId="1"/>
          <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" ueId="2"/>
       </tapa.tfu.recp.req>        
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="0" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="1" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="2" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect data reception request
      <tapa.expset>
      <tapa.tfu.recp.req numRntis="3">
          <tapa.tfu.pusch.recp.req use="5" vldtDatRecp="TRUE" ueId="0"/>
          <tapa.tfu.pusch.recp.req use="6" vldtDatRecp="TRUE" ueId="1"/>
          <tapa.tfu.pusch.recp.req use="7" vldtDatRecp="TRUE" ueId="2"/>
       </tapa.tfu.recp.req>        
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="2" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="3" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="4" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit.grp16/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.23
#
#       Desc:    To validate RR scheduling 
#
#       Notes:   None
#              
#       Module:  uplink.datapath
#
#       File:    rgac_tc5.xml
#
#
<tapa.testcase id="15.23">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="uplink.datapath"/>

      <tapa.desc>
         "To validate RR scheduling with two UEs"
      </tapa.desc>

      <tapa.longdesc>
         "Configure two UEs. Send the BSR for both UEs (with a value of BSR index value 
          such as grant can be satisfied in one SF for both UEs) in SF N so that all the 
          grant for both UEs can be accommodated in one TTI. Verify that both UE1 and UE2 
          are scheduled in SF N+1. Then in SF N+2 verify that again both UEs are getting 
          scheduled. And so on for 3-4 TTIs"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgInitErr/>
      <tapa.rg.dbgInitParm/>
      <tapa.rg.dbgInitInfo/>
      #Initialize CELL (configure min bandwidth)
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2" numSubbands="4"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0" maxUlHqTx="4"/>
      <tapa.rg.UeInit ueId="1" maxUlHqTx="4"/>
      #Intialize 2 bi-directional DCCHs

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 

      # Configure bi-directional DTCH for default UE1 (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8" ueId="0"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure bi-directional DTCH for default UE2 (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8" ueId="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure bi-directional DTCH for default UE1 (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8"  instId="5" ueId="0"/>
      </tapa.send>

      # Configure UL LCG on RGR on UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5" ueId="0"/>
      </tapa.send>
      
      # Configure bi-directional DTCH for default UE2 (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8"  instId="5" ueId="1"/>
      </tapa.send>

      # Configure UL LCG on RGR on UE2
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5" ueId="1"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" 
            vldtTx="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" 
            vldtTx="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
     
      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="4"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
     
      #Send CRC for Msg for UE 1
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
      
      #Send CRC for Msg for UE 2
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send data indication using TB size recieved in the grant
    <tapa.send>
       <tapa.tfu.dat.ind datInds="2">
          <tapa.tfu.dat ueId="0" use="3" lcId="3" addShortBsr="TRUE" bsr="38"/>
          <tapa.tfu.dat ueId="1" use="4" lcId="3" addShortBsr="TRUE" bsr="38"/>
       </tapa.tfu.dat.ind>
    </tapa.send>

      # Expect a DatInd at RLC
      <tapa.expset>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="3,1"/>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="3,1"/>
      </tapa.expset>

       # Send a TTI to schedule the BSR sent
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="2" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="3" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expset>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="4" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="5" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expset>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="6" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="7" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
    
      # Send a TTI to schedule the BSR sent
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expset>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="8" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="9" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
     </tapa.expset>

      # Send a TTI to schedule the BSR sent
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
    
      # Expect data reception request
      <tapa.expset>
      <tapa.tfu.recp.req numRntis="2">
          <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" ueId="0"/>
          <tapa.tfu.pusch.recp.req use="3" vldtDatRecp="TRUE" ueId="1"/>
       </tapa.tfu.recp.req>        
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="10" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="11" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
    
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect data reception request
      <tapa.expset>
      <tapa.tfu.recp.req numRntis="2">
          <tapa.tfu.pusch.recp.req use="4" vldtDatRecp="TRUE" ueId="0"/>
          <tapa.tfu.pusch.recp.req use="5" vldtDatRecp="TRUE" ueId="1"/>
       </tapa.tfu.recp.req>        
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="10" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="12" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect data reception request
      <tapa.expset>
      <tapa.tfu.recp.req numRntis="2">
          <tapa.tfu.pusch.recp.req use="6" vldtDatRecp="TRUE" ueId="0"/>
          <tapa.tfu.pusch.recp.req use="7" vldtDatRecp="TRUE" ueId="1"/>
       </tapa.tfu.recp.req>        
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="10" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="13" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
  
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit.grp16/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    15.24
#
#       Desc:    To validate RR scheduling 
#
#       Notes:   None
#              
#       Module:  uplink.datapath
#
#       File:    rgac_tc5.xml
#
#
<tapa.testcase id="15.24">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="uplink.datapath"/>

      <tapa.desc>
         "To validate RR scheduling with three UEs"
      </tapa.desc>

      <tapa.longdesc>
         "Configure three UEs, Send the BSR for two UEs such that the grant for 
          them can be satisfied in one SF and BSR for 3rd UE such that it can't 
          be satisfied in one SF. Verify that in SF N+1 UE1 and UE2 are being given 
          the UL grant, and then in SF N+2 UE3 is being given the grant (completely). 
          Following by UE1 and UE2 again being given the grant in SF N+3 and then UE3 in N+4"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgInitErr/>
      <tapa.rg.dbgInitParm/>
      <tapa.rg.dbgInitInfo/>
      #Initialize CELL (configure min bandwidth)
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2" numSubbands="3" maxUlUeNewTxPerTti="3" ulTotalBw="25"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0" maxUlHqTx="4"/>
      <tapa.rg.UeInit ueId="1" maxUlHqTx="4"/>
      <tapa.rg.UeInit ueId="2" maxUlHqTx="4"/>
      #Intialize 2 bi-directional DCCHs

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 

      # Configure bi-directional DTCH for default UE1 (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8" ueId="0"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure bi-directional DTCH for default UE2 (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8" ueId="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Configure bi-directional DTCH for default UE2 (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8" ueId="2"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure bi-directional DTCH for default UE1 (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8"  instId="5" ueId="0"/>
      </tapa.send>

      # Configure UL LCG on RGR on UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5" ueId="0"/>
      </tapa.send>
      
      # Configure bi-directional DTCH for default UE2 (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8"  instId="5" ueId="1"/>
      </tapa.send>

      # Configure UL LCG on RGR on UE2
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5" ueId="1"/>
      </tapa.send>
      
      # Configure bi-directional DTCH for default UE3 (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8"  instId="5" ueId="2"/>
      </tapa.send>

      # Configure UL LCG on RGR on UE3
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5" ueId="2"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
           <tapa.tfu.sr ueId="2"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send a TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" 
            vldtTx="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" 
              vldtTx="TRUE" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req saveTo="3" isUlGrant="TRUE" vldtGrant="TRUE" 
              vldtTx="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
     </tapa.expset>
    
      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="3">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="4"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="5"/>
        <tapa.tfu.pusch.recp.req ueId="2" use="3" vldtDatRecp="TRUE" saveTo="6"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
     
      #Send CRC for Msg for UE 1
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
      
      #Send CRC for Msg for UE 2
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
      
      #Send CRC for Msg for UE 3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="2" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="2" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
     
      # Send data indication using TB size recieved in the grant
    <tapa.send>
       <tapa.tfu.dat.ind datInds="3">
          <tapa.tfu.dat ueId="0" use="4" lcId="3" addShortBsr="TRUE" bsr="23"/>
          <tapa.tfu.dat ueId="1" use="5" lcId="3" addShortBsr="TRUE" bsr="25"/>
          <tapa.tfu.dat ueId="2" use="6" lcId="3" addShortBsr="TRUE" bsr="36"/>
       </tapa.tfu.dat.ind>
    </tapa.send>

      # Expect a DatInd at RLC
      <tapa.expset>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="3,1"/>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="3,1"/>
         <tapa.rgu.ddatind ueId="2" lchTb1Data="3,1"/>
      </tapa.expset>

       # Send a TTI to schedule the BSR sent
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="0" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="1" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="2" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expect>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="3" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="4" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="5" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
     
      # Send a TTI to schedule the BSR sent
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1" TTI="200"/>
      </tapa.send>

      <tapa.expect>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="6" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="7" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expect>
      # Expect DCI format 0 and do basic validations of the grant
      # Grant should be near to minimum expected grant 
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="8" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect data reception request
      <tapa.expset>
      <tapa.tfu.recp.req numRntis="2">
          <tapa.tfu.pusch.recp.req use="0" vldtDatRecp="TRUE" ueId="0"/>
          <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" ueId="1"/>
       </tapa.tfu.recp.req>        
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="9" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect data reception request
      <tapa.expset>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" ueId="2"/>
       </tapa.tfu.recp.req>        
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req vldtTx="TRUE" saveTo="10" minGrantBits="152"
             vldtGrant="TRUE" isUlGrant="TRUE" ueId="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit.grp16/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    15.25
#
#       Desc:   "To verify if the retransmission allocation if failing for
#                  particular HARQ process continously the release the HARQ 
#                  process and removed the node from the retransmission list"
#
#       Notes:   None
#
#       Module:  "PFS"
#
#       File:    rgac_tc14.xml
#
#
<tapa.testcase id="15.25">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
      "To verify if the retransmission allocation if failing for
      particular HARQ process continously the release the HARQ 
      process and removed the node from the retransmission list"
      </tapa.desc>

      <tapa.longdesc>
      "To verify if the retransmission allocation if failing for
      particular HARQ process continously the release the HARQ 
      process and removed the node from the retransmission list"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="15" maxDlBwPerUe="10" maxDlRetxBw="10"
         dlSchdType="2" raWinSize="5"/>

      # UEs Creation
      <tapa.rg.UeInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         # Configure a GBR DTCH at MAC (not scheduler) for UE 0
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0"
            dir="3" lcType="4"/>
      </tapa.send>

            # Configure GBR DTCH (RGR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            dlQci="1" instId="5"/>
      </tapa.send>

            # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect the successful confirms
      <tapa.expset>
         <tapa.crg.cfgcfm/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Set good CQIs intially (later we worsen it so that
      # the two retx procs cannot go toghether)
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" cqiIdx="12"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send BOs. Note that BOs should be sent such
      # that they are completely satisfied without
      # leaving a lot of buffer in the bandwidth.
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="3" bo="500"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect staInd from MAC to RLC for both DCCH and DTCH
      <tapa.expset>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="3"/>
      </tapa.expset>

      <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="3" ueId="0" lcId="3"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA(3) - TFU_DELTA(2) Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="1">
            <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="3" validate="TRUE"/>
         </tapa.tfu.dat.req>
      </tapa.expset>

      # Send 4 TTIs to get the harqrecpRequest from MAC
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req numRntis="1" spId="1">
            <tapa.tfu.hq.recp.req ueId="0"/>
         </tapa.tfu.recp.req>
      </tapa.expset>

      <tapa.send>
         # Send a 2 TTIs (TFU_DELTA) + 1 TTI (TFU_UL_DELTA) before
         # sending the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      # NACK both the transmissions
      <tapa.send>
         <tapa.tfu.hq.ind hqInds="1">
            <tapa.tfu.hq ueId="0" isAck="FALSE"/>
         </tapa.tfu.hq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="10" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="1" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>


      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="10" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="2" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="1" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="3" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="2" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="4" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="3" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>


      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="5" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="4" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="6" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="5" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
 
       <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="7" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="6" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
 
        <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="8" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="7" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
           
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="9" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="8" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
            <tapa.tfu.rareq raRnti="10" numRapId="1" rapIds="1" timingAdvs="3"
               tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req/>
        <tapa.tfu.cntrl.req/>
      </tapa.expset>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#rg002.301 ccpu00109543 MOD
#
#
#       Test:    15.26
#
#       Desc:    To verify successful UE reset for UEs pending with
#       transmissions or re-transmissions through 2 UE scenario.
#
#       Notes:   None
#              
#       Module:  "RR Module"
#
#       File:    rgac_tc13.xml
#
#
<tapa.testcase id="15.26">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify successful UE reset for UEs pending with transmissions or
         re-transmissions through 2 UE scenario.
      </tapa.desc>

      <tapa.longdesc>
         To verify successful UE reset for UEs pending with transmissions or
         re-transmissions through 2 UE scenario.
      </tapa.longdesc>

   </tapa.doc>
   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="50" dlSchdType="2" maxDlBwPerUe="25" 
         maxDlRetxBw="25" ulSchdType="2"/>

      # UE Creation with periodic mode 1-0
      <tapa.rg.UeInit ueId="0" ueCatEnum="1" 
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"
         dlAmbr="15000"/>
      <tapa.rg.UeInit ueId="1" ueCatEnum="1"
         prdModeEnumPres="TRUE" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.send>
         # Configure a dedicated logical channel (DCCH) for the UE1  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure a dedicated logical channel (DTCH) for the UE1  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      <tapa.send>
         # Configure an non-ambr dedicated logical channel (DTCH) for the UE2
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DCCH on RGR for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>
      
      # Configure a GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 3 for UE2
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" dir="1" lcType="4"
            dlQci="3" instId="5" />
      </tapa.send>
      
      # Configure a Non-GBR dedicated logical channel (DTCH) for the created UE with
      # QCI = 7 for UE1
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4"
            dlQci="7" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>
      
      <tapa.send>
         # Send BO for the DCCH on RGU for UE1 
         <tapa.rgu.dstarsp ueId="0" lcId="1" lcType="5" bo="800"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE1
         <tapa.rgu.dstarsp ueId="0" lcId="3" lcType="4" bo="580"/>
      </tapa.send>
      
      <tapa.send>
         # Send BO for the GBR DTCH on RGU for UE2
         <tapa.rgu.dstarsp ueId="1" lcId="3" lcType="4" bo="480"/>
      </tapa.send>
      
      # Send CQI indication for periodic mode 1-0 for UE1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="TRUE" cqiMode="0" cqiIdx="10"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      # Send CQI indication for periodic mode 1-0 for UE2
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="TRUE" cqiMode="0" cqiIdx="8"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      
      # Send UE Reset Request for the same UE created above at CRG.
      <tapa.send>
         <tapa.crg.cfgreq.UeReset   ueId="0"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Send UE Reset Request for the same UE created above at RGR.
      <tapa.send>
         <tapa.rgr.cfgreq.UeReset instId="5"  ueId="0"/>
      </tapa.send>
      
      #Expect positive Configuration Confirm from Scheduler
      <tapa.expect>
         <tapa.rgr.cfgCfm/>
      </tapa.expect>

      # Send TTI to Scheduler
      # Expect staInd for UE2
      <tapa.send>
        <tapa.tfu.tti.ind  />
      </tapa.send>
      

      <tapa.expect>
        # Now DTCH of UE2 shall get scheduled
        <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="3" />
      </tapa.expect>

      <tapa.send>
         # Send data for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="3,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send a TTI to get the PDCCH for UE2
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1"/>
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req ueId="1" use="1" saveTo="2" validate="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         # Send a 3 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="1" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
   
      # Send UE Reset Request for the same UE created above at CRG.
      <tapa.send>
         <tapa.crg.cfgreq.UeReset  ueId="1"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      # Send UE Reset Request for the same UE created above at RGR.
      <tapa.send>
         <tapa.rgr.cfgreq.UeReset instId="5"  ueId="1"/>
      </tapa.send>
      
      #Expect positive Configuration Confirm from Scheduler
      <tapa.expect>
         <tapa.rgr.cfgCfm/>
      </tapa.expect>

      # Send TTIs to Scheduler
      # No other pending data is expected
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>




#
#
#       Test:    15.27
#
#       Desc:    Verify that RR schedules a UE with TA and DL data in same TTI 
#
#       Notes:   None
#              
#       Module:  RR SCH 
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.27">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that RR schedules a UE with TA and DL data in same TTI" 
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
   
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit
         dlSchdType="2" ulSchdType="2" maxDlUeNewTxPerTti="1"/>

      # UE configuration
      <tapa.rg.UeInit taTmrPres="TRUE" taTmr="30"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

     <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="5" dir="3"
            lcgId="0" ulQci="4" dlQci="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm status="0"/>
      </tapa.expect>

     <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="5" dir="3"
            lcgId="0" ulQci="4" dlQci="4" instId="5"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the configuration applied. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm status="0" instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp lcId="9" lcType="5" bo="50"/>
      </tapa.send>

      <tapa.send>
         # Send TA for UE
          <tapa.tfu.timingadv.ind>
             <tapa.tfu.timingadv ueId="0" timingAdv="3"  />
          </tapa.tfu.timingadv.ind>
      </tapa.send>	  
	  
      <tapa.send>
         # Send a Tti to get the transmission scheduled, and to schedule the TA 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC  
         <tapa.rgu.dstaind lchTb1Data="9" saveTo="2"/>
      </tapa.expect>

      <tapa.send>
         # Send data with size equal to the allocated size on RGU. 
         <tapa.rgu.ddatreq ueId="0" lchTb1Data="9" lcType="5"/>
      </tapa.send>
	  
	  
      <tapa.send>
         # Send one TTI to transmit the TA
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>


      <tapa.expset>
         # Expect datReq with TA
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req ueId="0" chkTa="TRUE" taVal="3" use="9" lcId="9" chkSdu="TRUE"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" />
        </tapa.tfu.cntrl.req>
      </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

      # Layer Manager ShutDown

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    15.28
#
#       Desc:    Verify that non-CSG UEs are scheduled in the reported BO order 
#
#       Notes:   None
#              
#       Module:  "RR SCH"
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.28">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that UEs are scheduled in the reported BO order" 
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlSchdType="2" ulSchdType="2" 
       csgAccMode = "3"  minDlResNonCsg="10" minUlResNonCsg="10"/>

      # UE Creation
      <tapa.rg.2UeRrInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      #UE1 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      #UE2 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      #Send BO for UE1
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="2" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="4" bo="64"/>
      </tapa.send>

      #Send BO for UE2
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="2" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="3" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="4" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind ueId="0" numLchTb1="4" lchTb1Data="1:2:3:4" />
         <tapa.rgu.dstaind ueId="1" numLchTb1="4" lchTb1Data="1:2:3:4" />
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE1 
         <tapa.rgu.ddatreq ueId="0" numLchTb1="4" lchTb1Data="1,0,1:2,0,1:3,0,1:4,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DDatReq for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="4" lchTb1Data="1,0,1:2,0,1:3,0,1:4,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="1" use="2" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expect>
     <tapa.tfu.recp.req spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind>
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>



#
#
#       Test:    15.29
#
#       Desc:    Verify that CSG UEs are scheduled in the reported BO order 
#
#       Notes:   None
#              
#       Module:  "RR SCH"
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.29">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that UEs are scheduled in the reported BO order" 
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlSchdType="2" ulSchdType="2" 
       csgAccMode = "3"  minDlResNonCsg="10" minUlResNonCsg="10"/>

      # UE Creation
      <tapa.rg.2UeRrInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      #UE1 Configuration
      # at RGR
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         <tapa.rgr.cfgreq.recfg.ue  ueId="0" UeReCfgType="4194304" csgMmbrSta="1"/>
      </tapa.send>

      # Send TTI to apply the config
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      #UE2 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="2" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="4" lcgId="1" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="2" dir="1" lcType="5" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" dir="1" lcType="4" instId="5" />
      </tapa.send>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="4" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      #Send BO for UE1
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="2" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="3" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="4" bo="64"/>
      </tapa.send>

      #Send BO for UE2
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="2" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="3" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="4" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind ueId="0" numLchTb1="4" lchTb1Data="1:2:3:4" />
         <tapa.rgu.dstaind ueId="1" numLchTb1="4" lchTb1Data="1:2:3:4" />
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE1 
         <tapa.rgu.ddatreq ueId="0" numLchTb1="4" lchTb1Data="1,0,1:2,0,1:3,0,1:4,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DDatReq for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="4" lchTb1Data="1,0,1:2,0,1:3,0,1:4,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req>
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"/>
        <tapa.tfu.pdsch.dat.req ueId="1" use="2" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         # Send a 4 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expect>
     <tapa.tfu.recp.req spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expect>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind>
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>



#
#
#       Test:    15.30
#
#       Desc:    Verify that CSG-nonCSG UEs are scheduled in cyclic order 
#
#       Notes:   None
#              
#       Module:  "RR SCH"
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.30">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that UEs are scheduled in the reported BO order" 
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlSchdType="2" ulSchdType="2" 
         csgAccMode = "3"  minDlResNonCsg="30" minUlResNonCsg="30" maxUePerDlSf="4"/>

      # UE Creation
      <tapa.rg.4UeRrInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      #UE1 Configuration
      # at RGR
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      #UE2 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      <tapa.send>
         <tapa.rgr.cfgreq.recfg.ue  oldUeId="1" newUeId="1" UeReCfgType="4194304" csgMmbrSta="1"/>
      </tapa.send>

      # Send TTI to apply the config
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      #UE3 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="2" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      <tapa.send>
         <tapa.rgr.cfgreq.recfg.ue oldUeId="2"  newUeId="2" UeReCfgType="4194304" csgMmbrSta="1"/>
      </tapa.send>

      # Send TTI to apply the config
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      #UE4 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="3" lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="3" lcId="1" dir="1" lcType="5" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      <tapa.send>
         <tapa.rgr.cfgreq.recfg.ue  oldUeId="3" newUeId="3" UeReCfgType="4194304" csgMmbrSta="1"/>
      </tapa.send>

      # Send TTI to apply the config
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Configure DL LC on RGR
      #Send BO for UE1
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="64"/>
      </tapa.send>

      #Send BO for UE2
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="1" bo="64"/>
      </tapa.send>

      #Send BO for UE3
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="2" lcId="1" bo="64"/>
      </tapa.send>

      #Send BO for UE4
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="3" lcId="1" bo="64"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="1" />
         <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="1" />
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE1 
         <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DDatReq for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
        </tapa.tfu.cntrl.req>
        <tapa.rgu.dstaind ueId="2" numLchTb1="1" lchTb1Data="1" />
        <tapa.rgu.dstaind ueId="3" numLchTb1="1" lchTb1Data="1" />
        <tapa.tfu.dat.req>
           <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"/>
           <tapa.tfu.pdsch.dat.req ueId="1" use="2" validate="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE3
         <tapa.rgu.ddatreq ueId="2" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DDatReq for UE4
         <tapa.rgu.ddatreq ueId="3" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="3"/>
           <tapa.tfu.pdcch.cntrl.req ueId="3" saveTo="4"/>
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req>
           <tapa.tfu.pdsch.dat.req ueId="2" use="3" validate="TRUE"/>
           <tapa.tfu.pdsch.dat.req ueId="3" use="4" validate="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         # Send a 3 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      <tapa.expect>
         <tapa.tfu.recp.req spId="1">
            <tapa.tfu.hq.recp.req ueId="0"/>
            <tapa.tfu.hq.recp.req ueId="1"/>
         </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         # Send a 1 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
        <tapa.tfu.recp.req spId="1">
           <tapa.tfu.hq.recp.req ueId="2"/>
           <tapa.tfu.hq.recp.req ueId="3"/>
        </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.hq.ind>
            <tapa.tfu.hq ueId="0"/>
            <tapa.tfu.hq ueId="1"/>
         </tapa.tfu.hq.ind>   
      </tapa.send>

      <tapa.send>
         # Send a 2 TTIs to Send the HARQ ACK Indication
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind>
        <tapa.tfu.hq ueId="2"/>
        <tapa.tfu.hq ueId="3"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>



#
#
#       Test:    15.31
#
#       Desc:    Verify that CSG-nonCSG UEs are scheduled in cyclic order 
#
#       Notes:   None
#              
#       Module:  "RR SCH"
#
#       File:    rgac_tc15.xml
#
#
<tapa.testcase id="15.31">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify that UEs are scheduled in the reported BO order" 
      </tapa.desc>

      <tapa.longdesc>

      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlSchdType="2" ulSchdType="2" 
       csgAccMode = "3"  minDlResNonCsg="10" minUlResNonCsg="10" maxUePerDlSf="4"/>

      # UE Creation
      <tapa.rg.4UeRrInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      #UE1 Configuration
      # at RGR
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="1" lcgId="0" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="1" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      #UE2 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="1" lcgId="0" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="1" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      <tapa.send>
         <tapa.rgr.cfgreq.recfg.ue  oldUeId="1" newUeId="1" UeReCfgType="67108864" csgMmbrSta="1"/>
      </tapa.send>

      # Send TTI to apply the config
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      #UE3 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="1" lcgId="0" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="2" lcId="1" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      <tapa.send>
         <tapa.rgr.cfgreq.recfg.ue oldUeId="2"  newUeId="2" UeReCfgType="67108864" csgMmbrSta="1"/>
      </tapa.send>

      # Send TTI to apply the config
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      #UE4 Configuration
      <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="3" lcId="1" lcgId="0" dir="3" lcType="4" />
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="3" lcId="1" dir="1" lcType="4" instId="5" />
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      <tapa.expset>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      <tapa.send>
         <tapa.rgr.cfgreq.recfg.ue  oldUeId="3" newUeId="3" UeReCfgType="67108864" csgMmbrSta="1"/>
      </tapa.send>

      # Send TTI to apply the config
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Configure DL LC on RGR
      #Send BO for UE1
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="0" lcId="1" bo="2000"/>
      </tapa.send>

      #Send BO for UE2
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="1" lcId="1" bo="500"/>
      </tapa.send>

      #Send BO for UE3
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="2" lcId="1" bo="500"/>
      </tapa.send>

      #Send BO for UE4
      <tapa.send>
         # Send BO for the created logical channel on RGU. 
         <tapa.rgu.dstarsp ueId="3" lcId="1" bo="500"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC for Msg4 
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="1" />
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE1 
         <tapa.rgu.ddatreq ueId="0" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>


      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        </tapa.tfu.cntrl.req>
         <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="1" />
        <tapa.rgu.dstaind ueId="2" numLchTb1="1" lchTb1Data="1" />
        <tapa.tfu.dat.req>
           <tapa.tfu.pdsch.dat.req ueId="0" use="1" validate="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>
      <tapa.send>
         # Send DDatReq for UE3
         <tapa.rgu.ddatreq ueId="2" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
           <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="3"/>
        </tapa.tfu.cntrl.req>
        <tapa.rgu.dstaind ueId="1" numLchTb1="1" lchTb1Data="1" />
         <tapa.rgu.dstaind ueId="3" numLchTb1="1" lchTb1Data="1" />
        <tapa.tfu.dat.req>
           <tapa.tfu.pdsch.dat.req ueId="1" use="2" validate="TRUE"/>
           <tapa.tfu.pdsch.dat.req ueId="2" use="3" validate="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE2
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>
      <tapa.send>
         # Send DDatReq for UE3
         <tapa.rgu.ddatreq ueId="3" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send DL_DELTA Ttis to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="3"/>
           <tapa.tfu.pdcch.cntrl.req ueId="3" saveTo="4"/>
        </tapa.tfu.cntrl.req>
         <tapa.rgu.dstaind ueId="2" numLchTb1="1" lchTb1Data="1" />
         <tapa.rgu.dstaind ueId="3" numLchTb1="1" lchTb1Data="1" />
        <tapa.tfu.dat.req>
           <tapa.tfu.pdsch.dat.req ueId="1" use="3" validate="TRUE"/>
           <tapa.tfu.pdsch.dat.req ueId="3" use="4" validate="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         # Send DDatReq for UE2
         <tapa.rgu.ddatreq ueId="2" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>
      <tapa.send>
         # Send DDatReq for UE3
         <tapa.rgu.ddatreq ueId="3" numLchTb1="1" lchTb1Data="1,0,1"/>
      </tapa.send>

      <tapa.send>
         # Send a 3 TTIs to get the harqrecpRequest from MAC
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req>
           <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="3"/>
           <tapa.tfu.pdcch.cntrl.req ueId="3" saveTo="4"/>
        </tapa.tfu.cntrl.req>
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="1" />
        <tapa.tfu.dat.req>
           <tapa.tfu.pdsch.dat.req ueId="2" use="3" validate="TRUE"/>
           <tapa.tfu.pdsch.dat.req ueId="3" use="4" validate="TRUE"/>
        </tapa.tfu.dat.req>
      </tapa.expset>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


# DO NOT DELETE THIS LINE -- TC number generation script depends on it.


# DO NOT DELETE THIS LINE -- TC number generation script depends on it.
# xyzabcend
 
#/********************************************************************30**
#
#         End of file:     rgac_tc15.xml@@/main/1 - Thu Mar 26 01:11:03 2009
#
#*********************************************************************31*/
#/**********************************************************************
#        Revision History:
#
#**********************************************************************/
#/********************************************************************90**
# 
#     ver       pat    init                  description
#------------ -------- ---- ----------------------------------------------
#/main/1      ---     sm   1. Initial Release.
#$SID$         ---     sm   1. Initial Release.
#             rg004.201 rnt  1. Modified for SI Enhancement
#$SID$        ---     gvj  1. LTE MAC 3.1 Release
#$SID$      ---        rt  1. LTE MAC 4.1 Release
#*********************************************************************91*/
