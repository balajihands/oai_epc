#/************************************************************************
#     Name:     LTE-MAC Test Cases (HD-FDD)
#
#     Type:     XML Script
#
#     Desc:     XML source for LTE MAC Test Case for HD-FDD Feature
#
#     File:     rgac_tc16.xml
#
#     Sid:
#
#     Prg:      ns
#**********************************************************************/

# DO NOT DELETE THIS LINE -- TC number generation script depends on it.
# xyzabcstart=16:sm:rgac_tc22.xml

###############################################################################
#
#       Test:    22.1
#
#       Desc:   "Verify that HD-FDD Configuration happens sucessfully."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.1" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify that HD-FDD Configuration happens sucessfully."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Send Reconfigure with HD-FDD is enabled.
                3. Expect Configuration confirm iwth status = RGR_CFG_CFM_OK"
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

      # Configuration subsection
      <tapa.cfg>

         # Layer Manager Configuration
         <tapa.rg.macInit/>

         # Cell Configuration
         <tapa.rg.cellInit ulTotalBw="100"  numTxAntPorts="2" startRnti="70"
            rntiSize="11" />
         <tapa.rg.dbgDeInitAll/>
         <tapa.rg.dbgInitAll/>
      </tapa.cfg>

      # Test Steps subsection
      <tapa.test>
            <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
               # Send RaReqInd for one rapId
            <tapa.send>
               <tapa.tfu.tti.ind numTti="1"/>
            </tapa.send>
            <tapa.send>
               <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
                  <tapa.tfu.rareq  numRapId="1" rapIds="1" timingAdvs="3"
                     tpcs="1" cqiPres="TRUE" cqis="4"/>
               </tapa.tfu.rareq.ind>
            </tapa.send>

            # Ue starts expecting raResp after 3 subframes within the raResp
            # window.
            # In this TC, it shall expect raResp in the first subframe after
            # 3 Ttis.
            <tapa.send>
               <tapa.tfu.tti.ind numTti="1"/>
            </tapa.send>
            <tapa.send>
               <tapa.tfu.tti.ind numTti="1"/>
            </tapa.send>

            # Expect RaResp for the rapId sent in RaReq
            <tapa.expset>
              <tapa.tfu.dat.req datReqs="1">
                 <tapa.tfu.rarsp.req />
              </tapa.tfu.dat.req>
              <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
                 <tapa.tfu.pdcch.cntrl.req/>
              </tapa.tfu.cntrl.req>
            </tapa.expset>

            <tapa.send>
               <tapa.tfu.tti.ind numTti="6"/>
            </tapa.send>

            <tapa.expect>
               <tapa.tfu.recp.req numRntis="1" spId="1" >
                  <tapa.tfu.msg3.recp.req/>
               </tapa.tfu.recp.req>
            </tapa.expect>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="3"/>
         </tapa.send>

         #Send CRC for Msg3
         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc isFailure="FALSE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="1"/>
         </tapa.send>

         # Expect HARQ ACK in PHICH For MSG3
         <tapa.expect>
            <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
               <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
            </tapa.tfu.cntrl.req>
         </tapa.expect>

         # Send Message3 after receiving Message3 reception req.
         <tapa.send>
             <tapa.tfu.dat.ind datInds="1">
                <tapa.tfu.dat isCcchSdu="TRUE" sduSize="6" />
             </tapa.tfu.dat.ind>
         </tapa.send>


         # Expect Message3 datReq on CCCH at RGU.
         <tapa.expect>
            <tapa.rgu.cdatind lcId="4"/>
         </tapa.expect>

          # Send BO for Msg4 on RGU.
          <tapa.send>
             <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10"/>
          </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="1"/>
         </tapa.send>

         # Expect CStatInd For MSG4
         <tapa.expset>
            <tapa.rgu.cstaind lcId="4"/>
         </tapa.expset>

         # Send Msg4 on RGU.
         <tapa.send>
            <tapa.rgu.cdatreq lcId="4" lcType="3" />
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="1"/>
         </tapa.send>

         # Expect Msg4 from MAC to PHY.
         <tapa.expset>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" validate="FALSE"/>
           </tapa.tfu.dat.req>
           <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="4"/>
         </tapa.send>

         # Recv Hq Recp Req for Msg4.
         <tapa.expect>
           <tapa.tfu.recp.req numRntis="1" spId="1">
              <tapa.tfu.hq.recp.req/>
           </tapa.tfu.recp.req>
         </tapa.expect>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="3" />
         </tapa.send>

         # Send ACK as feedback for Msg4.
         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq />
           </tapa.tfu.hq.ind>
        </tapa.send>

         # Send UE config request
         <tapa.send>
           <tapa.crg.cfgreq.cfg.ue/>
         </tapa.send>

         # Expect success in cfg cfm
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Send UE config request
         <tapa.send>
           <tapa.rgr.cfgreq.cfg.ue hdfdd="TRUE"/>
         </tapa.send>


         # Send TTI to apply the config
         <tapa.send>
            <tapa.tfu.tti.ind/>
         </tapa.send>

         # Expect success in cfg cfm
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>


      </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.2
#
#       Desc:   "Verify that re-configuration of HD-FDD is not allowed."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.2" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify that re-configuration of HD-FDD is not allowed."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Send Reconfigure with HD-FDD is enabled.
                3. Expect Configuration confirm with status = RGR_CFG_CFM_OK
                4. Send Reconfigure with HD-FDD is enabled.
                5. Expect Configuration confirm with status = RGR_CFG_CFM_NOK
                6. Send Reconfigure with HD-FDD is disabled.
                7. Expect Configuration confirm with status = RGR_CFG_CFM_NOK"
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

      # Configuration subsection
      <tapa.cfg>

         # Layer Manager Configuration
         <tapa.rg.macInit/>

         # Cell Configuration
         <tapa.rg.cellInit ulTotalBw="100"  numTxAntPorts="2" startRnti="70"
            rntiSize="11" />
         <tapa.rg.dbgDeInitAll/>
         <tapa.rg.dbgInitAll/>
      </tapa.cfg>

      # Test Steps subsection
      <tapa.test>
            <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
               # Send RaReqInd for one rapId
            <tapa.send>
               <tapa.tfu.tti.ind numTti="1"/>
            </tapa.send>
            <tapa.send>
               <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
                  <tapa.tfu.rareq  numRapId="1" rapIds="1" timingAdvs="3"
                     tpcs="1" cqiPres="TRUE" cqis="4"/>
               </tapa.tfu.rareq.ind>
            </tapa.send>

      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # In this TC, it shall expect raResp in the first subframe after 3 Ttis.
            <tapa.send>
               <tapa.tfu.tti.ind numTti="1"/>
            </tapa.send>
            <tapa.send>
               <tapa.tfu.tti.ind numTti="1"/>
            </tapa.send>

            # Expect RaResp for the rapId sent in RaReq
            <tapa.expset>
              <tapa.tfu.dat.req datReqs="1">
                 <tapa.tfu.rarsp.req />
              </tapa.tfu.dat.req>
              <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
                 <tapa.tfu.pdcch.cntrl.req/>
              </tapa.tfu.cntrl.req>
            </tapa.expset>

            <tapa.send>
               <tapa.tfu.tti.ind numTti="6"/>
            </tapa.send>

            <tapa.expect>
               <tapa.tfu.recp.req numRntis="1" spId="1" >
                  <tapa.tfu.msg3.recp.req/>
               </tapa.tfu.recp.req>
            </tapa.expect>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="3"/>
         </tapa.send>

         #Send CRC for Msg3
         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc isFailure="FALSE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="1"/>
         </tapa.send>

         # Expect HARQ ACK in PHICH For MSG3
         <tapa.expect>
            <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
               <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
            </tapa.tfu.cntrl.req>
         </tapa.expect>

         # Send Message3 after receiving Message3 reception req.
         <tapa.send>
             <tapa.tfu.dat.ind datInds="1">
                <tapa.tfu.dat isCcchSdu="TRUE" sduSize="6" />
             </tapa.tfu.dat.ind>
         </tapa.send>


         # Expect Message3 datReq on CCCH at RGU.
         <tapa.expect>
            <tapa.rgu.cdatind lcId="4"/>
         </tapa.expect>

          # Send BO for Msg4 on RGU.
          <tapa.send>
             <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10"/>
          </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="1"/>
         </tapa.send>

         # Expect CStatInd For MSG4
         <tapa.expset>
            <tapa.rgu.cstaind lcId="4"/>
         </tapa.expset>

         # Send Msg4 on RGU.
         <tapa.send>
            <tapa.rgu.cdatreq lcId="4" lcType="3" />
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="1"/>
         </tapa.send>

         # Expect Msg4 from MAC to PHY.
         <tapa.expset>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" validate="FALSE"/>
           </tapa.tfu.dat.req>
           <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="4"/>
         </tapa.send>

         # Recv Hq Recp Req for Msg4.
         <tapa.expect>
           <tapa.tfu.recp.req numRntis="1" spId="1">
              <tapa.tfu.hq.recp.req/>
           </tapa.tfu.recp.req>
         </tapa.expect>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="3" />
         </tapa.send>

         # Send ACK as feedback for Msg4.
         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq />
           </tapa.tfu.hq.ind>
        </tapa.send>

         # Send UE config request
         <tapa.send>
           <tapa.crg.cfgreq.cfg.ue/>
         </tapa.send>

         # Expect success in cfg cfm
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Send UE config request with HD-FDD enabled
         <tapa.send>
           <tapa.rgr.cfgreq.cfg.ue hdfdd="TRUE"/>
         </tapa.send>


         # Send TTI to apply the config
         <tapa.send>
            <tapa.tfu.tti.ind/>
         </tapa.send>

         # Expect success in cfg cfm
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Send UE config request with HD-FDD enabled again
         <tapa.send>
           <tapa.rgr.cfgreq.recfg.ue hdfdd="TRUE"/>
         </tapa.send>


         # Send TTI to apply the config
         <tapa.send>
            <tapa.tfu.tti.ind/>
         </tapa.send>

         # Expect success in cfg cfm
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5" status="15"/>
         </tapa.expect>

         # Send UE config request with HD-FDD disabled
         <tapa.send>
           <tapa.rgr.cfgreq.recfg.ue hdfdd="FALSE"/>
         </tapa.send>


         # Send TTI to apply the config
         <tapa.send>
            <tapa.tfu.tti.ind/>
         </tapa.send>

         # Expect success in cfg cfm
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>
      </tapa.test>


      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.3
#
#       Desc:   "Verify that configuration of HD-FDD fails if UL SPS is already
#                enabled for that UE."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.3" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify that configuration of HD-FDD fails if UL SPS is already enab
             led for that UE."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Send Reconfigure with SPS-DL enabled.
                3. Expect Configuration confirm with status = RGR_CFG_CFM_OK
                4. Send Reconfigure with HD-FDD is enabled.
                5. Expect Configuration confirm with status = RGR_CFG_CFM_NOK "
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
            <tapa.flag id="LTEMAC_SPS"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

      # Configuration subsection
      <tapa.cfg>

         # Layer Manager Configuration
         <tapa.rg.macInit/>
         #Initialize CELL
         <tapa.rg.cellInit ulTotalBw="100"  numTxAntPorts="2" startRnti="70"
         rntiSize="11" isDlFreqSel="1" hopOffst="20"/>
         #Initialize UE
         <tapa.rg.UeInit  ULSPSEnFlag = "TRUE" DLSPSEnFlag = "TRUE" SPSRnti="65"
         SPSSchIntrv="10" ULSPSSchIntrv="RGR_SPS_PRD_10SF" numSPSproc="1"
         txModeEnum="RGR_UE_TM_3" ULSPSPcktSize="80" ULSPSimpRls="2"/>
         <tapa.rg.dbgDeInitAll/>
         <tapa.rg.dbgInitAll/>
      </tapa.cfg>

      # Test Steps subsection
      <tapa.test>
         # Send UE config request with HD-FDD enabled
         <tapa.send>
             <tapa.rgr.cfgreq.recfg.ue  hdfdd="TRUE" />
         </tapa.send>

         # Send TTI to apply the config
         <tapa.send>
            <tapa.tfu.tti.ind/>
         </tapa.send>

         # Expect success in cfg cfm
         <tapa.expect>
            <tapa.rgr.cfgCfm status="15"/>
         </tapa.expect>
      </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.4
#
#       Desc:   "Verify that configuration of HD-FDD fails if DL SPS is already
#                enabled for that UE."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.4" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify that configuration of HD-FDD fails if DL SPS is already enab
             led for that UE."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Send Reconfigure with SPS-UL enabled.
                3. Expect Configuration confirm with status = RGR_CFG_CFM_OK
                4. Send Reconfigure with HD-FDD is enabled.
                5. Expect Configuration confirm with status = RGR_CFG_CFM_NOK"
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
            <tapa.flag id="LTEMAC_SPS"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit DLSPSMaxBw = "40" dlTotalBw="50" />
      # UE Configuration
      <tapa.rg.UeInit ULSPSEnFlag = "TRUE" DLSPSEnFlag = "TRUE" SPSRnti="65"
         DLSPSSchIntrv="20" NumSPSProc="4" ueId = "0"/>
      <tapa.rg.dbgDeInitAll/>
      <tapa.rg.dbgInitAll/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      # Send UE config request with HD-FDD enabled
      <tapa.send>
          <tapa.rgr.cfgreq.recfg.ue  hdfdd="TRUE" />
      </tapa.send>

      # Send TTI to apply the config
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="15"/>
      </tapa.expect>
   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      # Layer Manager ShutDown
   </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.5
#
#       Desc:   "Verify scheduler should not schedule downlink data  for sub
#                frame(n) while periodic CQI reports transmission instance in
#                sub frame(n) with RI is not enabled."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.5" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should not schedule downlink data for sub frame(n)
             while periodic CQI reports transmission instance in sub frame(n) wi
             -th RI is not enabled."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure Periodic CQI(RI is disabled), HD-FDD is enabled.
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (on
                    -ly one up logical channel)
                4. RLC reports BO
                5. Expecting Periodic CQI in sub frame n, scheduler should not s
                   -chedule DL data in sub frame n.
                5. Expect TFU Reception request with  Periodic CQI information f
                   -rom TFU interface.
                6. Send  periodic CQI information at TFU interface.
                7. Expect Down link data.
                Note: SimultaneousAckNackAndCQI is TRUE"
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
            <tapa.flag id="TFU_UPGRADE"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

      # Configuration subsection
      <tapa.cfg>


         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit numTxAntPorts ="2"/>

         #Finish RACH and then do UE Configuratrion
         <tapa.rg.rach/>

      </tapa.cfg>
      # Test Steps subsection
      <tapa.test>
        # Send UE config request at CRG
        <tapa.send>
           <tapa.crg.cfgreq.cfg.ue/>
        </tapa.send>
        # Expect success in cfg cfm from MAC
        <tapa.expect>
           <tapa.crg.cfgcfm/>
        </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

        # Send UE config request at RGR
        # At start of this step, we are at (2,1) and Reception Request Info time is (2,9)
        <tapa.send>
          <tapa.rgr.cfgreq.cfg.ue instId="5" ueId="0" txModeEnum="RGR_UE_TM_3"
          prdCqiCfg.type="TRUE" cqiPCfgIdx = "40" hdfdd="TRUE" />
        </tapa.send>

         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

        # Send TTI to apply the config
        <tapa.send>
           <tapa.tfu.tti.ind  TTI-Identity="1" numTti="1"/># tti 1
        </tapa.send>

        # Expect success in cfg cfm from Scheduler
         <tapa.expset>
          <tapa.rgr.cfgCfm instId="5"/>
          <tapa.rgr.cfgCfm instId="5"/>
          <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="2 to 18" numTti="17"/># tti 2 to 18
         </tapa.send>

         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="19 and 20" numTti="2"/># tti 19 and 20
         </tapa.send>

        # At start of this step, we are at (2,4) and Reception Request Info time is (2,6)
        # Expect DL CQI reception request from Scheduler
         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
           <tapa.tfu.recp.req expRecpReq="1">
              <tapa.tfu.dlcqi.recp.req />
           </tapa.tfu.recp.req>
         </tapa.expset>

        <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0"
                        lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="21" numTti="1"/># tti 21
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="22 and 23" numTti="2"/># tti 22 and 23
         </tapa.send>

         #Send Raw CQI Indication
         <tapa.send >
            <tapa.tfu.rawdlcqi.ind>
               <tapa.tfu.rawdlcqi ueId="0" />
            </tapa.tfu.rawdlcqi.ind>
         </tapa.send>


         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="24 and 25" numTti="2"/># tti 24 and 25
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="26 and 28" numTti="3"/># tti 26 and 28
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0" isAck="TRUE"/>
           </tapa.tfu.hq.ind>
         </tapa.send>
      </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>

      </tapa.shutdown>

   </tapa.testcase>


###############################################################################
#
#       Test:    22.6
#
#       Desc:   "Verify scheduler should not schedule  downlink data for sub fra
#                me(n) while periodic CQI reports transmission instance in sub f
#                rame (n) with RI is enabled."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.6" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should not schedule downlink data for sub frame(n)
             while periodic CQI reports transmission instance in sub frame (n)
             with RI is enabled."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure Periodic CQI (RI is enabled), HD-FDD is enabled.
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (only one up logical channel)
                4. RLC reports BO
                5. Expecting Periodic CQI in sub frame n, scheduler should not
                   schedule DL data in sub frame n.
                5. Expect TFU Reception request with Periodic CQI information
                   from TFU interface.
                6. Send periodic CQI information at TFU interface.
                7. Expect Down link data.
                Note: SimultaneousAckNackAndCQI is TRUE"
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
            <tapa.flag id="TFU_UPGRADE"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

      # Configuration subsection
      <tapa.cfg>


         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit numTxAntPorts ="2"/>

         #Finish RACH and then do UE Configuratrion
         <tapa.rg.rach/>

      </tapa.cfg>
      # Test Steps subsection
      <tapa.test>
        # Send UE config request at CRG
        <tapa.send>
           <tapa.crg.cfgreq.cfg.ue/>
        </tapa.send>
        # Expect success in cfg cfm from MAC
        <tapa.expect>
           <tapa.crg.cfgcfm/>
        </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

        # Send UE config request at RGR
        # At start of this step, we are at (2,1) and Reception Request Info time is (2,3)
        # Periodicity yielded from below step will be 5.
        # Hence, the PCQI will arrive on Reception Request Info time (2,6)
        <tapa.send>
          <tapa.rgr.cfgreq.cfg.ue instId="5" ueId="0" txModeEnum="RGR_UE_TM_3"
            prdCqiCfg.type="TRUE" cqiPCfgIdx = "40" hdfdd="TRUE"
            riEna = "TRUE"  riCfgIdx = "5" />
        </tapa.send>

         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

        # Send TTI to apply the config
        <tapa.send>
           <tapa.tfu.tti.ind  TTI-Identity="1" numTti="1"/># tti 1
        </tapa.send>

        # Expect success in cfg cfm from Scheduler
         <tapa.expset>
          <tapa.rgr.cfgCfm instId="5"/>
          <tapa.rgr.cfgCfm instId="5"/>
          <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="2 to 15" numTti="14"/># tti 2 to 15
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req expRecpReq="1">
              <tapa.tfu.dlcqi.recp.req />
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="16 to 18" numTti="3"/># tti 16 to 18
         </tapa.send>

         <tapa.send >
            <tapa.tfu.rawdlcqi.ind>
               <tapa.tfu.rawdlcqi ueId="0" />
            </tapa.tfu.rawdlcqi.ind>
         </tapa.send>

         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="19 and 20" numTti="2"/># tti 19 and 20
         </tapa.send>

         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
           <tapa.tfu.recp.req expRecpReq="1">
              <tapa.tfu.dlcqi.recp.req />
           </tapa.tfu.recp.req>
         </tapa.expset>

        <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0"
                        lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="21" numTti="1"/># tti 21
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="22 and 23" numTti="2"/># tti 22 and 23
         </tapa.send>

         #Send Raw CQI Indication
         <tapa.send >
            <tapa.tfu.rawdlcqi.ind>
               <tapa.tfu.rawdlcqi ueId="0" />
            </tapa.tfu.rawdlcqi.ind>
         </tapa.send>


         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="24 and 25" numTti="2"/># tti 24 and 25
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="26 to 28" numTti="3"/># tti 26 to 28
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0" isAck="TRUE"/>
           </tapa.tfu.hq.ind>
         </tapa.send>
      </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.7
#
#       Desc:   "Verify scheduler should not schedule downlink data for sub
#                frame(n) while SRS reports transmission instance in
#                sub frame (n) ."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.7" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should not schedule downlink data for sub frame(n)
              while SRS reports transmission instance in sub frame (n) ."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure SRS (Wide band is enabled), HD-FDD is enabled.
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (only one up logical channel)
                4. RLC reports BO
                5. Expecting SRS in sub frame n, scheduler should not schedule
                   DL data in sub frame n.
                6. Expect TFU Reception request with SRS information from TFU
                   interface.
                7. Send SRS information at TFU interface.
                8. Expect Down link data.
                Note: SimultaneousAckNackAndSRS is TRUE"
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
            <tapa.flag id="TFU_UPGRADE"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

      # Configuration subsection
      <tapa.cfg>


         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit numTxAntPorts ="2"/>

         #Finish RACH and then do UE Configuratrion
         <tapa.rg.rach/>

      </tapa.cfg>
      # Test Steps subsection
      <tapa.test>
        # Send UE config request at CRG
        <tapa.send>
           <tapa.crg.cfgreq.cfg.ue/>
        </tapa.send>
        # Expect success in cfg cfm from MAC
        <tapa.expect>
           <tapa.crg.cfgcfm/>
        </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

        # Send UE config request at RGR
        # At start of this step, we are at (2,1) and Reception Request Info time is (3,1)
        <tapa.send>
          <tapa.rgr.cfgreq.cfg.ue instId="5" ueId="0"
            srsCfgPres ="TRUE" srsCfgIdx ="10" sANSrs="TRUE"
            hdfdd="TRUE"/>
        </tapa.send>

         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

        # Send TTI to apply the config
        <tapa.send>
           <tapa.tfu.tti.ind  TTI-Identity="1" numTti="1"/># tti 1
        </tapa.send>

        # Expect success in cfg cfm from Scheduler
         <tapa.expset>
          <tapa.rgr.cfgCfm instId="5"/>
          <tapa.rgr.cfgCfm instId="5"/>
          <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="2 to 8" numTti="7"/># tti 2 to 8
         </tapa.send>

         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="9 and 10" numTti="2"/># tti 9 and 10
         </tapa.send>

         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
            <tapa.tfu.recp.req >
               <tapa.tfu.srs.recp.req />
             </tapa.tfu.recp.req>
          </tapa.expset>

         <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0"
                        lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="11" numTti="1"/># tti 11
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12 and 13" numTti="2"/># tti 12 and 13
         </tapa.send>

         <tapa.send>
            <tapa.tfu.srs.ind>
               <tapa.tfu.srs ueId="0" />
            </tapa.tfu.srs.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="14 and 15" numTti="2"/># tti 14 and 15
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="16 to 18" numTti="3"/># tti 16 to 18
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0" isAck="TRUE"/>
           </tapa.tfu.hq.ind>
         </tapa.send>
      </tapa.test>
      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.8
#
#       Desc:   "Verify scheduler should not schedule downlink data for
#                subframe(n) while SR reports transmission instance in
#                subframe (n) ."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.8" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should not schedule downlink data for sub frame(n)
              while SR reports transmission instance in subframe (n) ."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure SR (subband is enabled), HD-FDD is enabled.
                3. Configure DL logical Channel 1, UL logical channel group 1
                     (only one up logical channel)
                4. RLC reports BO
                5. Expecting SR in subframe n, scheduler should not schedule DL
                    data in sub frame n.
                6. Expect TFU Reception request with SR information from TFU
                   interface.
                7. Send  SR information at TFU interface.
                8. Expect Down link data."
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
            <tapa.flag id="TFU_UPGRADE"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

      # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit numTxAntPorts ="2"/>

         #Finish RACH and then do UE Configuratrion
         <tapa.rg.rach/>

      </tapa.cfg>
      # Test Steps subsection
      <tapa.test>
        # Send UE config request at CRG
        <tapa.send>
           <tapa.crg.cfgreq.cfg.ue/>
        </tapa.send>
        # Expect success in cfg cfm from MAC
        <tapa.expect>
           <tapa.crg.cfgcfm/>
        </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

        # Send UE config request at RGR
        # At start of this step, we are at (2,1) and Reception Request Info time is (4,3)
        <tapa.send>
          <tapa.rgr.cfgreq.cfg.ue instId="5" ueId="0"
            srCfgPres ="TRUE" srCfgIdx ="40"  UeReCfgType="16384"
            hdfdd="TRUE" prdBsrTmr="65535"/>
        </tapa.send>

         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

        # Send TTI to apply the config
        <tapa.send>
           <tapa.tfu.tti.ind  TTI-Identity="1" numTti="1"/># tti 1
        </tapa.send>

        # Expect success in cfg cfm from Scheduler
         <tapa.expset>
          <tapa.rgr.cfgCfm instId="5"/>
          <tapa.rgr.cfgCfm instId="5"/>
          <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="2 to 20" numTti="19"/># tti 2 to 20
         </tapa.send>

         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="21 to 22" numTti="2"/># tti 21 to 22
         </tapa.send>

         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
            <tapa.tfu.recp.req >
               <tapa.tfu.sr.recp.req/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0"
                        lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="23" numTti="1"/># tti 23
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="24 and 25" numTti="2"/># tti 24 and 25
         </tapa.send>

        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/>
           </tapa.tfu.sr.ind>
        </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="26" numTti="1"/># tti 26
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                        vldtGrant="TRUE" vldtTx="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="27" numTti="1"/># tti 27
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="28 to 30" numTti="3"/># tti 28 to 30
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0" isAck="TRUE"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1">
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="31 to 33" numTti="3"/># tti 31 to 33
         </tapa.send>

         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="34" numTti="1"/># tti 34
         </tapa.send>

         # Expect HARQ ACK in PHICH
         <tapa.expect>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expect>

         # Send Data Indication using TB size recieved in the grant
         <tapa.send>
          <tapa.tfu.dat.ind datInds="1">
             <tapa.tfu.dat use="2" lcId="9"/>
          </tapa.tfu.dat.ind>
         </tapa.send>

         # Expect Data Indication at RLC
         <tapa.expect>
            <tapa.rgu.ddatind lchTb1Data="9,1" vldtBuf="TRUE"/>
         </tapa.expect>

           # Extra TTIs
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="EXTRA" numTti="3"/>
         </tapa.send>
      </tapa.test>
      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.9
#
#       Desc:   "Verify scheduler should not schedule for down link data for sub
#                frame "n" while UP link data has been schedule for
#                subframe "n"."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.9" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should not schedule for down link data for
             subframe "n" while UP link data has been schedule for
             subframe "n"."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure HD-FDD is enabled.
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (only one logical channel)
                4. Report BSR
                5. Schedule UL data for sub frame (n).
                6. RLC Report BO status for DL data, make sure DL data should
                   be not be scheduled for sub frame n."
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

   # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit ulTotalBw="20"/>
         #Initialize UE
         <tapa.rg.UeInit hdfdd="TRUE"/>

      </tapa.cfg>

   # Test Steps subsection
      <tapa.test>

         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0"
                        dir="3" lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="1" numTti="1"/>#tti 1
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Send SR Indication for default UE for DATA (A)
        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/>
           </tapa.tfu.sr.ind>
        </tapa.send>

         # Send a TTI to schedule SR
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="2" numTti="1"/>#tti 2
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                        vldtGrant="TRUE" vldtTx="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="3 and 4" numTti="2"/>#tti 3 and 4
         </tapa.send>

         # Send BO for the created logical channel on RGU.
         # This requests DL to be scheduled in n
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/> # DATA (B)
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="5 and 6" numTti="2"/>#tti 5 and 6
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/> #For (B)
            <tapa.tfu.recp.req numRntis="1"> #For DATA (A)
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         # Send DDatReq for UE1 with size equal to the allocated size on RGU.
        <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0"
                        lcId="9" lcType="4"/># For (B)
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="7" numTti="1"/>#tti 7
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/> #For (B)
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
       #This is Scheduled for actual air tx in 10, Hq is at 14, RecpReq at 12
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>#For (B)
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="8 and 9" numTti="2"/>#tti 8 and 9
         </tapa.send>

         #Send CRC for Msg
         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/># For (A)
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="10" numTti="1"/> #tti 10
         </tapa.send>

         # Expect HARQ ACK in PHICH
         <tapa.expect>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/> #For (A)
           </tapa.tfu.cntrl.req>
         </tapa.expect>

         # Send Data Indication using TB size recieved in the grant
         <tapa.send>
          <tapa.tfu.dat.ind datInds="1">
             <tapa.tfu.dat use="2" lcId="9"/> #For (A)
          </tapa.tfu.dat.ind>
         </tapa.send>

         # Expect Data Indication at RLC
         <tapa.expect>
            <tapa.rgu.ddatind lchTb1Data="9,1" vldtBuf="TRUE"/>
         </tapa.expect>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="11" numTti="1"/> #tti 11
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
               # This Hq f/b is received at 13(Air) and indicated in 14
              <tapa.tfu.hq.recp.req ueId="0"/>#For (B)
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12" numTti="1"/> #tti 12
         </tapa.send>
<!--
       #Periodic BSR timer expires. So DCI-0 grant is given.
         <tapa.expect>
           <tapa.tfu.cntrl.req numCntrlReq="1"/>
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                        vldtGrant="TRUE" vldtTx="TRUE"/>
         </tapa.expect>
-->
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="13, 14" numTti="2"/> #tti 13 and 14
         </tapa.send>
         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0"/># For (A)
           </tapa.tfu.hq.ind>
         </tapa.send>

     </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.10
#
#       Desc:   "Verify scheduler should not schedule for down link data for
#                 sub frame, while n+1 is scheduled for UL."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.10" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should not schedule for down link data for sub
            frame, while n+1 is scheduled for UL."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure HD-FDD is enabled.
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (only one logical channel)
                4. Report BSR
                5. Schedule UL data for sub frame n+1.
                6. Schedule DL data for sub frame n.
                7. RLC Report BO status for DL data, make sure DL data should
                   be not be scheduled for sub frame n."
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

   # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit ulTotalBw="20"/>
         #Initialize UE
         <tapa.rg.UeInit hdfdd="TRUE"/>

      </tapa.cfg>

   # Test Steps subsection
      <tapa.test>

         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="1" numTti="1"/>#tti 1
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Send SR Indication for default UE for DATA (A)
        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/>
           </tapa.tfu.sr.ind>
        </tapa.send>

         # Send a TTI to schedule SR
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="2" numTti="1"/>#tti 2
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                     vldtGrant="TRUE" vldtTx="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="3" numTti="1"/>#tti 3
         </tapa.send>

         # Send BO for the created logical channel on RGU.
         # This requests DL to be scheduled in n + 1
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/> # DATA (B)
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="4, 5 and 6" numTti="3"/>#tti 4, 5 and 6
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/> #For (B)
            <tapa.tfu.recp.req numRntis="1"> #For DATA (A)
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         # Send DDatReq for UE1 with size equal to the allocated size on RGU.
        <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9"
                     lcType="4"/># For (B)
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="7" numTti="1"/>#tti 7
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/> #For (B)
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
           #This is Scheduled for actual air tx in 10, Hq is at 14, RecpReq at 12
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>#For (B)
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="8 and 9" numTti="2"/>#tti 8 and 9
         </tapa.send>

         #Send CRC for Msg
         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/># For (A)
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="10" numTti="1"/> #tti 10
         </tapa.send>

         # Expect HARQ ACK in PHICH
         <tapa.expect>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/> #For (A)
           </tapa.tfu.cntrl.req>
         </tapa.expect>

         # Send Data Indication using TB size recieved in the grant
         <tapa.send>
          <tapa.tfu.dat.ind datInds="1">
             <tapa.tfu.dat use="2" lcId="9"/> #For (A)
          </tapa.tfu.dat.ind>
         </tapa.send>

         # Expect Data Indication at RLC
         <tapa.expect>
            <tapa.rgu.ddatind lchTb1Data="9,1" vldtBuf="TRUE"/>
         </tapa.expect>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="11" numTti="1"/> #tti 11
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
               # This Hq f/b is received at 13(Air) and indicated in 14
              <tapa.tfu.hq.recp.req ueId="0"/>#For (B)
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12"
                     numTti="1"/> #tti 12
         </tapa.send>
<!--
       #Periodic BSR timer expires. So DCI-0 grant is given.
         <tapa.expect>
           <tapa.tfu.cntrl.req numCntrlReq="1"/>
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                        vldtGrant="TRUE" vldtTx="TRUE"/>
         </tapa.expect>
-->
        <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity=" 13, 14"
                     numTti="2"/> #tti  13 and 14
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0"/># For (A)
           </tapa.tfu.hq.ind>
         </tapa.send>

     </tapa.test>
      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.11
#
#       Desc:   "Verify scheduler should not schedule for down link data for
#                sub frame, while n+4 is scheduled for DL."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.11" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should not schedule for down link data for sub
               frame, while n+4 is scheduled for DL."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure HD-FDD is enabled.
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (only one logical channel)
                4. Report BSR
                5. Schedule UL data for sub frame n
                6. Schedule DL in n+8
                7. UE sends erroneous data in n
                8. Check that ACK is sent at across TFU in subframe n+4"
         </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
         <tapa.ifdef>
            <tapa.flag id="RGR_SI_SCH"/>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>
   </tapa.require>

      # Configuration subsection
   <tapa.cfg>

         # Layer Manager Configuration
         <tapa.rg.macInit/>

         # Cell Configuration
         <tapa.rg.cellInit ulTotalBw="100"  numTxAntPorts="2"/>
         <tapa.rg.UeInit ueId="0" hdfdd="TRUE"/>
         <tapa.rg.dbgDeInitAll/>
         <tapa.rg.dbgInitAll/>
   </tapa.cfg>

   <tapa.test>
         # Starting at 2,2
         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="1" numTti="1"/>#tti 2, 3
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expset>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         <tapa.send>
            # Send SI Configuration request for MIB
            <tapa.rgr.sicfgreq instId="5" bcchIdx="0" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_MIB" />
         </tapa.send>

         <tapa.expect>
            # Expect SI Cfg Cfm from MAC
            <tapa.rgr.sicfgcfm instId="5"/>
         </tapa.expect>

         # For HD-FDD UE, this BO should get scheduled in 3,6
         # But since, 3,6 + HARQ_TIME i.e, 4,0 is DL (BCCH), it
         # should try scheduling in 3,7. But it cannot be scheduled
         # for 3,7, since it violates Guard time rule by having 4,0 as DL and 4,1 as UL.
         # So best time to schedule is in 3,8 and hence DStaInd
         # in 3, 5

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="9"/> # tti 3,2
         </tapa.send>

         # Send BO for the created logical channel on RGU.
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="3"/> # tti 3,5
         </tapa.send>

         # Expect staInd from MAC to RLC for UE1.
         <tapa.expect>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="1"/>
         </tapa.expect>

         # Send DDatReq for UE1 with size equal to the allocated size on RGU.
        <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="1"/> # tti 3,6
         </tapa.send>

         <tapa.expset>
            # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req ueId="0" use="2" lcId="9"/>
           </tapa.tfu.dat.req>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="2"/>
           </tapa.tfu.cntrl.req>
        </tapa.expset>

         # MIB is scheduled for 4,0, so expect Dat Request at 3,8
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="2"/> # tti 3,8
         </tapa.send>

         <tapa.expect>
            <tapa.tfu.dat.req>
               <tapa.tfu.bch.dat.req />
            </tapa.tfu.dat.req>
         </tapa.expect>

         # Harq is expected at 4,2. Send Harq Recp request at 4,0
         # and send Harq Indication to MAC in 4,3
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="2"/> # tti 4,0
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="3"/>#tti 4,3
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

    # Run till next BCH occasion, i.e, 8,0 and
    # hence tx request is at 7,3
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="37"/>
         </tapa.send>

         <tapa.expect>
            <tapa.tfu.dat.req>
               <tapa.tfu.bch.dat.req />
            </tapa.tfu.dat.req>
         </tapa.expect>
   </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.12
#
#       Desc:   "Verify scheduler schedules down link data for sub frame n
#                while following conditions are met:
#                Condition 1:  subframe n is not UL
#                Condition 2:  subframe n+1 is not UL
#                Condition 3:  subframe n+4 is not DL"
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.12" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler schedules down link data for sub frame n while
             following conditions are met:
                Condition 1:  subframe n is not UL
                Condition 2:  subframe n+1 is not UL
                Condition 3:  subframe n+4 is not DL"
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure HD-FDD is enabled.
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (only one logical channel)
                4. Report BSR
                5. Schedule UL/DL data for next 10 subframes.
                6. RLC Report BO status for DL data, make sure that scheduling
                     happens as per the DL scheduling rules."
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

      # Configuration subsection
      <tapa.cfg>


         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>

         #Initialize CELL
         <tapa.rg.cellInit.dlSched
            dlSchdType="0" ulSchdType="0"/>

         #Do RACH and UE Config
         <tapa.rg.UeInit ueId="0" hdfdd="TRUE"/>

      </tapa.cfg>

      # Test Steps subsection
      <tapa.test>

         # Configure a dedicated logical channel for the created UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1"
            dlQci="3" dlGbr="1000" dlMbr="2000"/>
         </tapa.send>

         # Expect success in cfg cfm
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure a dedicated logical channel for the created UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="0" lcId="9" lcType="4"
            dir="1" dlQci="3" dlGbr="1000" dlMbr="2000"/>
         </tapa.send>

         # Send a Tti to get the configuration applied.
         <tapa.send>
            <tapa.tfu.tti.ind/> #tti 1
         </tapa.send>

         # Expect success in cfg cfm
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Send BO for the created logical channel on RGU.
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/> # DATA (A)
         </tapa.send>

         # Send a Tti to get the transmission scheduled.
         <tapa.send>
            <tapa.tfu.tti.ind/> #tti 2
         </tapa.send>

         # Expect staInd from MAC to RLC for UE1.
         <tapa.expect>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/> #For (A)
         </tapa.expect>

         # Send DDatReq for UE1 with size equal to the allocated size on RGU.
        <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9"
                     lcType="4"/># For (A)
         </tapa.send>

         # Send BO for the created logical channel on RGU.
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/> # DATA (B)
         </tapa.send>


         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.send>
            <tapa.tfu.tti.ind /> #tti 3
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/> #For (B)
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/> #For (A)
        </tapa.tfu.cntrl.req>
      # Expect Msg4 from MAC to PHY.
        <tapa.tfu.dat.req datReqs="1">
            #This is Scheduled for actual air tx in 5, Hq is at 9, RecpReq at 7
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>#For (A)
        </tapa.tfu.dat.req>
      </tapa.expset>

         # Send DDatReq for UE1 with size equal to the allocated size on RGU.
        <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9"
                  lcType="4"/> #For (B)
         </tapa.send>

         # Send BO for the created logical channel on RGU.
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/> #DATA (C)
         </tapa.send>


      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="4" numTti="1"/> #tti 4
      </tapa.send>

      # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/> #For (C)
        <tapa.tfu.cntrl.req numCntrlReq="1">
            #This is Scheduled for actual air tx in 6, Hq is at 10, RecpReq at 8
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>#For (B)
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>#For (B)
        </tapa.tfu.dat.req>
      </tapa.expset>

      # Send DDatReq for UE1 with size equal to the allocated size on RGU.
      <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/> #For (C)
      </tapa.send>

      # Send BO for the created logical channel on RGU.
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/> #DATA (D)
      </tapa.send>


      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="5" numTti="1"/> #tti 5
      </tapa.send>

      # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
      <tapa.expset>
      <tapa.tfu.cntrl.req numCntrlReq="1">
            #This is Scheduled for actual air tx in 7, Hq is at 11, RecpReq at 9
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>#For (C)
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>#For (C)
        </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="6" numTti="1"/> #tti 6
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="7" numTti="1"/> #tti 7
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.recp.req numRntis="1">
            # This Hq f/b is received at 9(Air) and indicated in 10
           <tapa.tfu.hq.recp.req ueId="0"/>#For (A)
        </tapa.tfu.recp.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="8" numTti="1"/> #tti 8
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.recp.req numRntis="1">
            # This Hq f/b is received at 10(Air) and indicated in 11
           <tapa.tfu.hq.recp.req ueId="0"/>#For (B)
        </tapa.tfu.recp.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="9" numTti="1"/> #tti 9
      </tapa.send>

      <tapa.expset>
        <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/> #For (D)
        <tapa.tfu.recp.req numRntis="1">
            # This Hq f/b is received at 10(Air) and indicated in 11
           <tapa.tfu.hq.recp.req ueId="0"/>#For (C)
        </tapa.tfu.recp.req>
      </tapa.expset>

      # Send DDatReq for UE1 with size equal to the allocated size on RGU.
      <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/> #For (D)
      </tapa.send>


      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="10" numTti="1"/> #tti 10
      </tapa.send>

      # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
      #This is Scheduled for actual air tx in 12, Hq is at 16, RecpReq at 14
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>#For (D)
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>#For (D)
        </tapa.tfu.dat.req>
      </tapa.expset>


      <tapa.send>
        <tapa.tfu.hq.ind hqInds="1">
           <tapa.tfu.hq ueId="0"/># For (A)
        </tapa.tfu.hq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="11" numTti="1"/> #tti 11
      </tapa.send>

      <tapa.send>
        <tapa.tfu.hq.ind hqInds="1">
           <tapa.tfu.hq ueId="0"/># For (B)
        </tapa.tfu.hq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="12" numTti="1"/> #tti 12
      </tapa.send>

      <tapa.send>
        <tapa.tfu.hq.ind hqInds="1">
           <tapa.tfu.hq ueId="0"/># For (C)
        </tapa.tfu.hq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="14" numTti="2"/> #tti 13 and 14
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.recp.req numRntis="1">
            # This Hq f/b is received at 10(Air) and indicated in 11
           <tapa.tfu.hq.recp.req ueId="0"/>#For (C)
        </tapa.tfu.recp.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="17" numTti="3"/> #tti 15, 16 and 17
      </tapa.send>

      <tapa.send>
        <tapa.tfu.hq.ind hqInds="1">
           <tapa.tfu.hq ueId="0"/># For (D)
        </tapa.tfu.hq.ind>
      </tapa.send>

      #Sending extra tti to make sure nothing is left
      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="EXTRA" numTti="4"/> #tti Extra TTI
      </tapa.send>

      </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.13
#
#       Desc:   "Verify scheduler schedules down link data for sub frame "n"
#               while UP link data has been schedule for sub frame "n-4"."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.13" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler schedules down link data for sub frame "n"
               while UP link data has been schedule for sub frame "n-4"."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure HD-FDD is enabled.
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (only one logical channel)
                4. Report BSR
                5. Schedule UL data at sub frame n-4.
                6. BO reported from RLC.
                7. Dl should be scheduled at sub frame n."
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

      # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>

         #Initialize CELL
         <tapa.rg.cellInit.dlSched
            dlSchdType="0" ulSchdType="0"/>

         #Do RACH and UE Config
         <tapa.rg.UeInit ueId="0" hdfdd="TRUE"/>

      </tapa.cfg>

      # Test Steps subsection
      <tapa.test>

         # Configure a dedicated logical channel for the created UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1"
            dlQci="3" dlGbr="1000" dlMbr="2000"/>
         </tapa.send>

         # Expect success in cfg cfm
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure a dedicated logical channel for the created UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="0" lcId="9" lcType="4"
            dir="1" dlQci="3" dlGbr="1000" dlMbr="2000"/>
         </tapa.send>

         # Send a Tti to get the configuration applied.
         <tapa.send>
            <tapa.tfu.tti.ind/> #tti 1
         </tapa.send>

         # Expect success in cfg cfm
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Send BO for the created logical channel on RGU.
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/> # DATA (A)
         </tapa.send>

         # Send a Tti to get the transmission scheduled.
         <tapa.send>
            <tapa.tfu.tti.ind/> #tti 2
         </tapa.send>

         # Expect staInd from MAC to RLC for UE1.
         <tapa.expect>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/> #For (A)
         </tapa.expect>

         # Send DDatReq for UE1 with size equal to the allocated size on RGU.
        <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9"
                      lcType="4"/># For (A)
         </tapa.send>

         # Send BO for the created logical channel on RGU.
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/> # DATA (B)
         </tapa.send>


         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.send>
            <tapa.tfu.tti.ind /> #tti 3
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/> #For (B)
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/> #For (A)
        </tapa.tfu.cntrl.req>
      # Expect Msg4 from MAC to PHY.
        <tapa.tfu.dat.req datReqs="1">
            #This is Scheduled for actual air tx in 5, Hq is at 9, RecpReq at 7
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>#For (A)
        </tapa.tfu.dat.req>
      </tapa.expset>

         # Send DDatReq for UE1 with size equal to the allocated size on RGU.
        <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9"
                     lcType="4"/> #For (B)
         </tapa.send>

         # Send BO for the created logical channel on RGU.
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/> #DATA (C)
         </tapa.send>


      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="4" numTti="1"/> #tti 4
      </tapa.send>

      # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/> #For (C)
        <tapa.tfu.cntrl.req numCntrlReq="1">
            #This is Scheduled for actual air tx in 6, Hq is at 10, RecpReq at 8
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>#For (B)
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>#For (B)
        </tapa.tfu.dat.req>
      </tapa.expset>

      # Send DDatReq for UE1 with size equal to the allocated size on RGU.
      <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/> #For (C)
      </tapa.send>

      # Send BO for the created logical channel on RGU.
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/> #DATA (D)
      </tapa.send>


      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="5" numTti="1"/> #tti 5
      </tapa.send>

      # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
      <tapa.expset>
      <tapa.tfu.cntrl.req numCntrlReq="1">
            #This is Scheduled for actual air tx in 7, Hq is at 11, RecpReq at 9
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>#For (C)
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>#For (C)
        </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="6" numTti="1"/> #tti 6
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="7" numTti="1"/> #tti 7
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.recp.req numRntis="1">
            # This Hq f/b is received at 9(Air) and indicated in 10
           <tapa.tfu.hq.recp.req ueId="0"/>#For (A)
        </tapa.tfu.recp.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="8" numTti="1"/> #tti 8
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.recp.req numRntis="1">
            # This Hq f/b is received at 10(Air) and indicated in 11
           <tapa.tfu.hq.recp.req ueId="0"/>#For (B)
        </tapa.tfu.recp.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="9" numTti="1"/> #tti 9
      </tapa.send>

      <tapa.expset>
        <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/> #For (D)
        <tapa.tfu.recp.req numRntis="1">
            # This Hq f/b is received at 10(Air) and indicated in 11
           <tapa.tfu.hq.recp.req ueId="0"/>#For (C)
        </tapa.tfu.recp.req>
      </tapa.expset>

      # Send DDatReq for UE1 with size equal to the allocated size on RGU.
      <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/> #For (D)
      </tapa.send>


      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="10" numTti="1"/> #tti 10
      </tapa.send>

      # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
       #This is Scheduled for actual air tx in 12, Hq is at 16, RecpReq at 14
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>#For (D)
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>#For (D)
        </tapa.tfu.dat.req>
      </tapa.expset>


      <tapa.send>
        <tapa.tfu.hq.ind hqInds="1">
           <tapa.tfu.hq ueId="0"/># For (A)
        </tapa.tfu.hq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="11" numTti="1"/> #tti 11
      </tapa.send>

      <tapa.send>
        <tapa.tfu.hq.ind hqInds="1">
           <tapa.tfu.hq ueId="0"/># For (B)
        </tapa.tfu.hq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="12" numTti="1"/> #tti 12
      </tapa.send>

      <tapa.send>
        <tapa.tfu.hq.ind hqInds="1">
           <tapa.tfu.hq ueId="0"/># For (C)
        </tapa.tfu.hq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="14" numTti="2"/> #tti 13 and 14
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.recp.req numRntis="1">
            # This Hq f/b is received at 10(Air) and indicated in 11
           <tapa.tfu.hq.recp.req ueId="0"/>#For (C)
        </tapa.tfu.recp.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="17" numTti="3"/> #tti 15, 16 and 17
      </tapa.send>

      <tapa.send>
        <tapa.tfu.hq.ind hqInds="1">
           <tapa.tfu.hq ueId="0"/># For (D)
        </tapa.tfu.hq.ind>
      </tapa.send>

      #Sending extra tti to make sure nothing is left
      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="EXTRA" numTti="4"/> #tti Extra TTI
      </tapa.send>

      </tapa.test>
      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.14
#
#       Desc:   "Verify scheduler should schedule downlink  data in sub
#                frame n, if n-4 has been scheduled for uplink adaptive
#                retransmission data.(HARQ Feedback is expecting at nth
#                sub frame)."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.14" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should schedule downlink  data in sub frame n, if
             n-4 has been scheduled for uplink adaptive retransmission data.
             (HARQ Feedback is expected at nth sub frame)."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure HD-FDD is enabled.
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (only one logical channel)
                4. Report BSR
                5. Schedule UL data.
                6. Receive UL Data (CRC Indication failure)
                7. Retransmission the UL grants (Adaptive) at sub frame n-4.
                8 RLC Report BO
                9. DL data should be scheduled at sub frame n."
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit/>

      # UE configuration
      <tapa.rg.UeInit hdfdd="TRUE"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE
         # lcType=5 for DCCH (cm_lte.h)
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="5" dir="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm status="0"/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE
         # lcType=5 for DCCH (cm_lte.h)
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="5" dir="1" instId="5"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the configuration applied.
         <tapa.tfu.tti.ind TTI-Identity="1" numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm status="0" instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="9" lcType="5" bo="50"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled.
         <tapa.tfu.tti.ind TTI-Identity="2" numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC for Msg4
         <tapa.rgu.dstaind lchTb1Data="9" saveTransId="2"/>
      </tapa.expect>

      <tapa.send>
         # Send data with size equal to the allocated size on RGU.
         <tapa.rgu.ddatreq ueId="0" lchTb1Data="9" lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind TTI-Identity="3" numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req ueId="0" use="1"
             lcId="9" chkSdu="TRUE" saveTo="2"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req chkTransId="2" saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
         # - TFU_DELTA Ttis to expect harqrecp req from MAC.
         <tapa.tfu.tti.ind TTI-Identity="4 to 7" numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req/>
     </tapa.tfu.recp.req>
      </tapa.expect>

      # Send TFU_DELTA + TFU_UL_DELTA Ttis to send fdbk to MAC.
      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="8 to 10" numTti="3"/>
      </tapa.send>

      # Send NACK for the received PDU
      <tapa.send>
        <tapa.tfu.hq.ind hqInds="1">
           <tapa.tfu.hq isAck="FALSE"/>
        </tapa.tfu.hq.ind>
      </tapa.send>

      <tapa.send>
         # Send 2 Ttis (one for scheduling, one for retransmission,
         # if scheduled and hence NACK is successfully handled)
         <tapa.tfu.tti.ind TTI-Identity="11" numTti="1"/>
      </tapa.send>

      <tapa.send>
         # Send 2 Ttis (one for scheduling, one for retransmission,
         # if scheduled and hence NACK is successfully handled)
         <tapa.tfu.tti.ind TTI-Identity="12" numTti="1"/>
      </tapa.send>

      <tapa.expset>
          # Expect PDU from MAC to PHY.
          #ccpu00119023 MOD changed added retx parameters for validation
        <tapa.tfu.dat.req datReqs="1">
            <tapa.tfu.pdsch.dat.req use="3" chkSdu="TRUE" lcId="9"
                isRetx="TRUE" retxUse="2" validate="TRUE" vldtRetx="TRUE"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req use="1" saveTo="3" vldtRetx="TRUE" validate="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

   </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.15
#
#       Desc:   "Verify Configuration fails if periodicity of CQI reporting
#                is less than 10 for HD-FDD UE"
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.15" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
               "Verify Configuration fails if periodicity of CQI reporting
               is less than 10 for HD-FDD UE"
         </tapa.desc>

         <tapa.longdesc>
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
            <tapa.flag id="TFU_UPGRADE"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

      # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit numTxAntPorts ="2"/>

         #Finish RACH and then do UE Configuratrion
         <tapa.rg.rach/>

      </tapa.cfg>
      # Test Steps subsection
      <tapa.test>
        # Send UE config request at CRG
        <tapa.send>
           <tapa.crg.cfgreq.cfg.ue/>
        </tapa.send>
        # Expect success in cfg cfm from MAC
        <tapa.expect>
           <tapa.crg.cfgcfm/>
        </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

        # Send UE config request at RGR
        # At start of this step, we are at (2,1) and Reception Request Info time is (2,9)
        <tapa.send>
          <tapa.rgr.cfgreq.cfg.ue instId="5" ueId="0" txModeEnum="RGR_UE_TM_3"
          prdCqiCfg.type="TRUE" cqiPCfgIdx = "3" hdfdd="TRUE" />
        </tapa.send>

        # Send TTI to apply the config
        <tapa.send>
           <tapa.tfu.tti.ind  TTI-Identity="1" numTti="1"/># tti 1
        </tapa.send>

        # Expect success in cfg cfm from Scheduler
         <tapa.expset>
          <tapa.rgr.cfgCfm status="15" instId="5"/>
         </tapa.expset>

      </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>


###############################################################################
#
#       Test:    22.16
#
#       Desc:   "Verify Configuration fails if periodicity of SRS reporting
#                is less than 10 for HD-FDD UE"
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.16" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
               "Verify Configuration fails if periodicity of SRS reporting
               is less than 10 for HD-FDD UE"
         </tapa.desc>

         <tapa.longdesc>
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
            <tapa.flag id="TFU_UPGRADE"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

      # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit numTxAntPorts ="2"/>

         #Finish RACH and then do UE Configuratrion
         <tapa.rg.rach/>

      </tapa.cfg>
      # Test Steps subsection
      <tapa.test>
        # Send UE config request at CRG
        <tapa.send>
           <tapa.crg.cfgreq.cfg.ue/>
        </tapa.send>
        # Expect success in cfg cfm from MAC
        <tapa.expect>
           <tapa.crg.cfgcfm/>
        </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

        <tapa.send>
          <tapa.rgr.cfgreq.cfg.ue instId="5" ueId="0"
            srsCfgPres ="TRUE" srsCfgIdx ="3" sANSrs="TRUE"
            hdfdd="TRUE"/>
        </tapa.send>

        # Send TTI to apply the config
        <tapa.send>
           <tapa.tfu.tti.ind  TTI-Identity="1" numTti="1"/># tti 1
        </tapa.send>

        # Expect success in cfg cfm from Scheduler
         <tapa.expset>
          <tapa.rgr.cfgCfm status="15" instId="5"/>
         </tapa.expset>

      </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.17
#
#       Desc:   "Verify scheduler should not schedule UP link data for sub frame
#                n, while n-4 sub frame is schedule for uplink data."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.17" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should not schedule UP link data for sub frame n,
            while n-4 sub frame is schedule for uplink data."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure UE with HD-FDD enabled.
                3. Configure DL logical channel 1, ul logical channel group 1
                   (only
                   one logical channel)
                4. Report BSR
                5. Allocate grants for uplink data for sub frame n-4
                6. UE transmit UP Link data in sub frame n-4
                7. Scheduler transmit DL HARQ Feed back at sub frame n.
                8. Scheduler should not schedule uplink data for sub frame n."
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

   # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit ulTotalBw="20"/>
         #Initialize UE
         <tapa.rg.UeInit hdfdd="TRUE"/>

      </tapa.cfg>

   # Test Steps subsection
      <tapa.test>

         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="1" numTti="1"/>#tti 1
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Send BO for the created logical channel on RGU.
         # This requests DL to be scheduled in n + 1
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/> # DATA (A)
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="2" numTti="1"/>#tti 2
         </tapa.send>

         <tapa.expect>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/> #For (A)
         </tapa.expect>

         # Send DDatReq for UE1 with size equal to the allocated size on RGU.
         <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9"
                     lcType="4"/># For (A)
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="3" numTti="1"/>#tti 3
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/> #For (A)
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>#For (A)
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="4 to 6" numTti="3"/>#tti 4 to 6
         </tapa.send>

         # Send SR Indication for default UE
        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/> #DATA (B)
           </tapa.tfu.sr.ind>
        </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="7" numTti="1"/>#tti 7
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>#For A
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="8" numTti="1"/>#tti 8
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                     vldtGrant="TRUE" vldtTx="TRUE"/> #For B
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="9 and 10" numTti="2"/>#tti 9 and 10
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0"/># For A
           </tapa.tfu.hq.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="11 and 12" numTti="2"/>#tti 11 and 12
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1"> #For B
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="13 to 15" numTti="3"/>#tti 13 to 15
         </tapa.send>

         #Send CRC for Msg
         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/># For B
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="16" numTti="1"/> #tti 16
         </tapa.send>

         # Expect HARQ ACK in PHICH
         <tapa.expect>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/> #For B
           </tapa.tfu.cntrl.req>
         </tapa.expect>

         # Send Data Indication using TB size recieved in the grant
         <tapa.send>
          <tapa.tfu.dat.ind datInds="1">
             <tapa.tfu.dat use="2" lcId="9"/> #For
          </tapa.tfu.dat.ind>
         </tapa.send>

         # Expect Data Indication at RLC
         <tapa.expect>
            <tapa.rgu.ddatind lchTb1Data="9,1" vldtBuf="TRUE"/>
         </tapa.expect>

         #Sending extra tti to make sure nothing is left
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="EXTRA" numTti="1"/> #tti Extra TTI
         </tapa.send>

      </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.18
#
#       Desc:   "Verify scheduler should not schedule UP link data for sub frame
#                n, while n+4 sub frame is schedule for uplink data. "
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.18" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should not schedule UP link data for sub frame n,
             while n+4 sub frame is schedule for uplink data. "
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure UE with HD-FDD enabled.
                3. Configure DL logical channel 1, ul logical channel group 1
                   (only one logical channel)
                4. Report BSR
                5. Allocate grants for uplink data for sub frame n+4
                6. UE transmit UP Link data in sub frame n+4
                7. Scheduler transmit DL HARQ Feed back at sub frame n.
                8. Scheduler should not schedule uplink data for sub frame n."
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
            <tapa.flag id="TFU_UPGRADE"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

      # Configuration subsection
      <tapa.cfg>


         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit numTxAntPorts ="2"/>

         #Finish RACH and then do UE Configuratrion
         <tapa.rg.rach/>

      </tapa.cfg>
      # Test Steps subsection
      <tapa.test>
        # Send UE config request at CRG
        <tapa.send>
           <tapa.crg.cfgreq.cfg.ue/>
        </tapa.send>
        # Expect success in cfg cfm from MAC
        <tapa.expect>
           <tapa.crg.cfgcfm/>
        </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

        # Send UE config request at RGR
        # At start of this step, we are at (2,1) and Reception Request Info time is (4,3)
        <tapa.send>
          <tapa.rgr.cfgreq.cfg.ue instId="5" ueId="0"
            srsCfgPres ="TRUE" srsCfgIdx ="40" sANSrs="TRUE"
            hdfdd="TRUE"/>
        </tapa.send>

         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

        # Send TTI to apply the config
        <tapa.send>
           <tapa.tfu.tti.ind  TTI-Identity="1" numTti="1"/># tti 1
        </tapa.send>

        # Expect success in cfg cfm from Scheduler
         <tapa.expset>
          <tapa.rgr.cfgCfm instId="5"/>
          <tapa.rgr.cfgCfm instId="5"/>
          <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="2 to 11" numTti="10"/># tti 2 to 11
         </tapa.send>

        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/>
           </tapa.tfu.sr.ind>
        </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12 to 13" numTti="2"/># tti 12 to 13
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                        vldtGrant="TRUE" vldtTx="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>


         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="14 to 17" numTti="4"/># tti 14 to 17
         </tapa.send>

         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1">
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="18 to 20" numTti="3"/># tti 18 to 20
         </tapa.send>

         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.expset>
            <tapa.tfu.recp.req >
               <tapa.tfu.srs.recp.req />
             </tapa.tfu.recp.req>
          </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="21" numTti="1"/># tti 21
         </tapa.send>

         <tapa.send>
          <tapa.tfu.dat.ind datInds="1">
             <tapa.tfu.dat use="2" lcId="9"/>
          </tapa.tfu.dat.ind>
         </tapa.send>

         <tapa.expset>
            <tapa.rgu.ddatind lchTb1Data="9,1" vldtBuf="TRUE"/>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

      </tapa.test>
      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.19
#
#       Desc:   "Verify scheduler should not schedule UP link data in sub frame
#                n, if down link data has been scheduled in sub frame "n-1"."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.19" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should not schedule UP link data in sub frame n,
            if down link data has been scheduled in sub frame "n-1"."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure UE with HD-FDD enabled.
                3. Configure DL logical channel 1, ul logical channel group 1
                   (only one logical channel)
                4. Report BSR
                5. Schedule downlink data in n-1.
                6. Schedule uplink grant for n.
                7. Scheduler should not schedule uplink data for sub frame n."
         </tapa.longdesc>

      </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
         <tapa.ifdef>
            <tapa.flag id="RGR_SI_SCH"/>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>
         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>
   </tapa.require>

      # Configuration subsection
   <tapa.cfg>

         # Layer Manager Configuration
         <tapa.rg.macInit/>

         # Cell Configuration
         <tapa.rg.cellInit ulTotalBw="100"  numTxAntPorts="2"/>
         <tapa.rg.UeInit ueId="0" hdfdd="TRUE"/>
         <tapa.rg.dbgDeInitAll/>
         <tapa.rg.dbgInitAll/>
   </tapa.cfg>

   <tapa.test>
         # Starting at 2,2
         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="1" numTti="1"/>#tti 2, 3
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expset>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         <tapa.send>
            # Send SI Configuration request for MIB
            <tapa.rgr.sicfgreq instId="5" bcchIdx="0" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_MIB" />
         </tapa.send>

         <tapa.expect>
            # Expect SI Cfg Cfm from MAC
            <tapa.rgr.sicfgcfm instId="5"/>
         </tapa.expect>

         # As MIB is at 4,0, we can consider this as n-1th subframe in this test cases.
         # IF we send SR indication in 3,4, for HD-FDD UE, this BO should get scheduled
         # in 4,1, But since 4,0 is DL, this should get scheduled in 4,2.
         # For this TFU should receive PDCCH Grant Tx request at 3,6, UL Recp Req at
         # 4,0, CRC Ind at 4,3, DDatInd and PHICH Tx req at 4,4

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="12" numTti="11"/> # tti 3,4
         </tapa.send>

        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/>
           </tapa.tfu.sr.ind>
        </tapa.send>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="14" numTti="2"/> # tti 3,6
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                     vldtGrant="TRUE" vldtTx="TRUE"/> #For A
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         # MIB is scheduled for 4,0, so expect Dat Request at 3,8
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="16" numTti="2"/> # tti 3,8
         </tapa.send>

         <tapa.expect>
            <tapa.tfu.dat.req>
               <tapa.tfu.bch.dat.req />
            </tapa.tfu.dat.req>
         </tapa.expect>

         # UL is expected at 4,2. Send Harq Recp request at 4,0
         # and send Harq Indication to MAC in 4,3
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="18" numTti="2"/> # tti 4,0
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1">
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>


         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="21" numTti="3"/>#tti 4,3
         </tapa.send>

         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="19" numTti="1"/>#tti 4,4
         </tapa.send>

         <tapa.send>
          <tapa.tfu.dat.ind datInds="1">
             <tapa.tfu.dat use="2" lcId="9"/>
          </tapa.tfu.dat.ind>
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
           </tapa.tfu.cntrl.req>
            <tapa.rgu.ddatind lchTb1Data="9,1" vldtBuf="TRUE"/>
         </tapa.expset>
   </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.20
#
#       Desc:   "Verify scheduler should schedule UP link data in sub frame n,
#                if -
#                Condition 1:  subframe n is not DL
#                Condition 1:  subframe n does not have any BCCH/PCCH occasions
#                Condition 2:  subframe n + 4 is not UL
#                Condition 3:  subframe n - 4 is not UL
#                Condition 4:  subframe n - 1 is not DL data"
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.20" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should schedule UP link data in sub frame n, if
                Condition 1:  subframe n is not DL
                Condition 1:  subframe n does not have any BCCH/PCCH occasions
                Condition 2:  subframe n + 4 is not UL
                Condition 3:  subframe n - 4 is not UL
                Condition 4:  subframe n - 1 is not DL data"
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure HD-FDD is enabled.
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (only one logical channel)
                4. Report BSR
                5. Schedule UL/DL data for next 10 subframes.
                6. Make sure that scheduling happens as per the UL scheduling
                   rules."
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

   # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit ulTotalBw="20"/>
         #Initialize UE
         <tapa.rg.UeInit hdfdd="TRUE"/>

      </tapa.cfg>

   # Test Steps subsection
      <tapa.test>

         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="1" numTti="1"/>#tti 1
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Send SR Indication for default UE
        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/> #DATA (A)
           </tapa.tfu.sr.ind>
        </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="2" numTti="1"/>#tti 2
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                     vldtGrant="TRUE" vldtTx="TRUE"/> #For A
           </tapa.tfu.cntrl.req>
         </tapa.expset>

        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/> #DATA (B)
           </tapa.tfu.sr.ind>
        </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="3" numTti="1"/>#tti 3
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                     vldtGrant="TRUE" vldtTx="TRUE"/> #For C
           </tapa.tfu.cntrl.req>
         </tapa.expset>

        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/> #DATA (C)
           </tapa.tfu.sr.ind>
        </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="4" numTti="1"/>#tti 4
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                     vldtGrant="TRUE" vldtTx="TRUE"/> #For C
           </tapa.tfu.cntrl.req>
         </tapa.expset>

        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/> #DATA (D)
           </tapa.tfu.sr.ind>
        </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="5" numTti="1"/>#tti 5
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                     vldtGrant="TRUE" vldtTx="TRUE"/> #For D
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="6" numTti="1"/>#tti 6
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1"> #For A
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="7" numTti="1"/>#tti 7
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1"> #For B
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="8" numTti="1"/>#tti 8
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1"> #For C
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="9" numTti="1"/>#tti 9
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1"> #For D
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/># For A
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="10" numTti="1"/>#tti 10
         </tapa.send>

         #Send CRC for Msg
         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/># For B
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
          <tapa.tfu.dat.ind datInds="1">
             <tapa.tfu.dat use="2" lcId="9"/> #For A
          </tapa.tfu.dat.ind>
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/> #For A
           </tapa.tfu.cntrl.req>
            <tapa.rgu.ddatind lchTb1Data="9,1" vldtBuf="TRUE"/>#For  A
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="11" numTti="1"/>#tti 11
         </tapa.send>

         #Send CRC for Msg
         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/># For C
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
          <tapa.tfu.dat.ind datInds="1">
             <tapa.tfu.dat use="2" lcId="9"/> #For B
          </tapa.tfu.dat.ind>
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/> #For B
           </tapa.tfu.cntrl.req>
            <tapa.rgu.ddatind lchTb1Data="9,1" vldtBuf="TRUE"/>#For  B
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12" numTti="1"/>#tti 12
         </tapa.send>

         #Send CRC for Msg
         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/># For D
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
          <tapa.tfu.dat.ind datInds="1">
             <tapa.tfu.dat use="2" lcId="9"/> #For C
          </tapa.tfu.dat.ind>
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/> #For C
           </tapa.tfu.cntrl.req>
            <tapa.rgu.ddatind lchTb1Data="9,1" vldtBuf="TRUE"/>#For  C
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="13" numTti="1"/>#tti 13
         </tapa.send>

         #Send CRC for Msg
         <tapa.send>
          <tapa.tfu.dat.ind datInds="1">
             <tapa.tfu.dat use="2" lcId="9"/> #For D
          </tapa.tfu.dat.ind>
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/> #For D
           </tapa.tfu.cntrl.req>
            <tapa.rgu.ddatind lchTb1Data="9,1" vldtBuf="TRUE"/> #For D
         </tapa.expset>

         #Sending extra tti to make sure nothing is left
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="EXTRA" numTti="1"/> #tti Extra TTI
         </tapa.send>

      </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.21
#
#       Desc:   "Verify scheduler should not schedule uplink data at sub frame
#                n if BCCH transmission is expecting at sub frame "n"."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.21" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should not schedule uplink data at sub frame n if
             BCCH transmission is expecting at sub frame "n"."
         </tapa.desc>

         <tapa.longdesc>
                "1. Configure BCCH data transmission instance at sub frame n
                2. SR Reported
                3. BSR Reported
                4. Scheduler should not schedule uplink data at sub frame n"
         </tapa.longdesc>

      </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
         <tapa.ifdef>
            <tapa.flag id="RGR_SI_SCH"/>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>
         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>
   </tapa.require>

      # Configuration subsection
   <tapa.cfg>

         # Layer Manager Configuration
         <tapa.rg.macInit/>

         # Cell Configuration
         <tapa.rg.cellInit ulTotalBw="100"  numTxAntPorts="2"/>
         <tapa.rg.UeInit ueId="0" hdfdd="TRUE"/>
         <tapa.rg.dbgDeInitAll/>
         <tapa.rg.dbgInitAll/>
   </tapa.cfg>

   <tapa.test>
         # Starting at 2,2
         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="23" numTti="1"/>#tti 2, 3
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expset>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         <tapa.send>
            # Send SI Configuration request for MIB
            <tapa.rgr.sicfgreq instId="5" bcchIdx="0" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_MIB" />
         </tapa.send>

         <tapa.expect>
            # Expect SI Cfg Cfm from MAC
            <tapa.rgr.sicfgcfm instId="5"/>
         </tapa.expect>

         # As MIB is at 4,0, we can consider this as nth subframe in this test cases.
         # IF we send SR indication in 3,3, for HD-FDD UE, this BO should get scheduled
         # in 4,0, But since 4,0 is DL, it cannot be scheduled in 4,0. even it cannot
         # be scheduled in 4,1 as this violates Guard Time requirement. So it should
         # IT should get scheduled in 4,2
         # For this TFU should receive PDCCH Grant Tx request at 3,6, UL Recp Req at
         # 4,0, CRC Ind at 4,3, DDatInd and PHICH Tx req at 4,4

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="33" numTti="10"/> # tti 3,3
         </tapa.send>

        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/>
           </tapa.tfu.sr.ind>
        </tapa.send>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="36" numTti="3"/> # tti 3,6
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                     vldtGrant="TRUE" vldtTx="TRUE"/> #For A
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         # MIB is scheduled for 4,0, so expect Dat Request at 3,8
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="38" numTti="2"/> # tti 3,8
         </tapa.send>

         <tapa.expect>
            <tapa.tfu.dat.req>
               <tapa.tfu.bch.dat.req />
            </tapa.tfu.dat.req>
         </tapa.expect>

         # UL is expected at 4,2. Send Harq Recp request at 4,0
         # and send Harq Indication to MAC in 4,3
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="40" numTti="2"/> # tti 4,0
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1">
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>


         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="43" numTti="3"/>#tti 4,3
         </tapa.send>

         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="44" numTti="1"/>#tti 4,4
         </tapa.send>

         <tapa.send>
          <tapa.tfu.dat.ind datInds="1">
             <tapa.tfu.dat use="2" lcId="9"/>
          </tapa.tfu.dat.ind>
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
           </tapa.tfu.cntrl.req>
            <tapa.rgu.ddatind lchTb1Data="9,1" vldtBuf="TRUE"/>
         </tapa.expset>
   </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.22
#
#       Desc:   "Verify scheduler should not schedule uplink re transmission
#                (adaptive) at sub frame n if BCCH transmission is expecting
#                at sub frame "n"."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.22" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should not schedule uplink re transmission
            (adaptive) at sub frame n if BCCH transmission is expecting
            at sub frame "n"."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1(SR is enabled, periodic CQI, SRS is enabled,
                   HD-FDD), Cell#1
                2. Configure BCCH data transmission instance at sub frame n
                3. SR Reported
                4. BSR Reported
                5. Scheduler should not schedule uplink data at sub frame n"
         </tapa.longdesc>

      </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
         <tapa.ifdef>
            <tapa.flag id="RGR_SI_SCH"/>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>
         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>
   </tapa.require>

      # Configuration subsection
   <tapa.cfg>

         # Layer Manager Configuration
         <tapa.rg.macInit/>

         # Cell Configuration
         <tapa.rg.cellInit ulTotalBw="100"  numTxAntPorts="2"/>
         <tapa.rg.UeInit ueId="0" hdfdd="TRUE"/>
         <tapa.rg.dbgDeInitAll/>
         <tapa.rg.dbgInitAll/>
   </tapa.cfg>

   <tapa.test>
         # Starting at 2,2
         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="23" numTti="1"/>#tti 2, 3
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expset>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         <tapa.send>
            # Send SI Configuration request for MIB
            <tapa.rgr.sicfgreq instId="5" bcchIdx="0" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_MIB" />
         </tapa.send>

         <tapa.expect>
            # Expect SI Cfg Cfm from MAC
            <tapa.rgr.sicfgcfm instId="5"/>
         </tapa.expect>

         # SR indication is sent at 2,5 so that UL happens on 3,2
         # Respective ACK/NACK is scheduled at 3,6, such that,
         # if NACK is to be sent at 3,6, Re-tx from UE can happen
         # in 4,0 (UL), this colides with scheduled MIB message
         # because of which no re-tx scheduling happens. Trigger for
         # re-tx is done by sending Failure CRC indication.
         # SR ind at 2,5, Grant req at 2,6, PUSCH Recp Req at 3,0
         # Crc Ind (Failure) at 3,3, Phich (Tx REq (ACK) at 3,4
         # BCH Tx Req at 3,8

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="25" numTti="2"/> # tti 2,5
         </tapa.send>

        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/>
           </tapa.tfu.sr.ind>
        </tapa.send>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="26" numTti="1"/> # tti 2,6
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         # UL is expected at 3,2. Send Harq Recp request at 3,0
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="30" numTti="4"/> # tti 3,0
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1">
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="33" numTti="3"/>#tti 3,3
         </tapa.send>

         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="TRUE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="34" numTti="1"/>#tti 3,4
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="38" numTti="2"/>#tti 3,8
         </tapa.send>
<!--
       #Periodic BSR timer expires. So DCI-0 grant is given.
         <tapa.expect>
           <tapa.tfu.cntrl.req numCntrlReq="1"/>
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                        vldtGrant="TRUE" vldtTx="TRUE"/>
         </tapa.expect>
-->
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="38" numTti="2"/>#tti 3,8
         </tapa.send>
         <tapa.expect>
            <tapa.tfu.dat.req>
               <tapa.tfu.bch.dat.req />
            </tapa.tfu.dat.req>
         </tapa.expect>
   </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.23
#
#       Desc:   "Verify scheduler sends ACK instead of NACK in subframe n if
#                n has BCCH occasion."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.23" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler sends ACK instead of NACK in subframe n if n has
            BCCH occasion."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1(SR is enabled, periodic CQI, SRS is enabled,
                  HD-FDD), Cell#1
                2. Configure BCCH data transmission instance at sub frame n
                3. SR Reported
                4. BSR Reported
                5. Scheduler should not schedule uplink data at sub frame n"
         </tapa.longdesc>

      </tapa.doc>


   # Require features and flags subsection
   <tapa.require>
         <tapa.ifdef>
            <tapa.flag id="RGR_SI_SCH"/>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>
         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>
   </tapa.require>

      # Configuration subsection
   <tapa.cfg>

         # Layer Manager Configuration
         <tapa.rg.macInit/>

         # Cell Configuration
         <tapa.rg.cellInit ulTotalBw="100"  numTxAntPorts="2"/>
         <tapa.rg.UeInit ueId="0" hdfdd="TRUE"/>
         <tapa.rg.dbgDeInitAll/>
         <tapa.rg.dbgInitAll/>
   </tapa.cfg>

   <tapa.test>
         # Starting at 2,2
         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="1" numTti="1"/>#tti 2, 3
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expset>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         <tapa.send>
            # Send SI Configuration request for MIB
            <tapa.rgr.sicfgreq instId="5" bcchIdx="0" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_MIB" />
         </tapa.send>

         <tapa.expect>
            # Expect SI Cfg Cfm from MAC
            <tapa.rgr.sicfgcfm instId="5"/>
         </tapa.expect>

         # SR indication is sent at 2,5 so that UL happens on 3,2
         # Respective ACK/NACK is scheduled at 3,6, such that,
         # if NACK is to be sent at 3,6, Re-tx from UE can happen
         # in 4,0 (UL), this colides with scheduled MIB message
         # because of which ACK is sent instead of NACK. Trigger for
         # re-tx is done by sending Failure CRC indication.
         # SR ind at 2,5, Grant req at 2,6, PUSCH Recp Req at 3,0
         # Crc Ind (Failure) at 3,3, Phich (Tx REq (ACK) at 3,4
         # BCH Tx Req at 3,8

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="2"/> # tti 2,5
         </tapa.send>

        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/>
           </tapa.tfu.sr.ind>
        </tapa.send>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="1"/> # tti 2,6
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                     vldtGrant="TRUE" vldtTx="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         # UL is expected at 3,2. Send Harq Recp request at 3,0
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="4"/> # tti 3,0
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1">
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="3"/>#tti 3,3
         </tapa.send>

         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="TRUE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="1"/>#tti 3,4
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="2"/>#tti 3,8
         </tapa.send>
<!--
       #Periodic BSR timer expires. So DCI-0 grant is given.
         <tapa.expect>
           <tapa.tfu.cntrl.req numCntrlReq="1"/>
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                        vldtGrant="TRUE" vldtTx="TRUE"/>
         </tapa.expect>
-->
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="2"/>#tti 3,8
         </tapa.send>

         <tapa.expect>
            <tapa.tfu.dat.req>
               <tapa.tfu.bch.dat.req />
            </tapa.tfu.dat.req>
         </tapa.expect>

         # Send Extra TTI to make sure that nothing gets 
         # scheduled as part of retransmission
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind numTti="1"/>#tti 3,8
         </tapa.send>

   </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.24
#
#       Desc:   "Verify scheduler should not schedule uplink re transmission
#                (adaptive) at sub frame n if PCCH transmission is expecting
#                at sub frame "n"."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.24" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should not schedule uplink re transmission
            (adaptive) at sub frame n if PCCH transmission is expecting
            at sub frame "n"."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1(SR is enabled, periodic CQI, SRS is enabled,
                   HD-FDD), Cell#1
                2. Configure BCCH data transmission instance at sub frame n
                3. SR Reported
                4. BSR Reported
                5. Scheduler should not schedule uplink data at sub frame n"
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

   # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit ulTotalBw="20"/>
         #Initialize UE
         <tapa.rg.UeInit hdfdd="TRUE"/>

      </tapa.cfg>

   # Test Steps subsection
      <tapa.test>

         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3" lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="1" numTti="1"/>#tti 1
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Send BO for PCCH
         <tapa.send>
            <tapa.rgu.cstarsp lcId="3" lcType="2" bo="41" sfOffset="8" />
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="24" numTti="1"/>#tti 2
         </tapa.send>

         # Send SR Indication for default UE for
        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/>
           </tapa.tfu.sr.ind>
        </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="27" numTti="3"/>#tti 5
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="28" numTti="1"/>#tti 5
         </tapa.send>

         <tapa.expset>
            <tapa.rgu.cstaind lcId="3"/>
         </tapa.expset>

         <tapa.send>
            <tapa.rgu.cdatreq bcchIdx="1" lcId="3" lcType="2" bufSize="41"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="29" numTti="1"/>#tti 7
         </tapa.send>

         #Expect Pdcch/Pdsch Tx Req for PCCH Data
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="2" bcchIdx="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="2" bcchIdx="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="31" numTti="2"/>#tti 9
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1">
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="34" numTti="3"/>#tti 12
         </tapa.send>

         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="35" numTti="1"/>#tti 13
         </tapa.send>

         <tapa.send>
          <tapa.tfu.dat.ind datInds="1">
             <tapa.tfu.dat use="2" lcId="9"/>
          </tapa.tfu.dat.ind>
         </tapa.send>


         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
           </tapa.tfu.cntrl.req>
            <tapa.rgu.ddatind lchTb1Data="9,1" vldtBuf="TRUE"/>
         </tapa.expset>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="35" numTti="1"/>#tti 13
         </tapa.send>
      </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.25
#
#       Desc:   "Verify scheduler sends ACK instead of NACK in subframe n if n
#                has PCCH occasion."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.25" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler sends ACK instead of NACK in subframe n if n has
             PCCH occasion."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure HD-FDD is enabled.
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (only one logical channel)
                4. Report BSR
                5. Schedule UL data for sub frame n
                6. Schedule DL in n+8
                7. UE sends erroneous data in n
                8. Check that ACK is sent at across TFU in subframe n+4"
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

   # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>
         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit ulTotalBw="20"/>
         #Initialize UE
         <tapa.rg.UeInit hdfdd="TRUE"/>

      </tapa.cfg>

   # Test Steps subsection
      <tapa.test>

         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3" lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="1" numTti="1"/>#tti 1
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Send SR Indication for default UE for
        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/>
           </tapa.tfu.sr.ind>
        </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="24" numTti="1"/>#tti 2
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="28" numTti="4"/>#tti 6
         </tapa.send>

         # Send BO for PCCH
         <tapa.send>
            <tapa.rgu.cstarsp lcId="3" lcType="2" bo="41" sfOffset="10" />
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1">
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="31" numTti="3"/>#tti 8
         </tapa.send>

         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="TRUE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="32" numTti="1"/>#tti 10
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="35" numTti="2"/>#tti 14
         </tapa.send>
<!--
       #Periodic BSR timer expires. So DCI-0 grant is given.
         <tapa.expect>
           <tapa.tfu.cntrl.req numCntrlReq="1"/>
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
                        vldtGrant="TRUE" vldtTx="TRUE"/>
         </tapa.expect>
-->
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="35" numTti="1"/>#tti 14
         </tapa.send>
         <tapa.expset>
            <tapa.rgu.cstaind lcId="3"/>
         </tapa.expset>

         <tapa.send>
            <tapa.rgu.cdatreq bcchIdx="1" lcId="3" lcType="2" bufSize="41"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="36" numTti="1"/>#tti 15
         </tapa.send>

         #Expect Pdcch/Pdsch Tx Req for PCCH Data
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="2" bcchIdx="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="2" bcchIdx="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>
      </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.26
#
#       Desc:   "Verify that if scheduler schedules all 10 subframes in
#                downlink or uplink, No conflict occurs and all HARQ and PDCCH
#                transfers are taken care."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.26" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify that if scheduler schedules all 10 subframes in downlink or
             uplink, No conflict occurs and all HARQ and PDCCH transfers are
             taken care."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Reconfigure HD-FDD is enabled.
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (only one logical channel)
                4. Report BSR
                5. Schedule UL/DL data for next 10 subframes.
                6. Make sure that scheduling happens as per the UL/DL scheduling
                   rules.
                  In this test case effective subframes actually scheduled
                  are 25"
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

   # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit ulTotalBw="20"/>
         #Initialize UE
         <tapa.rg.UeInit hdfdd="TRUE"/>

      </tapa.cfg>

   # Test Steps subsection
      <tapa.test>

         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="1" numTti="1"/>#tti 1
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Send SR Indication for default UE for
        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/>
           </tapa.tfu.sr.ind>
        </tapa.send>

         # Send a TTI to schedule SR
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="2" numTti="1"/>#tti 2
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="3 to 5" numTti="3"/>#tti 3 to 5
         </tapa.send>

         # Send BO for the created logical channel on RGU.
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="6" numTti="1"/>#tti 6
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
            <tapa.tfu.recp.req numRntis="1">
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         # Send DDatReq for UE1 with size equal to the allocated size on RGU.
        <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
         </tapa.send>

         # Send BO for the created logical channel on RGU.
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="7" numTti="1"/>#tti 7
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

        <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
         </tapa.send>

         # Send BO for the created logical channel on RGU.
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="8" numTti="1"/>#tti 8
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

        <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
         </tapa.send>

         # Send BO for the created logical channel on RGU.
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="9" numTti="1"/>#tti 9
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         #Send CRC for Msg
         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="10" numTti="1"/> #tti 10
         </tapa.send>

         # Expect HARQ ACK in PHICH
         <tapa.expect>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expect>

         # Send Data Indication using TB size recieved in the grant
         <tapa.send>
          <tapa.tfu.dat.ind datInds="1">
             <tapa.tfu.dat use="2" lcId="9"/>
          </tapa.tfu.dat.ind>
         </tapa.send>

         # Expect Data Indication at RLC
         <tapa.expect>
            <tapa.rgu.ddatind lchTb1Data="9,1" vldtBuf="TRUE"/>
         </tapa.expect>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="11" numTti="1"/> #tti 11
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12" numTti="1"/> #tti 12
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="13" numTti="1"/> #tti 13
         </tapa.send>

         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="14" numTti="1"/> #tti 14
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="15" numTti="1"/> #tti 15
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="16" numTti="1"/> #tti 16
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="17 and 18" numTti="2"/> #tti 17 and 18
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="19" numTti="1"/> #tti 19
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="20" numTti="1"/> #tti 20
         </tapa.send>

         <tapa.expset>
           <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="21" numTti="1"/> #tti 21
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
         <tapa.expset>
           <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="22" numTti="1"/> #tti 22
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
         <tapa.expset>
           <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="23" numTti="1"/> #tti 23
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="24" numTti="1"/> #tti 24 and 25
         </tapa.send>
<!--
       #Periodic BSR timer expires. So DCI-0 grant is given.
   <tapa.expect>
     <tapa.tfu.cntrl.req numCntrlReq="1"/>
        <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
             vldtGrant="TRUE" vldtTx="TRUE"/>
   </tapa.expect>
-->
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="25" numTti="1"/> #tti 24 and 25
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="26" numTti="1"/> #tti 26
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="27" numTti="1"/> #tti 27
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="28" numTti="1"/> #tti 28
         </tapa.send>
<!--
         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1">
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>
-->
         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="29" numTti="1"/> #tti 29
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="30" numTti="1"/> #tti 30
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

     </tapa.test>
      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.27
#
#       Desc:   "Verify that HD-FDD and FDD UEs can co-exist in a CELL."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.27" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify that HD-FDD and FDD UEs can co-exist in a CELL."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, UE#2 and Cell#1
                2. Reconfigure HD-FDD is enabled in UE#1
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (only one logical channel) for each UE
                4. Report BSR for both UEs
                5. Schedule UL/DL data for next 10 subframes. for both UEs
                6. Make sure that scheduling happens as per the UL/DL scheduling
                   rules for HD-FDD ue and normal scheduling happens for UE2"
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

   # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit ulTotalBw="20"/>
         #Initialize UE
         <tapa.rg.UeInit ueId="0" hdfdd="TRUE"/>
         <tapa.rg.UeInit ueId="1"/>

      </tapa.cfg>

   # Test Steps subsection
      <tapa.test>

         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcgId="0"
                        dir="3" lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="9" lcgId="0"
                        dir="3" lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="1" numTti="1"/>#tti 1
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expset>
            <tapa.rgr.cfgCfm instId="5"/>
            <tapa.rgr.cfgCfm instId="5"/>
            <tapa.rgr.cfgCfm instId="5"/>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         # Send SR Indication for default UE for DATA (A)
        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr ueId="0"/>
              <tapa.tfu.sr ueId="1"/>
           </tapa.tfu.sr.ind>
        </tapa.send>

         # Send a TTI to schedule SR
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="2" numTti="1"/>#tti 2
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="2">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" />
              <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" />
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="3 and 4" numTti="2"/>#tti 3 and 4
         </tapa.send>

         # Send BO for the created logical channel on RGU.
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.rgu.dstarsp ueId="1" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="5" numTti="1"/>#tti 5
         </tapa.send>

         # Expect data reception request
         <tapa.expect>
            <tapa.rgu.dstaind ueId="1" lchTb1Data="9" saveTo="5"/>
         </tapa.expect>

         # Send DDatReq for UE1 with size equal to the allocated size on RGU.
        <tapa.send>
            <tapa.rgu.ddatreq ueId="1" lchTb1Data="9" lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="6" numTti="1"/>#tti 6
         </tapa.send>

         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="5"/>
            <tapa.tfu.recp.req numRntis="1">
               <tapa.tfu.pusch.recp.req ueId="0" use="1" saveTo="3"/>
               <tapa.tfu.pusch.recp.req ueId="1" use="2" saveTo="4"/>
            </tapa.tfu.recp.req>

           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="5"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req ueId="1" use="5" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         # Send DDatReq for UE1 with size equal to the allocated size on RGU.
        <tapa.send>
            <tapa.rgu.ddatreq ueId="0" lchTb1Data="9" lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="7" numTti="1"/>#tti 7
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="6"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req ueId="0" use="6" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="8 and 9" numTti="2"/>#tti 8 and 9
         </tapa.send>

         #Send CRC for Msg
         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         #Send CRC for Msg
         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="10" numTti="1"/> #tti 10
         </tapa.send>

         # Expect HARQ ACK in PHICH
         <tapa.expect>
           <tapa.tfu.cntrl.req numCntrlReq="2">
              <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
              <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expect>

         # Send Data Indication using TB size recieved in the grant
         <tapa.send>
          <tapa.tfu.dat.ind datInds="1">
             <tapa.tfu.dat ueId="0" use="3" lcId="9"/>
             <tapa.tfu.dat ueId="1" use="4" lcId="9"/>
          </tapa.tfu.dat.ind>
         </tapa.send>

         # Expect Data Indication at RLC
         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="1"/>
           </tapa.tfu.recp.req>
            <tapa.rgu.ddatind ueId="0" lchTb1Data="9,1" vldtBuf="TRUE"/>
            <tapa.rgu.ddatind ueId="1" lchTb1Data="9,1" vldtBuf="TRUE"/>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="11" numTti="1"/> #tti 11
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12" numTti="1"/># tti 12 and 13
         </tapa.send>
<!--
       #Periodic BSR timer expires. So DCI-0 grant is given.
   <tapa.expect>
     <tapa.tfu.cntrl.req numCntrlReq="2"/>
        <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
             vldtGrant="TRUE" vldtTx="TRUE"/>
   </tapa.expect>
-->
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="13" numTti="1"/># tti 12 and 13
         </tapa.send>
         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="1"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="14" numTti="1"/># tti 14
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         #Sending extra tti to make sure nothing is left
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="EXTRA" numTti="1"/> #tti Extra TTI
         </tapa.send>
     </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.28
#
#       Desc:   "Verify that more than one HD-FDD UEs can be supported."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.28" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify that more than one HD-FDD UEs can be supported."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, UE#2 and Cell#1
                2. Reconfigure HD-FDD is enabled for both UEs
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (only one logical channel) for each UE
                4. Report BSR for both UEs
                5. Schedule UL/DL data for next 15 subframes. for both UEs
                6. Make sure that scheduling happens as per the UL/DL scheduling
                    rules for all HD-FDD ues"
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

   # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit ulTotalBw="20"/>
         #Initialize UE
         <tapa.rg.UeInit ueId="0" hdfdd="TRUE"/>
         <tapa.rg.UeInit ueId="1" hdfdd="TRUE"/>

      </tapa.cfg>

   # Test Steps subsection
      <tapa.test>

         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcgId="0" dir="3" lcType="4" ulQci="8"/>
         </tapa.send>

         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="9" lcgId="0" dir="3" lcType="4" ulQci="8"/>
         </tapa.send>


         # Expect configuration confirm after the TTI
         <tapa.expset>
            <tapa.crg.cfgcfm/>
            <tapa.crg.cfgcfm/>
         </tapa.expset>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="9" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>


         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="0" instId="5"/>
         </tapa.send>
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="0" instId="5"/>
         </tapa.send>


         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="1" numTti="1"/>#tti 1
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expset>
            <tapa.rgr.cfgCfm instId="5"/>
            <tapa.rgr.cfgCfm instId="5"/>
            <tapa.rgr.cfgCfm instId="5"/>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         # Send SR Indication for default UE for DATA (A)
        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr ueId="0" />
              <tapa.tfu.sr ueId="1" />
           </tapa.tfu.sr.ind>
        </tapa.send>

         # Send a TTI to schedule SR
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="2" numTti="1"/>#tti 2
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="2">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE"
                        vldtGrant="TRUE" vldtTx="TRUE"/>
              <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE"
                        vldtGrant="TRUE" vldtTx="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="3 and 4" numTti="2"/>#tti 3 and 4
         </tapa.send>

         # Send BO for the created logical channel on RGU.
         # This requests DL to be scheduled in n
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.rgu.dstarsp ueId="1" lcId="9" lcType="4" bo="10"/>
         </tapa.send>


         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="5 and 6" numTti="2"/>#tti 5 and 6
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="5"/>
            <tapa.rgu.dstaind ueId="1" lchTb1Data="9" saveTo="6"/>
            <tapa.tfu.recp.req numRntis="1">
               <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="3"/>
               <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="4"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         # Send DDatReq for UE1 with size equal to the allocated size on RGU.
        <tapa.send>
            <tapa.rgu.ddatreq ueId="0" lchTb1Data="9" lcId="9" lcType="4"/>
         </tapa.send>

        <tapa.send>
            <tapa.rgu.ddatreq ueId="1" lchTb1Data="9" lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="7" numTti="1"/>#tti 7
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="2">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="5"/>
              <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="6"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="2">
       #This is Scheduled for actual air tx in 10, Hq is at 14, RecpReq at 12
              <tapa.tfu.pdsch.dat.req ueId="0" use="5" numSdu="1"/>
              <tapa.tfu.pdsch.dat.req ueId="1" use="6" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="8 and 9" numTti="2"/>#tti 8 and 9
         </tapa.send>

         #Send CRC for Msg
         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
               <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="10" numTti="1"/> #tti 10
         </tapa.send>

         # Expect HARQ ACK in PHICH
         <tapa.expect>
           <tapa.tfu.cntrl.req numCntrlReq="2">
              <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
              <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expect>

         # Send Data Indication using TB size recieved in the grant
         <tapa.send>
          <tapa.tfu.dat.ind datInds="2">
             <tapa.tfu.dat ueId="0" use="3" lcId="9"/>
             <tapa.tfu.dat ueId="1" use="4" lcId="9"/>
          </tapa.tfu.dat.ind>
         </tapa.send>

         # Expect Data Indication at RLC
         <tapa.expset>
            <tapa.rgu.ddatind ueId="0" lchTb1Data="9,1" vldtBuf="TRUE"/>
            <tapa.rgu.ddatind ueId="1" lchTb1Data="9,1" vldtBuf="TRUE"/>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="11" numTti="1"/> #tti 11
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="2">
              <tapa.tfu.hq.recp.req ueId="0"/>
              <tapa.tfu.hq.recp.req ueId="1"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12, 13, 14"
                           numTti="1"/> #tti 12, 13 and 14
         </tapa.send>
<!--
       #Periodic BSR timer expires. So DCI-0 grant is given.
   <tapa.expect>
     <tapa.tfu.cntrl.req numCntrlReq="2"/>
        <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
             vldtGrant="TRUE" vldtTx="TRUE"/>
   </tapa.expect>
-->
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12, 13, 14"
                           numTti="2"/> #tti 12, 13 and 14
         </tapa.send>
         <tapa.send>
           <tapa.tfu.hq.ind hqInds="2">
              <tapa.tfu.hq ueId="0"/>
              <tapa.tfu.hq ueId="1"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         #Sending extra tti to make sure nothing is left
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="EXTRA" numTti="1"/> #tti Extra TTI
         </tapa.send>

     </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.29
#
#       Desc:   "Verify that more than one HD-FDD and FDD UEs can co-exist in a
#               CELL."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.29" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify that more than one HD-FDD and FDD UEs can co-exist
            in a CELL."
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, UE#2, UE#3, UE#4 and Cell#1
                2. Reconfigure HD-FDD is enabled in UE1, UE2
                3. Configure DL logical Channel 1, UL logical channel group 1
                   (only one logical channel) for each UE
                4. Report BSR for all UEs
                5. Schedule UL/DL data for next 10 subframes for all UEs
                6. Make sure that scheduling happens as per the UL/DL scheduling
                   rules for UE1 and UE2  and normal scheduling happens for
                   UE3 and UE4"
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
            <tapa.flag id="LTEMAC_RGU_PAD"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

   # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         # <tapa.rg.cellInit ulTotalBw="100"/>
         <tapa.rg.cellInit ulTotalBw="100" maxDlUeNewTxPerTti="4" maxUlUeNewTxPerTti="4"
                       maxUePerDlSf="4"/>
         #Initialize UE
         <tapa.rg.UeInit ueId="0" hdfdd="TRUE"/>
         <tapa.rg.UeInit ueId="1"/>
         <tapa.rg.UeInit ueId="2" hdfdd="TRUE"/>
         <tapa.rg.UeInit ueId="3"/>

      </tapa.cfg>

   # Test Steps subsection
      <tapa.test>

         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcgId="0" dir="3" lcType="4" ulQci="8"/>
         </tapa.send>
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="9" lcgId="0" dir="3" lcType="4" ulQci="8"/>
         </tapa.send>
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="9" lcgId="0" dir="3" lcType="4" ulQci="8"/>
         </tapa.send>
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch ueId="3" lcId="9" lcgId="0" dir="3" lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expset>
            <tapa.crg.cfgcfm/>
            <tapa.crg.cfgcfm/>
            <tapa.crg.cfgcfm/>
            <tapa.crg.cfgcfm/>
         </tapa.expset>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="9" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch ueId="2" lcId="9" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch ueId="3" lcId="9" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="0" instId="5"/>
         </tapa.send>
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="0" instId="5"/>
         </tapa.send>
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg ueId="2" lcgId="0" instId="5"/>
         </tapa.send>
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg ueId="3" lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="1" numTti="1"/>#tti 1
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expset>
            <tapa.rgr.cfgCfm instId="5"/>
            <tapa.rgr.cfgCfm instId="5"/>
            <tapa.rgr.cfgCfm instId="5"/>
            <tapa.rgr.cfgCfm instId="5"/>
            <tapa.rgr.cfgCfm instId="5"/>
            <tapa.rgr.cfgCfm instId="5"/>
            <tapa.rgr.cfgCfm instId="5"/>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         # Send SR Indication for default UE for DATA (A)
        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr ueId="0"/>
              <tapa.tfu.sr ueId="1"/>
              <tapa.tfu.sr ueId="2"/>
              <tapa.tfu.sr ueId="3"/>
           </tapa.tfu.sr.ind>
        </tapa.send>

         # Send a TTI to schedule SR
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="2" numTti="1"/>#tti 2
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="4">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" />
              <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" />
              <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="3" isUlGrant="TRUE" />
              <tapa.tfu.pdcch.cntrl.req ueId="3" saveTo="4" isUlGrant="TRUE" />
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="3 and 4" numTti="2"/>#tti 3 and 4
         </tapa.send>

         # Send BO for the created logical channel on RGU.
         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>
         <tapa.send>
            <tapa.rgu.dstarsp ueId="1" lcId="9" lcType="4" bo="10"/>
         </tapa.send>
         <tapa.send>
            <tapa.rgu.dstarsp ueId="2" lcId="9" lcType="4" bo="10"/>
         </tapa.send>
         <tapa.send>
            <tapa.rgu.dstarsp ueId="3" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="5" numTti="1"/>#tti 5
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.rgu.dstaind ueId="1" lchTb1Data="9" saveTo="10"/>
            <tapa.rgu.dstaind ueId="3" lchTb1Data="9" saveTo="10"/>
         </tapa.expset>

         # Send DDatReq for UE1 with size equal to the allocated size on RGU.
        <tapa.send>
            <tapa.rgu.ddatreq ueId="1" lchTb1Data="9" lcId="9" lcType="4"/>
            <tapa.rgu.ddatreq ueId="3" lchTb1Data="9" lcId="9" lcType="4"/>
         </tapa.send>

          <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="6" numTti="1"/>#tti 6
         </tapa.send>
         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="10"/>
            <tapa.rgu.dstaind ueId="2" lchTb1Data="9" saveTo="10"/>
            <tapa.tfu.cntrl.req numCntrlReq="2">
               <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="11"/>
               <tapa.tfu.pdcch.cntrl.req ueId="3" saveTo="12"/>
            </tapa.tfu.cntrl.req>
            <tapa.tfu.recp.req numRntis="1">
               <tapa.tfu.pusch.recp.req ueId="0" use="1" saveTo="5"/>
               <tapa.tfu.pusch.recp.req ueId="1" use="2" saveTo="6"/>
               <tapa.tfu.pusch.recp.req ueId="2" use="3" saveTo="7"/>
               <tapa.tfu.pusch.recp.req ueId="3" use="4" saveTo="8"/>
            </tapa.tfu.recp.req>
           <tapa.tfu.dat.req datReqs="2">
             <tapa.tfu.pdsch.dat.req ueId="1" use="11" numSdu="1"/>
              <tapa.tfu.pdsch.dat.req ueId="3" use="12" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         # Send DDatReq for UE1 with size equal to the allocated size on RGU.
        <tapa.send>
            <tapa.rgu.ddatreq ueId="0" lchTb1Data="9" lcId="9" lcType="4"/>
            <tapa.rgu.ddatreq ueId="2" lchTb1Data="9" lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="7" numTti="1"/>#tti 7
         </tapa.send>

         # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="2">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="13"/>
              <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="14"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="2">
              <tapa.tfu.pdsch.dat.req ueId="0" use="13" numSdu="1"/>
              <tapa.tfu.pdsch.dat.req ueId="2" use="14" numSdu="1"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="8 and 9" numTti="2"/>#tti 8 and 9
         </tapa.send>

         #Send CRC for Msg
         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
               <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
               <tapa.tfu.crc ueId="2" isFailure="FALSE"/>
               <tapa.tfu.crc ueId="3" isFailure="FALSE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="10" numTti="1"/> #tti 10
         </tapa.send>

         # Expect HARQ ACK in PHICH
         <tapa.expect>
           <tapa.tfu.cntrl.req numCntrlReq="4">
              <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
              <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
              <tapa.tfu.phich.cntrl.req ueId="2" isAck="TRUE"/>
              <tapa.tfu.phich.cntrl.req ueId="3" isAck="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expect>

         # Send Data Indication using TB size recieved in the grant
         <tapa.send>
          <tapa.tfu.dat.ind datInds="4">
             <tapa.tfu.dat ueId="0" use="5" lcId="9"/>
             <tapa.tfu.dat ueId="1" use="6" lcId="9"/>
             <tapa.tfu.dat ueId="2" use="7" lcId="9"/>
             <tapa.tfu.dat ueId="3" use="8" lcId="9"/>
          </tapa.tfu.dat.ind>
         </tapa.send>

         # Expect Data Indication at RLC
         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="1"/>
              <tapa.tfu.hq.recp.req ueId="3"/>
           </tapa.tfu.recp.req>
            <tapa.rgu.ddatind ueId="0" lchTb1Data="9,1" vldtBuf="TRUE"/>
            <tapa.rgu.ddatind ueId="1" lchTb1Data="9,1" vldtBuf="TRUE"/>
            <tapa.rgu.ddatind ueId="2" lchTb1Data="9,1" vldtBuf="TRUE"/>
            <tapa.rgu.ddatind ueId="3" lchTb1Data="9,1" vldtBuf="TRUE"/>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="11" numTti="1"/> #tti 11
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
              <tapa.tfu.hq.recp.req ueId="2"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12, 13" numTti="1"/># tti 12 and 13
         </tapa.send>
<!--
       #Periodic BSR timer expires. So DCI-0 grant is given.
   <tapa.expect>
     <tapa.tfu.cntrl.req numCntrlReq="2"/>
        <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE"
             vldtGrant="TRUE" vldtTx="TRUE"/>
   </tapa.expect>
-->
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12, 13" numTti="1"/># tti 12 and 13
         </tapa.send>
         <tapa.send>
           <tapa.tfu.hq.ind hqInds="2">
              <tapa.tfu.hq ueId="1"/>
              <tapa.tfu.hq ueId="3"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="14" numTti="1"/># tti 14
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="2">
              <tapa.tfu.hq ueId="0"/>
              <tapa.tfu.hq ueId="2"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         #Sending extra tti to make sure nothing is left
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="EXTRA" numTti="1"/> #tti Extra TTI
         </tapa.send>
     </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>



###############################################################################
#
#       Test:    22.30
#
#       Desc:   "Verify Configuration fails if periodicity of SR reporting
#                is less than 10 for HD-FDD UE"
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.30" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
               "Verify Configuration fails if periodicity of SR reporting
               is less than 10 for HD-FDD UE"
         </tapa.desc>

         <tapa.longdesc>
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
            <tapa.flag id="TFU_UPGRADE"/>
         </tapa.ifdef>

         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

      # Configuration subsection
      <tapa.cfg>

         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit numTxAntPorts ="2"/>

         #Finish RACH and then do UE Configuratrion
         <tapa.rg.rach/>

      </tapa.cfg>
      # Test Steps subsection
      <tapa.test>
        # Send UE config request at CRG
        <tapa.send>
           <tapa.crg.cfgreq.cfg.ue/>
        </tapa.send>
        # Expect success in cfg cfm from MAC
        <tapa.expect>
           <tapa.crg.cfgcfm/>
        </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

        <tapa.send>
          <tapa.rgr.cfgreq.cfg.ue instId="5" ueId="0"
            srCfgPres ="TRUE" srCfgIdx ="4"  UeReCfgType="16384"
            hdfdd="TRUE"/>
        </tapa.send>

        # Send TTI to apply the config
        <tapa.send>
           <tapa.tfu.tti.ind  TTI-Identity="1" numTti="1"/># tti 1
        </tapa.send>

        # Expect success in cfg cfm from Scheduler
         <tapa.expset>
          <tapa.rgr.cfgCfm status="15" instId="5"/>
         </tapa.expset>

      </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

###############################################################################
#
#       Test:    22.31
#
#       Desc:   "Verify down link data and BCCH data can be scheduled in same
#                subframe."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
<tapa.testcase id="22.31" >

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Verify down link data and BCCH data can be scheduled in same
          subframe."
      </tapa.desc>

      <tapa.longdesc>
         "   1. Configure UE#1, Cell#1
             2. Reconfigure HD-FDD is enabled.
             3. Configure DL logical Channel 1, UL logical channel group 1
                (only one logical channel)
             4. Report BSR
             5. Schedule UL/DL data for next 10 subframes.
             6. RLC Report BO status for DL data, make sure that scheduling
                  happens as per the DL scheduling rules."
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="LTEMAC_HDFDD"/>
         <tapa.flag id="RGR_SI_SCH"/>
      </tapa.ifdef>

      <tapa.ifndef>
      </tapa.ifndef>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>


      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueId="0" hdfdd="TRUE"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1"
         dlQci="3" dlGbr="1000" dlMbr="2000"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="0" lcId="9" lcType="4"
         dir="1" dlQci="3" dlGbr="1000" dlMbr="2000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied.
      <tapa.send>
         <tapa.tfu.tti.ind/> #tti 1 (2,3)
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         # Send SI Configuration request for MIB
         <tapa.rgr.sicfgreq instId="5" bcchIdx="0" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_MIB" />
      </tapa.send>

      <tapa.expect>
         # Expect SI Cfg Cfm from MAC
         <tapa.rgr.sicfgcfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="13"/> #tti 1 (3,6)
      </tapa.send>

      # Send BO for the created logical channel on RGU.
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/> # DATA (A)
      </tapa.send>

      # Send a Tti to get the transmission scheduled.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/> #tti 2 (3,7)
      </tapa.send>

      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/> #For (A)
      </tapa.expect>

      # Send DDatReq for UE1 with size equal to the allocated size on RGU.
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9"
                  lcType="4"/># For (A)
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1" /> #tti 3 (3,8)
      </tapa.send>

      <tapa.expset>
        # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/> #For (A)
        </tapa.tfu.cntrl.req>
        <tapa.tfu.dat.req datReqs="2">
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>#For (A)
           <tapa.tfu.bch.dat.req />
        </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="4" numTti="4"/> #tti 4
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.recp.req numRntis="1">
            # This Hq f/b is received at 9(Air) and indicated in 10
           <tapa.tfu.hq.recp.req ueId="0"/>#For (A)
        </tapa.tfu.recp.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind TTI-Identity="8" numTti="3"/> #tti 8
      </tapa.send>

      <tapa.send>
        <tapa.tfu.hq.ind hqInds="1">
           <tapa.tfu.hq ueId="0"/># For (A)
        </tapa.tfu.hq.ind>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      # Layer Manager ShutDown
   </tapa.shutdown>
</tapa.testcase>

###############################################################################
#
#       Test:    22.32
#
#       Desc:   "Verify scheduler should schedule uplink re transmission
#                at sub frame n if no BCCH transmission is expecting
#                at sub frame "n"."
#
#       Notes:   None
#
#       Module:  Half Duplex FDD
#
#       File:    rgac_tc22.xml
#
################################################################################
   <tapa.testcase id="22.32" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
            "Verify scheduler should schedule uplink re transmission
            (adaptive) at sub frame n if no BCCH transmission is expecting
            at sub frame "n"."
         </tapa.desc>

         <tapa.longdesc>
                5. Scheduler should not schedule uplink data at sub frame n"
         </tapa.longdesc>

      </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
         <tapa.ifdef>
            <tapa.flag id="LTEMAC_HDFDD"/>
         </tapa.ifdef>
         <tapa.ifndef>
         </tapa.ifndef>
         <tapa.mode mode="single"/>
   </tapa.require>

      # Configuration subsection
   <tapa.cfg>

         # Layer Manager Configuration
         <tapa.rg.macInit/>

         # Cell Configuration
         <tapa.rg.cellInit ulTotalBw="100"  numTxAntPorts="2"/>
         <tapa.rg.UeInit ueId="0" hdfdd="TRUE"/>
         <tapa.rg.dbgDeInitAll/>
         <tapa.rg.dbgInitAll/>
   </tapa.cfg>

   <tapa.test>
         # Starting at 2,2
         <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Send TTI indication for default cell
         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="23" numTti="1"/>#tti 2, 3
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expset>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # SR indication is sent at 2,5 so that UL happens on 3,2
         # Respective ACK/NACK is scheduled at 3,6, such that,
         # if NACK is to be sent at 3,6, Re-tx from UE can happen
         # in 4,0 (UL), this colides with scheduled MIB message
         # because of which no re-tx scheduling happens. Trigger for
         # re-tx is done by sending Failure CRC indication.
         # SR ind at 2,5, Grant req at 2,6, PUSCH Recp Req at 3,0
         # Crc Ind (Failure) at 3,3, Phich (Tx REq (ACK) at 3,4
         # BCH Tx Req at 3,8

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="25" numTti="2"/> # tti 2,5
         </tapa.send>

        <tapa.send>
           <tapa.tfu.sr.ind>
              <tapa.tfu.sr/>
           </tapa.tfu.sr.ind>
        </tapa.send>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="26" numTti="1"/> # tti 2,6
         </tapa.send>

         # Expect DCI format 0 and do basic validations of the grant
         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         # UL is expected at 3,2. Send Harq Recp request at 3,0
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="30" numTti="4"/> # tti 3,0
         </tapa.send>

         # Expect data reception request
         <tapa.expset>
            <tapa.tfu.recp.req numRntis="1">
               <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
            </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="33" numTti="3"/>#tti 3,3
         </tapa.send>

         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="TRUE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>

         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="34" numTti="1"/>#tti 3,4
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.phich.cntrl.req isAck="FALSE"/>
           </tapa.tfu.cntrl.req>
         </tapa.expset>

         /* Send extra TTI so that nothing is recieved
         <tapa.send lc="TRUE">
            <tapa.tfu.tti.ind TTI-Identity="EXTRA" numTti="1"/>#tti 3,4
         </tapa.send>


   </tapa.test>

      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

# DO NOT DELETE THIS LINE -- TC number generation script depends on it.
# xyzabcend
#/********************************************************************30**
#
#         End of file:
#
#*********************************************************************31*/
#/**********************************************************************
#        Revision History:
#
#**********************************************************************/
#/********************************************************************90**
# 
#     ver       pat    init                  description
#------------ -------- ---- ----------------------------------------------
#$SID$         ---     ps   1. Initial Release.
#$SID$        ---     gvj  1. LTE MAC 3.1 Release
#$SID$        rg001.301 nudupi 1.Added the Changes for the CR ccpu00119023. 
#$SID$        rg002.301 asehgal 1.Modified change note. 
#$SID$      ---        rt  1. LTE MAC 4.1 Release
#*********************************************************************91*/
#
