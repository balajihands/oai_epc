#
#/********************************************************************20**
#
#     Name:    LTE-MAC 
#
#     Type:    XML Test File
#
#     Desc:    XML Based Test Cases For TDD 
#
#     File:    rgac_tc34.xml
#
#     Sid:      rgac_tc34.xml@@/main/1 - Thu Mar 26 01:11:03 2009
#
#     Prg:     ns 
#
#*********************************************************************21*/


#
#
#       Test:    34.1
#
#
#       Desc:    Validate DCFI UT Stub for config type 2
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#

<tapa.testcase id="34.1">
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "TDD Configuration 2 DCFI UT stub execution"
      </tapa.desc>

      <tapa.longdesc>
         "TDD Configuration 2 DCFI UT stub execution"
      </tapa.longdesc>
         
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>
      <tapa.rg.dbgInitAll/>

      #Initialize CELL
	  <tapa.rg.cellInit ulDlCfgIdx="2"  isDynCfiEnb="TRUE"/>

   </tapa.cfg>


   # Test Steps subsection
   <tapa.test>
      <tapa.dcfi.stub/>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.2
#
#
#       Desc:    Validate DCFI UT Stub for config type 1
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#

<tapa.testcase id="34.2">
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "TDD Configuration 1 DCFI UT stub execution"
      </tapa.desc>

      <tapa.longdesc>
         "TDD Configuration 1 DCFI UT stub execution"
      </tapa.longdesc>
         
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>
      <tapa.rg.dbgInitAll/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
	  <tapa.rg.cellInit ulDlCfgIdx="1" />

   </tapa.cfg>


   # Test Steps subsection
   <tapa.test>
      <tapa.dcfi.stub/>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.3
#
#
#       Desc:    Validate cell reconfiguration of DCFI 
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#

<tapa.testcase id="34.3">
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "Validate cell reconfiguration of DCFI"
      </tapa.desc>

      <tapa.longdesc>
         "Validate cell reconfiguration of DCFI"
      </tapa.longdesc>
         
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>
      <tapa.rg.dbgInitAll/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
	  <tapa.rg.cellInit ulDlCfgIdx="1" />
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      #Do the cell reconfiguration
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" recfgType="16384" isDynCfiEnb="TRUE"/>
      </tapa.send>
      
	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

	  <tapa.expect>
	     <tapa.rgr.cfgCfm instId="5" />
      </tapa.expect>

	  #Do the cell reconfiguration
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" recfgType="16384" isDynCfiEnb="FALSE"/>
      </tapa.send>
      
	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

	  <tapa.expect>
	     <tapa.rgr.cfgCfm instId="5" />
      </tapa.expect>

      <tapa.dcfi.stub/>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.4 DCFI_CMN_44 DCFI_CMN_84 (Config type 2)
#
#
#       Desc:    Validate that CFI changes after cell reconfiguration(DCFI enable to disable) 
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.4">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="DwPts"/>

      <tapa.desc>
            "Validate that CFI changes after cell reconfiguration(DCFI enable to disable)"
      </tapa.desc>

      <tapa.longdesc>
            "Validate that CFI changes after cell reconfiguration(DCFI enable to disable)"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgInitErr/>
      #<tapa.rg.dbgInitParm/>
      #<tapa.rg.dbgInitInfo/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched.tddsplraocc ulDlCfgIdx="2" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="TRUE" cfi="2"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      
      # [0, 2] 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="3" numRapId="1" rapIds="5" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
     
      # [0, 4] 
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="3"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
     
      # Send extra TTI to be sure that there is no unexpected
      # scheduling
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>

	  # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req numRntis="1" spId="1">
            <tapa.tfu.msg3.recp.req/>
         </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   #Send CRC for Msg3
   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="0"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>

	  # Expect Message3 datReq on CCCH at RGU.
      <tapa.expect>
         <tapa.rgu.cdatind ueId="0" lcId="4"/>
      </tapa.expect>

	  
   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   # Expect HARQ ACK in PHICH For MSG3
   <tapa.expect>
      <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

   # Send BO for Msg4 on RGU.
    <tapa.send>
       <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10"/>
    </tapa.send>

	<tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect CStatInd For MSG4
   <tapa.expset>
      <tapa.rgu.cstaind lcId="4"/>
   </tapa.expset>

   # Send Msg4 on RGU.
   <tapa.send>
      <tapa.rgu.cdatreq ueId="0" lcId="4" lcType="3" />
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect Msg4 from MAC to PHY.
   <tapa.expset>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req use="1" validate="FALSE"/>
     </tapa.tfu.dat.req>
     <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="6"/>
   </tapa.send>

   # Recv Hq Recp Req for Msg4.
   <tapa.expect>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req vldtNp="TRUE" np="1"/>
     </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   # Send ACK as feedback for Msg4.
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAckLst="TRUE:FALSE:FALSE:FALSE"/>
     </tapa.tfu.hq.ind>
  </tapa.send>

  # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
     <tapa.rgr.cfgreq.cfg.ue instId="5" />
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>

   #Till now RACH and basic UE context is setup
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>

      # Configure bi-directional DTCH for default UE
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="5"/>
      </tapa.send>
      #Sub-frame 3

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>

	 # Send TTI(s) to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 7
	  
      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset> #GB
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expset>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 0

      # Expect data reception request
      <tapa.expect> #RB
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 5

      # Send Data Indication using TB size recieved in the grant
	  # Send Data Indication using TB size recieved in the grant
      <tapa.send> #BSR=B
         <tapa.tfu.dat.ind datInds="1">
            <tapa.tfu.dat  ueId="0" use="2"
               addShortBsr="TRUE" lcgId="0" bsr="40" />
         </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 7

      # Expect HARQ ACK in PHICH
      <tapa.expect> #AB/G1
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 8

	  #Do the cell reconfiguration
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" recfgType="16384" isDynCfiEnb="FALSE"/>
      </tapa.send>
      
	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

	  <tapa.expect>
	     <tapa.rgr.cfgCfm instId="5" />
      </tapa.expect>
      #Sub-frame 9

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 0


      # Expect data reception request
      <tapa.expect> #R1
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 2

	  <tapa.expect> #G2
        <tapa.tfu.cntrl.req expCntrlReq="1">
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 5

	  # Expect data reception request
      <tapa.expect> #R2
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="3"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send> #D1
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="2" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 7

	  <tapa.expect> #A1/G3
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 9

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 0

	  <tapa.send> #D2
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

	  <tapa.expect> #R3
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

      # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 2

	  <tapa.expect> #A2/G4
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"  cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 5

	  # Expect data reception request
      <tapa.expect> #R4
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="3"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send> #D3
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="2" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 7

	  <tapa.expect> #A3/G5
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"  cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 9

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 0

	  # Expect data reception request
      <tapa.expect> #R5
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send> #D4
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 2

	  <tapa.expect> #A4/G6
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"  cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

   </tapa.test>


   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.5 DCFI_TDD_24
#
#
#       Desc:    Validate that switchover window length is 2 for config 2 
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.5">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="DwPts"/>

      <tapa.desc>
            "Validate switchover window for config 2"
      </tapa.desc>

      <tapa.longdesc>
            "Validate switchover window for config 2"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgInitErr/>
      #<tapa.rg.dbgInitParm/>
      #<tapa.rg.dbgInitInfo/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched.tddsplraocc ulDlCfgIdx="2" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="TRUE" cfi="2"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      
      # [0, 2] 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="3" numRapId="1" rapIds="5" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
     
      # [0, 4] 
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="3"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
     
      # Send extra TTI to be sure that there is no unexpected
      # scheduling
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>

     # [1 ,0]
	  # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req numRntis="1" spId="1">
            <tapa.tfu.msg3.recp.req/>
         </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   # [1 ,4]
   #Send CRC for Msg3
   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

      # [1 ,5]
      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="0"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>

	  # Expect Message3 datReq on CCCH at RGU.
      <tapa.expect>
         <tapa.rgu.cdatind ueId="0" lcId="4"/>
      </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   # [1 ,7]
   # Expect HARQ ACK in PHICH For MSG3
   <tapa.expect>
      <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

   # Send BO for Msg4 on RGU.
    <tapa.send>
       <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10"/>
    </tapa.send>

	<tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # [1 ,8]
   # Expect CStatInd For MSG4
   <tapa.expset>
      <tapa.rgu.cstaind lcId="4"/>
   </tapa.expset>

   # Send Msg4 on RGU.
   <tapa.send>
      <tapa.rgu.cdatreq ueId="0" lcId="4" lcType="3" />
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # [1 ,9]
   # Expect Msg4 from MAC to PHY.
   <tapa.expset>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req use="1" validate="FALSE"/>
     </tapa.tfu.dat.req>
     <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="6"/>
   </tapa.send>

   # [2 ,5]
   # Recv Hq Recp Req for Msg4.
   <tapa.expect>
     <tapa.tfu.recp.req numRntis="1" spId="1">
        <tapa.tfu.hq.recp.req vldtNp="TRUE" np="1"/>
     </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   # [2 ,8]
   # Send ACK as feedback for Msg4.
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAckLst="TRUE:FALSE:FALSE:FALSE"/>
     </tapa.tfu.hq.ind>
  </tapa.send>

  # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
     <tapa.rgr.cfgreq.cfg.ue instId="5" />
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>

   #Till now RACH and basic UE context is setup
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>

      # Configure bi-directional DTCH for default UE
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure DL LC on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="5"/>
      </tapa.send>
      #Sub-frame 3

      # [3, 3]
      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>

	 # Send TTI(s) to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 7
	  
      # [3, 7]
      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset> #GB
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expset>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 0

      # Expect data reception request
      <tapa.expect> #RB
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 5

      # Send Data Indication using TB size recieved in the grant
	  # Send Data Indication using TB size recieved in the grant
      <tapa.send> #BSR=B
         <tapa.tfu.dat.ind datInds="1">
            <tapa.tfu.dat  ueId="0" use="2"
               addShortBsr="TRUE" lcgId="0" bsr="40" />
         </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 7

      # Expect HARQ ACK in PHICH
      <tapa.expect> #AB/G1
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 8

	  #Do the cell reconfiguration
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" recfgType="16384" isDynCfiEnb="FALSE"/>
      </tapa.send>
      
	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      #Sub-frame 9
	  <tapa.expect>
	     <tapa.rgr.cfgCfm instId="5" />
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 0


      # Expect data reception request
      <tapa.expect> #R1
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 2

	  <tapa.expect> #G2
        <tapa.tfu.cntrl.req expCntrlReq="1">
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg
      <tapa.send>#C1
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="TRUE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 5

	  # Expect data reception request
      <tapa.expect> #R2
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="3"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <!--<tapa.send> #D1
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="2" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>-->

      # Expect Data Indication at RLC
      <!--<tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>-->

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 7

	  <tapa.expect> #A1/G3
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 9

      #Send CRC for Msg
      <tapa.send>#C2
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="TRUE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 0

	  <!--<tapa.send> #D2
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>-->

	  <tapa.expect> #R3
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

      # Expect Data Indication at RLC
      <!--<tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>-->

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 2

	  <tapa.expect> #A2/G4
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"  cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg
      <tapa.send> #C3
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="TRUE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 5

	  # Expect data reception request
      <tapa.expect> #R4
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="3"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <!--<tapa.send> #D3
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="2" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>-->

      # Expect Data Indication at RLC
      <!--<tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>-->

	  <tapa.send>
         <tapa.tfu.tti.ind HERE="TRUE" numTti="2"/>
      </tapa.send>
      #Sub-frame 7

	  <tapa.expect> #A3/G5
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="FALSE"/>
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"  cfi="2" ueId="0"/> 
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 9

      #Send CRC for Msg
      <tapa.send> #C4
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 0

	  # Expect data reception request
      <tapa.expect> #R5
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="4"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send> #D4
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 2

	  <tapa.expect> #A4/G6
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"  cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

   </tapa.test>


   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.6 DCFI_CMN_53
#
#
#       Desc:    Cell reconfiguration of in case wrong CFI is configured
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#

<tapa.testcase id="34.6">
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "Cell reconfiguration of in case wrong CFI is configured"
      </tapa.desc>

      <tapa.longdesc>
         "Cell reconfiguration of in case wrong CFI is configured"
      </tapa.longdesc>
         
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>
      <tapa.rg.dbgInitAll/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      #Send Bind Request for CRG SAP 
      <tapa.send>
         <tapa.crg.bndreq/>
      </tapa.send>
      
      # Expect positive Configuration Confirm from MAC
      <tapa.expect>
         <tapa.crg.bndcfm/>
      </tapa.expect>
      
      #Send Bind Request for RGR SAP 
      <tapa.send>
         <tapa.rgr.bndreq instId="5"/>
      </tapa.send>
      
      # Expect positive Configuration Confirm from MAC
      <tapa.expect>
         <tapa.rgr.bndcfm/>
      </tapa.expect>
      #Send Bind Request for RGR SAP 
      <tapa.send>
         <tapa.rgu.bndreq/>
      </tapa.send>
      
      # Expect positive Configuration Confirm from MAC
      <tapa.expect>
         <tapa.rgu.bndcfm/>
      </tapa.expect>
      
	  #Expect NOK_DONE Control Confirm from LTE MAC
      #Send Control Request to Enable TFU SAP
      <tapa.send>
         <tapa.lrg.cntrlreq suId="0" spId="0" action="ABND" elmntType="STTFUSAP" />
      </tapa.send>
      
      <tapa.expect>
         <tapa.lrg.cntrlcfm status="LCM_PRIM_OK_NDONE" reason="LCM_REASON_NOT_APPL"/>
      </tapa.expect>


      # Expect Dummy TFU Bind Request
      <tapa.expect>
         <tapa.tfu.bndreq instId="0"/>
      </tapa.expect>
      
      #<tapa.rg.dbgDeInitAll/>
      #Send Dummy TFU Bind Confirm
      <tapa.send>
         <tapa.tfu.bndcfm suId="0" instId="0"/>
      </tapa.send>

      #Expect positive Control Confirm from LTE MAC
      <tapa.expect>
         <tapa.lrg.cntrlcfm/>
      </tapa.expect>

      #Send Control Request to Enable TFU SAP
      <tapa.send>
         <tapa.lrg.schcntrlreq instId="5" suId="0" spId="0" action="ABND" elmntType="STTFUSAP" />
      </tapa.send>

      <tapa.expect>
         <tapa.lrg.schcntrlcfm status="LCM_PRIM_OK_NDONE" reason="LCM_REASON_NOT_APPL" instId="5"/>
      </tapa.expect>

      # Expect Dummy TFU Bind Request
      <tapa.expect>
         <tapa.tfu.sch.bndreq instId="5" spId="1"/>
      </tapa.expect>
      
      #<tapa.rg.dbgDeInitAll/>
      #Send Dummy TFU Bind Confirm
      <tapa.send>
         <tapa.tfu.sch.bndcfm suId="0" instId="5" spId="1"/>
      </tapa.send>

      
      #Expect positive Control Confirm from LTE MAC
      <tapa.expect>
         <tapa.lrg.schcntrlcfm instId="5"/>
      </tapa.expect>

      #Send CRG Cell Configuration
      <tapa.send>
         <tapa.crg.cfgreq.cfg.cell/>
      </tapa.send>
      

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      #<tapa.rg.dbgDeInitAll/>

      #Send Common Logical Channel Configuration BCCH->BCH
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch crnti="1234" lcId="1" dir="1" lcType="1" dlTrchType="1"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      #Send Common Logical Channel Configuration BCCH->DLSCH1
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch crnti="1234" lcId="2" dir="1" lcType="1"
            dlTrchType="3"/>
      </tapa.send>
      
      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>
      
      #Send Common Logical Channel Configuration PCCH
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch  crnti="1234" lcId="3" dir="1" lcType="2"/>
      </tapa.send>
     
      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      #Send Common Logical Channel Configuration CCCH
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch  crnti="1234" lcId="4" dir="3" lcType="3"
            dlTrchType="3" ulTrchType="5"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      #Send Common Logical Channel Configuration BCCH->DLSCH2
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch crnti="1234" lcId="5" dir="1" lcType="1"
            dlTrchType="3"/>
      </tapa.send>
      
      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      #Sending RGR CELL Configuration
      #cmnLcInfo = "lcId:lcType:dir:dlTrchType:ulTrchType:...."
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.cell instId="5" numCmnLc="5"
         cmnLcInfo="1:1:1:1:0:2:1:1:3:0:3:2:1:0:0:4:3:3:3:5:5:1:1:3:0"  ulDlCfgIdx="1" cfi="4"/>
      </tapa.send>

      #Expect positive Configuration Confirm from LTEMAC
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5" status="15"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.7 DCFI_TDD_32
#
#
#       Desc:    Validate that maximum value of cfi in spcl sf is 2
#                for config type 2
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.7">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="DwPts"/>

      <tapa.desc>
            "Validate that maximum value of cfi in spcl sf is 2 for config type 2"
      </tapa.desc>

      <tapa.longdesc>
            "Validate that maximum value of cfi in spcl sf is 2 for config type 2"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgInitErr/>
      #<tapa.rg.dbgInitParm/>
      #<tapa.rg.dbgInitInfo/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched.tddsplraocc ulDlCfgIdx="2" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="FALSE" cfi="3"/>

	  <tapa.rg.tddUeInitCfgTyp2SplSfCfg7 />

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 2

      <tapa.send>
         <tapa.rgu.dstarsp lcId="3" lcType="5" bo="50" ueId="0"/>
      </tapa.send>
      
	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 3

	  # Expect staInd from MAC to RLC for DAT1
      <tapa.expect>
		 <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 4

	<tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" cfi="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="3" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.8 DCFI_TDD_32
#
#
#       Desc:    Validate that if default cfi is 1 then cfi in spcl sf is 1
#                for config type 2
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.8">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="DwPts"/>

      <tapa.desc>
            "Validate that if default cfi is 1 then cfi in spcl sf is 1 for config type 2"
      </tapa.desc>

      <tapa.longdesc>
            "Validate that if default cfi is 1 then cfi in spcl sf is 1 for config type 2"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgInitErr/>
      #<tapa.rg.dbgInitParm/>
      #<tapa.rg.dbgInitInfo/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched.tddsplraocc ulDlCfgIdx="2" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="FALSE" cfi="1"/>

	  <tapa.rg.tddUeInitCfgTyp2SplSfCfg7 />

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 2

      <tapa.send>
         <tapa.rgu.dstarsp lcId="3" lcType="5" bo="50" ueId="0"/>
      </tapa.send>
      
	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 3

	  # Expect staInd from MAC to RLC for DAT1
      <tapa.expect>
		 <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 4

	<tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" cfi="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="3" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    34.9 DCFI_TDD_31
#
#
#       Desc:    Validate that maximum value of cfi in spcl sf is 2
#                for config type 1
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.9">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="DwPts"/>

      <tapa.desc>
            "Validate that maximum value of cfi in spcl sf is 2 for config type 1"
      </tapa.desc>

      <tapa.longdesc>
            "Validate that maximum value of cfi in spcl sf is 2 for config type 1"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgInitErr/>
      #<tapa.rg.dbgInitParm/>
      #<tapa.rg.dbgInitInfo/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched.tddsplraocc ulDlCfgIdx="1" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="FALSE" cfi="3"/>

	  <tapa.rg.tddUeInitCfgTyp1SplSfCfg7 />

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 2

      <tapa.send>
         <tapa.rgu.dstarsp lcId="3" lcType="5" bo="50" ueId="0"/>
      </tapa.send>
      
	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 3

	  # Expect staInd from MAC to RLC for DAT1
      <tapa.expect>
		 <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 4

	<tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" cfi="2"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="3" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.10 DCFI_TDD_31
#
#
#       Desc:    Validate that if default cfi is 1 then cfi in spcl sf is 1
#                for config type 1
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.10">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="DwPts"/>

      <tapa.desc>
            "Validate that if default cfi is 1 then cfi in spcl sf is 1 for config type 2"
      </tapa.desc>

      <tapa.longdesc>
            "Validate that if default cfi is 1 then cfi in spcl sf is 1 for config type 2"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgInitErr/>
      #<tapa.rg.dbgInitParm/>
      #<tapa.rg.dbgInitInfo/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched.tddsplraocc ulDlCfgIdx="1" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="FALSE" cfi="1"/>

	  <tapa.rg.tddUeInitCfgTyp1SplSfCfg7 />

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 2

      <tapa.send>
         <tapa.rgu.dstarsp lcId="3" lcType="5" bo="50" ueId="0"/>
      </tapa.send>
      
	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 3

	  # Expect staInd from MAC to RLC for DAT1
      <tapa.expect>
		 <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="3" />
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 4

	<tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" cfi="1"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0" use="1" saveTo="3" validate="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.11 DCFI_CMN_44
#
#
#       Desc:    Validate the DCFI switchover window length for config type 1
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.11">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="DwPts"/>

      <tapa.desc>
            "Validate the DCFI switchover window length for config type 1"
      </tapa.desc>

      <tapa.longdesc>
            "Validate the DCFI switchover window length for config type 1"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgInitErr/>
      #<tapa.rg.dbgInitParm/>
      #<tapa.rg.dbgInitInfo/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched.tddsplraocc ulDlCfgIdx="1" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="TRUE" cfi="2"/>

	  <tapa.rg.tddUeInitCfgTyp1SplSfCfg7 />

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

   <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>
   #Sub-frame 2

   # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>

	 # Send TTI(s) to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 3
	  
      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset> #GB
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expset>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 6

      # Expect data reception request
      <tapa.expect> #RB
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 0

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 1

      # Send Data Indication using TB size recieved in the grant
	  # Send Data Indication using TB size recieved in the grant
      <tapa.send> #BSR=B
         <tapa.tfu.dat.ind datInds="1">
            <tapa.tfu.dat  ueId="0" use="2"
               addShortBsr="TRUE" lcgId="0" bsr="40" />
         </tapa.tfu.dat.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 3

      # Expect HARQ ACK in PHICH
      <tapa.expect> #AB/G1
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 5

      <tapa.expect> #G2
        <tapa.tfu.cntrl.req expCntrlReq="1">
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 6
	  
	  # Expect data reception request
      <tapa.expect> #R1
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="3"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  #Do the cell reconfiguration
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" recfgType="16384" isDynCfiEnb="FALSE"/>
      </tapa.send>
      
	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 7

	  <tapa.expect>
	     <tapa.rgr.cfgCfm instId="5" />
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 8

	  <tapa.expect> #G3
        <tapa.tfu.cntrl.req expCntrlReq="1">
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 0

      #Send CRC for Msg
      <tapa.send> #C1
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.expect> #G4
        <tapa.tfu.cntrl.req expCntrlReq="1">
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="4" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  # Expect data reception request
      <tapa.expect> #R2
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" saveTo="5"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 1

	  # Expect data reception request
      <tapa.expect> #R3
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send> #D1
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

	  # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 3

	  <tapa.expect> #A1/G5
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 4

	  #Send CRC for Msg
      <tapa.send> #C2
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 5

	  <tapa.send> #D2
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="5" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

	  <tapa.expect> #G6/A2
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  # Expect data reception request
      <tapa.expect> #R4
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="4" vldtDatRecp="TRUE" saveTo="5"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

	  #Send CRC for Msg
      <tapa.send> #C3
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 6

	  <tapa.send> #D3
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

	  # Expect data reception request
      <tapa.expect> #R5
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="3"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 8

	  <tapa.expect> #G7/A3
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 9

	  #Send CRC for Msg
      <tapa.send> #C4
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 0

      <tapa.expect> #G8/A4
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="4" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  # Expect data reception request
      <tapa.expect> #R6
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" saveTo="6"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send> #D4
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="5" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

	  # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

	  #Send CRC for Msg
      <tapa.send> #C5
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 1

	  # Expect data reception request
      <tapa.expect> #R7
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send> #D5
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

	  # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 3

	  <tapa.expect> #G9/A5
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 4

	  #Send CRC for Msg
      <tapa.send> #C6
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 5

	  <tapa.send> #D6
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="6" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

	  <tapa.expect> #G10/A6
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  # Expect data reception request
      <tapa.expect> #R8
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="4" vldtDatRecp="TRUE" saveTo="3"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

	  #Send CRC for Msg
      <tapa.send> #C7
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 6

	  # Expect data reception request
      <tapa.expect> #R9
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="4"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send> #D7
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="2" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

	  # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 8

	  <tapa.expect> #A7
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    34.12 (DCFI_TDD_23)
#
#
#       Desc:    Validate the DCFI switchover window length for config type 1
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.12">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="DwPts"/>

      <tapa.desc>
            "Validate the DCFI switchover window length for config type 1"
      </tapa.desc>

      <tapa.longdesc>
            "Validate the DCFI switchover window length for config type 1"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgInitErr/>
      #<tapa.rg.dbgInitParm/>
      #<tapa.rg.dbgInitInfo/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched.tddsplraocc ulDlCfgIdx="1" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="TRUE" cfi="2"/>

	  <tapa.rg.tddUeInitCfgTyp1SplSfCfg7 />

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

   <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>
   #Sub-frame 2

   # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>

	 # Send TTI(s) to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 3
	  
      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset> #GB
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expset>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 6

      # Expect data reception request
      <tapa.expect> #RB
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 0

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 1

      # Send Data Indication using TB size recieved in the grant
	  # Send Data Indication using TB size recieved in the grant
      <tapa.send> #BSR=B
         <tapa.tfu.dat.ind datInds="1">
            <tapa.tfu.dat  ueId="0" use="2"
               addShortBsr="TRUE" lcgId="0" bsr="40" />
         </tapa.tfu.dat.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 3

      # Expect HARQ ACK in PHICH
      <tapa.expect> #AB/G1
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 5

      <tapa.expect> #G2
        <tapa.tfu.cntrl.req expCntrlReq="1">
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 6
	  
	  # Expect data reception request
      <tapa.expect> #R1
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="3"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  #Do the cell reconfiguration
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" recfgType="16384" isDynCfiEnb="FALSE"/>
      </tapa.send>
      
	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 7

	  <tapa.expect>
	     <tapa.rgr.cfgCfm instId="5" />
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 8

	  <tapa.expect> #G3
        <tapa.tfu.cntrl.req expCntrlReq="1">
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 0

      #Send CRC for Msg
      <tapa.send> #C1
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="TRUE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.expect> #G4
        <tapa.tfu.cntrl.req expCntrlReq="1">
		   # Expect DCI format 0 and do basic validations of the grant
		   <tapa.tfu.pdcch.cntrl.req saveTo="4" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  # Expect data reception request
      <tapa.expect> #R2
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" saveTo="5"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 1

	  # Expect data reception request
      <tapa.expect> #R3
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <!--<tapa.send> #D1
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

	  # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>-->

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 3

	  <tapa.expect> #A1/G5
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 4

	  #Send CRC for Msg
      <tapa.send> #C2
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="TRUE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 5

	  <!--<tapa.send> #D2
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="5" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>-->

	  <tapa.expect> #G6/A2
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  # Expect data reception request
      <tapa.expect> #R4
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="4" vldtDatRecp="TRUE" saveTo="5"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  # Expect Data Indication at RLC
      <!--<tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>-->

	  #Send CRC for Msg
      <tapa.send> #C3
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="TRUE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 6

	  <!--<tapa.send> #D3
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>-->

	  # Expect data reception request
      <tapa.expect> #R5
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="3"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  # Expect Data Indication at RLC
      <!--<tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>-->

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 8

	  <tapa.expect> #G7/A3
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 9

	  #Send CRC for Msg
      <tapa.send> #C4
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="TRUE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 0

      <tapa.expect> #G8/A4
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="4" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  # Expect data reception request
      <tapa.expect> #R6
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" saveTo="6"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <!--<tapa.send> #D4
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="5" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

	  # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>-->

	  #Send CRC for Msg
      <tapa.send> #C5
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="TRUE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 1

	  # Expect data reception request
      <tapa.expect> #R7
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <!--<tapa.send> #D5
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

	  # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>-->

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 3

	  <tapa.expect> #G9/A5
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="FALSE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="2"/> #This should not come. Have to debug this issue and modify the test case here onwards.
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 4

	  #Send CRC for Msg
      <tapa.send> #C6
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 5

	  <tapa.send> #D6
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="6" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

	  <tapa.expect> #G10/A6
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   <tapa.tfu.pdcch.cntrl.req saveTo="6" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  # Expect data reception request
      <tapa.expect> #R8
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="4" vldtDatRecp="TRUE" saveTo="3"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

	  #Send CRC for Msg
      <tapa.send> #C7
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 6

	  # Expect data reception request
      <tapa.expect> #R9
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="4"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send> #D7
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="2" lcId="1"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

	  # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 8

	  <tapa.expect> #A7
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.13 (DCFI_TDD_49)
#
#
#       Desc:    Validate cell recfg at the DCFI switchover window for config type 1
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.13">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="DwPts"/>

      <tapa.desc>
            "Validate cell recfg at the DCFI switchover window for config type 1"
      </tapa.desc>

      <tapa.longdesc>
            "Validate cell recfg at the DCFI switchover window for config type 1"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched.tddsplraocc ulDlCfgIdx="1" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="TRUE" cfi="2"/>

	  <tapa.rg.tddUeInitCfgTyp1SplSfCfg7 />

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      #Do the cell reconfiguration
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" recfgType="16384" isDynCfiEnb="FALSE"/>
      </tapa.send>
      
	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 1

	  <tapa.expect>
	     <tapa.rgr.cfgCfm instId="5" />
      </tapa.expect>

	  #Do the cell reconfiguration
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" recfgType="16384" isDynCfiEnb="TRUE"/>
      </tapa.send>
      
	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 2

	  <tapa.expect>
	     <tapa.rgr.cfgCfm instId="5" />
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="5"/>
      </tapa.send>
      #Sub-frame 7

	   # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>

	 # Send TTI(s) to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Subframe 8
      #Switchover due to 1st cell recfg started here

	  # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset> #GB
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req HERE="TRUE" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="2"/>
         </tapa.tfu.cntrl.req>
      </tapa.expset>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 1

      # Expect data reception request
      <tapa.expect> #RB
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 5

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 6

      # Send Data Indication using TB size recieved in the grant
	  # Send Data Indication using TB size recieved in the grant
      <tapa.send> #BSR=B
         <tapa.tfu.dat.ind datInds="1">
            <tapa.tfu.dat  ueId="0" use="2"
               addShortBsr="TRUE" lcgId="0" bsr="0" /> #intentionally sent 0 to avoid complication in tc. Intention to test cfi value only.
         </tapa.tfu.dat.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 8

      # Expect HARQ ACK in PHICH
      <tapa.expect> #AB
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   # Expect DCI format 0 and do basic validations of the grant
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1003"/>
      </tapa.send>
      #Subframe 1

	  # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>

	 # Send TTI(s) to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Subframe 3
      #Switchover due to 1st cell recfg started here

	  # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset> #GB
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req HERE="TRUE" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
         </tapa.tfu.cntrl.req>
      </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    34.14 (DCFI_TDD_43)
#
#
#       Desc:    Validate that CFI counters should not be updated if scheduled 
#                subframe is Uplink subframe for config type 1
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.14">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="DwPts"/>

      <tapa.desc>
            "Validate that CFI counters should not be updated if scheduled subframe is Uplink subframe for config type 1"
      </tapa.desc>

      <tapa.longdesc>
            "Validate that CFI counters should not be updated if scheduled subframe is Uplink subframe for config type 1"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched.tddsplraocc ulDlCfgIdx="1" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="TRUE" cfi="2"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="10"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="20"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.15 (DCFI_TDD_72)
#
#
#       Desc:    To validate the start RB value for Msg3 UE scheduling in case 
#                if DCFI feature is disabled for config type 1
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.15">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="DwPts"/>

      <tapa.desc>
            "To validate the start RB value for Msg3 UE scheduling in case if DCFI feature is disabled for config type 1"
      </tapa.desc>

      <tapa.longdesc>
            "To validate the start RB value for Msg3 UE scheduling in case if DCFI feature is disabled for config type 1"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #Initialize CELL
      <tapa.rg.cellInit ulDlCfgIdx="1" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="FALSE" cfi="1" ngEnum="RGAC_RGR_NG_ONESIXTH" dlTotalBw="50" ulTotalBw="50"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
      
	  # Send RaReqInd for one rapId in the first special frame 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 2

      # Send it in the 6th frequency index 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="52" numRapId="1" rapIds="5" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

	  # Ue starts expecting raResp after 3 subframes within the raResp window.
      # In this TC, it shall expect raResp in the first DL subframe after 3 Ttis.

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 4
      
      # Expect RaResp for the rapId sent in RaReq
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="52"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>
      #Sub-frame 0

	  # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req numRntis="1" spId="1">
            <tapa.tfu.msg3.recp.req validate="TRUE" rbStart="1"/>
         </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 5

	  # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="0"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>

	  # Expect Message3 datReq on CCCH at RGU.
      <tapa.expect>
         <tapa.rgu.cdatind ueId="0" lcId="4"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.16 (DCFI_TDD_73)
#
#
#       Desc:    To validate the start RB value for Msg3 UE scheduling in case 
#                if DCFI feature is disabled for config type 2
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.16">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="DwPts"/>

      <tapa.desc>
            "To validate the start RB value for Msg3 UE scheduling in case if DCFI feature is disabled for config type 2"
      </tapa.desc>

      <tapa.longdesc>
            "To validate the start RB value for Msg3 UE scheduling in case if DCFI feature is disabled for config type 2"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #Initialize CELL
      <tapa.rg.cellInit ulDlCfgIdx="2" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="FALSE" cfi="1"  ngEnum="RGAC_RGR_NG_ONESIXTH" dlTotalBw="50" ulTotalBw="50"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 2
      
      # [0, 2] 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="3" numRapId="1" rapIds="5" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 4
     
      # [0, 4] 
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="3"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>
      #Sub-frame 0

	  # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req numRntis="1" spId="1">
            <tapa.tfu.msg3.recp.req validate="TRUE" rbStart="2"/>
         </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 5

      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="0"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>

	  # Expect Message3 datReq on CCCH at RGU.
      <tapa.expect>
         <tapa.rgu.cdatind ueId="0" lcId="4"/>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 7

      # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.17 (DCFI_TDD_50)
#
#
#       Desc:    Validate cell recfg at the DCFI switchover window for config type 2
#                 
#       Notes:   None
#              
#       Module:  DCFI with DwPTS Scheduling 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.17">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="DwPts"/>

      <tapa.desc>
            "Validate cell recfg at the DCFI switchover window for config type 2"
      </tapa.desc>

      <tapa.longdesc>
            "Validate cell recfg at the DCFI switchover window for config type 2"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched.tddsplraocc ulDlCfgIdx="2" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="TRUE" cfi="2"/>

	  <tapa.rg.tddUeInitCfgTyp2SplSfCfg7 />

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      #Do the cell reconfiguration
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" recfgType="16384" isDynCfiEnb="FALSE"/>
      </tapa.send>
      
	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 1

	  <tapa.expect>
	     <tapa.rgr.cfgCfm instId="5" />
      </tapa.expect>

	  #Do the cell reconfiguration
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" recfgType="16384" isDynCfiEnb="TRUE"/>
      </tapa.send>
      
	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 2

	  <tapa.expect>
	     <tapa.rgr.cfgCfm instId="5" />
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="5"/>
      </tapa.send>
      #Sub-frame 7

	 # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>

	 # Send TTI(s) to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="5"/>
      </tapa.send>
      #Subframe 2
      
	  #Switchover due to 1st cell recfg started so cfi change

	  # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset> #GB
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req HERE="TRUE" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="2"/>
         </tapa.tfu.cntrl.req>
      </tapa.expset>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 5

      # Expect data reception request
      <tapa.expect> #RB
        <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
        </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 9

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 0

      # Send Data Indication using TB size recieved in the grant
	  # Send Data Indication using TB size recieved in the grant
      <tapa.send> #BSR=B
         <tapa.tfu.dat.ind datInds="1">
            <tapa.tfu.dat  ueId="0" use="2"
               addShortBsr="TRUE" lcgId="0" bsr="0" /> #intentionally sent 0 to avoid complication in tc. Intention to test cfi value only.
         </tapa.tfu.dat.ind>
      </tapa.send>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 2

      # Expect HARQ ACK in PHICH
      <tapa.expect> #AB
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
		   # Expect DCI format 0 and do basic validations of the grant
        </tapa.tfu.cntrl.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="1013"/>
      </tapa.send>
      #Subframe 5

	  # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>

	 # Send TTI(s) to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Subframe 3
      #Switchover due to 1st cell recfg started here

	  # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset> #GB
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req HERE="TRUE" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
         </tapa.tfu.cntrl.req>
      </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.18 (DCFI_CMN_55)
#
#
#       Desc:    To validate the start RB value for Msg3 in case 
#                of PUSCH SB size is 1 and bandwidth is 10 Mhz
#                 
#       Notes:   None
#              
#       Module:  Uplink RB allocation with DCFI enabled 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.18">

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="Dynamic Cfi"/>
      <tapa.desc>
            "To validate the start RB value for Msg3 in case of PUSCH SB size is 1 and bandwidth is 10 Mhz"
      </tapa.desc>
      <tapa.longdesc>
         "1) Verify that the start RB is correct as per the CFI"
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

   # Initialize LTEMAC
   <tapa.rg.macInit/>

   #Initialize CELL
   <tapa.rg.cellInit ulDlCfgIdx="2" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="TRUE" cfi="1"  ngEnum="RGAC_RGR_NG_ONE" dlTotalBw="50" ulTotalBw="50"  
         size="1" numTxAntPorts="2" n1PucchAn="8" />
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 2
      
      # [0, 2] 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="3" numRapId="2" rapIds="5:6" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 4
     
      # [0, 4] 
      <tapa.expset>
      
        <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
        
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="3"/>
        </tapa.tfu.dat.req>
      
      </tapa.expset>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>
      #Sub-frame 0

	  # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req numRntis="2" spId="1">
            <tapa.tfu.msg3.recp.req validate="TRUE" rbStart="2" ueId="0" numRb="1"/>
            <tapa.tfu.msg3.recp.req validate="TRUE" rbStart="3" ueId="1" numRb="1"/>
         </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 7

      # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="2" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE" />
            <tapa.tfu.phich.cntrl.req isAck="TRUE" />
         </tapa.tfu.cntrl.req>
      </tapa.expect>
   
   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown/>

</tapa.testcase>

#
#
#       Test:    34.19 (DCFI_CMN_56)
#
#
#       Desc:    To validate the start RB value for Msg3 in case 
#                of PUSCH SB size is 6 and bandwidth is 10 Mhz
#                 
#       Notes:   None
#              
#       Module:  Uplink RB allocation with DCFI enabled 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.19">

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="Dynamic Cfi"/>
      <tapa.desc>
            "To validate the start RB value for Msg3 in case of PUSCH SB size is 6 and bandwidth is 10 Mhz"
      </tapa.desc>
      <tapa.longdesc>
         "1) Verify that the start RB is correct as per the CFI"
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

   # Initialize LTEMAC
   <tapa.rg.macInit/>

   #Initialize CELL
   <tapa.rg.cellInit ulDlCfgIdx="2" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="TRUE" cfi="1"  ngEnum="RGAC_RGR_NG_ONESIXTH" dlTotalBw="50" ulTotalBw="50"  
         size="6" numTxAntPorts="2" n1PucchAn="8" />
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 2
      
      # [0, 2] 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="3" numRapId="2" rapIds="5:6" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 4
     
      # [0, 4] 
      <tapa.expset>
      
        <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
        
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="3"/>
        </tapa.tfu.dat.req>
      
      </tapa.expset>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>
      #Sub-frame 0

	  # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req numRntis="2" spId="1">
            <tapa.tfu.msg3.recp.req validate="TRUE" rbStart="2" ueId="0" numRb="6"/>
            <tapa.tfu.msg3.recp.req validate="TRUE" rbStart="8" ueId="1" numRb="6"/>
         </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 7

      # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="2" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE" />
            <tapa.tfu.phich.cntrl.req isAck="TRUE" />
         </tapa.tfu.cntrl.req>
      </tapa.expect>
   
   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown/>

</tapa.testcase>

#
#
#       Test:    34.20 (DCFI_CMN_57)
#
#
#       Desc:    To validate the start RB value for Msg3 in case 
#                of PUSCH SB size is 1 and bandwidth is 5 Mhz
#                 
#       Notes:   None
#              
#       Module:  Uplink RB allocation with DCFI enabled 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.20">

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="Dynamic Cfi"/>
      <tapa.desc>
            "To validate the start RB value for Msg3 in case of PUSCH SB size is 6 and bandwidth is 10 Mhz"
      </tapa.desc>
      <tapa.longdesc>
         "1) Verify that the start RB is correct as per the CFI"
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

   # Initialize LTEMAC
   <tapa.rg.macInit/>

   #Initialize CELL
   <tapa.rg.cellInit ulDlCfgIdx="2" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="TRUE" cfi="1"  ngEnum="RGAC_RGR_NG_ONE" dlTotalBw="25" ulTotalBw="25"  
         size="1" numTxAntPorts="2" n1PucchAn="8" />
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 2
      
      # [0, 2] 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="3" numRapId="2" rapIds="5:6" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 4
     
      # [0, 4] 
      <tapa.expset>
      
        <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
        
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="3"/>
        </tapa.tfu.dat.req>
      
      </tapa.expset>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>
      #Sub-frame 0

	  # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req numRntis="2" spId="1">
            <tapa.tfu.msg3.recp.req validate="TRUE" rbStart="1" ueId="0" numRb="1"/>
            <tapa.tfu.msg3.recp.req validate="TRUE" rbStart="2" ueId="1" numRb="1"/>
         </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 7

      # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="2" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE" />
            <tapa.tfu.phich.cntrl.req isAck="TRUE" />
         </tapa.tfu.cntrl.req>
      </tapa.expect>
   
   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown/>

</tapa.testcase>

#
#
#       Test:    34.21 (DCFI_CMN_59)
#
#
#       Desc:    To validate the start RB value for Msg3 in case 
#                of PUSCH SB size is 2 and bandwidth is 10 Mhz
#                 
#       Notes:   None
#              
#       Module:  Uplink RB allocation with DCFI enabled 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.21">

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="Dynamic Cfi"/>
      <tapa.desc>
            "To validate the start RB value for Msg3 in case of PUSCH SB size is 2 and bandwidth is 10 Mhz"
      </tapa.desc>
      <tapa.longdesc>
         "1) Verify that the start RB is correct as per the CFI"
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

   # Initialize LTEMAC
   <tapa.rg.macInit/>

   #Initialize CELL
   <tapa.rg.cellInit ulDlCfgIdx="2" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="TRUE" cfi="1"  ngEnum="RGAC_RGR_NG_HALF" dlTotalBw="50" ulTotalBw="50"  
         size="2" numTxAntPorts="2" n1PucchAn="8" />
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 2
      
      # [0, 2] 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="3" numRapId="2" rapIds="5:6" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 4
     
      # [0, 4] 
      <tapa.expset>
      
        <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
        
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="3"/>
        </tapa.tfu.dat.req>
      
      </tapa.expset>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>
      #Sub-frame 0

	  # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req numRntis="2" spId="1">
            <tapa.tfu.msg3.recp.req validate="TRUE" rbStart="2" ueId="0" numRb="2"/>
            <tapa.tfu.msg3.recp.req validate="TRUE" rbStart="4" ueId="1" numRb="2"/>
         </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 7

      # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="2" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE" />
            <tapa.tfu.phich.cntrl.req isAck="TRUE" />
         </tapa.tfu.cntrl.req>
      </tapa.expect>
   
   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown/>

</tapa.testcase>

#
#
#       Test:    34.22 (DCFI_CMN_60)
#
#
#       Desc:    To validate the start RB value for Msg3 in case 
#                of PUSCH SB size is 2 and bandwidth is 5 Mhz
#                 
#       Notes:   None
#              
#       Module:  Uplink RB allocation with DCFI enabled 
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.22">

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="Dynamic Cfi"/>
      <tapa.desc>
            "To validate the start RB value for Msg3 in case of PUSCH SB size is 2 and bandwidth is 5 Mhz"
      </tapa.desc>
      <tapa.longdesc>
         "1) Verify that the start RB is correct as per the CFI"
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="RGR_V2"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

   # Initialize LTEMAC
   <tapa.rg.macInit/>

   #Initialize CELL
   <tapa.rg.cellInit ulDlCfgIdx="2" spclSfCfgIdx="7"
         numRsc="1" freqIdxLst="0" sfnLst="2" halfFrmLst="0" 
         ulStartSfIdxLst="0" isDynCfiEnb="FALSE" cfi="3"  ngEnum="RGAC_RGR_NG_ONE" dlTotalBw="25" ulTotalBw="25"  
         size="1" numTxAntPorts="2" n1PucchAn="8" />
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 2
      
      # [0, 2] 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="3" numRapId="2" rapIds="5:6" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 4
     
      # [0, 4] 
      <tapa.expset>
      
        <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
        
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="3"/>
        </tapa.tfu.dat.req>
      
      </tapa.expset>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>
      #Sub-frame 0

	  # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req numRntis="2" spId="1">
            <tapa.tfu.msg3.recp.req validate="TRUE" rbStart="2" ueId="0" numRb="1"/>
            <tapa.tfu.msg3.recp.req validate="TRUE" rbStart="3" ueId="1" numRb="1"/>
         </tapa.tfu.recp.req>
      </tapa.expect>

	  <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 7

      # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="2" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE" />
            <tapa.tfu.phich.cntrl.req isAck="TRUE" />
         </tapa.tfu.cntrl.req>
      </tapa.expect>
   
   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown/>

</tapa.testcase>

#
#
#       Test:    34.23
#
#       Desc:    DCFI_TDD_74
#                To verify that the SPS is reactivated when the CFI changes. 
#
#       Notes:   None
#              
#       Module:  uplink.sps.datapath
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.23">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id="uplink.sps.datapath"/>

      <tapa.desc>
         " To verify that the SPS is reactivated when the CFI changes"  
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="LTEMAC_SPS"/>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

 # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit ulDlCfgIdx="1" raWinSize="10" DLSPSMaxBw = "30"
         startRnti="70" rntiSize="10" isDynCfiEnb="TRUE" cfi="2" spclSfCfgIdx="7" hopOffst="0"/>
      
      # UE Configuration
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
      
	   # Send RaReqInd for one rapId in the first special frame 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 2

      # Send it in the 6th frequency index 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="52" numRapId="1" rapIds="5" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

	   # Ue starts expecting raResp after 3 subframes within the raResp window.
      # In this TC, it shall expect raResp in the first DL subframe after 3 Ttis.

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      #Sub-frame 4
      
      # Expect RaResp for the rapId sent in RaReq
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="52"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

	   <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>
      #Sub-frame 0

	   # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req numRntis="1" spId="1">
            <tapa.tfu.msg3.recp.req/>
         </tapa.tfu.recp.req>
      </tapa.expect>

	   <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 5

	   # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="0"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>

	   # Expect Message3 datReq on CCCH at RGU.
      <tapa.expect>
         <tapa.rgu.cdatind ueId="0" lcId="4"/>
      </tapa.expect>

	   # Send BO for Msg4 on RGU.
      <tapa.send>
         <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10"/>
      </tapa.send>

	   <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 6
   
      # Expect CStatInd For MSG4
      <tapa.expset>
         <tapa.rgu.cstaind lcId="4"/>
      </tapa.expset>

	   # Send Msg4 on RGU.
      <tapa.send>
         <tapa.rgu.cdatreq ueId="0" lcId="4" lcType="3" />
      </tapa.send>

	   <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 7
   
      # Expect Msg4 from MAC to PHY.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req use="1" validate="FALSE"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

	   <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 1

      # Recv Hq Recp Req for Msg4.
      <tapa.expect>
        <tapa.tfu.recp.req numRntis="1" spId="1">
           <tapa.tfu.hq.recp.req />
        </tapa.tfu.recp.req>
      </tapa.expect>

	   <tapa.send>
         <tapa.tfu.tti.ind numTti="3" />
      </tapa.send>
      #Sub-frame 4

      # Send ACK as feedback for Msg4.
      <tapa.send>
        <tapa.tfu.hq.ind hqInds="1">
           <tapa.tfu.hq ueId="0" isAckLst="TRUE:FALSE:FALSE:FALSE"/>
        </tapa.tfu.hq.ind>
      </tapa.send>

	   # Send UE config request
      <tapa.send>
        <tapa.crg.cfgreq.cfg.ue/>
      </tapa.send>
   
      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>
   
      # Send UE config request
      <tapa.send>
        <tapa.rgr.cfgreq.cfg.ue instId="5" ULSPSEnFlag = "TRUE" DLSPSEnFlag = "TRUE" SPSRnti="65"
         prdBsrTmr="65535" ULSPSSchIntrv="RGR_SPS_PRD_20SF" ULSPSimpRls="RGR_SPS_E2" 
         ULSPSTwoIntConf="TRUE" maxUlHqTx="2"/>
      </tapa.send>
   
      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
      # Configure a dedicated SPS logical channel for the created UE
      # lcType=5 for DCCH (cm_lte.h) at MAC
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="4" lcType="5" dir="3" lcgId="1" />
      </tapa.send>

      <tapa.expect>
      # Expect success in cfg cfm
         <tapa.crg.cfgcfm status="0"/>
      </tapa.expect>

      <tapa.send>
      # Create DL SPS service for the UE at scheduler
         <tapa.rgr.cfgreq.cfg.lch ueId = "0" lcId = "4" lcgId = "1" dir = "3" lcType = "5"
            DLSPSLchEnabFlag="TRUE" DLSPSLchPktSize="40" DLSPSLchExpltRelCnt="2"/>
      </tapa.send>

      #Sub-frame 5
      #expect config Cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0"/>
      </tapa.expect>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="1" instId="5"/>
      </tapa.send>

      <tapa.expect>
         <tapa.rgr.cfgCfm status="0"/>
      </tapa.expect>

	   <tapa.send>
         <tapa.tfu.tti.ind SUBFRAME="0" numTti="6" />
      </tapa.send>
      #Sub-frame 0

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      # Send SR Indication for default UE
      <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Sub-frame 3
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" 
              vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Sub-frame 6
      # Expect data reception request
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="3"/>
         </tapa.tfu.recp.req>
      </tapa.expect>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Sub-frame 0
      #Send CRC for PUSCH
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Sub-frame 3
      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
     
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  ueId="0" addShortBsr="TRUE" lcgId="1" bsr="10" />
       </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      #Sub-frame 5
      #Expect SPS activation for subframe 2
      <tapa.expect>
         <tapa.tfu.cntrl.req expCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"
               isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" ULSPSInit="TRUE" cfi="1"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="5"/>
      </tapa.send>

      #Sub-frame 0
      #Expect data reception request of SPS activation for subframe 2
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"
               isSpsRnti="TRUE" vldtHarq="TRUE" expHarqProcId="0" />
         </tapa.tfu.recp.req>   
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Sub-frame 4
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      #Sub-frame 5
      # Expect HARQ ACK in PHICH
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      #SPS Data
      <tapa.send>
         <tapa.tfu.dat.ind datInds="1">
            <tapa.tfu.dat  ueId="0" use="2" isSpsRnti="TRUE" lcId="4" />
         </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.expect>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="4,1" vldtBuf="TRUE"/>
      </tapa.expect>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="16"/>
      </tapa.send>

      #Sub-frame 1
      #Expect Data reception req of SPS occasion at sf3
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"
               isSpsRnti="TRUE" vldtHarq="TRUE" expHarqProcId="1"/>
         </tapa.tfu.recp.req>   
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Sub-frame 5
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Sub-frame 8
      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.dat.ind datInds="1">
            <tapa.tfu.dat  ueId="0" use="2" isSpsRnti="TRUE" lcId="4" 
               lcgId="1" />
         </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.expect>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="4,1" vldtBuf="TRUE"/>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="12"/>
      </tapa.send>

      #Sub-frame 0
      #Expect Data reception req of SPS occasion at sf2
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"
               isSpsRnti="TRUE" vldtHarq="TRUE" expHarqProcId="0"/>
         </tapa.tfu.recp.req>   
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Sub-frame 4
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      #Sub-frame 5
      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.dat.ind datInds="1">
            <tapa.tfu.dat  ueId="0" use="2" isSpsRnti="TRUE" lcId="4" 
               lcgId="1" />
         </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.expect>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="4,1" vldtBuf="TRUE"/>
      </tapa.expect>

      #Change the CFI by disabling the feature. CFI will stepup to 2
      #Do the cell reconfiguration
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" recfgType="16384" isDynCfiEnb="FALSE"/>
      </tapa.send>
 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
   	
      #Sub-frame 6 
      <tapa.expect>
	     <tapa.rgr.cfgCfm instId="5" />
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="12"/>
      </tapa.send>
      
      #Sub-frame 8 
      <tapa.expset>
         #SPS reactivation happens because of the CFI change
         <tapa.tfu.cntrl.req expCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"
               isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" ULSPSInit="TRUE" cfi="2" rbStart="3"/>
         </tapa.tfu.cntrl.req>
      </tapa.expset>
 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
  
      #Sub-frame 1
      #Expect data reception request of SPS activation for subframe 3
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"
               isSpsRnti="TRUE" vldtHarq="TRUE" expHarqProcId="1"/>
         </tapa.tfu.recp.req>   
      </tapa.expset>
  
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Sub-frame 5
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Sub-frame 8
      # Expect HARQ ACK in PHICH
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      #SPS Data
      <tapa.send>
         <tapa.tfu.dat.ind datInds="1">
            <tapa.tfu.dat  ueId="0" use="2" isSpsRnti="TRUE" lcId="4" />
         </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.expect>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="4,1" vldtBuf="TRUE"/>
      </tapa.expect>
 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="12"/>
      </tapa.send>

      #Sub-frame 0
      #Expect data reception request of SPS activation for subframe 3
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"
               isSpsRnti="TRUE" vldtHarq="TRUE" expHarqProcId="0"/>
         </tapa.tfu.recp.req>   
      </tapa.expset>
 
   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

      # Layer Manager ShutDown

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    34.24
#
#       Desc:    DCFI_TDD_75
#                To verify that the SPS is reactivated when the CFI changes  
#
#       Notes:   None
#              
#       Module:  uplink.sps.datapath
#
#       File:    rgac_tc34.xml
#
#
<tapa.testcase id="34.24">>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id="uplink.sps.datapath"/>

      <tapa.desc>
         " To verify that the SPS is reactivated when the CFI changes"  
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="LTEMAC_SPS"/>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

 # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit ulDlCfgIdx="2" raWinSize="10" DLSPSMaxBw = "30"
         startRnti="70" rntiSize="10" isDynCfiEnb="TRUE" cfi="2" spclSfCfgIdx="7" hopOffst="0"/>
      
      # UE Configuration
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
      
	   # Send RaReqInd for one rapId in the first special frame 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 2

      # Send it in the 6th frequency index 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="52" numRapId="1" rapIds="5" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

	   # Ue starts expecting raResp after 3 subframes within the raResp window.
      # In this TC, it shall expect raResp in the first DL subframe after 3 Ttis.

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>
      
      #Sub-frame 4
      # Expect RaResp for the rapId sent in RaReq
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="52"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
	   
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>
      #Sub-frame 0

	   # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req numRntis="1" spId="1">
            <tapa.tfu.msg3.recp.req/>
         </tapa.tfu.recp.req>
      </tapa.expect>

	   <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      #Sub-frame 4

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Sub-frame 7

	   # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="0"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>

	   # Expect Message3 datReq on CCCH at RGU.
      <tapa.expect>
         <tapa.rgu.cdatind ueId="0" lcId="4"/>
      </tapa.expect>

	   # Send BO for Msg4 on RGU.
      <tapa.send>
         <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10"/>
      </tapa.send>

	   <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 8
   
      # Expect CStatInd For MSG4
      <tapa.expset>
         <tapa.rgu.cstaind lcId="4"/>
      </tapa.expset>

	   # Send Msg4 on RGU.
      <tapa.send>
         <tapa.rgu.cdatreq ueId="0" lcId="4" lcType="3" />
      </tapa.send>

	   <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      #Sub-frame 9
   
      # Expect Msg4 from MAC to PHY.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req use="1" validate="FALSE"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
	   
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>
      #Sub-frame 5

      # Recv Hq Recp Req for Msg4.
      <tapa.expect>
        <tapa.tfu.recp.req numRntis="1" spId="1">
           <tapa.tfu.hq.recp.req />
        </tapa.tfu.recp.req>
      </tapa.expect>

	   <tapa.send>
         <tapa.tfu.tti.ind numTti="3" />
      </tapa.send>
      #Sub-frame 8

      # Send ACK as feedback for Msg4.
      <tapa.send>
        <tapa.tfu.hq.ind hqInds="1">
           <tapa.tfu.hq ueId="0" isAckLst="TRUE:FALSE:FALSE:FALSE"/>
        </tapa.tfu.hq.ind>
      </tapa.send>

	   # Send UE config request
      <tapa.send>
        <tapa.crg.cfgreq.cfg.ue/>
      </tapa.send>
   
      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>
   
      # Send UE config request
      <tapa.send>
        <tapa.rgr.cfgreq.cfg.ue instId="5" ULSPSEnFlag = "TRUE" DLSPSEnFlag = "TRUE" SPSRnti="65"
         prdBsrTmr="65535" ULSPSSchIntrv="RGR_SPS_PRD_20SF" ULSPSimpRls="RGR_SPS_E2" 
         ULSPSTwoIntConf="TRUE" maxUlHqTx="2"/>
      </tapa.send>
   
      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
      # Configure a dedicated SPS logical channel for the created UE
      # lcType=5 for DCCH (cm_lte.h) at MAC
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="4" lcType="5" dir="3" lcgId="1" />
      </tapa.send>

      <tapa.expect>
      # Expect success in cfg cfm
         <tapa.crg.cfgcfm status="0"/>
      </tapa.expect>

      <tapa.send>
      # Create DL SPS service for the UE at scheduler
         <tapa.rgr.cfgreq.cfg.lch ueId = "0" lcId = "4" lcgId = "1" dir = "3" lcType = "5"
            DLSPSLchEnabFlag="TRUE" DLSPSLchPktSize="40" DLSPSLchExpltRelCnt="2"/>
      </tapa.send>

      #Sub-frame 5
      #expect config Cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0"/>
      </tapa.expect>

      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="1" instId="5"/>
      </tapa.send>

      <tapa.expect>
         <tapa.rgr.cfgCfm status="0"/>
      </tapa.expect>

	   <tapa.send>
         <tapa.tfu.tti.ind SUBFRAME="0" numTti="2" />
      </tapa.send>
      #Sub-frame 0

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      # Send SR Indication for default UE
      <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      #Sub-frame 2
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" 
              vldtGrant="TRUE" vldtTx="TRUE" cfi="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Sub-frame 5
      # Expect data reception request
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="3"/>
         </tapa.tfu.recp.req>
      </tapa.expect>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Sub-frame 9
      #Send CRC for PUSCH
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Sub-frame 2
      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      #Sub-frame 3
      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  ueId="0" addShortBsr="TRUE" lcgId="1" bsr="10" />
       </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Sub-frame 7
      #Expect SPS activation for subframe 2
      <tapa.expect>
         <tapa.tfu.cntrl.req expCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"
               isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" ULSPSInit="TRUE" cfi="1"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>
      
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Sub-frame 0
      #Expect data reception request of SPS activation for subframe 2
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"
               isSpsRnti="TRUE" vldtHarq="TRUE" expHarqProcId="0" />
         </tapa.tfu.recp.req>   
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Sub-frame 4
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Sub-frame 7
      # Expect HARQ ACK in PHICH
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      #SPS Data
      <tapa.send>
         <tapa.tfu.dat.ind datInds="1">
            <tapa.tfu.dat  ueId="0" use="2" isSpsRnti="TRUE" lcId="4" />
         </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.expect>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="4,1" vldtBuf="TRUE"/>
      </tapa.expect>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="18"/>
      </tapa.send>

      #Sub-frame 5
      #Expect Data reception req of SPS occasion at sf3
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"
               isSpsRnti="TRUE" vldtHarq="TRUE" expHarqProcId="1"/>
         </tapa.tfu.recp.req>   
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Sub-frame 9
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Sub-frame 2
      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
      
      <tapa.send>
         <tapa.tfu.dat.ind datInds="1">
            <tapa.tfu.dat  ueId="0" use="2" isSpsRnti="TRUE" lcId="4" 
               lcgId="1" />
         </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.expect>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="4,1" vldtBuf="TRUE"/>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="8"/>
      </tapa.send>

      #Sub-frame 0
      #Expect Data reception req of SPS occasion at sf2
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"
               isSpsRnti="TRUE" vldtHarq="TRUE" expHarqProcId="0"/>
         </tapa.tfu.recp.req>   
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Sub-frame 4
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Sub-frame 7
      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
 
      <tapa.send>
         <tapa.tfu.dat.ind datInds="1">
            <tapa.tfu.dat  ueId="0" use="2" isSpsRnti="TRUE" lcId="4" 
               lcgId="1" />
         </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.expect>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="4,1" vldtBuf="TRUE"/>
      </tapa.expect>

      #Change the CFI by disabling the feature. CFI will stepup to 2
      #Do the cell reconfiguration
      <tapa.send>
         <tapa.rgr.cfgreq.recfg.cell instId="5" recfgType="16384" isDynCfiEnb="FALSE"/>
      </tapa.send>
 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
   	
      #Sub-frame 8
      <tapa.expect>
	     <tapa.rgr.cfgCfm instId="5" />
      </tapa.expect>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="14"/>
      </tapa.send>
      
      #Sub-frame 2 
      <tapa.expset>
         #SPS reactivation happens because of the CFI change
         <tapa.tfu.cntrl.req expCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"
               isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE" ULSPSInit="TRUE" cfi="2" rbStart="4"/>
         </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
  
      #Sub-frame 5
      #Expect data reception request of SPS activation for subframe 3
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"
               isSpsRnti="TRUE" vldtHarq="TRUE" expHarqProcId="1"/>
         </tapa.tfu.recp.req>   
      </tapa.expset>
  
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Sub-frame 9
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Sub-frame 2
      # Expect HARQ ACK in PHICH
      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      #SPS Data
      <tapa.send>
         <tapa.tfu.dat.ind datInds="1">
            <tapa.tfu.dat  ueId="0" use="2" isSpsRnti="TRUE" lcId="4" />
         </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.expect>
         <tapa.rgu.ddatind ueId="0" lchTb1Data="4,1" vldtBuf="TRUE"/>
      </tapa.expect>
 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="8"/>
      </tapa.send>

      #Sub-frame 0
      #Expect data reception request of SPS activation for subframe 3
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"
               isSpsRnti="TRUE" vldtHarq="TRUE" expHarqProcId="0"/>
         </tapa.tfu.recp.req>   
      </tapa.expset>
   
   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

      # Layer Manager ShutDown

   </tapa.shutdown>

</tapa.testcase>


