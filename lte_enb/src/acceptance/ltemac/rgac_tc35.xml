#
#/********************************************************************20**
#
#     Name:    LTE-MAC 
#
#     Type:    XML Test File
#
#     Desc:    XML Based Test Cases For TDD 
#
#     File:    rgac_tc35.xml
#
#     Sid:     rgac_tc35.xml@@/main/1 - Thu Mar 26 01:11:03 2009
#
#     Prg:     ns 
#
#*********************************************************************21*/


#
#       Test:    35.1
#
#       Desc:   "To verify the Configuration support of Periodic CQI Reporting Mode 2-0"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.1">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the Configuration support of Periodic CQI Reporting Mode 2-0
      </tapa.desc>

      <tapa.longdesc>
         To verify the Configuration support of Periodic CQI Reporting Mode 2-0
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
      prdBsrTmr="65535" ueCatEnum="1" prdModeEnumPres="TRUE" K="3" prdCqiCfg.type="TRUE" 
      prdModeEnum="RGAC_RGR_PRD_CQI_MOD20" cqiRepType="2"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>  
</tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase> 

#
#       Test:    35.2
#
#       Desc:   "To verify the Configuration support of Aperiodic CQI Reporting Mode 3-0"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.2">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the Configuration support of Aperiodic CQI Reporting Mode 3-0
      </tapa.desc>

      <tapa.longdesc>
         To verify the Configuration support of Aperiodic CQI Reporting Mode 3-0
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="2"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

   <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Send RaReqInd for one rapId in the first special frame 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3" TTI="TEST"/>
      </tapa.send>

         # Send it in the 6th frequency index 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="52" numRapId="1" rapIds="5" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # In this TC, it shall expect raResp in the first DL subframe after 3 Ttis.

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      
      # Expect RaResp for the rapId sent in RaReq
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="52"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="9"/>
      </tapa.send>

      # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="1" spId="1">
            <tapa.tfu.msg3.recp.req ueId="0" />
         </tapa.tfu.recp.req>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   #Send CRC for Msg3 for 1st UE
   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" TTI="TEST0"/>
   </tapa.send>

   # Expect HARQ ACK in PHICH For MSG3
   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

      # Send Message3 after receiving Message3 reception req for 1st UE .
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="0"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

      # Expect Message3 datReq on CCCH at RGU.
      <tapa.expset>
         <tapa.rgu.cdatind ueId="0" lcId="4"/>
      </tapa.expset>

    # Send BO for Msg4 on RGU for 1st UE.
    <tapa.send>
       <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10" ueId="0"/>
    </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Expect CStatInd For MSG4
   <tapa.expset>
      <tapa.rgu.cstaind lcId="4"/>
   </tapa.expset>

   # Send Msg4 on RGU for 1st UE.
   <tapa.send>
      <tapa.rgu.cdatreq ueId="0" lcId="4" lcType="3" />
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect Msg4 from MAC to PHY.
   <tapa.expset>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req use="1" validate="FALSE"/>
     </tapa.tfu.dat.req>
     <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   # Recv Hq Recp Req for Msg4.
   <tapa.expect>
     <tapa.tfu.recp.req expRecpReq="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   # Send ACK as feedback for Msg4 for 1st UE.
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAckLst="TRUE:FALSE:FALSE:FALSE"/>
     </tapa.tfu.hq.ind>
  </tapa.send>

   # Send UE config request for 1st UE
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue ueId="0"/>
   </tapa.send>

   # Expect success in cfg cfm for 1st UE
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>
   
   <tapa.send>
      #<tapa.tfu.tti.ind numTti="3" />
      <tapa.tfu.tti.ind numTti="5"/>
   </tapa.send>

   # Send UE config request for 1st UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="1" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0"/>
   </tapa.send>

   # Send TTI to apply the config
   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect> 

</tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>

#
#       Test:    35.3
#
#       Desc:   "To verify the Invalid Configuration of k value for Periodic CQI Reporting Mode 2-0"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.3">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the Invalid Configuration of k value for Periodic CQI Reporting Mode 2-0
      </tapa.desc>

      <tapa.longdesc>
         To verify the Invalid Configuration of k value for Periodic CQI Reporting Mode 2-0
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
      prdBsrTmr="65535" ueCatEnum="1" prdModeEnumPres="TRUE" K="5" prdCqiCfg.type="TRUE" 
      prdModeEnum="RGAC_RGR_PRD_CQI_MOD20" cqiRepType="2"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5" status="15"/>
   </tapa.expect>  
</tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>  

#
#       Test:    35.4
#
#       Desc:   "To verify the Invalid configuration of Aperiodic CQI for 
#                dlTotalBw less than 7"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.4">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the Invalid configuration of Aperiodic CQI for 
         dlTotalBw less than 7
      </tapa.desc>

      <tapa.longdesc>
         To verify the Invalid configuration of Aperiodic CQI for 
         dlTotalBw less than 7
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="2"  isDlFreqSel="1" 
      dlTotalBw="6" raWinSize="10" ulTotalBw="50"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

   <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Send RaReqInd for one rapId in the first special frame 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3" TTI="TEST"/>
      </tapa.send>

         # Send it in the 6th frequency index 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="52" numRapId="1" rapIds="5" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # In this TC, it shall expect raResp in the first DL subframe after 3 Ttis.

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      
      # Expect RaResp for the rapId sent in RaReq
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="52"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="9"/>
      </tapa.send>

      # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="1" spId="1">
            <tapa.tfu.msg3.recp.req ueId="0" />
         </tapa.tfu.recp.req>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   #Send CRC for Msg3 for 1st UE
   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" TTI="TEST0"/>
   </tapa.send>

   # Expect HARQ ACK in PHICH For MSG3
   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

      # Send Message3 after receiving Message3 reception req for 1st UE .
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="0"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

      # Expect Message3 datReq on CCCH at RGU.
      <tapa.expset>
         <tapa.rgu.cdatind ueId="0" lcId="4"/>
      </tapa.expset>

    # Send BO for Msg4 on RGU for 1st UE.
    <tapa.send>
       <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10" ueId="0"/>
    </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Expect CStatInd For MSG4
   <tapa.expset>
      <tapa.rgu.cstaind lcId="4"/>
   </tapa.expset>

   # Send Msg4 on RGU for 1st UE.
   <tapa.send>
      <tapa.rgu.cdatreq ueId="0" lcId="4" lcType="3" />
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect Msg4 from MAC to PHY.
   <tapa.expset>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req use="1" validate="FALSE"/>
     </tapa.tfu.dat.req>
     <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   # Recv Hq Recp Req for Msg4.
   <tapa.expect>
     <tapa.tfu.recp.req expRecpReq="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   # Send ACK as feedback for Msg4 for 1st UE.
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAckLst="TRUE:FALSE:FALSE:FALSE"/>
     </tapa.tfu.hq.ind>
  </tapa.send>

   # Send UE config request for 1st UE
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue ueId="0"/>
   </tapa.send>

   # Expect success in cfg cfm for 1st UE
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>
   
   <tapa.send>
      #<tapa.tfu.tti.ind numTti="3" />
      <tapa.tfu.tti.ind numTti="5"/>
   </tapa.send>

   # Send UE config request for 1st UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="1" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0"/>
   </tapa.send>

   # Send TTI to apply the config
   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5" status="15"/>
   </tapa.expect> 

</tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase> 

#
#       Test:    35.5
#
#       Desc:   "To verify the Invalid Reconfiguration of k value for Periodic CQI Reporting Mode 2-0"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.5">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the Invalid Reconfiguration of k value for Periodic CQI 
         Reporting Mode 2-0.
      </tapa.desc>

      <tapa.longdesc>
         To verify the Invalid Reconfiguration of k value for Periodic CQI 
         Reporting Mode 2-0.
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
      prdBsrTmr="65535" ueCatEnum="1" prdModeEnumPres="TRUE" K="5" prdCqiCfg.type="TRUE" 
      prdModeEnum="RGAC_RGR_PRD_CQI_MOD20" cqiRepType="2"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5" status="15"/>
   </tapa.expect>  
</tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>  

#
#       Test:    35.6
#
#       Desc:   "To verify the Invalid reconfiguration of Aperiodic CQI for dlTotalBw less than 7"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.6">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the Invalid reconfiguration of Aperiodic CQI for 
         dlTotalBw less than 7.
      </tapa.desc>

      <tapa.longdesc>
         To verify the Invalid reconfiguration of Aperiodic CQI for 
         dlTotalBw less than 7.
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="6" raWinSize="10" ulTotalBw="50"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="1" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5" status="15"/>
   </tapa.expect>  
</tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>   

#
#       Test:    35.7
#
#       Desc:   "To validate the reception request for wideband CQI when 
#                UE got configured with Periodic CQI 2-0"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.7">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To validate the reception request for wideband CQI when 
         UE got configured with Periodic CQI 2-0.
      </tapa.desc>

      <tapa.longdesc>
         To validate the reception request for wideband CQI when 
         UE got configured with Periodic CQI 2-0.
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="2"  isDlFreqSel="1" 
      dlTotalBw="100" raWinSize="10" ulTotalBw="100"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

   <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Send RaReqInd for one rapId in the first special frame 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3" TTI="TEST"/>
      </tapa.send>

         # Send it in the 6th frequency index 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="52" numRapId="1" rapIds="5" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # In this TC, it shall expect raResp in the first DL subframe after 3 Ttis.

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      
      # Expect RaResp for the rapId sent in RaReq
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="52"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="9"/>
      </tapa.send>

      # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="1" spId="1">
            <tapa.tfu.msg3.recp.req ueId="0" />
         </tapa.tfu.recp.req>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   #Send CRC for Msg3 for 1st UE
   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" TTI="TEST0"/>
   </tapa.send>

   # Expect HARQ ACK in PHICH For MSG3
   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

      # Send Message3 after receiving Message3 reception req for 1st UE .
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="0"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

      # Expect Message3 datReq on CCCH at RGU.
      <tapa.expset>
         <tapa.rgu.cdatind ueId="0" lcId="4"/>
      </tapa.expset>

    # Send BO for Msg4 on RGU for 1st UE.
    <tapa.send>
       <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10" ueId="0"/>
    </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Expect CStatInd For MSG4
   <tapa.expset>
      <tapa.rgu.cstaind lcId="4"/>
   </tapa.expset>

   # Send Msg4 on RGU for 1st UE.
   <tapa.send>
      <tapa.rgu.cdatreq ueId="0" lcId="4" lcType="3" />
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect Msg4 from MAC to PHY.
   <tapa.expset>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req use="1" validate="FALSE"/>
     </tapa.tfu.dat.req>
     <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   # Recv Hq Recp Req for Msg4.
   <tapa.expect>
     <tapa.tfu.recp.req expRecpReq="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   # Send ACK as feedback for Msg4 for 1st UE.
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAckLst="TRUE:FALSE:FALSE:FALSE"/>
     </tapa.tfu.hq.ind>
  </tapa.send>

   # Send UE config request for 1st UE
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue ueId="0"/>
   </tapa.send>

   # Expect success in cfg cfm for 1st UE
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>
   
   <tapa.send>
      #<tapa.tfu.tti.ind numTti="3" />
      <tapa.tfu.tti.ind numTti="5"/>
   </tapa.send>

   # Send UE config request for 1st UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="1" prdModeEnumPres="TRUE" K="3" prdCqiCfg.type="TRUE" 
         prdModeEnum="RGAC_RGR_PRD_CQI_MOD20" cqiRepType="2" cqiPCfgIdx="308"/>
   </tapa.send>

   # Send TTI to apply the config
   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="110"/>
   </tapa.send>

   #Expect CQI recp req
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req/>
      </tapa.tfu.recp.req>
   </tapa.expect>

</tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>  

#
#       Test:    35.8
#
#       Desc:   "To validate the reception request for subband CQI when 
#                UE got configured with Periodic CQI 2-0"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.8">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To validate the reception request for subband CQI when 
         UE got configured with Periodic CQI 2-0
      </tapa.desc>

      <tapa.longdesc>
         To validate the reception request for subband CQI when 
         UE got configured with Periodic CQI 2-0
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
      prdBsrTmr="65535" ueCatEnum="1" prdModeEnumPres="TRUE" K="4" prdCqiCfg.type="TRUE" 
      prdModeEnum="RGAC_RGR_PRD_CQI_MOD20" cqiRepType="2" cqiPCfgIdx="308"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>  

   <tapa.send>
      <tapa.tfu.tti.ind numTti="117"/>
   </tapa.send>

   #Expect WB CQI recp req
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 1 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>  

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 2 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 3 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 1 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>  

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 2 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 3 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 1 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>  

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 2 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 3 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 1 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>  

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 2 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 3 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect WB CQI recp req 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>  
</tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>  

#
#       Test:    35.9
#
#       Desc:   "To validate the reception request for RI when UE
#                got configured with Periodic CQI 2-0"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.9">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To validate the reception request for wideband CQI when 
         UE got configured with Periodic CQI 2-0.
      </tapa.desc>

      <tapa.longdesc>
         To validate the reception request for wideband CQI when 
         UE got configured with Periodic CQI 2-0.
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="2"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

   <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Send RaReqInd for one rapId in the first special frame 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3" TTI="TEST"/>
      </tapa.send>

         # Send it in the 6th frequency index 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="52" numRapId="1" rapIds="5" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # In this TC, it shall expect raResp in the first DL subframe after 3 Ttis.

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      
      # Expect RaResp for the rapId sent in RaReq
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="52"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="9"/>
      </tapa.send>

      # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="1" spId="1">
            <tapa.tfu.msg3.recp.req ueId="0" />
         </tapa.tfu.recp.req>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   #Send CRC for Msg3 for 1st UE
   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" TTI="TEST0"/>
   </tapa.send>

   # Expect HARQ ACK in PHICH For MSG3
   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

      # Send Message3 after receiving Message3 reception req for 1st UE .
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="0"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

      # Expect Message3 datReq on CCCH at RGU.
      <tapa.expset>
         <tapa.rgu.cdatind ueId="0" lcId="4"/>
      </tapa.expset>

    # Send BO for Msg4 on RGU for 1st UE.
    <tapa.send>
       <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10" ueId="0"/>
    </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Expect CStatInd For MSG4
   <tapa.expset>
      <tapa.rgu.cstaind lcId="4"/>
   </tapa.expset>

   # Send Msg4 on RGU for 1st UE.
   <tapa.send>
      <tapa.rgu.cdatreq ueId="0" lcId="4" lcType="3" />
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect Msg4 from MAC to PHY.
   <tapa.expset>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req use="1" validate="FALSE"/>
     </tapa.tfu.dat.req>
     <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   # Recv Hq Recp Req for Msg4.
   <tapa.expect>
     <tapa.tfu.recp.req expRecpReq="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   # Send ACK as feedback for Msg4 for 1st UE.
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAckLst="TRUE:FALSE:FALSE:FALSE"/>
     </tapa.tfu.hq.ind>
  </tapa.send>

   # Send UE config request for 1st UE
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue ueId="0"/>
   </tapa.send>

   # Expect success in cfg cfm for 1st UE
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>
   
   <tapa.send>
      #<tapa.tfu.tti.ind numTti="3" />
      <tapa.tfu.tti.ind numTti="5"/>
   </tapa.send>

   # Send UE config request for 1st UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="1" prdModeEnumPres="TRUE" K="1" prdCqiCfg.type="TRUE" 
         prdModeEnum="RGAC_RGR_PRD_CQI_MOD20" cqiRepType="2" cqiPCfgIdx="308" 
         riEna="TRUE" riCfgIdx="166" txModeEnum="RGR_UE_TM_3"/>
   </tapa.send>

   # Send TTI to apply the config
   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="105"/>
   </tapa.send>

   #Expect RI recp req
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="1"/>
      </tapa.tfu.recp.req>
   </tapa.expect>  

   <tapa.send>
      <tapa.tfu.tti.ind numTti="5"/>
   </tapa.send>

   #Expect WB CQI recp req
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 1 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>  

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 2 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 3 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect WB CQI recp req 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 1 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>  

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 2 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="160"/>
   </tapa.send>

   #Expect SB CQI recp req BP 3 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="155"/>
   </tapa.send>   

   #Expect RI recp req
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="1"/>
      </tapa.tfu.recp.req>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="5"/>
   </tapa.send>  

   #Expect WB CQI recp req 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>   

</tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>   

#
#       Test:    35.10
#
#       Desc:   "To verify Aperiodic CQI trigger when weighted sum, which 
#                is a function of number of ACKs and NACKS, is reaching 
#                the threshold"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.10">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify Aperiodic CQI trigger when weighted sum, 
         which is a function of number of ACKs and NACKS, 
         is reaching the threshold.
      </tapa.desc>

      <tapa.longdesc>
         To verify Aperiodic CQI trigger when weighted sum, 
         which is a function of number of ACKs and NACKS, 
         is reaching the threshold.
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" maxDlHqTx="5" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0" 
         txModeEnum="RGR_UE_TM_3"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>  

   #Trigger Aperiodic CQI
   <tapa.rg.dlfs.aprdcqiTrg/>
</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>    

#
#       Test:    35.11
#
#       Desc:   "To test the successful DL path for a MAC PDU for a 
#                frequency selective cell with UE configured to report
#                CQI through aperiodic mode 3-0"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.11"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify Aperiodic CQI trigger when weighted sum, 
         which is a function of number of ACKs and NACKS, 
         is reaching the threshold.
      </tapa.desc>

      <tapa.longdesc>
         To verify Aperiodic CQI trigger when weighted sum, 
         which is a function of number of ACKs and NACKS, 
         is reaching the threshold.
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" maxDlHqTx="5" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0" 
         txModeEnum="RGR_UE_TM_3"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>  

   #Trigger Aperiodic CQI
   <tapa.rg.dlfs.aprdcqiTrg ueId="0"/>
  
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect data reception request, HARQ for DL Data and ACQI
   <tapa.expset>
      <tapa.tfu.recp.req expRecpReq="1">
         <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
            cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="0" riPres="1" ri="1"/>
      </tapa.tfu.recp.req>   
   </tapa.expset> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" ri="1" wbCqi="10"
            cqiIdxLst="0:1:3:2:0:2:0:1:2"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>
                      
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created logical channel on RGU.
      <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      # Expect staInd from MAC to RLC
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="1"/>
   </tapa.expect>

   <tapa.send>
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="4"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect PDSCH and PDCCH for the dat req for DAT1
   <tapa.expset>
     <tapa.tfu.cntrl.req expCntrlReq="1" >
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" vldDciFrmt="TRUE" isFormat2a="TRUE"
           isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
           vldtResAllocMap="TRUE" resAllocMap="35:48:128:0" />
      </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0"  use="1" lcId="4" chkSdu="TRUE"
            transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
            saveTo="2"/>
     </tapa.tfu.dat.req>
   </tapa.expset> 
</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>     

#
#       Test:    35.12
#
#       Desc:   "To verify the consideration of UCI multiplexing while 
#                allocating UL grant"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.12"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the consideration of UCI multiplexing 
         while allocating UL grant
      </tapa.desc>

      <tapa.longdesc>
         To verify the consideration of UCI multiplexing 
         while allocating UL grant
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" maxDlHqTx="5" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0" 
         txModeEnum="RGR_UE_TM_3" bCQIIdx="5"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>  

   #Trigger Aperiodic CQI
   <tapa.rg.dlfs.aprdcqiTrg.puschdata ueId="0"/>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>
   
   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1">
         <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" 
            vldtGrant="TRUE" vldtTx="TRUE" />
      </tapa.tfu.cntrl.req>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   # Expect data reception request, HARQ for DL Data and ACQI
   <tapa.expset>
      <tapa.tfu.recp.req expRecpReq="1">
         <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
            cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="5" riPres="1" ri="1"/>
      </tapa.tfu.recp.req>   
   </tapa.expset> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" ri="1" wbCqi="10"
            cqiIdxLst="0:1:3:2:0:2:0:1:2"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>
                      
   <tapa.expset>
      <tapa.tfu.recp.req expRecpReq="1">
         <tapa.tfu.pusch.recp.req use ="1" saveTo="2"/> 
      </tapa.tfu.recp.req>   
   </tapa.expset> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created logical channel on RGU.
      <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      # Expect staInd from MAC to RLC
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="0"/>
   </tapa.expect>

   <tapa.send>
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="4"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect PDSCH and PDCCH for the dat req for DAT1
   <tapa.expset>
     <tapa.tfu.cntrl.req expCntrlReq="2" >
        <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" vldDciFrmt="TRUE" isFormat2a="TRUE"
           isTb1Pres="TRUE" isTb2Pres="FALSE" vldCWSwapFlag="FALSE" 
           vldtResAllocMap="TRUE"  />
           #vldtResAllocMap="TRUE" resAllocMap="35:48:128:0" />
      </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0"  use="1" lcId="4" chkSdu="TRUE"
            transMode="TFU_UE_TM_3" isTb1="TRUE"  numTb1Lyrs="1" numTb2Lyrs="1"
            saveTo="2"/>
     </tapa.tfu.dat.req>
   </tapa.expset> 
</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>      

#
#       Test:    35.13
#
#       Desc:   "To verify the consideration of UCI multiplexing while 
#                allocating UL grant when betaCqiOffset is 0"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.13"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the consideration of UCI multiplexing 
         while allocating UL grant
      </tapa.desc>

      <tapa.longdesc>
         To verify the consideration of UCI multiplexing 
         while allocating UL grant
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" maxDlHqTx="5" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0" 
         txModeEnum="RGR_UE_TM_3" bCQIIdx="0"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>  

   #Trigger Aperiodic CQI
   <tapa.rg.dlfs.aprdcqiTrg.puschdata ueId="0"/>
  
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1">
         <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" 
            vldtGrant="TRUE" vldtTx="TRUE" />
      </tapa.tfu.cntrl.req>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   # Expect data reception request, HARQ for DL Data and ACQI
   <tapa.expset>
      <tapa.tfu.recp.req expRecpReq="1">
         <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
            cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="0" riPres="1" ri="1"/>
      </tapa.tfu.recp.req>   
   </tapa.expset> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" ri="1" wbCqi="10"
            cqiIdxLst="0:1:3:2:0:2:0:1:2"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>
                      
   <tapa.expset>
      <tapa.tfu.recp.req expRecpReq="1">
         <tapa.tfu.pusch.recp.req use ="1" saveTo="2"/> 
      </tapa.tfu.recp.req>   
   </tapa.expset> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created logical channel on RGU.
      <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      # Expect staInd from MAC to RLC
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="0"/>
   </tapa.expect>

   <tapa.send>
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="4"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect PDSCH and PDCCH for the dat req for DAT1
   <tapa.expset>
     <tapa.tfu.cntrl.req expCntrlReq="2" >
        <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" vldDciFrmt="TRUE" isFormat2a="TRUE"
           isTb1Pres="TRUE" vldCWSwapFlag="FALSE" 
           vldtResAllocMap="TRUE"  />
      </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0"  use="1" lcId="4" chkSdu="TRUE"
            transMode="TFU_UE_TM_3" isTb1="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
            saveTo="2"/>
     </tapa.tfu.dat.req>
   </tapa.expset> 

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>       

#
#       Test:    35.14
#
#       Desc:   "To verify the consideration of UCI multiplexing while 
#                allocating UL grant when betaCqiOffset is 0"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.14"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the consideration of UCI multiplexing 
         while allocating UL grant
      </tapa.desc>

      <tapa.longdesc>
         To verify the consideration of UCI multiplexing 
         while allocating UL grant
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" maxDlHqTx="5" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0" 
         txModeEnum="RGR_UE_TM_3" bCQIIdx="15"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>  

   #Trigger Aperiodic CQI
   <tapa.rg.dlfs.aprdcqiTrg.puschdata ueId="0"/>
  
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1">
         <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" 
            vldtGrant="TRUE" vldtTx="TRUE" />
      </tapa.tfu.cntrl.req>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   # Expect data reception request, HARQ for DL Data and ACQI
   <tapa.expset>
      <tapa.tfu.recp.req expRecpReq="1">
         <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
            cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="15" riPres="1" ri="1"/>
      </tapa.tfu.recp.req>   
   </tapa.expset> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" ri="1" wbCqi="10"
            cqiIdxLst="0:1:3:2:0:2:0:1:2"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>
                      
   <tapa.expset>
      <tapa.tfu.recp.req expRecpReq="1">
         <tapa.tfu.pusch.recp.req use ="1" saveTo="2"/> 
      </tapa.tfu.recp.req>   
   </tapa.expset> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created logical channel on RGU.
      <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      # Expect staInd from MAC to RLC
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="0"/>
   </tapa.expect>

   <tapa.send>
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="4"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect PDSCH and PDCCH for the dat req for DAT1
   <tapa.expset>
     <tapa.tfu.cntrl.req expCntrlReq="2" >
        <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" vldDciFrmt="TRUE" isFormat2a="TRUE"
           isTb1Pres="TRUE" vldCWSwapFlag="FALSE" 
           vldtResAllocMap="TRUE" />
      </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0"  use="1" lcId="4" chkSdu="TRUE"
            transMode="TFU_UE_TM_3" isTb1="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
            saveTo="2"/>
     </tapa.tfu.dat.req>
   </tapa.expset> 

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>       
 
#
#       Test:    35.15
#
#       Desc:   "To verify the DL RB allocation for multi UEs based 
#                on aperiodic CQI report are prioritized based on 
#                CQI Deviation"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.15"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the DL RB allocation for multi UEs based 
         on aperiodic CQI report are prioritized based on 
         Avg CQI.
      </tapa.desc>

      <tapa.longdesc>
         To verify the DL RB allocation for multi UEs based 
         on aperiodic CQI report are prioritized based on 
         Avg CQI.
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" maxDlHqTx="5" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>

      # UE Configuration
      <tapa.rg.UeInitTdd1 instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0" 
         txModeEnum="RGR_UE_TM_3"/>

      #Initialize 2nd UE
      <tapa.rg.UeInitTdd1 instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="1" 
         txModeEnum="RGR_UE_TM_3"/>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Trigger Aperiodic CQI
      <tapa.rg.dlfs.aprdcqiTrg ueId="0"/>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect data reception request, HARQ for DL Data and ACQI
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
               cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="0" riPres="1" ri="1"/>
         </tapa.tfu.recp.req>   
      </tapa.expset> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" ri="1" wbCqi="10"
               cqiIdxLst="0:1:3:2:0:2:0:1:2"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="8"/>
      </tapa.send>

      #Trigger Aperiodic CQI
      <tapa.rg.dlfs.aprdcqiTrg ueId="1"/>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect data reception request, HARQ for DL Data and ACQI
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
               cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="0" 
               riPres="1" ri="1" ueId="1"/>
         </tapa.tfu.recp.req>   
      </tapa.expset> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" ri="1" wbCqi="10"
               cqiIdxLst="0:1:3:2:0:2:0:1:2"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE" ueId="1"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>  

      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000" ueId="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         <tapa.rgu.dstaind lchTb1Data="4" numLchTb2="1" ueId="1"/>
         <tapa.rgu.dstaind lchTb1Data="4" numLchTb2="1"/>
      </tapa.expset>

      <tapa.send>
         <tapa.rgu.ddatreq ueId="1" lchTb1Data="4" lcType="4"/>
      </tapa.send> 

      <tapa.send>
         <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="4"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDSCH and PDCCH for the dat req for DAT1
      <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="2" >
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="2" vldDciFrmt="TRUE" isFormat2a="TRUE"
               isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
               vldtResAllocMap="FALSE" resAllocMap="176:3:0:0"/>
            <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1" vldDciFrmt="TRUE" isFormat2a="TRUE"
               isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
               vldtResAllocMap="FALSE" resAllocMap="3:48:128:0" />
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="2">
            <tapa.tfu.pdsch.dat.req ueId="0"  use="2" lcId="4" chkSdu="TRUE"
               transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
               saveTo="4"/>
            <tapa.tfu.pdsch.dat.req ueId="1"  use="1" lcId="4" chkSdu="TRUE"
               transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
               saveTo="3"/>
         </tapa.tfu.dat.req>
      </tapa.expset> 
</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>      

#
#       Test:    35.16
#
#       Desc:   "To verify the DL RB allocation for multi UEs based 
#                on aperiodic CQI report are prioritized based on 
#                CQI Deviation"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.16"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the DL RB allocation for multi UEs based 
         on aperiodic CQI report are prioritized based on 
         CQI Deviation.
      </tapa.desc>

      <tapa.longdesc>
         To verify the DL RB allocation for multi UEs based 
         on aperiodic CQI report are prioritized based on 
         CQI Deviation.
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" maxDlHqTx="5" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>

      # UE Configuration
      <tapa.rg.UeInitTdd1 instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0" 
         txModeEnum="RGR_UE_TM_3"/>

      #Initialize 2nd UE
      <tapa.rg.UeInitTdd1 instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="1" 
         txModeEnum="RGR_UE_TM_3"/>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Trigger Aperiodic CQI
      <tapa.rg.dlfs.aprdcqiTrg ueId="0"/>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect data reception request, HARQ for DL Data and ACQI
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
               cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="0" riPres="1" ri="1"/>
         </tapa.tfu.recp.req>   
      </tapa.expset> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" ri="1" wbCqi="10"
               cqiIdxLst="2:1:2:3:0:0:2:3:1"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="8"/>
      </tapa.send>

      #Trigger Aperiodic CQI
      <tapa.rg.dlfs.aprdcqiTrg ueId="1"/>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect data reception request, HARQ for DL Data and ACQI
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
               cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="0" 
               riPres="1" ri="1" ueId="1"/>
         </tapa.tfu.recp.req>   
      </tapa.expset> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" ri="1" wbCqi="10"
               cqiIdxLst="1:2:3:0:0:3:1:2:2"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE" ueId="1"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>  

      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000" ueId="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC
         <tapa.rgu.dstaind lchTb1Data="4" numLchTb2="1" ueId="1"/>
         <tapa.rgu.dstaind lchTb1Data="4" numLchTb2="1"/>
      </tapa.expset>

      <tapa.send>
         <tapa.rgu.ddatreq ueId="1" lchTb1Data="4" lcType="4"/>
      </tapa.send> 

      <tapa.send>
         <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="4"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDSCH and PDCCH for the dat req for DAT1
      <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="2" >
            <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1" vldDciFrmt="TRUE" isFormat2a="TRUE"
               isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
               vldtResAllocMap="TRUE" resAllocMap="176:3:128:0" />
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="2" vldDciFrmt="TRUE" isFormat2a="TRUE"
               isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
               vldtResAllocMap="TRUE" resAllocMap="76:12:0:0"/>
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="2">
            <tapa.tfu.pdsch.dat.req ueId="1"  use="1" lcId="4" chkSdu="TRUE"
               transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
               saveTo="3"/>
            <tapa.tfu.pdsch.dat.req ueId="0"  use="2" lcId="4" chkSdu="TRUE"
               transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
               saveTo="4"/>
         </tapa.tfu.dat.req>
      </tapa.expset> 
</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>       

#
#       Test:    35.17
#
#       Desc:   "To verify the DL RB allocation for multi UEs based 
#                on aperiodic CQI report are prioritized based on 
#                CQI Deviation"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.17"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the DL RB allocation for multi UEs based 
         on aperiodic CQI report are prioritized based on 
         CQI Deviation.
      </tapa.desc>

      <tapa.longdesc>
         To verify the DL RB allocation for multi UEs based 
         on aperiodic CQI report are prioritized based on 
         CQI Deviation.
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" maxDlHqTx="5" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>

      # UE Configuration
      <tapa.rg.UeInitTdd1 instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0" 
         txModeEnum="RGR_UE_TM_3"/>

      #Initialize 2nd UE
      <tapa.rg.UeInitTdd1 instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="1" 
         txModeEnum="RGR_UE_TM_3"/>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Trigger Aperiodic CQI
      <tapa.rg.dlfs.aprdcqiTrg ueId="0"/>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect data reception request, HARQ for DL Data and ACQI
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
               cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="0" riPres="1" ri="1"/>
         </tapa.tfu.recp.req>   
      </tapa.expset> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" ri="1" wbCqi="10"
               cqiIdxLst="2:1:2:3:0:0:2:3:1"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="8"/>
      </tapa.send>

      #Trigger Aperiodic CQI
      <tapa.rg.dlfs.aprdcqiTrg ueId="1"/>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect data reception request, HARQ for DL Data and ACQI
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
               cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="0" 
               riPres="1" ri="1" ueId="1"/>
         </tapa.tfu.recp.req>   
      </tapa.expset> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" ri="1" wbCqi="11"
               cqiIdxLst="1:2:3:0:0:3:1:2:2"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE" ueId="1"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>  

      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000" ueId="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC
         <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="1" ueId="1"/>
         <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="1"/>
      </tapa.expset>

      <tapa.send>
         <tapa.rgu.ddatreq ueId="1" lchTb1Data="4" lcType="4"/>
      </tapa.send> 

      <tapa.send>
         <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="4"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDSCH and PDCCH for the dat req for DAT1
      <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="2" >
            <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1" vldDciFrmt="TRUE" isFormat2a="TRUE"
               isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
               vldtResAllocMap="TRUE" resAllocMap="48:3:0:0" />
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="2" vldDciFrmt="TRUE" isFormat2a="TRUE"
               isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
               vldtResAllocMap="TRUE" resAllocMap="204:8:0:0"/>
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="2">
            <tapa.tfu.pdsch.dat.req ueId="1"  use="1" lcId="4" chkSdu="TRUE"
               transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
               saveTo="3"/>
            <tapa.tfu.pdsch.dat.req ueId="0"  use="2" lcId="4" chkSdu="TRUE"
               transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
               saveTo="4"/>
         </tapa.tfu.dat.req>
      </tapa.expset> 
</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>           

#
#       Test:    35.18
#
#       Desc:   "To verify the aperiodic CQI trigger for Hand-in 
#                UE in Random access response"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#

<tapa.testcase id="35.18">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To verify the aperiodic CQI trigger for Hand-in
          UE in Random access response" 
      </tapa.desc>

      <tapa.longdesc>
         "To verify the aperiodic CQI trigger for Hand-in
          UE in Random access response" 
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>
   
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit.dlSched.tddraocc ulDlCfgIdx="2" 
            numRaPreamble="30" sizeRaPreambleGrpA="25" isDlFreqSel="1"
            preambleSetPres="1" preambleStart="30" preambleSize="20"
            numRsc="2" freqIdxLst="0:0" sfnLst="2:2" halfFrmLst="0:1"
            ulStartSfIdxLst="0:0" />

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>

        # Send UE config request
         <tapa.send>
            <tapa.crg.cfgreq.cfg.ue cellId="3" isHoUe="TRUE"/>
         </tapa.send>

        # Expect success in cfg cfm
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

         # Send UE config request with dedicated preamble
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.ue instId="5" cellId="3" 
               ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" dedPrmblPrsnt="TRUE" 
               dedPrmblId="50" aprdModeEnumPres="TRUE" 
               aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" bCQIIdx="5"/>
         </tapa.send>

         # Expect success in cfg cfm
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>
   
         # Configure DL LC on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5"/>
         </tapa.send>

         # Configure UL LCG on RGR
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expect>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="4"/>
         </tapa.send>

         # Send raReq with the preconfigured rapId
         <tapa.send>
            <tapa.tfu.rareq.ind numRaRnti="1" suId="0">
               <tapa.tfu.rareq  numRapId="1" rapIds="50" raRnti="3"
                     tpcs="1" cqiPres="TRUE" cqis="4"/>
            </tapa.tfu.rareq.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="3"/>
         </tapa.send>

         # Expect RaResp for the rapId sent in RaReq
         <tapa.expset>
            <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
               <tapa.tfu.pdcch.cntrl.req/>
            </tapa.tfu.cntrl.req>
            <tapa.tfu.dat.req datReqs="1">
               <tapa.tfu.rarsp.req poHoUeId="0" expectAll="TRUE"
                  chkCqiReq="TRUE" cqiReq="1"/>
            </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind numTti="9"/>
         </tapa.send>

         # Expect a reception request for this UE.
         <tapa.expect>
            <tapa.tfu.recp.req expRecpReq="1">
               <tapa.tfu.pusch.recp.req ueId="0" use="0" saveTo="2"/>
            </tapa.tfu.recp.req>   
         </tapa.expect>

         # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
         <tapa.send>
            <tapa.tfu.tti.ind numTti="4"/>
         </tapa.send>
      
         #Send CRC for Msg
         <tapa.send>
            <tapa.tfu.crc.ind>
               <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            </tapa.tfu.crc.ind>
         </tapa.send>
     
         <tapa.send>
            <tapa.tfu.tti.ind numTti="2"/>
         </tapa.send>

         # Send Data Indication using TB size recieved in the grant
         <tapa.send>
            <tapa.tfu.dat.ind datInds="1">
                <tapa.tfu.dat use="2" lcId="1"/>
            </tapa.tfu.dat.ind>
         </tapa.send>

         # Expect Data Indication at RLC
         <tapa.expect>
            <tapa.rgu.ddatind lchTb1Data="1,1" vldtBuf="TRUE"/>
         </tapa.expect>
     
         <tapa.send>
            <tapa.tfu.tti.ind numTti="1"/>
         </tapa.send>

         # Expect HARQ ACK in PHICH
         <tapa.expect>
            <tapa.tfu.cntrl.req expCntrlReq="1">
               <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
            </tapa.tfu.cntrl.req>
         </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase> 

#
#       Test:    35.19
#
#       Desc:   "To verify the aperiodic CQI trigger in Random access 
#                response of the UE for which PDCCH order got initiated"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
# 

<tapa.testcase id="35.19">
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
        "To verify the aperiodic CQI trigger in Random access response 
         of the UE for which PDCCH order got initiated"
      </tapa.desc>

      <tapa.longdesc>
        "To verify the aperiodic CQI trigger in Random access response 
         of the UE for which PDCCH order got initiated"
      </tapa.longdesc>
         
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched ulDlCfgIdx="1" numRaPreamble="30" 
          sizeRaPreambleGrpA="25" preambleSetPres="1" preambleStart="30" 
          preambleSize="20" sfnEnum="RGAC_RGR_SFN_ANY" raWinSize="10"
          raOccSubFrameNum="1:6" raOccSize = "2" isDlFreqSel="1"/>

   </tapa.cfg>

 # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   # Do RACH init
   <tapa.rg.rachtdd1/>

   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
     <tapa.rgr.cfgreq.cfg.ue instId="5" taTmrPres="TRUE" taTmr="40" 
        maxUlHqTx="4" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL"
        aprdModeEnumPres="TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" 
        bCQIIdx="5"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>

     <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="5" dir="3"
            lcgId="0" ulQci="4" dlQci="4"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm status="0"/>
      </tapa.expect>

     <tapa.send>
         # Configure a dedicated logical channel for the created UE  
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="5" dir="3"
            lcgId="0" ulQci="4" dlQci="4" instId="5"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the configuration applied. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm status="0" instId="5"/>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="13"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req/>
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="1">
            <tapa.tfu.pdsch.dat.req  validate="TRUE" chkTA="TRUE"
               taVal="31" />
         </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # expect a recp req for this UE.
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.hq.recp.req ueId="0"/>
         </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send> 

      <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req/>
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="1">
            <tapa.tfu.pdsch.dat.req  validate="TRUE" chkTA="TRUE"
               taVal="31" />
         </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # expect a recp req for this UE.
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.hq.recp.req ueId="0"/>
         </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 Ttis, to make sure TA is not scheduled for idle UE.  
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send> 

      <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req/>
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="1">
            <tapa.tfu.pdsch.dat.req  validate="TRUE" chkTA="TRUE"
               taVal="31" />
         </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # expect a recp req for this UE.
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.hq.recp.req ueId="0"/>
         </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 Ttis, to make sure TA is not scheduled for idle UE.  
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send> 

      <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req/>
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="1">
            <tapa.tfu.pdsch.dat.req  validate="TRUE" chkTA="TRUE"
               taVal="31" />
         </tapa.tfu.dat.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # expect a recp req for this UE.
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.hq.recp.req ueId="0"/>
         </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="5"/>
      </tapa.send> 

      # Send BO for the created logical channel on RGU to trigger a PO. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="5" bo="10"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send> 

      <tapa.expset>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" vldtTx="TRUE" vldtPO="TRUE" poRapId="30" prachMaskIdx="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send RaReqInd for one rapId in the first special frame 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="14"/>
      </tapa.send>

      # RA Req on PO Rap ID
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq numRapId="1" rapIds="30" tpcs="1" cqiPres="TRUE" cqis="4" raRnti="52"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="5"/>
      </tapa.send>
      
      # Expect RaResp for the rapId sent in RaReq
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req poUeId="61"
              chkCqiReq="TRUE" cqiReq="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit.grp16/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>

</tapa.testcase> 

#
#       Test:    35.20
#
#       Desc:   "To verify Aperiodic CQI trigger when weighted sum, which 
#                is a function of number of ACKs and NACKS, is reaching 
#                the threshold"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.20">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify Aperiodic CQI trigger when weighted sum, 
         which is a function of number of ACKs and NACKS, 
         is reaching the threshold.
      </tapa.desc>

      <tapa.longdesc>
         To verify Aperiodic CQI trigger when weighted sum, 
         which is a function of number of ACKs and NACKS, 
         is reaching the threshold. Provided ACKS 40 times 
         to reach threshold.  
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" maxDlHqTx="5" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0" 
         txModeEnum="RGR_UE_TM_3"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>  

   # Configure bi-directional DCCH for default UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Expect configuration confirm after the TTI
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Configure bi-directional DTCH for default UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="4" />
   </tapa.send>

   # Expect configuration confirm after the TTI
   <tapa.expect>
      <tapa.crg.cfgcfm status="0"/>
   </tapa.expect>

   <!--- on RGR interface -->
   # Configure bi-directional DCCH for default UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5"/>
   </tapa.send>

   # Send TTI indication for default cell
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect configuration confirm
   <tapa.expect>
      <tapa.rgr.cfgCfm status="0"/>
   </tapa.expect>

   # Configure bi-directional DTCH for default UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch lcId="4" dir="1" lcType="4" instId="5"/>
   </tapa.send>

   # Send TTI indication for default cell
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   #Expect configuration confirm
   <tapa.expect>
      <tapa.rgr.cfgCfm status="0" />
   </tapa.expect>    

   <tapa.repeat.start repeatCount="41"/>  
   # DATA --->1  
   <tapa.send>
      # Send BO for the created logical channel on RGU.
      <tapa.rgu.dstarsp lcId="4" lcType="4" bo="50"/>
   </tapa.send>

   <tapa.send>
      # Send a Tti to get the transmission scheduled.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # DATA --->1 
   <tapa.expect>
      # Expect staInd from MAC to RLC
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="2"/>
   </tapa.expect>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU.
      <tapa.rgu.ddatreq lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # DATA --->1 at (3,7) for DL SF (3,9)
   <tapa.expset>
      <tapa.tfu.cntrl.req expCntrlReq="1">
         <tapa.tfu.pdcch.cntrl.req saveTo="9" vldDciFrmt="TRUE" isFormat2a="TRUE" transMode="TFU_UE_TM_3"/>
      </tapa.tfu.cntrl.req>
      <tapa.tfu.dat.req datReqs="1">
         <tapa.tfu.pdsch.dat.req  use="9" lcId="4" chkSdu="TRUE"/>
      </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   # DATA --->1: expect Recp Req at (4,1)
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1">
         <tapa.tfu.hq.recp.req/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   #1 DATA --->1: Send Hq Ind at (4,4) for UL Subframe (4,3)
   <tapa.send>
      <tapa.tfu.hq.ind hqInds="1">
         <tapa.tfu.hq  isAckLst="TRUE"/>
      </tapa.tfu.hq.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1" />
   </tapa.send> 
   <tapa.repeat.end />  

   # Expect DCI format 0
   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1">
         <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" 
            vldtGrant="TRUE" vldtTx="TRUE" cqiReq="1"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>   

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>     

#
#       Test:    35.21
#
#       Desc:   "To test the successful DL path for a MAC PDU for a 
#                frequency selective cell with UE configured to report
#                CQI through aperiodic mode 3-0. Allocated RBs are
#                overlapping with PBCH RBs"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.21"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To test the successful DL path for a MAC PDU for a
         frequency selective cell with UE configured to report
         CQI through aperiodic mode 3-0.
      </tapa.desc>

      <tapa.longdesc>
         To test the successful DL path for a MAC PDU for a
         frequency selective cell with UE configured to report
         CQI through aperiodic mode 3-0. Allocated RBs are 
         overlapping with PBCH RBs. 
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" maxDlHqTx="5" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0" 
         txModeEnum="RGR_UE_TM_3"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>  

   #Trigger Aperiodic CQI
   <tapa.rg.dlfs.aprdcqiTrg ueId="0"/>
  
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect data reception request, HARQ for DL Data and ACQI
   <tapa.expset>
      <tapa.tfu.recp.req expRecpReq="1">
         <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
            cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="0" riPres="1" ri="1"/>
      </tapa.tfu.recp.req>   
   </tapa.expset> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" ri="1" wbCqi="10"
            cqiIdxLst="0:1:3:2:2:1:0:1:2"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>
                      
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created logical channel on RGU.
      <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      # Expect staInd from MAC to RLC
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="1"/>
   </tapa.expect>

   <tapa.send>
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="4"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect PDSCH and PDCCH for the dat req for DAT1
   <tapa.expset>
     <tapa.tfu.cntrl.req expCntrlReq="1" >
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" vldDciFrmt="TRUE" isFormat2a="TRUE"
           isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
           vldtResAllocMap="TRUE" resAllocMap="35:192:128:0" />
      </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0"  use="1" lcId="4" chkSdu="TRUE"
            transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
            saveTo="2"/>
     </tapa.tfu.dat.req>
   </tapa.expset> 
</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>      

#
#       Test:    35.22
#
#       Desc:   "To verify the collision between aperiodic CQI 
#                and periodic CQI"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.22">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the collision between aperiodic CQI 
         and periodic CQI.
      </tapa.desc>

      <tapa.longdesc>
         To verify the collision between aperiodic CQI 
         and periodic CQI.
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" maxDlHqTx="5" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0" 
         txModeEnum="RGR_UE_TM_3" prdModeEnumPres="TRUE" K="1" prdCqiCfg.type="TRUE"
         prdModeEnum="RGAC_RGR_PRD_CQI_MOD20" cqiRepType="2" cqiPCfgIdx="308"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>  

   <tapa.send>
      <tapa.tfu.tti.ind numTti="60" />
   </tapa.send>

   #Trigger Aperiodic CQI
   <tapa.rg.dlfs.aprdcqiTrg/>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect data reception request, HARQ for DL Data and ACQI
   <tapa.expset>
      <tapa.tfu.recp.req expRecpReq="1">
         <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
            cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="0" riPres="1" ri="1"/>
      </tapa.tfu.recp.req>   
   </tapa.expset> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" ri="1" wbCqi="10"
            cqiIdxLst="0:1:3:2:2:1:0:1:2"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>
                      
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="155"/>
   </tapa.send>

   #Expect SB CQI recp req BP 1 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>   
</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>  

#
#       Test:    35.23
#
#       Desc:   "To verify the scenario when RI in aperiodic CQI report is 
#                different from the previously reported periodic RI"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.23">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the scenario when RI in aperiodic CQI report 
         is different from the previously reported periodic RI.
      </tapa.desc>

      <tapa.longdesc>
         To verify the scenario when RI in aperiodic CQI report 
         is different from the previously reported periodic RI.
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" maxDlHqTx="5" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0" riEna="TRUE" riCfgIdx="166" 
         txModeEnum="RGR_UE_TM_3" prdModeEnumPres="TRUE" K="1" prdCqiCfg.type="TRUE"
         prdModeEnum="RGAC_RGR_PRD_CQI_MOD20" cqiRepType="2" cqiPCfgIdx="308"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>  

   <tapa.send>
      <tapa.tfu.tti.ind numTti="112" />
   </tapa.send>

   #Expect RI recp req at (14,5) for (14,7)
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="1"/>
      </tapa.tfu.recp.req>
   </tapa.expect>   

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" ri="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>  

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2" />
   </tapa.send>

   #Expect WB CQI recp req at (15,0) for (15,2)
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" wbCqi="6" rawDlCqiEnc="TRUE"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send> 

   #Trigger Aperiodic CQI
   <tapa.rg.dlfs.aprdcqiTrg/>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect data reception request, HARQ for DL Data and ACQI
   <tapa.expset>
      <tapa.tfu.recp.req expRecpReq="1">
         <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
            cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="0" riPres="1" ri="1"/>
      </tapa.tfu.recp.req>   
   </tapa.expset> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" ri="1" wbCqi="10"
            cqiIdxLst="2:1:3:2:2:1:0:1:2"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>
                      
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="95"/>
   </tapa.send>

   #Expect SB CQI recp req BP 1 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
            vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>   

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="10" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send> 

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created logical channel on RGU.
      <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      # Expect staInd from MAC to RLC
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="1"/>
   </tapa.expect>

   <tapa.send>
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="4"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect PDSCH and PDCCH for the dat req for DAT1
   <tapa.expset>
     <tapa.tfu.cntrl.req expCntrlReq="1" >
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" vldDciFrmt="TRUE" isFormat2a="TRUE"
           isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
           vldtResAllocMap="TRUE" resAllocMap="195:128:0:0" />
      </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req ueId="0"  use="1" lcId="4" chkSdu="TRUE"
            transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
            saveTo="2"/>
     </tapa.tfu.dat.req>
   </tapa.expset> 

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>  
 
#
#       Test:    35.24
#
#       Desc:   "To verify the Invalid configuration of Periodic CQI 
#                for dlTotalBw less than 7"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.24">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the Invalid configuration of Periodic CQI 
         for dlTotalBw less than 7.
      </tapa.desc>

      <tapa.longdesc>
         To verify the Invalid configuration of Periodic CQI
         for dlTotalBw less than 7.
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="7" raWinSize="10" ulTotalBw="50"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
      prdBsrTmr="65535" ueCatEnum="1" prdModeEnumPres="TRUE" K="4" prdCqiCfg.type="TRUE" 
      prdModeEnum="RGAC_RGR_PRD_CQI_MOD20" cqiRepType="2"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5" status="15"/>
   </tapa.expect>  
</tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>   

#
#       Test:    35.25
#
#       Desc:   "To verify the DL RB allocation for multi UEs based 
#                on periodic subband CQI report such that make sure 
#                UE are prioritized based on Average CQI"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.25">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the DL RB allocation for multi UEs based 
         on periodic subband CQI report such that make sure 
         UE are prioritized based on Average CQI.
      </tapa.desc>

      <tapa.longdesc>
         To verify the DL RB allocation for multi UEs based 
         on periodic subband CQI report such that make sure 
         UE are prioritized based on Average CQI.
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="25" raWinSize="10" ulTotalBw="25" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
      # Send UE config request
      <tapa.rg.UeInitTdd1 instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" prdModeEnumPres="TRUE" K="1" prdCqiCfg.type="TRUE" 
         prdModeEnum="RGAC_RGR_PRD_CQI_MOD20" cqiRepType="2" cqiPCfgIdx="308" 
         riEna="TRUE" riCfgIdx="166" txModeEnum="RGR_UE_TM_3"/>

      <tapa.rg.UeInitTdd1 instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" prdModeEnumPres="TRUE" K="1" prdCqiCfg.type="TRUE" 
         prdModeEnum="RGAC_RGR_PRD_CQI_MOD20" cqiRepType="2" cqiPCfgIdx="308" cqiPResIdx="502" 
         riEna="TRUE" riCfgIdx="166" txModeEnum="RGR_UE_TM_3" ueId="1"/>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="66" />
      </tapa.send>

      #Expect RI recp req at (14,5) for (14,7)
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="2" spId="1">
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="1"/>
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="502" cqiPmiSz="1" ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expect>   

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3" />
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="0" ri="1"/>
            <tapa.tfu.rawdlcqi ueId="1" ri="1"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>  

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2" />
      </tapa.send>

      #Expect WB CQI recp req at (15,0) for (15,2)
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="2" spId="1">
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="4"/>
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="502" cqiPmiSz="4" ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expect> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="0" wbCqi="12" rawDlCqiEnc="TRUE"/>
            <tapa.tfu.rawdlcqi ueId="1" wbCqi="13" rawDlCqiEnc="TRUE"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>      

      <tapa.send>
         <tapa.tfu.tti.ind numTti="157"/>
      </tapa.send>

      #Expect SB CQI recp req BP 1 
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="2" spId="1">
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="502" cqiPmiSz="6" ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expect>   

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="10" label="0"/>
            <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>    

      <tapa.send>
         <tapa.tfu.tti.ind numTti="157"/>
      </tapa.send>

      #Expect SB CQI recp req BP 2 
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="2" spId="1">
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="502" cqiPmiSz="6" ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expect>   

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="14" label="0"/>
            <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" sbCqi="15" label="0"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>     

      # Configure bi-directional DCCH for default UE
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure bi-directional DTCH for default UE
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="4" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.crg.cfgcfm status="0"/>
      </tapa.expect>

      # Configure bi-directional DCCH for UE 1
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" ueId="1" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.crg.cfgcfm ueId="1"/>
      </tapa.expect>

      # Configure bi-directional DTCH for default UE
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="4" ueId="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.crg.cfgcfm status="0" ueId="1"/>
      </tapa.expect>  

      <!--- on RGR interface -->
      # Configure bi-directional DCCH for default UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5"/>
      </tapa.send>

      <!--- on RGR interface -->
      # Configure bi-directional DCCH for default UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" ueId="1"/>
      </tapa.send> 


      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0"/>
      </tapa.expect>

      # Expect configuration confirm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0" ueId="1"/>
      </tapa.expect>

      # Configure UL LCG on RGR for UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Configure bi-directional DTCH for default UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="4" dir="1" lcType="4" instId="5"/>
      </tapa.send>

       # Configure UL LCG on RGR for UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5" ueId="1"/>
      </tapa.send>

      # Configure bi-directional DTCH for default UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="4" dir="1" lcType="4" instId="5" ueId="1"/>
      </tapa.send> 

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      #Expect configuration confirm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0" />
      </tapa.expect>

      #Expect configuration confirm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0" ueId="1"/>
      </tapa.expect>

      <tapa.send>
         # Send a Tti to get the transmission scheduled.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0"/>
      </tapa.expect> 

      # Expect configuration confirm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0" ueId="1"/>
      </tapa.expect> 

      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="4" lcType="4" bo="500"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="4" lcType="4" bo="500" ueId="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC
         <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="1" ueId="1"/>
      </tapa.expect>

      <tapa.expect>
         # Expect staInd from MAC to RLC
         <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="1"/>
      </tapa.expect>

      <tapa.send>
         <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="4"/>
      </tapa.send>

      <tapa.send>
         <tapa.rgu.ddatreq ueId="1" lchTb1Data="4" lcType="4"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDSCH and PDCCH for the dat req for DAT1
      <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="2" >
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" vldDciFrmt="TRUE" isFormat2a="TRUE"
               isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
               vldtResAllocMap="TRUE" resAllocMap="56:0:0:0" />
            <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" vldDciFrmt="TRUE" isFormat2a="TRUE"
               isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
               vldtResAllocMap="TRUE" resAllocMap="0:192:0:0" />
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="2">
            <tapa.tfu.pdsch.dat.req ueId="0"  use="1" lcId="4" chkSdu="TRUE"
               transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
               saveTo="3" />
            <tapa.tfu.pdsch.dat.req ueId="1"  use="2" lcId="4" chkSdu="TRUE"
               transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
               saveTo="4" />
         </tapa.tfu.dat.req>  
      </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>         

#
#       Test:    35.26
#
#       Desc:   "To verify the DL RB allocation for multi UEs based 
#                on periodic subband CQI report such that make sure 
#                UE are prioritized based on Average CQI"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.26">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the DL RB allocation for multi UEs based 
         on periodic subband CQI report such that make sure 
         UE are prioritized based on Average CQI.
      </tapa.desc>

      <tapa.longdesc>
         To verify the DL RB allocation for multi UEs based 
         on periodic subband CQI report such that make sure 
         UE are prioritized based on Average CQI.
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="25" raWinSize="10" ulTotalBw="25" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
      # Send UE config request
      <tapa.rg.UeInitTdd1 instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" prdModeEnumPres="TRUE" K="1" prdCqiCfg.type="TRUE" 
         prdModeEnum="RGAC_RGR_PRD_CQI_MOD20" cqiRepType="2" cqiPCfgIdx="308" 
         riEna="TRUE" riCfgIdx="166" txModeEnum="RGR_UE_TM_3"/>

      <tapa.rg.UeInitTdd1 instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" prdModeEnumPres="TRUE" K="1" prdCqiCfg.type="TRUE" 
         prdModeEnum="RGAC_RGR_PRD_CQI_MOD20" cqiRepType="2" cqiPCfgIdx="308" cqiPResIdx="502" 
         riEna="TRUE" riCfgIdx="166" txModeEnum="RGR_UE_TM_3" ueId="1"/>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="66" />
      </tapa.send>

      #Expect RI recp req at (14,5) for (14,7)
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="2" spId="1">
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="1"/>
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="502" cqiPmiSz="1" ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expect>   

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3" />
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="0" ri="1"/>
            <tapa.tfu.rawdlcqi ueId="1" ri="1"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>  

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2" />
      </tapa.send>

      #Expect WB CQI recp req at (15,0) for (15,2)
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="2" spId="1">
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="4"/>
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="502" cqiPmiSz="4" ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expect> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="0" wbCqi="12" rawDlCqiEnc="TRUE"/>
            <tapa.tfu.rawdlcqi ueId="1" wbCqi="12" rawDlCqiEnc="TRUE"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>      

      <tapa.send>
         <tapa.tfu.tti.ind numTti="157"/>
      </tapa.send>

      #Expect SB CQI recp req BP 1 
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="2" spId="1">
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="502" cqiPmiSz="6" ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expect>   

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="10" label="0"/>
            <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" sbCqi="11" label="1"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>    

      <tapa.send>
         <tapa.tfu.tti.ind numTti="157"/>
      </tapa.send>

      #Expect SB CQI recp req BP 2 
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="2" spId="1">
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="500" cqiPmiSz="6"/>
            <tapa.tfu.dlcqi.recp.req vldtPucchRsrc="TRUE" pdcchSavedIdx="1" 
               vldtCqiPmiSz="TRUE" n2PucchIdx="502" cqiPmiSz="6" ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expect>   

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="14" label="0"/>
            <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" sbCqi="15" label="0"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>     

      # Configure bi-directional DCCH for default UE
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure bi-directional DTCH for default UE
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="4" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.crg.cfgcfm status="0"/>
      </tapa.expect>

      # Configure bi-directional DCCH for UE 1
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" ueId="1" />
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.crg.cfgcfm ueId="1"/>
      </tapa.expect>

      # Configure bi-directional DTCH for default UE
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="4" ueId="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.crg.cfgcfm status="0" ueId="1"/>
      </tapa.expect>  

      <!--- on RGR interface -->
      # Configure bi-directional DCCH for default UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5"/>
      </tapa.send>

      <!--- on RGR interface -->
      # Configure bi-directional DCCH for default UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5" ueId="1"/>
      </tapa.send> 


      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0"/>
      </tapa.expect>

      # Expect configuration confirm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0" ueId="1"/>
      </tapa.expect>

      # Configure UL LCG on RGR for UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Configure bi-directional DTCH for default UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="4" dir="1" lcType="4" instId="5"/>
      </tapa.send>

       # Configure UL LCG on RGR for UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5" ueId="1"/>
      </tapa.send>

      # Configure bi-directional DTCH for default UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="4" dir="1" lcType="4" instId="5" ueId="1"/>
      </tapa.send> 

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      #Expect configuration confirm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0" />
      </tapa.expect>

      #Expect configuration confirm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0" ueId="1"/>
      </tapa.expect>

      <tapa.send>
         # Send a Tti to get the transmission scheduled.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0"/>
      </tapa.expect> 

      # Expect configuration confirm
      <tapa.expect>
         <tapa.rgr.cfgCfm status="0" ueId="1"/>
      </tapa.expect> 

      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="4" lcType="4" bo="500"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="4" lcType="4" bo="500" ueId="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC
         <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="1" ueId="1"/>
      </tapa.expect>

      <tapa.expect>
         # Expect staInd from MAC to RLC
         <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="1"/>
      </tapa.expect>

      <tapa.send>
         <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="4"/>
      </tapa.send>

      <tapa.send>
         <tapa.rgu.ddatreq ueId="1" lchTb1Data="4" lcType="4"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDSCH and PDCCH for the dat req for DAT1
      <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="2" >
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" vldDciFrmt="TRUE" isFormat2a="TRUE"
               isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
               vldtResAllocMap="TRUE" resAllocMap="56:0:0:0" />
            <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" vldDciFrmt="TRUE" isFormat2a="TRUE"
               isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
               vldtResAllocMap="TRUE" resAllocMap="128:192:0:0" />
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="2">
            <tapa.tfu.pdsch.dat.req ueId="0"  use="1" lcId="4" chkSdu="TRUE"
               transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
               saveTo="3" />
            <tapa.tfu.pdsch.dat.req ueId="1"  use="2" lcId="4" chkSdu="TRUE"
               transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
               saveTo="4" />
         </tapa.tfu.dat.req>  
      </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>          

#
#       Test:    35.27
#
#       Desc:   "To test the successful DL path for a UE without 
#                CQI Reporting Configuration" 
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.27"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To test the successful DL path for a UE without 
         CQI Reporting Configuration. 
      </tapa.desc>

      <tapa.longdesc>
         To test the successful DL path for a UE without 
         CQI Reporting Configuration. 
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" maxDlHqTx="5" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
   
   # Do RACH init
   <tapa.rg.rachtdd1/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Send UE config request
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.ue instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" ueId="0" 
         txModeEnum="RGR_UE_TM_3"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>  

   # Configure bi-directional DCCH for default UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch lcId="1" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Expect configuration confirm after the TTI
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   # Configure bi-directional DTCH for default UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="4" />
   </tapa.send>

   # Expect configuration confirm after the TTI
   <tapa.expect>
      <tapa.crg.cfgcfm status="0"/>
   </tapa.expect>

   <!--- on RGR interface -->
   # Configure bi-directional DCCH for default UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch lcId="1" dir="1" lcType="5" instId="5"/>
   </tapa.send>

   # Send TTI indication for default cell
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect configuration confirm
   <tapa.expect>
      <tapa.rgr.cfgCfm status="0"/>
   </tapa.expect>

   # Configure UL LCG on RGR for UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
   </tapa.send>

   # Configure bi-directional DTCH for default UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch lcId="4" dir="1" lcType="4" instId="5"/>
   </tapa.send>

   # Send TTI indication for default cell
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   #Expect configuration confirm
   <tapa.expect>
      <tapa.rgr.cfgCfm status="0" />
   </tapa.expect>    

   <tapa.send>
      # Send BO for the created logical channel on RGU.
      <tapa.rgu.dstarsp lcId="4" lcType="4" bo="50"/>
   </tapa.send>

   <tapa.send>
      # Send a Tti to get the transmission scheduled.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect configuration confirm
   <tapa.expect>
      <tapa.rgr.cfgCfm status="0"/>
   </tapa.expect>

   <tapa.expect>
      # Expect staInd from MAC to RLC
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="2"/>
   </tapa.expect>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU.
      <tapa.rgu.ddatreq lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
      <tapa.tfu.cntrl.req expCntrlReq="1">
         <tapa.tfu.pdcch.cntrl.req saveTo="9" vldDciFrmt="TRUE" isFormat2a="TRUE" 
            transMode="TFU_UE_TM_3" vldtResAllocMap="TRUE" resAllocMap="192:0:0:0"/>
      </tapa.tfu.cntrl.req>
      <tapa.tfu.dat.req datReqs="1">
         <tapa.tfu.pdsch.dat.req  use="9" lcId="4" chkSdu="TRUE"/>
      </tapa.tfu.dat.req>
   </tapa.expset> 

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>      

#
#       Test:    35.28
#
#       Desc:   "To verify the RB allocation for combination of new 
#                transmisison and re-transmission"
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.28"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         To verify the RB allocation for combination of new 
         transmisison and re-transmission.
      </tapa.desc>

      <tapa.longdesc>
         To verify the RB allocation for combination of new 
         transmisison and re-transmission.
      </tapa.longdesc>

   </tapa.doc>
   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" ulTotalBw="50" maxDlHqTx="5" numTxAntPorts="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>

      # UE Configuration
      <tapa.rg.UeInitTdd1 instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="0" 
         txModeEnum="RGR_UE_TM_3"/>

      #Initialize 2nd UE
      <tapa.rg.UeInitTdd1 instId="5" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" 
         prdBsrTmr="65535" ueCatEnum="CM_LTE_UE_CAT_4" aprdModeEnumPres="TRUE" 
         aprdModeEnum="RGAC_RGR_APRD_CQI_MOD30" ueId="1" 
         txModeEnum="RGR_UE_TM_3"/>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      #Trigger Aperiodic CQI
      <tapa.rg.dlfs.aprdcqiTrg ueId="0"/>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect data reception request, HARQ for DL Data and ACQI
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
               cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="0" riPres="1" ri="1"/>
         </tapa.tfu.recp.req>   
      </tapa.expset> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" ri="1" wbCqi="10"
               cqiIdxLst="2:1:2:3:0:0:2:3:1"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="8"/>
      </tapa.send>

      #Trigger Aperiodic CQI
      <tapa.rg.dlfs.aprdcqiTrg ueId="1"/>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect data reception request, HARQ for DL Data and ACQI
      <tapa.expset>
         <tapa.tfu.recp.req expRecpReq="1">
            <tapa.tfu.pusch.recp.req use ="1" saveTo="2" vldtCqi="TRUE"
               cqiPmiSzR1="22" cqiPmiSzRn1="22" cqiBetaOff="0" 
               riPres="1" ri="1" ueId="1"/>
         </tapa.tfu.recp.req>   
      </tapa.expset> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send Raw CQI Indication
      <tapa.send >
         <tapa.tfu.rawdlcqi.ind>
            <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" ri="1" wbCqi="10"
               cqiIdxLst="1:2:3:0:0:3:1:2:2"/>
         </tapa.tfu.rawdlcqi.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req isAck="TRUE" ueId="1"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>  

      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000" ueId="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC
         <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="1"/>
         <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="1" ueId="1"/>
      </tapa.expset>

      <tapa.send>
         <tapa.rgu.ddatreq ueId="1" lchTb1Data="4" lcType="4"/>
      </tapa.send> 

      <tapa.send>
         <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="4"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDSCH and PDCCH for the dat req for DAT1
      <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="2" >
            <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1" vldDciFrmt="TRUE" isFormat2a="TRUE"
               isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
               vldtResAllocMap="TRUE" resAllocMap="176:3:128:0" />
            <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="2" vldDciFrmt="TRUE" isFormat2a="TRUE"
               isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
               vldtResAllocMap="TRUE" resAllocMap="76:12:0:0"/>
         </tapa.tfu.cntrl.req>
         <tapa.tfu.dat.req datReqs="2">
            <tapa.tfu.pdsch.dat.req ueId="1"  use="1" lcId="4" chkSdu="TRUE"
               transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
               saveTo="3"/>
            <tapa.tfu.pdsch.dat.req ueId="0"  use="2" lcId="4" chkSdu="TRUE"
               transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
               saveTo="4"/>
         </tapa.tfu.dat.req>
      </tapa.expset> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="2">
            <tapa.tfu.hq.recp.req/>
            <tapa.tfu.hq.recp.req ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3" />
      </tapa.send>

      <tapa.send>
         <tapa.tfu.hq.ind hqInds="2">
            <tapa.tfu.hq  isAckLst="FALSE"/>
            <tapa.tfu.hq  isAckLst="TRUE" isAckLstTb2="TRUE" 
               isTb2="TRUE" ueId="1"/>
         </tapa.tfu.hq.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="4" lcType="4" bo="1000" ueId="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC
         <tapa.rgu.dstaind lchTb1Data="4" saveTo="2" numLchTb2="1" ueId="1"/>
      </tapa.expect>

      <tapa.send>
         <tapa.rgu.ddatreq ueId="1" lchTb1Data="4" lcType="4"/>
      </tapa.send> 

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1" />
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.cntrl.req expCntrlReq="2" >
            <tapa.tfu.pdcch.cntrl.req saveTo="9"  validate="TRUE" vldtRetx="TRUE"/>
            <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1" vldDciFrmt="TRUE" isFormat2a="TRUE"
               isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" 
               vldtResAllocMap="TRUE" resAllocMap="48:7:128:0" />
         </tapa.tfu.cntrl.req>

         <tapa.tfu.dat.req datReqs="2">
            <tapa.tfu.pdsch.dat.req  use="9" lcId="4" chkSdu="TRUE" 
               isRetx="TRUE" retxUse="5" validate="TRUE" vldtRetx="TRUE"/>
            <tapa.tfu.pdsch.dat.req ueId="1"  use="1" lcId="4" chkSdu="TRUE"
               transMode="TFU_UE_TM_3" isTb1="TRUE" isTb2="TRUE" numTb1Lyrs="1" numTb2Lyrs="1"
               saveTo="3"/>
         </tapa.tfu.dat.req>  
      </tapa.expset>  

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase> 

#
#       Test:    35.29
#
#       Desc:    To test successful Configuration/Re-Configuration of Multiple UEs at CRG and RGR
#                   with PCQI,RI, ACQI,SRS and SR being enabled and released and various other
#		      Configuration parameters set.
#
#       Notes:   None
#              
#       Module:  Configuration 
#
#       File:    rgac_tc20.xml
#

<tapa.testcase id="35.29">

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test successful CRG and RGR Multiple UEs Configuration, 
           Reconfiguration, config params setting and Release"
      </tapa.desc>

      <tapa.longdesc>
         "Finish CELL, Common Logical channel configurations at CRG and RGR
         and also finish RACH and then send UE configuration request to 
         LTEMAC from Dummy RRC with enabling  PCQI,RI, ACQI,SRS and SR for Few
         UEs, Reconfigure them with  PCQI,RI, ACQI,SRS and SR enabled for few other
         UEs and set various other configuration parameters "
      </tapa.longdesc>
   </tapa.doc>

  # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef>
         <tapa.flag id="TFU_UPGRADE"/>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched ulDlCfgIdx="0"  dlSchdType="2" ulSchdType="2"
         raWinSize="10" numTxAntPorts ="2"/>

   </tapa.cfg>


   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
         # Send RaReqInd for one rapId in the first special frame 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="5"/>
      </tapa.send>

         # Send it in the 6th frequency index 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="4" numRapId="2" rapIds="5:6" cqiPres="TRUE:TRUE" cqis="4:4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # In this TC, it shall expect raResp in the first DL subframe after 3 Ttis.

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      <tapa.send lc="TRUE">
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      
      # Expect RaResp for the rapId sent in RaReq
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="4"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="7"/>
      </tapa.send>

      # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="2" spId="1">
            <tapa.tfu.msg3.recp.req ueId="0"/>
            <tapa.tfu.msg3.recp.req ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expect>

      <tapa.send lc="TRUE">
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   #Send CRC for Msg3
   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send lc="TRUE">
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="0"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

      # Expect Message3 datReq on CCCH at RGU.
      <tapa.expset>
         <tapa.rgu.cdatind ueId="0" lcId="4"/>
      <tapa.tfu.cntrl.req expCntrlReq="2" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="1"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>
     # Expect Message3 datReq on CCCH at RGU.
      <tapa.expect>
         <tapa.rgu.cdatind ueId="1" lcId="4"/>
      </tapa.expect>


    # Send BO for Msg4 on RGU.
    <tapa.send>
       <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10" ueId="0" />
    </tapa.send>

    # Send BO for Msg4 on RGU.
    <tapa.send>
       <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10" ueId="1" />
    </tapa.send>

   <tapa.send lc="TRUE">
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect CStatInd For MSG4
   <tapa.expset>
      <tapa.rgu.cstaind lcId="4" ueId="0"/>
      <tapa.rgu.cstaind lcId="4" ueId="1"/>
   </tapa.expset>

   <tapa.delay delay="1"/>
   # Send Msg4 on RGU.
   <tapa.send>
      <tapa.rgu.cdatreq ueId="0" lcId="4" lcType="3" />
   </tapa.send>

   # Send Msg4 on RGU.
   <tapa.send>
      <tapa.rgu.cdatreq ueId="1" lcId="4" lcType="3" />
   </tapa.send>

   <tapa.send lc="TRUE">
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect Msg4 from MAC to PHY.
   <tapa.expset>
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req use="1" validate="FALSE" ueId="0"/>
        <tapa.tfu.pdsch.dat.req use="1" validate="FALSE" ueId="1"/>
     </tapa.tfu.dat.req>
     <tapa.tfu.cntrl.req expCntrlReq="2" spId="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1" ueId="0" />
        <tapa.tfu.pdcch.cntrl.req saveTo="2" ueId="1" />
     </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   # Recv Hq Recp Req for Msg4.
   <tapa.expect>
     <tapa.tfu.recp.req expRecpReq="2" spId="1">
        <tapa.tfu.hq.recp.req ueId="0" />
        <tapa.tfu.hq.recp.req ueId="1" />
     </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send lc="TRUE">
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   # Send ACK as feedback for Msg4.
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAckLst="TRUE"/>
        <tapa.tfu.hq ueId="1" isAckLst="TRUE"/>
     </tapa.tfu.hq.ind>
  </tapa.send>

   <tapa.delay delay="1"/>
   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue ueId="0"/>
   </tapa.send>

   # Send UE config request
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue ueId="1"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expset>
      <tapa.crg.cfgcfm/>
      <tapa.crg.cfgcfm/>
   </tapa.expset>

   # Send UE config request
   <tapa.send>
     <tapa.rgr.cfgreq.cfg.ue instId="5" ueId="0" txModeEnum="RGR_UE_TM_3"/>
   </tapa.send>

   # Send UE config request
   <tapa.send>
     <tapa.rgr.cfgreq.cfg.ue instId="5" ueId="1" txModeEnum="RGR_UE_TM_3"
     aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"
      aprdModeEnumPres="TRUE" prdCqiCfg.type="TRUE" riEna="TRUE"  srCfgPres="TRUE" />
   </tapa.send>

      # Expect success in cfg cfm
   <tapa.expset>
      <tapa.rgr.cfgCfm instId="5"/>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expset>       
      
    # Send UE ReConfiguration for the same UE-0 created above for Aperiodic CQI Cfg
      # at RGR
      <tapa.send>
          <tapa.rgr.cfgreq.recfg.ue  ueId="0"  txModeEnum="RGR_UE_TM_3"
       aprdModeEnumPres="TRUE"  aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20" 
       UeReCfgType="2" />
      </tapa.send>
      
    # Send UE ReConfiguration for the same UE-0 created above for Periodic CQI Cfg
      # at RGR
      <tapa.send>
          <tapa.rgr.cfgreq.recfg.ue  ueId="0" txModeEnum="RGR_UE_TM_3"
       prdCqiCfg.type="TRUE" riEna="TRUE" UeReCfgType="4096" />
      </tapa.send>


      # Send UE ReConfiguration for the same UE-0 created above for SR Cfg
      # at RGR
      <tapa.send>
          <tapa.rgr.cfgreq.recfg.ue  ueId="0" txModeEnum="RGR_UE_TM_3"
             srCfgPres="TRUE"  UeReCfgType="16384" />
      </tapa.send>

       # Send UE ReConfiguration for the same UE-1 created above for PRD DLCQI
      # Recfg at RGR
      <tapa.send>
          <tapa.rgr.cfgreq.recfg.ue  ueId="1" 
             cqiPResIdx="501" cqiPCfgIdx="315" cqiRepType="2" k="2" riCfgIdx = "501"
             sANCQI ="FALSE" prdModeEnum = "RGAC_RGR_PRD_CQI_MOD20" UeReCfgType="4096" />
      </tapa.send>


       # Send UE ReConfiguration for the same UE-1 created above for SR
      # Recfg at RGR
      <tapa.send>
          <tapa.rgr.cfgreq.recfg.ue  ueId="1" srCfgIdx="46" dTMax="16" 
        UeReCfgType="16384" />
      </tapa.send>
      
      
    # Send TTI to apply the reconfig
      <tapa.send>
        <tapa.tfu.tti.ind/>
      </tapa.send>

    #Expect positive Configuration Confirm from LTEMAC
      <tapa.expset>
         <tapa.rgr.cfgCfm ueId="0"/>
         <tapa.rgr.cfgCfm ueId="0"/>
         <tapa.rgr.cfgCfm ueId="0"/>
         <tapa.rgr.cfgCfm ueId="1"/>
         <tapa.rgr.cfgCfm ueId="1"/>
      </tapa.expset>


    # Send UE ReConfiguration for the same UE-1 created above for ACQI Release
      # at RGR
      <tapa.send>
          <tapa.rgr.cfgreq.recfg.ue  ueId="1" 
       aprdModeEnumPres="FALSE"  UeReCfgType="2" />
      </tapa.send>
    
      # Send UE PCQI/RI ReConfiguration for the same UE-1 created above  
      # for PRD DLCQI release
      <tapa.send>
          <tapa.rgr.cfgreq.recfg.ue  ueId="1"  prdCqiCfg.type="FALSE" 
        UeReCfgType="4096" />
      </tapa.send>

      # Send UE SR ReConfiguration for the same UE-1 created above 
      # for SR Release
      <tapa.send>
          <tapa.rgr.cfgreq.recfg.ue  ueId="1" srCfgPres="FALSE" 
        UeReCfgType="16384" />
      </tapa.send>
    
     # Send TTI to apply the reconfig
      <tapa.send>
        <tapa.tfu.tti.ind/>
      </tapa.send>

     #Expect positive Configuration Confirm from LTEMAC
      <tapa.expset>
         <tapa.rgr.cfgCfm ueId="1"/>
         <tapa.rgr.cfgCfm ueId="1"/>
         <tapa.rgr.cfgCfm ueId="1"/>
      </tapa.expset>

      # Send UE ReConfiguration for the same UE-1 created above for ACQI setup
      # at RGR
      <tapa.send>
          <tapa.rgr.cfgreq.recfg.ue  ueId="1"  txModeEnum="RGR_UE_TM_3"
          aprdModeEnum="RGAC_RGR_APRD_CQI_MOD20"
       aprdModeEnumPres="TRUE"  UeReCfgType="2" />
      </tapa.send>
      
       # Send UE PCQI/RI ReConfiguration for the same UE-1 created above  
      # with allowed range
      <tapa.send>
          <tapa.rgr.cfgreq.recfg.ue  ueId="1" txModeEnum="RGR_UE_TM_3"
          prdCqiCfg.type="TRUE" riEna="TRUE" cqiPCfgIdx="314"  riCfgIdx = "555"
        UeReCfgType="4096" />
      </tapa.send>

      # Send UE SR ReConfiguration for the same UE-1 created above  
      # with allowed range
      <tapa.send>
          <tapa.rgr.cfgreq.recfg.ue  ueId="1" 
         srCfgPres="TRUE" srCfgIdx="312"
        UeReCfgType="16384" />
      </tapa.send>

      # Send TTI to apply the reconfig
      <tapa.send>
        <tapa.tfu.tti.ind/>
      </tapa.send>

    #Expect positive Configuration Confirm from LTEMAC
      <tapa.expset>
          <tapa.rgr.cfgCfm ueId="1" />
          <tapa.rgr.cfgCfm ueId="1" />
          <tapa.rgr.cfgCfm ueId="1" />
      </tapa.expset>

  #Request to ShutDown LTEMAC

   </tapa.test>

   # Clean subsection
   <tapa.clean>
     <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>  

#
#       Test:    35.30
#
#       Desc:    TC_39: To verify RAR and UE specific allocation in same SF.
#
#       Notes:   None
#              
#       Module:  DLFSS
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.30" >

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To verify RAR and UE specific allocation in single subframe."
      </tapa.desc>

      <tapa.longdesc>
      "Verify when Common channels allocated using Type2 Localized and
      UE specific allocations using Type-0 coexist in same subframe, the 
      RB assignment is correct."

      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifndef>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched isDlFreqSel="1" numTxAntPorts="2"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueCatEnum="3"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8" />
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8"  instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>


         # Send RaReqInd for one rapId 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="2" suId="0">
            <tapa.tfu.rareq raRnti="10" numRapId="1" numRaReq="1" rapIds="1" timingAdvs="3" 
            tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # The number of subframes to wait for receiving the RA RSP is maximum of
      # RA RSP window and the scheduling delta RG_DL_DELTA (=3) minus the 
      # TFU_DELTA (=2) from the next TTI. This makes the number of TTIs 2 (3 - 2
      # + 1).

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="100"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      
      # Expect RaResp for the rapId sent in RaReq
      # Expect Ue specfic data allocation. Verify 
      # RBG0 is assigned for RARSP and RBGs1 and 2
      # are assigned for UE.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="2">
           <tapa.tfu.rarsp.req raRnti="10" rapIds="1"/>
           <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req vldtRbAlign="TRUE" rbStart="0" numRb="1"/>
           <tapa.tfu.pdcch.cntrl.req saveTo="1" ueId="0"
             vldtResAllocMap="TRUE" resAllocMap="96:0:0:0" />
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Counting the TTIs, RA RSP was received by PHY at sf = (0,2). PHY tranmits
      # the RA RSP in sf = (0, 4). UE will transmit the MSG3 at sf = (1, 0). We 
      # must receive data reception request at sf = (0, 8). Current TTI = (0, 2)
      # and hence we must send 6 TTIs.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req numRntis="1">
            <tapa.tfu.msg3.recp.req ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="1"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

      # Expect Message3 datReq on CCCH at RGU.
      <tapa.expset>
         <tapa.rgu.cdatind ueId="1" lcId="4"/>
      </tapa.expset>

      # Send BO for Msg4 on RGU. 
      <tapa.send>
         <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10"  ueId="1"/>
      </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect staInd from MAC to RLC for Msg4 
   <tapa.expect>
      <tapa.rgu.cstaind lcId="4"/>
   </tapa.expect>
   
   #<tapa.rg.dbgInitAll/>

   # Send Msg4 on RGU. 
   <tapa.send>
      <tapa.rgu.cdatreq ueId="1" lcId="4" lcType="3" />
   </tapa.send>

   #<tapa.rg.dbgDeInitAll/>
   
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect Msg4 from MAC to PHY.
   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
     </tapa.tfu.cntrl.req>
   # Expect Msg4 from MAC to PHY.
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req saveTo="4" use="2" ueId="1" chkCcchSh="TRUE"/>
     </tapa.tfu.dat.req>   
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2" op="RG_ACC_PLUS" numTfuDelta="1"/>
   </tapa.send>
   
   <tapa.expset>
     <tapa.tfu.recp.req numRntis="4">
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   # Send ACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue ueId="1" />
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   <tapa.send>
     <tapa.rgr.cfgreq.cfg.ue ueId="1" instId="5" />
   </tapa.send>


   # Send TTI to apply the config
   <tapa.send>
      <tapa.tfu.tti.ind/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>
   

   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit.grp16/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>
</tapa.testcase>      


#
#       Test:    35.31
#
#       Desc:    TC_40: To verify MSG4 TX and UE specific allocation in same SF.
#
#       Notes:   None
#              
#       Module:  DLFSS
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.31">

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To verify MSG4 TX and UE specific allocation in single subframe."
      </tapa.desc>

      <tapa.longdesc>
      "Verify when Common channels allocated using Type2 Localized and
      UE specific allocations using Type-0 coexist in same subframe, the 
      RB assignment is correct."

      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifndef>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched isDlFreqSel="1" numTxAntPorts="2"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueCatEnum="3"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8" />
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8"  instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>


         # Send RaReqInd for one rapId 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="2" suId="0">
            <tapa.tfu.rareq raRnti="10" numRapId="1" numRaReq="1" rapIds="1" timingAdvs="3" 
            tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # The number of subframes to wait for receiving the RA RSP is maximum of
      # RA RSP window and the scheduling delta RG_DL_DELTA (=3) minus the 
      # TFU_DELTA (=2) from the next TTI. This makes the number of TTIs 2 (3 - 2
      # + 1).

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      # Expect RaResp for the rapId sent in RaReq
      # Expect Ue specfic data allocation. Verify 
      # RBG0 is assigned for RARSP and RBGs1 and 2
      # are assigned for UE.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="2">
           <tapa.tfu.rarsp.req raRnti="10" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Counting the TTIs, RA RSP was received by PHY at sf = (0,2). PHY tranmits
      # the RA RSP in sf = (0, 4). UE will transmit the MSG3 at sf = (1, 0). We 
      # must receive data reception request at sf = (0, 8). Current TTI = (0, 2)
      # and hence we must send 6 TTIs.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req numRntis="1">
            <tapa.tfu.msg3.recp.req ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="1"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

      # Expect Message3 datReq on CCCH at RGU.
      <tapa.expset>
         <tapa.rgu.cdatind ueId="1" lcId="4"/>
      </tapa.expset>

      # Send BO for Msg4 on RGU. 
      <tapa.send>
         <tapa.rgu.cstarsp lcId="4" lcType="3" bo="300"  ueId="1"/>
      </tapa.send>
      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="200"/>
      </tapa.send>


   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect staInd from MAC to RLC for Msg4 
   <tapa.expect>
      <tapa.rgu.cstaind lcId="4"/>
   </tapa.expect>
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
   # Send Msg4 on RGU. 
   <tapa.send>
      <tapa.rgu.cdatreq ueId="1" lcId="4" lcType="3" />
   </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

   
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect Msg4 from MAC to PHY.
   # Expect Ue specfic data allocation. Verify 
   # RBG0-8 is assigned for RARSP and RBGs9,10,11 and 12
   # are assigned for UE.
   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" 
        vldtRbAlign="TRUE" rbStart="0" numRb="35"/>
        <tapa.tfu.pdcch.cntrl.req saveTo="1" ueId="0"
             vldtResAllocMap="TRUE" resAllocMap="0:120:0:0" />
     </tapa.tfu.cntrl.req>
   # Expect Msg4 from MAC to PHY.
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req saveTo="4" use="2" ueId="1" chkCcchSh="TRUE"/>
        <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
     </tapa.tfu.dat.req>   
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2" op="RG_ACC_PLUS" numTfuDelta="1"/>
   </tapa.send>
   
   <tapa.expset>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="1"/>
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   # Send ACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue ueId="1" />
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   <tapa.send>
     <tapa.rgr.cfgreq.cfg.ue ueId="1" instId="5" />
   </tapa.send>


   # Send TTI to apply the config
   <tapa.send>
      <tapa.tfu.tti.ind/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>
   

   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit.grp16/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>
</tapa.testcase>      


#
#       Test:    35.32
#
#       Desc:    TC_40: To verify MSG4 RETX and UE specific allocation in same SF.
#
#       Notes:   None
#              
#       Module:  DLFSS
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.32" >

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To verify MSG4 RETX and UE specific allocation in single subframe."
      </tapa.desc>

      <tapa.longdesc>
      "Verify when Common channels allocated using Type2 Localized and
      UE specific allocations using Type-0 coexist in same subframe, the 
      RB assignment is correct."

      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifndef>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched isDlFreqSel="1" numTxAntPorts="2" maxDlHqTx="4"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueCatEnum="3"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8" />
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8"  instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>


         # Send RaReqInd for one rapId 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="2" suId="0">
            <tapa.tfu.rareq raRnti="10" numRapId="1" numRaReq="1" rapIds="1" timingAdvs="3" 
            tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # The number of subframes to wait for receiving the RA RSP is maximum of
      # RA RSP window and the scheduling delta RG_DL_DELTA (=3) minus the 
      # TFU_DELTA (=2) from the next TTI. This makes the number of TTIs 2 (3 - 2
      # + 1).

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      # Expect RaResp for the rapId sent in RaReq
      # Expect Ue specfic data allocation. Verify 
      # RBG0 is assigned for RARSP and RBGs1 and 2
      # are assigned for UE.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="2">
           <tapa.tfu.rarsp.req raRnti="10" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Counting the TTIs, RA RSP was received by PHY at sf = (0,2). PHY tranmits
      # the RA RSP in sf = (0, 4). UE will transmit the MSG3 at sf = (1, 0). We 
      # must receive data reception request at sf = (0, 8). Current TTI = (0, 2)
      # and hence we must send 6 TTIs.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req numRntis="1">
            <tapa.tfu.msg3.recp.req ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="1"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

      # Expect Message3 datReq on CCCH at RGU.
      <tapa.expset>
         <tapa.rgu.cdatind ueId="1" lcId="4"/>
      </tapa.expset>

      # Send BO for Msg4 on RGU. 
      <tapa.send>
         <tapa.rgu.cstarsp lcId="4" lcType="3" bo="300"  ueId="1"/>
      </tapa.send>
      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="200"/>
      </tapa.send>


   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect staInd from MAC to RLC for Msg4 
   <tapa.expect>
      <tapa.rgu.cstaind lcId="4"/>
   </tapa.expect>
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
   # Send Msg4 on RGU. 
   <tapa.send>
      <tapa.rgu.cdatreq ueId="1" lcId="4" lcType="3" />
   </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

   
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect Msg4 from MAC to PHY.
   # Expect Ue specfic data allocation. Verify 
   # RBG0-8 is assigned for RARSP and RBGs9,10,11 and 12
   # are assigned for UE.
   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" 
        vldtRbAlign="TRUE" rbStart="0" numRb="35"/>
        <tapa.tfu.pdcch.cntrl.req saveTo="1" ueId="0"
             vldtResAllocMap="TRUE" resAllocMap="0:120:0:0" />
     </tapa.tfu.cntrl.req>
   # Expect Msg4 from MAC to PHY.
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req saveTo="4" use="2" ueId="1" chkCcchSh="TRUE"/>
        <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
     </tapa.tfu.dat.req>   
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2" op="RG_ACC_PLUS" numTfuDelta="1"/>
   </tapa.send>
   
   <tapa.expset>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="1"/>
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   # Send ACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
        <tapa.tfu.hq ueId="1" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="3" vldtRetx="TRUE" 
        vldtRbAlign="TRUE" rbStart="0" numRb="35"/>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="4" vldtRetx="TRUE"
             vldtResAllocMap="TRUE" resAllocMap="0:120:0:0" />
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req retxUse="2" ueId="1" numSdu="1" isRetx="TRUE"/>
        <tapa.tfu.pdsch.dat.req retxUse="1" ueId="0" numSdu="1" isRetx="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2" op="RG_ACC_PLUS" numTfuDelta="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="1"/>
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Send ACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="1"/>
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   #verify Nothing sent after wards.
   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue ueId="1" />
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   <tapa.send>
     <tapa.rgr.cfgreq.cfg.ue ueId="1" instId="5" />
   </tapa.send>


   # Send TTI to apply the config
   <tapa.send>
      <tapa.tfu.tti.ind/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>
   

   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit.grp16/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>
</tapa.testcase>      


#
#       Test:    35.33
#
#       Desc:    TC_40: To verify CCCH SDU TX-RETX and UE specific allocation in same SF.
#
#       Notes:   None
#              
#       Module:  DLFSS
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.33">

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To verify CCCH SDU TX-RETX and UE specific allocation in single subframe."
      </tapa.desc>

      <tapa.longdesc>
      "Verify when Common channels allocated using Type2 Localized and
      UE specific allocations using Type-0 coexist in same subframe, the 
      RB assignment is correct."

      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifndef>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched isDlFreqSel="1" numTxAntPorts="2" maxDlHqTx="4"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueCatEnum="3"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8" />
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8"  instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>


         # Send RaReqInd for one rapId 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="2" suId="0">
            <tapa.tfu.rareq raRnti="10" numRapId="1" numRaReq="1" rapIds="1" timingAdvs="3" 
            tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # The number of subframes to wait for receiving the RA RSP is maximum of
      # RA RSP window and the scheduling delta RG_DL_DELTA (=3) minus the 
      # TFU_DELTA (=2) from the next TTI. This makes the number of TTIs 2 (3 - 2
      # + 1).

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      # Expect RaResp for the rapId sent in RaReq
      # Expect Ue specfic data allocation. Verify 
      # RBG0 is assigned for RARSP and RBGs1 and 2
      # are assigned for UE.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="10" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Counting the TTIs, RA RSP was received by PHY at sf = (0,2). PHY tranmits
      # the RA RSP in sf = (0, 4). UE will transmit the MSG3 at sf = (1, 0). We 
      # must receive data reception request at sf = (0, 8). Current TTI = (0, 2)
      # and hence we must send 6 TTIs.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req numRntis="1">
            <tapa.tfu.msg3.recp.req ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="1"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

      # Expect Message3 datReq on CCCH at RGU.
      <tapa.expset>
         <tapa.rgu.cdatind ueId="1" lcId="4"/>
      </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="15"/>
   </tapa.send>

   # Expect Msg4 from MAC to PHY.
   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
     </tapa.tfu.cntrl.req>
   # Expect Msg4 from MAC to PHY.
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req use="2" ueId="1" validate="FALSE"/>
     </tapa.tfu.dat.req>   
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2" op="RG_ACC_PLUS" numTfuDelta="1"/>
   </tapa.send>
   
   <tapa.expset>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   # Send ACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue ueId="1" />
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   <tapa.send>
     <tapa.rgr.cfgreq.cfg.ue ueId="1" instId="5" />
   </tapa.send>


   # Send TTI to apply the config
   <tapa.send>
      <tapa.tfu.tti.ind/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>

      # Send BO for Msg4 on RGU. 
      <tapa.send>
         <tapa.rgu.cstarsp lcId="4" lcType="3" bo="300"  ueId="1"/>
      </tapa.send>
      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="200"/>
      </tapa.send>


   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect staInd from MAC to RLC for Msg4 
   <tapa.expect>
      <tapa.rgu.cstaind lcId="4"/>
   </tapa.expect>
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
   # Send Msg4 on RGU. 
   <tapa.send>
      <tapa.rgu.cdatreq ueId="1" lcId="4" lcType="3" />
   </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

   
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect Msg4 from MAC to PHY.
   # Expect Ue specfic data allocation. Verify 
   # RBG0-8 is assigned for RARSP and RBGs9,10,11 and 12
   # are assigned for UE.
   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" 
        vldtRbAlign="TRUE" rbStart="0" numRb="18"/>
        <tapa.tfu.pdcch.cntrl.req saveTo="1" ueId="0"
             vldtResAllocMap="TRUE" resAllocMap="7:128:0:0" />
     </tapa.tfu.cntrl.req>
   # Expect Msg4 from MAC to PHY.
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req saveTo="4" use="2" ueId="1" chkCcchSh="TRUE"/>
        <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
     </tapa.tfu.dat.req>   
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2" op="RG_ACC_PLUS" numTfuDelta="1"/>
   </tapa.send>
   
   <tapa.expset>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="1"/>
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   # Send ACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
        <tapa.tfu.hq ueId="1" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="3" vldtRetx="TRUE" 
        vldtRbAlign="TRUE" rbStart="0" numRb="18"/>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="4" vldtRetx="TRUE"
             vldtResAllocMap="TRUE" resAllocMap="7:128:0:0" />
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req retxUse="2" ueId="1" numSdu="1" isRetx="TRUE"/>
        <tapa.tfu.pdsch.dat.req retxUse="1" ueId="0" numSdu="1" isRetx="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2" op="RG_ACC_PLUS" numTfuDelta="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="1"/>
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Send ACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="1"/>
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   #verify Nothing sent after wards.
   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   
   

   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit.grp16/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>
</tapa.testcase>      


#
#
#       Test:   35.34
#
#       Desc:   "TC_37: To test BROADCAST along with UE data in same SF with DLFSS"
#       Notes:   None
#              
#       Module:  "DLFSS"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.34">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test BROADCAST along with UE data in same SF with DLFSS"
      </tapa.desc>

      <tapa.longdesc>
         "To test BROADCAST along with UE data in same SF with DLFSS"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>
      <tapa.ifndef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifndef>
      <tapa.mode mode="single"/>
   </tapa.require> 

  # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit.dlSched isDlFreqSel="1"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueCatEnum="3"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8" />
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8"  instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

     # Send L2 Measurement request
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         # Send BO for PCCH logical channel on RGU.
         # Chk the bo here! 
         <tapa.rgu.cstarsp lcId="3" lcType="2" bo="277" sfOffset="7"/>
      </tapa.send>

      <tapa.send>
         # Send 4 Ttis to get the transmission scheduled.
         # Send them individually so that if staInd comes in between, it will
         # fail. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
   
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="200"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC 
         <tapa.rgu.cstaind lcId="3" boSatisfied="TRUE" maxRb="3" saveTo="2"/>
      </tapa.expset>

      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      <tapa.send>
         # Send PCCH data to MAC on RGU. 
         <tapa.rgu.cdatreq bcchIdx="1" lcId="3" lcType="2" use="2"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

      <tapa.send>
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1" 
        vldtRbAlign="TRUE" rbStart="0" numRb="18"/>
        <tapa.tfu.pdcch.cntrl.req saveTo="1" ueId="0"
             vldtResAllocMap="TRUE" resAllocMap="7:128:0:0" />
     </tapa.tfu.cntrl.req>
   # Expect Msg4 from MAC to PHY.
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req use="1" lcId="3" bcchIdx="1" vldtPcch="TRUE"/>
        <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2" op="RG_ACC_PLUS" numTfuDelta="1"/>
   </tapa.send>
   
   <tapa.expset>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Send ACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0" isAck="TRUE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="10"/>
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

      # Layer Manager ShutDown

   </tapa.shutdown>

</tapa.testcase> 

#
#
#       Test:   35.35
#
#       Desc:   "TC_38: To test BROADCAST and MSG4 along with UE data in same SF with DLFSS"
#       Notes:   None
#              
#       Module:  "DLFSS"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.35">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test BROADCAST and MSG4 along with UE data in same SF with DLFSS"
      </tapa.desc>

      <tapa.longdesc>
         "To test BROADCAST and MSG4 along with UE data in same SF with DLFSS"
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>
      <tapa.ifndef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifndef>
      <tapa.mode mode="single"/>
   </tapa.require> 

  # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit.dlSched isDlFreqSel="1"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueCatEnum="3"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8" />
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8"  instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

         # Send RaReqInd for one rapId 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.rareq.ind numRaRnti="2" suId="0">
            <tapa.tfu.rareq raRnti="10" numRapId="1" numRaReq="1" rapIds="1" timingAdvs="3" 
            tpcs="1" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # The number of subframes to wait for receiving the RA RSP is maximum of
      # RA RSP window and the scheduling delta RG_DL_DELTA (=3) minus the 
      # TFU_DELTA (=2) from the next TTI. This makes the number of TTIs 2 (3 - 2
      # + 1).

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      # Expect RaResp for the rapId sent in RaReq
      # Expect Ue specfic data allocation. Verify 
      # RBG0 is assigned for RARSP and RBGs1 and 2
      # are assigned for UE.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="10" rapIds="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Counting the TTIs, RA RSP was received by PHY at sf = (0,2). PHY tranmits
      # the RA RSP in sf = (0, 4). UE will transmit the MSG3 at sf = (1, 0). We 
      # must receive data reception request at sf = (0, 8). Current TTI = (0, 2)
      # and hence we must send 6 TTIs.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="6"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.recp.req numRntis="1">
            <tapa.tfu.msg3.recp.req ueId="1"/>
         </tapa.tfu.recp.req>
      </tapa.expset>

     # Send L2 Measurement request
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         # Send BO for PCCH logical channel on RGU.
         # Chk the bo here! 
         <tapa.rgu.cstarsp lcId="3" lcType="2" bo="277" sfOffset="7"/>
      </tapa.send>

      <tapa.send>
         # Send 4 Ttis to get the transmission scheduled.
         # Send them individually so that if staInd comes in between, it will
         # fail. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
   
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      #Send CRC for Msg3
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH For MSG3
      <tapa.expect>
         <tapa.tfu.cntrl.req numCntrlReq="1" spId="1">
            <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
         </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send Message3 after receiving Message3 reception req.
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="1"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

      # Expect Message3 datReq on CCCH at RGU.
      <tapa.expset>
         <tapa.rgu.cdatind ueId="1" lcId="4"/>
      </tapa.expset>


      # Send BO for Msg4 on RGU. 
      <tapa.send>
         <tapa.rgu.cstarsp lcId="4" lcType="3" bo="300"  ueId="1"/>
      </tapa.send>
      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="200"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC 
         <tapa.rgu.cstaind lcId="3" boSatisfied="TRUE" maxRb="3" saveTo="2"/>
      </tapa.expset>

   # Expect staInd from MAC to RLC for Msg4 
   <tapa.expect>
      <tapa.rgu.cstaind lcId="4"/>
   </tapa.expect>

      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      <tapa.send>
         # Send PCCH data to MAC on RGU. 
         <tapa.rgu.cdatreq bcchIdx="1" lcId="3" lcType="2" use="2"/>
      </tapa.send>

   # Send Msg4 on RGU. 
   <tapa.send>
      <tapa.rgu.cdatreq ueId="1" lcId="4" lcType="3" />
   </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

      <tapa.send>
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1" 
        vldtRbAlign="TRUE" rbStart="0" numRb="18"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" 
        vldtRbAlign="TRUE" rbStart="18" numRb="35"/>
        <tapa.tfu.pdcch.cntrl.req saveTo="3" ueId="0"
             vldtResAllocMap="TRUE" resAllocMap="0:3:192:0" />
     </tapa.tfu.cntrl.req>
   # Expect Msg4 from MAC to PHY.
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req use="1" lcId="3" bcchIdx="1" vldtPcch="TRUE"/>
        <tapa.tfu.pdsch.dat.req use="2" ueId="1" chkCcchSh="TRUE"/>
        <tapa.tfu.pdsch.dat.req  use="3" ueId="0" numSdu="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2" op="RG_ACC_PLUS" numTfuDelta="1"/>
   </tapa.send>
   
   <tapa.expset>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Send ACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0" isAck="TRUE"/>
        <tapa.tfu.hq ueId="1" isAck="TRUE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="10"/>
   </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

      # Layer Manager ShutDown

   </tapa.shutdown>

</tapa.testcase>   

#
#       Test:    35.36
#
#       Desc:    TC_MAC_TDD_DLFS_9
#                "To test the successful DL path for a UE with UE configured to
#                 report CQI in periodic mode 1-0 for a frequency selective 
#                 cell."
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.36"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To test the successful DL path for a UE with UE configured to 
          report CQI in periodic mode 1-0 for a frequency selective cell."
      </tapa.desc>

      <tapa.longdesc>
         "To test the successful DL path for a UE with UE configured to 
          report CQI in periodic mode 1-0 for a frequency selective cell."
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs ulDlCfgIdx="2"  isDlFreqSel="1" 
      dlTotalBw="50" raWinSize="10" />
      
      <tapa.rg.UeInitTdd2 prdBsrTmr="65535" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"
         prdModeEnumPres="TRUE" prdCqiCfg.type="TRUE" cqiPCfgIdx="18"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
   
   # Configure bi-directional DTCH for default UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Expect configuration confirm after the TTI
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   <!--- on RGR interface -->
   # Configure bi-directional DTCH for default UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="5" instId="5"/>
   </tapa.send>

   # Send TTI indication for default cell
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect configuration confirm
   <tapa.expect>
      <tapa.rgr.cfgCfm status="0"/>
   </tapa.expect>

   #Expect CQI recp req
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="10"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      # Send BO for the created logical channel on RGU. 
      <tapa.rgu.dstarsp lcId="4" lcType="5" bo="500"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   <tapa.expect>
      # Expect staInd from MAC to RLC  
      <tapa.rgu.dstaind lchTb1Data="4"/>
   </tapa.expect>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send a Tti to get the transmission scheduled. 
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.tfu.dat.req datReqs="1">
         <tapa.tfu.pdsch.dat.req ueId="0" use="1" 
          lcId="4" chkSdu="TRUE" saveTo="2"/>
      </tapa.tfu.dat.req>
      <tapa.tfu.cntrl.req expCntrlReq="1">
         #Expect Contiguous RBGs
         <tapa.tfu.pdcch.cntrl.req saveTo="1" isFormat1="TRUE" vldDciFrmt="TRUE"
            vldtResAllocMap="TRUE" resAllocMap="248:0:0:0"/>
      </tapa.tfu.cntrl.req>
   </tapa.expset>

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>     

#
#       Test:    35.37
#
#       Desc:    TC_MAC_TDD_DLFS_10
#                "To test the successful DL path for a UE with UE configured to
#                 report CQI in periodic mode 2-0 for a frequency selective 
#                 cell."
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.37"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To test the successful DL path for a UE with UE configured to 
          report CQI in periodic mode 2-0 for a frequency selective cell."
      </tapa.desc>

      <tapa.longdesc>
         "To test the successful DL path for a UE with UE configured to 
          report CQI in periodic mode 2-0 for a frequency selective cell."
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="100" raWinSize="10" maxDlHqTx="5"/>
      
      <tapa.rg.UeInitTdd1 prdBsrTmr="65535" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"
         prdModeEnumPres="TRUE" prdCqiCfg.type="TRUE" cqiPCfgIdx="118" K="1" 
         cqiRepType="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
   
   # Configure bi-directional DTCH for default UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Expect configuration confirm after the TTI
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   <!--- on RGR interface -->
   # Configure bi-directional DTCH for default UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="5" instId="5"/>
   </tapa.send>

   # Send TTI indication for default cell
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect configuration confirm
   <tapa.expect>
      <tapa.rgr.cfgCfm status="0"/>
   </tapa.expect>

   #Expect for recp req WB CQI
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="10"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="77"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART0
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 0
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="77"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" >
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 1
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="6" label="1"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="77"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART2
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" >
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 2
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="3" label="2"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="77"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART3
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" >
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 3
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="13" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created logical channel on RGU. 
      <tapa.rgu.dstarsp lcId="4" lcType="5" bo="800"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   <tapa.expect>
      # Expect staInd from MAC to RLC  
      <tapa.rgu.dstaind lchTb1Data="4"/>
   </tapa.expect>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send a Tti to get the transmission scheduled. 
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.tfu.dat.req datReqs="1">
         <tapa.tfu.pdsch.dat.req ueId="0" use="1" 
          lcId="4" chkSdu="TRUE" saveTo="2"/>
      </tapa.tfu.dat.req>
      <tapa.tfu.cntrl.req expCntrlReq="1">
         <tapa.tfu.pdcch.cntrl.req saveTo="1" isFormat1="TRUE" vldDciFrmt="TRUE"
            vldtResAllocMap="TRUE" resAllocMap="240:0:12:0"/>
      </tapa.tfu.cntrl.req>
   </tapa.expset>

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>     

#
#       Test:    35.38
#
#       Desc:    TC_MAC_TDD_DLFS_16
#                "To verify the resource allocation type for Common Channel data."
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.38"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To verify the resource allocation type for Common Channel data."
      </tapa.desc>

      <tapa.longdesc>
         "To verify the resource allocation type for Common Channel data."
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="100" raWinSize="10" />
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
   
   # Send TTI indication for default cell
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.send>
      # Send SI Configuration request for MIB
      <tapa.rgr.sicfgreq instId="5" bcchIdx="0" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_MIB" />
   </tapa.send>

   <tapa.expect>
      # Expect SI Cfg Cfm from MAC 
      <tapa.rgr.sicfgcfm instId="5"/>
   </tapa.expect>

   <tapa.send>
      # Send SI Configuration request for SIB1
      <tapa.rgr.sicfgreq instId="5" bcchIdx="2" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SIB1" />
   </tapa.send>

   <tapa.expect>
      # Expect SI Cfg Cfm from MAC 
      <tapa.rgr.sicfgcfm instId="5"/>
   </tapa.expect>

   <tapa.send>
      # Send SI Configuration request for SI1
      <tapa.rgr.sicfgreq instId="5" bcchIdx="4" cellId="3" cfgType="RGAC_RGR_SI_CFG_TYPE_SI" siId="1" />
   </tapa.send>

   <tapa.expect>
      # Expect SI Cfg Cfm from MAC 
      <tapa.rgr.sicfgcfm instId="5"/>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   <tapa.expset>
      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.tfu.dat.req datReqs="1">
         <tapa.tfu.pdsch.dat.req use="1" saveTo="2" bcchIdx="2"/>
      </tapa.tfu.dat.req>
      <tapa.tfu.cntrl.req expCntrlReq="1">
         #Expect Contiguous RBGs
         <tapa.tfu.pdcch.cntrl.req saveTo="1" isFormat1a="TRUE" vldDciFrmt="TRUE" 
            vldtRbAlign="TRUE" rbStart="0" numRb="1"/>
      </tapa.tfu.cntrl.req>
   </tapa.expset>

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>     

#
#       Test:    35.39
#
#       Desc:    TC_MAC_TDD_DLFS_24
#                "To test the successful DL path for a re-tx UE with UE 
#                 configured to report CQI in periodic mode 1-0 for a 
#                 frequency selective cell."
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.39"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To test the successful DL path for a re-tx UE with UE configured to 
          report CQI in periodic mode 1-0 for a frequency selective cell."
      </tapa.desc>

      <tapa.longdesc>
         "To test the successful DL path for a re-tx UE with UE configured to 
          report CQI in periodic mode 1-0 for a frequency selective cell."
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="100" raWinSize="10" />
      
      <tapa.rg.UeInitTdd1 prdBsrTmr="65535" prdModeEnum="RGAC_RGR_PRD_CQI_MOD10"
         prdModeEnumPres="TRUE" prdCqiCfg.type="TRUE" cqiPCfgIdx="23"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
   
   # Configure bi-directional DTCH for default UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Expect configuration confirm after the TTI
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   <!--- on RGR interface -->
   # Configure bi-directional DTCH for default UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="5" instId="5"/>
   </tapa.send>

   # Send TTI indication for default cell
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect configuration confirm
   <tapa.expect>
      <tapa.rgr.cfgCfm status="0"/>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created logical channel on RGU. 
      <tapa.rgu.dstarsp lcId="4" lcType="5" bo="500"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
      #Expect CQI recp req
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req/>
      </tapa.tfu.recp.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
      # Expect staInd from MAC to RLC  
      <tapa.rgu.dstaind lchTb1Data="4"/>
   </tapa.expset>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send a Tti to get the transmission scheduled. 
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.tfu.dat.req datReqs="1">
         <tapa.tfu.pdsch.dat.req ueId="0" use="1" 
          lcId="4" chkSdu="TRUE" saveTo="2"/>
      </tapa.tfu.dat.req>
      <tapa.tfu.cntrl.req expCntrlReq="1">
         #Expect Contiguous RBGs 
         <tapa.tfu.pdcch.cntrl.req saveTo="1" isFormat1="TRUE" vldDciFrmt="TRUE"
            vldtResAllocMap="TRUE" resAllocMap="255:0:0:0"/>
      </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="10"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #send HARQ Recption Request 
   <tapa.expect>
     <tapa.tfu.recp.req expRecpReq="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Do not send HQ feedback Indication such that re-tx can happen

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   <tapa.expset>
      <tapa.tfu.dat.req datReqs="1">
         <tapa.tfu.pdsch.dat.req ueId="0" use="3" lcId="4" chkSdu="TRUE" 
            isRetx="TRUE" retxUse="2" validate="TRUE" vldtRetx="TRUE"/>
      </tapa.tfu.dat.req>
      <tapa.tfu.cntrl.req expCntrlReq="1">
         #Number of Rbs cannot be changed, Hence RB Allocation will be same as new tx 
         <tapa.tfu.pdcch.cntrl.req saveTo="3"  ueId="0" validate="TRUE" 
            vldtRetx="TRUE" isFormat1="TRUE" vldDciFrmt="TRUE" vldtHqId="TRUE"
            vldtResAllocMap="TRUE" resAllocMap="255:0:0:0" use="1"/>
      </tapa.tfu.cntrl.req>
   </tapa.expset>

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>     

#
#       Test:    35.40
#
#       Desc:    TC_MAC_TDD_DLFS_25
#                "To test the successful DL path for a re-tx UE with UE 
#                 configured to report CQI in periodic mode 2-0 for a 
#                 frequency selective cell."
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.40"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To test the successful DL path for a  retx UE with UE configured to 
          report CQI in periodic mode 2-0 for a frequency selective cell."
      </tapa.desc>

      <tapa.longdesc>
         "To test the successful DL path for a retx UE with UE configured to 
          report CQI in periodic mode 2-0 for a frequency selective cell."
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs ulDlCfgIdx="2"  isDlFreqSel="1" 
      dlTotalBw="25" raWinSize="10" />
      
      <tapa.rg.UeInitTdd2 prdBsrTmr="65535" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"
         prdModeEnumPres="TRUE" prdCqiCfg.type="TRUE" cqiPCfgIdx="118" K="2" 
         cqiRepType="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
   
   # Configure bi-directional DTCH for default UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Expect configuration confirm after the TTI
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>

   <!--- on RGR interface -->
   # Configure bi-directional DTCH for default UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="5" instId="5"/>
   </tapa.send>

   # Send TTI indication for default cell
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect configuration confirm
   <tapa.expect>
      <tapa.rgr.cfgCfm status="0"/>
   </tapa.expect>

   #Expect for recp req WB CQI
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="10"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="77"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART0
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 0
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="1"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="77"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" >
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 1
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="12" label="1"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="77"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART0
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" >
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 0
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="5" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="70"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created logical channel on RGU. 
      <tapa.rgu.dstarsp lcId="4" lcType="5" bo="300"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   <tapa.expect>
      # Expect staInd from MAC to RLC  
      <tapa.rgu.dstaind lchTb1Data="4"/>
   </tapa.expect>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send a Tti to get the transmission scheduled. 
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.tfu.dat.req datReqs="1">
         <tapa.tfu.pdsch.dat.req ueId="0" use="1" 
          lcId="4" chkSdu="TRUE" saveTo="2"/>
      </tapa.tfu.dat.req>
      # non-contiguous RBGs which are identified as best till now
      <tapa.tfu.cntrl.req expCntrlReq="1">
         <tapa.tfu.pdcch.cntrl.req saveTo="1" isFormat1="TRUE" vldDciFrmt="TRUE"
            vldtResAllocMap="TRUE" resAllocMap="48:48:0:0"/>
      </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" >
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6" ueId="0"/>
         <tapa.tfu.hq.recp.req ueId="0"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 1
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="13" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   #Do not send HQ feedback Indication such that re-tx can happen

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   <tapa.expset>
      <tapa.tfu.dat.req datReqs="1">
         <tapa.tfu.pdsch.dat.req ueId="0" use="3" lcId="4" chkSdu="TRUE" 
            isRetx="TRUE" retxUse="2" validate="TRUE" vldtRetx="TRUE"/>
      </tapa.tfu.dat.req>
      <tapa.tfu.cntrl.req expCntrlReq="1">
         #RB Allocation can be modified as the newly reported CQI is better 
         <tapa.tfu.pdcch.cntrl.req saveTo="3"  ueId="0" validate="TRUE" 
            vldtRetx="TRUE" isFormat1="TRUE" vldDciFrmt="TRUE" vldtHqId="TRUE"
            vldtResAllocMap="TRUE" resAllocMap="0:240:0:0" use="1"/>
      </tapa.tfu.cntrl.req>
   </tapa.expset>

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>     

#
#       Test:    35.41
#
#       Desc:    TC_MAC_TDD_DLFS_41
#                "To verify successful usage of unused SPS bandwidth for DLFS 
#                 Scheduler."
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.41"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To verify successful usage of unused SPS bandwidth for DLFS Scheduler"
      </tapa.desc>

      <tapa.longdesc>
         "To verify successful usage of unused SPS bandwidth for DLFS Scheduler."
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="LTEMAC_SPS"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs ulDlCfgIdx="2"  isDlFreqSel="1" DLSPSMaxBw="15" 
         dlTotalBw="25" raWinSize="10" startRnti="70" rntiSize="10"/>
      
      # UE Configuration
      <tapa.rg.UeInitTdd2 DLSPSEnFlag="TRUE" SPSRnti="65"
         DLSPSSchIntrv="20" NumSPSProc="4" prdBsrTmr="65535"/>

      #Initialize 2nd UE
      <tapa.rg.UeInitTdd2 ueId="1" prdBsrTmr="65535" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"
         prdModeEnumPres="TRUE" prdCqiCfg.type="TRUE" cqiPCfgIdx="238" K="2" 
         cqiRepType="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
   
   # Configure bi-directional DTCH for SPS UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Configure bi-directional DTCH for non-SPS UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="4" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Expect configuration confirm after the TTI
   <tapa.expset>
      <tapa.crg.cfgcfm/>
      <tapa.crg.cfgcfm/>
   </tapa.expset>

   <!--- on RGR interface -->
   # Configure bi-directional DTCH for SPS UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch lcId="4" dir="3" lcType="5" instId="5"
         DLSPSLchEnabFlag="TRUE" DLSPSLchPktSize="40" DLSPSLchPktPrd="32" 
         DLSPSLchExpltRelCnt="2"/>
   </tapa.send>

   # Configure bi-directional DTCH for non-SPS UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="4" dir="3" lcType="5" instId="5"/>
   </tapa.send>

   # Send TTI indication for default cell
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect configuration confirm
   <tapa.expset>
      <tapa.rgr.cfgCfm status="0"/>
      <tapa.rgr.cfgCfm status="0" ueId="1"/>
   </tapa.expset>

   #Expect for recp req WB CQI
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req ueId="1" vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" wbCqi="10"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART0
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req ueId="1" vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 0
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" sbCqi="7" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" >
         <tapa.tfu.dlcqi.recp.req ueId="1" vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 1
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" sbCqi="12" label="1"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART0
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" >
         <tapa.tfu.dlcqi.recp.req ueId="1" vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 0
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" sbCqi="13" label="1"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" >
         <tapa.tfu.dlcqi.recp.req ueId="1" vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 1
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" sbCqi="8" label="2"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   ###First BO scheduled dynamically
   <tapa.send>
      # Send BO for the created SPS service on RGU 
      <tapa.rgu.dstarsp lcId="4" lcType="5" bo="20"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      # Expect staInd from MAC to RLC for SPS service 
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="2"/>
   </tapa.expect>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   ##First BO Dynamic Sched
   <tapa.expset>
      <tapa.tfu.cntrl.req numCntrlReq="1">
         <tapa.tfu.pdcch.cntrl.req saveTo="2" DLSPSInit="FALSE" ueId="0" />
      </tapa.tfu.cntrl.req>
      <tapa.tfu.dat.req datReqs="1">
         <tapa.tfu.pdsch.dat.req ueId="0"  use="2" lcId="4" chkSdu="TRUE"
            validateSPS ="FALSE" DLSPSInit="FALSE"/>
      </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
         <tapa.tfu.hq.recp.req/>
      </tapa.tfu.recp.req>   
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Send ACK for the received PDU
   <tapa.send>
      <tapa.tfu.hq.ind hqInds="1">
         <tapa.tfu.hq ueId="0" isAckLst="TRUE:TRUE:TRUE:TRUE"/>
      </tapa.tfu.hq.ind>   
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="8"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created SPS service on RGU again
      <tapa.rgu.dstarsp lcId="4" lcType="5" bo="21"/>
   </tapa.send>

   <tapa.send>
      <tapa.rgu.dstarsp ueId="1" lcId="4" lcType="5" bo="300"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
      # Expect staInd from MAC to RLC for SPS and non-SPS 
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="2"/>
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="3" ueId="1"/>
   </tapa.expset>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="1" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   ##DL SPS Activation PDCCH
   <tapa.expset>
      <tapa.tfu.cntrl.req numCntrlReq="2">
         <tapa.tfu.pdcch.cntrl.req saveTo="2" DLSPSInit="TRUE" ueId="0" 
            vldDciFrmt="TRUE" vldtResAllocMap="TRUE" resAllocMap="192:0:0:0"/>
         #Unused RBGs from SPS BW are used here
         <tapa.tfu.pdcch.cntrl.req saveTo="3" ueId="1" vldDciFrmt="TRUE"
            isFormat1="TRUE" vldtResAllocMap="TRUE" resAllocMap="48:48:0:0"/>
      </tapa.tfu.cntrl.req>
      <tapa.tfu.dat.req datReqs="2">
         <tapa.tfu.pdsch.dat.req ueId="0"  use="2" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" DLSPSInit="TRUE"/>
         <tapa.tfu.pdsch.dat.req ueId="1"  use="3" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE"/>
      </tapa.tfu.dat.req>
   </tapa.expset>
   
   <!--
   ##DL SPS Activation PDCCH
   <tapa.expset>
     <tapa.tfu.cntrl.req expCntrlReq="2">
         <tapa.tfu.pdcch.cntrl.req saveTo="2" DLSPSInit="TRUE" ueId="0" 
            vldDciFrmt="TRUE" isFormat1="TRUE" vldtResAllocMap="TRUE" 
            resAllocMap="192:0:0:0"/>
          #Unused RBGs from SPS BW are used here 
         <tapa.tfu.pdcch.cntrl.req saveTo="3" ueId="1" vldDciFrmt="TRUE" 
            isFormat1="TRUE" vldtResAllocMap="TRUE" resAllocMap="48:48:0:0"/>
      </tapa.tfu.cntrl.req> 
      <tapa.tfu.dat.req datReqs="2">
         <tapa.tfu.pdsch.dat.req ueId="0"  use="2" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" DLSPSInit="TRUE"/>
            <tapa.tfu.pdsch.dat.req ueId="1"  use="3" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE"/>
      </tapa.tfu.dat.req>                       
   </tapa.expset>  -->
   
</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>     

#
#       Test:    35.42
#
#       Desc:    TC_MAC_TDD_DLFS_42
#                "To verify the failure in using unused SPS bandwidth for 
#                 DLFS Scheduler."
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.42"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To verify failure in usage of unused SPS bandwidth for DLFS Scheduler"
      </tapa.desc>

      <tapa.longdesc>
         "To verify failure in usage of unused SPS bandwidth for DLFS Scheduler."
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="LTEMAC_SPS"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs ulDlCfgIdx="1"  isDlFreqSel="1" DLSPSMaxBw="6" 
         dlTotalBw="50" raWinSize="10" startRnti="70" rntiSize="10"/>
      
      # UE Configuration
      <tapa.rg.UeInitTdd1 DLSPSEnFlag="TRUE" SPSRnti="65"
         DLSPSSchIntrv="20" NumSPSProc="4" prdBsrTmr="65535"/>

      #Initialize 2nd UE
      <tapa.rg.UeInitTdd1 ueId="1" prdBsrTmr="65535" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"
         prdModeEnumPres="TRUE" prdCqiCfg.type="TRUE" cqiPCfgIdx="238" K="1" 
         cqiRepType="2"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
   
   # Configure bi-directional DTCH for SPS UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Configure bi-directional DTCH for non-SPS UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="4" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Expect configuration confirm after the TTI
   <tapa.expset>
      <tapa.crg.cfgcfm/>
      <tapa.crg.cfgcfm/>
   </tapa.expset>

   <!--- on RGR interface -->
   # Configure bi-directional DTCH for SPS UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch lcId="4" dir="3" lcType="5" instId="5"
         DLSPSLchEnabFlag="TRUE" DLSPSLchPktSize="40" DLSPSLchPktPrd="32" 
         DLSPSLchExpltRelCnt="2"/>
   </tapa.send>

   # Configure bi-directional DTCH for non-SPS UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="4" dir="3" lcType="5" instId="5"/>
   </tapa.send>

   # Send TTI indication for default cell
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect configuration confirm
   <tapa.expset>
      <tapa.rgr.cfgCfm status="0"/>
      <tapa.rgr.cfgCfm status="0" ueId="1"/>
   </tapa.expset>

   #Expect for recp req WB CQI
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req ueId="1" vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" wbCqi="10"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART0
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req ueId="1" vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 0
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" sbCqi="14" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" >
         <tapa.tfu.dlcqi.recp.req ueId="1" vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 1
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" sbCqi="11" label="1"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for SB CQI- BW PART2
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" >
         <tapa.tfu.dlcqi.recp.req ueId="1" vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 2
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="1" rawDlCqiEnc="TRUE" sbCqi="10" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   ###First BO scheduled dynamically
   <tapa.send>
      # Send BO for the created SPS service on RGU 
      <tapa.rgu.dstarsp lcId="4" lcType="5" bo="20"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2"/>
   </tapa.send>

   <tapa.expect>
      # Expect staInd from MAC to RLC for SPS service 
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="2"/>
   </tapa.expect>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   ##First BO Dynamic Sched
   <tapa.expset>
      <tapa.tfu.cntrl.req numCntrlReq="1">
         <tapa.tfu.pdcch.cntrl.req saveTo="2" DLSPSInit="FALSE" ueId="0" />
      </tapa.tfu.cntrl.req>
      <tapa.tfu.dat.req datReqs="1">
         <tapa.tfu.pdsch.dat.req ueId="0"  use="2" lcId="4" chkSdu="TRUE"
            validateSPS ="FALSE" DLSPSInit="FALSE"/>
      </tapa.tfu.dat.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
         <tapa.tfu.hq.recp.req/>
      </tapa.tfu.recp.req>   
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Send ACK for the received PDU
   <tapa.send>
      <tapa.tfu.hq.ind hqInds="1">
         <tapa.tfu.hq ueId="0" isAckLst="TRUE:TRUE:TRUE:TRUE"/>
      </tapa.tfu.hq.ind>   
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="8"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created SPS service on RGU again
      <tapa.rgu.dstarsp lcId="4" lcType="5" bo="21"/>
   </tapa.send>

   <tapa.send>
      <tapa.rgu.dstarsp ueId="1" lcId="4" lcType="5" bo="300"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   <tapa.expset>
      # Expect staInd from MAC to RLC for SPS and non-SPS 
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="2"/>
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="3" ueId="1"/>
   </tapa.expset>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="1" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   ##DL SPS Activation PDCCH
   <tapa.expset>
      <tapa.tfu.cntrl.req expCntrlReq="2">
         #SPS UE will be scheduled with RA TYPE2 4 RBs then 1 partial RBG will
         #be available from SPS BW
         <tapa.tfu.pdcch.cntrl.req saveTo="2" DLSPSInit="TRUE" ueId="0" 
            vldDciFrmt="TRUE" isFormat1a="TRUE" vldtRbAlign="TRUE" 
            rbStart="0" numRb="4"/>
         #Unused RBGs from SPS BW are failed to use here
         <tapa.tfu.pdcch.cntrl.req saveTo="3" ueId="1" vldDciFrmt="TRUE" 
            isFormat1="TRUE" vldtResAllocMap="TRUE" resAllocMap="32:192:0:0"/>
      </tapa.tfu.cntrl.req>
      <tapa.tfu.dat.req datReqs="2">
         <tapa.tfu.pdsch.dat.req ueId="0"  use="2" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" DLSPSInit="TRUE"/>
         <tapa.tfu.pdsch.dat.req ueId="1"  use="3" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE"/>
      </tapa.tfu.dat.req>
   </tapa.expset>

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>     

#
#       Test:    35.43
#
#       Desc:    TC_MAC_TDD_DLFS_43
#                "To verify the failure in using unused SPS bandwidth for DLFS 
#                 Scheduler when non-contiguous RBs, which are together more 
#                 than an RBG, are available."
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.43"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To verify the failure in using unused SPS bandwidth for DLFS 
          Scheduler when non-contiguous RBs, which are together more than an 
          RBG, are available"
      </tapa.desc>

      <tapa.longdesc>
         "To verify the failure in using unused SPS bandwidth for DLFS 
          Scheduler when non-contiguous RBs, which are together more than an 
          RBG, are available"
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="LTEMAC_SPS"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs ulDlCfgIdx="2"  isDlFreqSel="1" DLSPSMaxBw="36" 
         dlTotalBw="50" raWinSize="10" startRnti="70" rntiSize="10"
         maxDlUeNewTxPerTti="6" maxSpsUePerDlSf="4" maxUePerDlSf="10"/>
      
      # SPS UE Configuration
      <tapa.rg.UeInitTdd2 DLSPSEnFlag="TRUE" SPSRnti="65"
         DLSPSSchIntrv="20" NumSPSProc="4" prdBsrTmr="65535" NumPucchVal="4"/>

      # 2nd SPS UE Configuration
      <tapa.rg.UeInitTdd2 ueId="1" DLSPSEnFlag="TRUE" SPSRnti="66"
         DLSPSSchIntrv="20" NumSPSProc="4" prdBsrTmr="65535" NumPucchVal="4"/>

      # 3rd SPS UE Configuration
      <tapa.rg.UeInitTdd2 ueId="2" DLSPSEnFlag="TRUE" SPSRnti="67"
         DLSPSSchIntrv="20" NumSPSProc="4" prdBsrTmr="65535" NumPucchVal="4"/>

      # 4th SPS UE Configuration
      <tapa.rg.UeInitTdd2 ueId="3" DLSPSEnFlag="TRUE" SPSRnti="68"
         DLSPSSchIntrv="20" NumSPSProc="4" prdBsrTmr="65535" NumPucchVal="4"/>

      #Initialize non-SPS UE
      <tapa.rg.UeInitTdd2 ueId="4" prdBsrTmr="65535" />
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
   
   # Configure bi-directional DTCH for SPS UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Configure bi-directional DTCH for SPS UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="4" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Configure bi-directional DTCH for SPS UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="4" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Configure bi-directional DTCH for SPS UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch ueId="3" lcId="4" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Configure bi-directional DTCH for non-SPS UE
   <tapa.send>
      <tapa.crg.cfgreq.cfg.lch ueId="4" lcId="4" lcgId="0" dir="3" lcType="5" />
   </tapa.send>

   # Expect configuration confirm after the TTI
   <tapa.expset>
      <tapa.crg.cfgcfm/>
      <tapa.crg.cfgcfm/>
      <tapa.crg.cfgcfm/>
      <tapa.crg.cfgcfm/>
      <tapa.crg.cfgcfm/>
   </tapa.expset>

   <!--- on RGR interface -->
   # Configure bi-directional DTCH for SPS UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch lcId="4" dir="3" lcType="5" instId="5"
         DLSPSLchEnabFlag="TRUE" DLSPSLchPktSize="40" DLSPSLchPktPrd="32" 
         DLSPSLchExpltRelCnt="2"/>
   </tapa.send>

   # Configure bi-directional DTCH for SPS UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="4" dir="3" lcType="5" instId="5"
         DLSPSLchEnabFlag="TRUE" DLSPSLchPktSize="40" DLSPSLchPktPrd="32" 
         DLSPSLchExpltRelCnt="2"/>
   </tapa.send>

   # Configure bi-directional DTCH for SPS UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch ueId="2" lcId="4" dir="3" lcType="5" instId="5"
         DLSPSLchEnabFlag="TRUE" DLSPSLchPktSize="40" DLSPSLchPktPrd="32" 
         DLSPSLchExpltRelCnt="2"/>
   </tapa.send>

   # Configure bi-directional DTCH for SPS UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch ueId="3" lcId="4" dir="3" lcType="5" instId="5"
         DLSPSLchEnabFlag="TRUE" DLSPSLchPktSize="40" DLSPSLchPktPrd="32" 
         DLSPSLchExpltRelCnt="2"/>
   </tapa.send>

   # Configure bi-directional DTCH for non-SPS UE
   <tapa.send>
      <tapa.rgr.cfgreq.cfg.lch ueId="4" lcId="4" dir="3" lcType="5" instId="5"/>
   </tapa.send>

   # Send TTI indication for default cell
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect configuration confirm
   <tapa.expset>
      <tapa.rgr.cfgCfm status="0"/>
      <tapa.rgr.cfgCfm status="0" ueId="1"/>
      <tapa.rgr.cfgCfm status="0" ueId="2"/>
      <tapa.rgr.cfgCfm status="0" ueId="3"/>
      <tapa.rgr.cfgCfm status="0" ueId="4"/>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="2" rawDlCqiEnc="TRUE" wbCqi="10"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   ###First BO scheduled dynamically - UE0
   <tapa.send>
      # Send BO for the created SPS service on RGU 
      <tapa.rgu.dstarsp lcId="4" lcType="5" bo="20"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expect>
      # Expect staInd from MAC to RLC for SPS service 
      <tapa.rgu.dstaind lchTb1Data="4" saveTo="2"/>
   </tapa.expect>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   ##First BO Dynamic Sched
   <tapa.expset>
      <tapa.tfu.dat.req datReqs="1">
         <tapa.tfu.pdsch.dat.req ueId="0"  use="2" lcId="4" chkSdu="TRUE"
            validateSPS ="FALSE" DLSPSInit="FALSE"/>
      </tapa.tfu.dat.req>
      <tapa.tfu.cntrl.req numCntrlReq="1">
         <tapa.tfu.pdcch.cntrl.req saveTo="2" DLSPSInit="FALSE" ueId="0" />
      </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
         <tapa.tfu.hq.recp.req/>
      </tapa.tfu.recp.req>   
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Send ACK for the received PDU
   <tapa.send>
      <tapa.tfu.hq.ind hqInds="1">
         <tapa.tfu.hq ueId="0" isAckLst="TRUE:TRUE:TRUE:TRUE"/>
      </tapa.tfu.hq.ind>   
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="8"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created SPS service on RGU again
      <tapa.rgu.dstarsp lcId="4" lcType="5" bo="21"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created SPS service of 2nd UE
      <tapa.rgu.dstarsp ueId="1" lcId="4" lcType="5" bo="21"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
      # Expect staInd from MAC to RLC for SPS UEs 
      <tapa.rgu.dstaind lchTb1Data="4" />
      <tapa.rgu.dstaind lchTb1Data="4" ueId="1"/>
   </tapa.expset>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="1" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   ##DL SPS Activation PDCCH For 1st UE
   <tapa.expset>
      <tapa.tfu.dat.req datReqs="2">
         <tapa.tfu.pdsch.dat.req ueId="0"  use="2" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" DLSPSInit="TRUE" />
         <tapa.tfu.pdsch.dat.req ueId="1"  use="3" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" DLSPSInit="FALSE"/>
      </tapa.tfu.dat.req>
      <tapa.tfu.cntrl.req expCntrlReq="2">
         <tapa.tfu.pdcch.cntrl.req saveTo="2" DLSPSInit="TRUE" ueId="0" 
            vldDciFrmt="TRUE" isFormat1a="TRUE" vldtRbAlign="TRUE" 
            rbStart="0" numRb="4"/>
         <tapa.tfu.pdcch.cntrl.req saveTo="3" DLSPSInit="FALSE" ueId="1" 
            vldDciFrmt="TRUE" isFormat1A="TRUE"  />
      </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="7"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="2">
         <tapa.tfu.hq.recp.req ueId="0"/>
         <tapa.tfu.hq.recp.req ueId="1"/>
      </tapa.tfu.recp.req>   
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Ack for 2 UEs 
   <tapa.send>
      <tapa.tfu.hq.ind hqInds="2">
         <tapa.tfu.hq ueId="0" isAckLst="TRUE:TRUE:TRUE:TRUE"/>
         <tapa.tfu.hq ueId="1" isAckLst="TRUE:TRUE:TRUE:TRUE"/>
      </tapa.tfu.hq.ind>   
   </tapa.send>
 
   <tapa.send>
      <tapa.tfu.dlcqi.ind>
         <tapa.tfu.dlcqi ueId="1" cqiIdx="4" />
      </tapa.tfu.dlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="8"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created SPS service on RGU again
      <tapa.rgu.dstarsp lcId="4" lcType="5" bo="21"/>
   </tapa.send>
 
   <tapa.send>
      # Send BO for the created SPS service on RGU again
      <tapa.rgu.dstarsp ueId="1" lcId="4" lcType="5" bo="21"/>
   </tapa.send>
 
   <tapa.send>
      # Send BO for the created SPS service on RGU again
      <tapa.rgu.dstarsp ueId="2" lcId="4" lcType="5" bo="21"/>
   </tapa.send>
 
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
      # Expect staInd from MAC to RLC for SPS service for SPS ocassion  
      <tapa.rgu.dstaind lchTb1Data="4" />
      <tapa.rgu.dstaind ueId="1" lchTb1Data="4" />
      <tapa.rgu.dstaind ueId="2" lchTb1Data="4" />
   </tapa.expset>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="1" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="2" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   ##DL SPS Activation PDCCH For 2nd UE
   <tapa.expset>
      <tapa.tfu.dat.req datReqs="3">
         <tapa.tfu.pdsch.dat.req ueId="0"  use="2" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" saveto="4"/>
         <tapa.tfu.pdsch.dat.req ueId="1"  use="3" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" DLSPSInit="TRUE"/>
         <tapa.tfu.pdsch.dat.req ueId="2"  use="4" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" DLSPSInit="FALSE"/>
      </tapa.tfu.dat.req>
      <tapa.tfu.cntrl.req expCntrlReq="2">
         <tapa.tfu.pdcch.cntrl.req saveTo="3" DLSPSInit="TRUE" ueId="1" 
            vldDciFrmt="TRUE" isFormat1a="TRUE" vldtResAllocMap="TRUE" 
            resAllocMap="60:0:0:0"/>
         <tapa.tfu.pdcch.cntrl.req saveTo="4" DLSPSInit="FALSE" ueId="2" 
            vldDciFrmt="TRUE" isFormat1="TRUE"  />
      </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="7"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="3">
         <tapa.tfu.hq.recp.req ueId="0"/>
         <tapa.tfu.hq.recp.req ueId="1"/>
         <tapa.tfu.hq.recp.req ueId="2"/>
      </tapa.tfu.recp.req>   
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Ack for 3 UEs 
   <tapa.send>
      <tapa.tfu.hq.ind hqInds="2">
         <tapa.tfu.hq ueId="0" isAckLst="TRUE:TRUE:TRUE:TRUE"/>
         <tapa.tfu.hq ueId="1" isAckLst="TRUE:TRUE:TRUE:TRUE"/>
         <tapa.tfu.hq ueId="2" isAckLst="TRUE:TRUE:TRUE:TRUE"/>
      </tapa.tfu.hq.ind>   
   </tapa.send>
 
   <tapa.send>
      <tapa.tfu.tti.ind numTti="8"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created SPS service on RGU again
      <tapa.rgu.dstarsp lcId="4" lcType="5" bo="21"/>
   </tapa.send>
 
   <tapa.send>
      # Send BO for the created SPS service on RGU again
      <tapa.rgu.dstarsp ueId="1" lcId="4" lcType="5" bo="21"/>
   </tapa.send>
 
   <tapa.send>
      # Send BO for the created SPS service on RGU again
      <tapa.rgu.dstarsp ueId="2" lcId="4" lcType="5" bo="21"/>
   </tapa.send>
 
   <tapa.send>
      # Send BO for the created SPS service on RGU again
      <tapa.rgu.dstarsp ueId="3" lcId="4" lcType="5" bo="21"/>
   </tapa.send>
 
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
      # Expect staInd from MAC to RLC for SPS service for SPS ocassion  
      <tapa.rgu.dstaind lchTb1Data="4" />
      <tapa.rgu.dstaind ueId="1" lchTb1Data="4" />
      <tapa.rgu.dstaind ueId="2" lchTb1Data="4" />
      <tapa.rgu.dstaind ueId="3" lchTb1Data="4" />
   </tapa.expset>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="1" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="2" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="3" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   ##DL SPS Activation PDCCH For 3rd UE
   <tapa.expset>
      <tapa.tfu.dat.req datReqs="4">
         <tapa.tfu.pdsch.dat.req ueId="0"  use="2" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" />
         <tapa.tfu.pdsch.dat.req ueId="1"  use="3" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" />
         <tapa.tfu.pdsch.dat.req ueId="2"  use="4" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" DLSPSInit="TRUE"/>
         <tapa.tfu.pdsch.dat.req ueId="3"  use="5" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" DLSPSInit="FALSE"/>
      </tapa.tfu.dat.req>
      <tapa.tfu.cntrl.req expCntrlReq="2">
         <tapa.tfu.pdcch.cntrl.req saveTo="4" DLSPSInit="TRUE" ueId="2" 
            vldDciFrmt="TRUE" isFormat1a="TRUE" vldtRbAlign="TRUE" rbStart="16" 
            numRb="4"/>
         <tapa.tfu.pdcch.cntrl.req saveTo="5" DLSPSInit="FALSE" ueId="3" 
            vldDciFrmt="TRUE" isFormat1="TRUE"  />
      </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="7"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="4">
         <tapa.tfu.hq.recp.req ueId="0"/>
         <tapa.tfu.hq.recp.req ueId="1"/>
         <tapa.tfu.hq.recp.req ueId="2"/>
         <tapa.tfu.hq.recp.req ueId="3"/>
      </tapa.tfu.recp.req>   
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Ack for 4 UEs 
   <tapa.send>
      <tapa.tfu.hq.ind hqInds="2">
         <tapa.tfu.hq ueId="0" isAckLst="TRUE:TRUE:TRUE:TRUE"/>
         <tapa.tfu.hq ueId="1" isAckLst="TRUE:TRUE:TRUE:TRUE"/>
         <tapa.tfu.hq ueId="2" isAckLst="TRUE:TRUE:TRUE:TRUE"/>
         <tapa.tfu.hq ueId="3" isAckLst="TRUE:TRUE:TRUE:TRUE"/>
      </tapa.tfu.hq.ind>   
   </tapa.send>
 
   <tapa.send>
      <tapa.tfu.dlcqi.ind>
         <tapa.tfu.dlcqi ueId="3" cqiIdx="4" />
      </tapa.tfu.dlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="8"/>
   </tapa.send>

   <tapa.send>
      # Send BO for the created SPS service on RGU again
      <tapa.rgu.dstarsp lcId="4" lcType="5" bo="21"/>
   </tapa.send>
 
   <tapa.send>
      # Send BO for the created SPS service on RGU again
      <tapa.rgu.dstarsp ueId="1" lcId="4" lcType="5" bo="21"/>
   </tapa.send>
 
   <tapa.send>
      # Send BO for the created SPS service on RGU again
      <tapa.rgu.dstarsp ueId="2" lcId="4" lcType="5" bo="21"/>
   </tapa.send>
 
   <tapa.send>
      # Send BO for the created SPS service on RGU again
      <tapa.rgu.dstarsp ueId="3" lcId="4" lcType="5" bo="21"/>
   </tapa.send>
 
   <tapa.send>
      # Send BO for the created non-SPS service on RGU 
      <tapa.rgu.dstarsp ueId="4" lcId="4" lcType="5" bo="21"/>
   </tapa.send>
 
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   <tapa.expset>
      # Expect staInd from MAC to RLC for SPS service for SPS ocassion  
      <tapa.rgu.dstaind lchTb1Data="4" />
      <tapa.rgu.dstaind ueId="1" lchTb1Data="4" />
      <tapa.rgu.dstaind ueId="2" lchTb1Data="4" />
      <tapa.rgu.dstaind ueId="3" lchTb1Data="4" />
      <tapa.rgu.dstaind ueId="4" lchTb1Data="4" />
   </tapa.expset>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="0" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="1" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="2" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="3" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      # Send data with size equal to the allocated size on RGU. 
      <tapa.rgu.ddatreq ueId="4" lchTb1Data="4" lcType="5"/>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   ##DL SPS Activation PDCCH For 4th UE and non-SPS UE RB allocation
   <tapa.expset>
      <tapa.tfu.dat.req datReqs="4">
         <tapa.tfu.pdsch.dat.req ueId="0"  use="2" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" />
         <tapa.tfu.pdsch.dat.req ueId="1"  use="3" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" />
         <tapa.tfu.pdsch.dat.req ueId="2"  use="4" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" />
         <tapa.tfu.pdsch.dat.req ueId="3"  use="5" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1" validateSPS ="TRUE" DLSPSInit="FALSE"/>
         <tapa.tfu.pdsch.dat.req ueId="4"  use="6" lcId="4" chkSdu="TRUE"
            numTb1Lyrs="1"/>
      </tapa.tfu.dat.req>
      <tapa.tfu.cntrl.req expCntrlReq="2">
         <tapa.tfu.pdcch.cntrl.req saveTo="5" DLSPSInit="TRUE" ueId="3" 
            vldDciFrmt="TRUE" isFormat1A="TRUE" vldtResAllocMap="TRUE"
            resAllocMap="0:240:0:0"/>
         #Whole 12 RBGs from SPS BW are occupied by SPS UES but 2 RBGs 
         #are left with 2 RBs each, that means totally 4 non-contiguous RBs
         #are available from SPS BW which cannot make an RBG. Hence non-SPS UE
         #can be allocated from SPS BW eventhough the number of RBs avaiable in
         #SPS BW is more than the RBG sizei and only one RBG is required for the UE
         <tapa.tfu.pdcch.cntrl.req saveTo="6" DLSPSInit="FALSE" ueId="4" 
            vldDciFrmt="TRUE" isFormat1="TRUE" vldtResAllocMap="TRUE"
            resAllocMap="0:16:0:0" />
      </tapa.tfu.cntrl.req>
   </tapa.expset>

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>     

#
#       Test:    35.44
#
#       Desc:    TC_MAC_TDD_DLFS_45
#                "To validate the collision between subband CQI and RI 
#                 when UE got configured with Periodic CQI 2-0."
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.44"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To validate the collision between subband CQI and RI when UE got 
          configured with Periodic CQI 2-0."
      </tapa.desc>

      <tapa.longdesc>
         "To validate the collision between subband CQI and RI when UE got 
          configured with Periodic CQI 2-0."
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs ulDlCfgIdx="2"  isDlFreqSel="1" 
         dlTotalBw="25" raWinSize="10" numTxAntPorts="2"/>
      
      <tapa.rg.UeInitTdd2 prdBsrTmr="65535" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"
         prdModeEnumPres="TRUE" prdCqiCfg.type="TRUE" cqiPCfgIdx="78" K="1" 
         cqiRepType="2" riEna="TRUE" riCfgIdx="80" txModeEnum="RGR_UE_TM_3"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
   
   <tapa.send>
      <tapa.tfu.tti.ind numTti="41"/>
   </tapa.send>

   #Expect for recp req SB CQI-BW PART 0
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="10" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="77"/>
   </tapa.send>

   #Expect recp req for RI where Subband CQI and RI are colliding here 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="1"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw Indication for RI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" ri="1"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="77"/>
   </tapa.send>

   #Expect recp req for WB CQI
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" >
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI Indication For BW Part 1
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="6"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>     

#
#       Test:    35.45
#
#       Desc:    TC_MAC_TDD_DLFS_46
#                "To verify that subband CQI will be missed for some BW Parts 
#                 during SFN wrap-around when the WB CQI periodicity is more 
#                 than 320ms and cannot divide 10240."
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.45"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To verify that subband CQI will be missed for some BW Parts during 
          SFN wrap-around when the WB CQI periodicity is more than 320ms and 
          cannot divide 10240."
      </tapa.desc>

      <tapa.longdesc>
         "For this config, only one Subband CQI can be received between WB CQI 
          occasions (1009,2) and (1,2) and rest will be missed."
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="100" raWinSize="10" maxDlHqTx="5"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
   
#5000 TTIs
  <tapa.send>
    <tapa.tfu.tti.ind numTti="500" />
  </tapa.send>
 <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>

#10000 TTIs
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>
   <tapa.delay delay="10"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="500" />
   </tapa.send>

   <tapa.rg.UeInitTdd1 prdBsrTmr="65535" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"
      prdModeEnumPres="TRUE" prdCqiCfg.type="TRUE" cqiPCfgIdx="168" K="2" 
      cqiRepType="2"/>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="51" />
   </tapa.send>

   #Expect for recp req WB CQI at (1009,2)
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw WB CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="10"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for WB CQI at (1,2) after SFN wrap-around 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw WB CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>     

#
#       Test:    35.46
#
#       Desc:    TC_MAC_TDD_DLFS_44
#                "To verify that subband CQI will be missed for some BW Parts 
#                 during SFN wrap-around when the WB CQI periodicity is more 
#                 than 320ms and cannot divide 10240."
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.46"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To verify that subband CQI will be missed for some BW Parts during 
          SFN wrap-around when the WB CQI periodicity is more than 320ms and 
          cannot divide 10240."
      </tapa.desc>

      <tapa.longdesc>
         "For this config, only one Subband CQI can be received between WB CQI 
          occasions (1009,2) and (1,2) and rest will be missed."
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="100" raWinSize="10" numTxAntPorts="2"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="10000" />
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="200" />
   </tapa.send>

   <tapa.rg.UeInitTdd1 prdBsrTmr="65535" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"
      prdModeEnumPres="TRUE" prdCqiCfg.type="TRUE" cqiPCfgIdx="159" K="1" 
      cqiRepType="2" riCfgIdx="644" riEna="TRUE" txModeEnum="RGR_UE_TM_3"/>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="2" />
   </tapa.send>

   #Expect recp req for RI at (0,3)
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="1"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw WB CQI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" ri="1"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

<tapa.repeat.start repeatCount="12"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART0 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 2
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 3
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for WB CQI 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw WB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

<tapa.repeat.end/>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART0 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART1 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART2 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="157"/>
   </tapa.send>

   #Expect recp req for RI.. Instead of SB CQI for BW Part3 at (0,3)
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="1"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   #Send RI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" ri="1"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>      

#
#       Test:    35.47
#
#       Desc:    TC_MAC_TDD_DLFS_44
#                "To verify that subband CQI will be missed for some BW Parts 
#                 during SFN wrap-around when the WB CQI periodicity is more 
#                 than 320ms and cannot divide 10240."
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.47"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To verify that subband CQI will be missed for some BW Parts during 
          SFN wrap-around when the WB CQI periodicity is more than 320ms and 
          cannot divide 10240."
      </tapa.desc>

      <tapa.longdesc>
         "For this config two subband cqi are missed.This checks for condition
         when CQI offset is greater than RI offset and CQI periodicity is 80ms"
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="100" raWinSize="10" numTxAntPorts="2"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="10000" />
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="200" />
   </tapa.send>

   <tapa.rg.UeInitTdd1 prdBsrTmr="65535" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"
      prdModeEnumPres="TRUE" prdCqiCfg.type="TRUE" cqiPCfgIdx="98" K="1" 
      cqiRepType="2" riCfgIdx="166" riEna="TRUE" txModeEnum="RGR_UE_TM_3"/>

<tapa.repeat.start repeatCount="12"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="16"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="1"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send RI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" ri="1"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   #Expect recp req for WB CQI 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw WB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART0 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 2
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 3
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for WB CQI 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw WB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART0 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 2
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 3
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="55"/>
   </tapa.send>

<tapa.repeat.end/>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="16"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="1"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send RI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" ri="1"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   #Expect recp req for WB CQI 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw WB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART0 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 2
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 3
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for WB CQI 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw WB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART0 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="71"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="1"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send RI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" ri="1"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>      


#
#       Test:    35.48
#
#       Desc:    TC_MAC_TDD_DLFS_44
#                "To verify that subband CQI will be missed for some BW Parts 
#                 during SFN wrap-around when the WB CQI periodicity is more 
#                 than 320ms and cannot divide 10240."
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.48"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To verify that subband CQI will be missed for some BW Parts during 
          SFN wrap-around when the WB CQI periodicity is more than 320ms and 
          cannot divide 10240."
      </tapa.desc>

      <tapa.longdesc>
         "For this config two subband cqi are missed.This checks for condition
         when RI offset is greater than CQI offset and CQI periodicity is 80ms"
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="100" raWinSize="10" numTxAntPorts="2"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="10000" />
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="200" />
   </tapa.send>

   <tapa.rg.UeInitTdd1 prdBsrTmr="65535" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"
      prdModeEnumPres="TRUE" prdCqiCfg.type="TRUE" cqiPCfgIdx="78" K="1" 
      cqiRepType="2" riCfgIdx="166" riEna="TRUE" txModeEnum="RGR_UE_TM_3"/>

<tapa.repeat.start repeatCount="12"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   #Expect recp req for WB CQI 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw WB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART0 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 2
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 3
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for WB CQI 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw WB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART0 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 2
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 3
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="71"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="1"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send RI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" ri="1"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

<tapa.repeat.end/>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   #Expect recp req for WB CQI 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw WB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART0 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 2
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 3
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for WB CQI 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw WB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART0 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="76"/>
   </tapa.send>

   #Expect recp req for WB CQI 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw WB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>
</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>      



#
#       Test:    35.49
#
#       Desc:    TC_MAC_TDD_DLFS_44
#                "To verify that subband CQI will be missed for some BW Parts 
#                 during SFN wrap-around when the WB CQI periodicity is more 
#                 than 320ms and cannot divide 10240."
#
#       Notes:   None
#
#       Module:  "DLFS Module"
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.49"> 

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To verify that subband CQI will be missed for some BW Parts during 
          SFN wrap-around when the WB CQI periodicity is more than 320ms and 
          cannot divide 10240."
      </tapa.desc>

      <tapa.longdesc>
         "For this config 1 Wb and 5 subband cqi are missed.This checks for condition
         when CQI offset is greater than RI offset and CQI periodicity is 160ms"
      </tapa.longdesc>

   </tapa.doc>
 # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
      </tapa.ifdef>

      <tapa.ifndef/>

      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Initialize LTEMAC
      <tapa.rg.macInit/>

      #<tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlfs ulDlCfgIdx="1"  isDlFreqSel="1" 
      dlTotalBw="100" raWinSize="10" numTxAntPorts="2"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="10000" />
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="200" />
   </tapa.send>

   <tapa.rg.UeInitTdd1 prdBsrTmr="65535" prdModeEnum="RGAC_RGR_PRD_CQI_MOD20"
      prdModeEnumPres="TRUE" prdCqiCfg.type="TRUE" cqiPCfgIdx="158" K="1" 
      cqiRepType="2" riCfgIdx="166" riEna="TRUE" txModeEnum="RGR_UE_TM_3"/>

<tapa.repeat.start repeatCount="6"/>
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   #Expect recp req for WB CQI 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw WB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="156"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART0 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="156"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="156"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 2
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="156"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 3
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="156"/>
   </tapa.send>

   #Expect recp req for WB CQI 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw WB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="156"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART0 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="156"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="156"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 2
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="156"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 3
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="151"/>
   </tapa.send>

   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="1"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send RI Indication
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" ri="1"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

<tapa.repeat.end/>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   #Expect recp req for WB CQI 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw WB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="156"/>
   </tapa.send>

   #Expect recp req for SB CQI - BW PART0 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="156"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 1
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="156"/>
   </tapa.send>

   #Expect recp req for SB CQI -BW PART 2
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="6"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw SB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" sbCqi="11" label="0"/>
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="156"/>
   </tapa.send>

   #Expect recp req for WB CQI 
   <tapa.expect>
      <tapa.tfu.recp.req expRecpReq="1" spId="1">
         <tapa.tfu.dlcqi.recp.req vldtCqiPmiSz="TRUE" cqiPmiSz="4"/>
      </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   #Send Raw WB CQI
   <tapa.send >
      <tapa.tfu.rawdlcqi.ind>
         <tapa.tfu.rawdlcqi ueId="0" rawDlCqiEnc="TRUE" wbCqi="11" />
      </tapa.tfu.rawdlcqi.ind>
   </tapa.send>

</tapa.test>

# Clean subsection
   <tapa.clean>
      #Command To ShutDown LTEMAC Layer
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>
   </tapa.shutdown>
</tapa.testcase>      

#
#       Test:    35.50
#
#       Desc:    Validation of PMI.
#                Incase of Precoding Information Signalling to a UE is implicit
#                then MAC Scheduler Shall explicitely inform the PHY layer as to
#                what are the sub band and PMI mappings.
#
#       Notes:   None
#
#       Module:
#
#       File:    rgac_tc35.xml
#
#
<tapa.testcase id="35.50">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
          Validate grant and RB allocation for TM4 DLFS when Aperiodic mode 3-1 is reported
      </tapa.desc>

      <tapa.longdesc>
         "1. Configure a UE with TM4.
          2. Send Feedback report using Aperiodic mode 3 - 1
             and RI=2 from the TFU Interface.
          3. Send non-zero BO.
          4. Verify 2 TB scheduling using TX scheme as Spatial
             Multiplexing, grant and Resource allocation map. 
      </tapa.longdesc>

   </tapa.doc>
# Require features and flags subsection
   <tapa.require>
      <tapa.ifdef>
         <tapa.flag id="TFU_TDD"/>
         <tapa.flag id="LTEMAC_MIMO"/>
         <tapa.flag id="RG_PHASE2_SCHED"/>
      </tapa.ifdef>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

# Configuration subsection
   <tapa.cfg>
   # Initialize LTEMAC
   <tapa.rg.macInit/>

   #<tapa.rg.dbgDeInitAll/>

   #Initialize CELL
  <tapa.rg.cellInit.dlfs thresholdCqi= "5" ulDlCfgIdx="2"  isDlFreqSel="1"
                dlTotalBw="100" raWinSize="10" ulTotalBw="100" numTxAntPorts="2" maxDlUeNewTxPerTti="2"/>
  </tapa.cfg>


   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>

         # Send RaReqInd for one rapId in the first special frame 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

         # Send it in the 6th frequency index 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="52" numRapId="1" rapIds="5" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # In this TC, it shall expect raResp in the first DL subframe after 3 Ttis.

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      
      # Expect RaResp for the rapId sent in RaReq
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="52"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="9"/>
      </tapa.send>

      # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="1" spId="1">
            <tapa.tfu.msg3.recp.req ueId="0" />
         </tapa.tfu.recp.req>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   #Send CRC for Msg3 for 1st UE
   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Expect HARQ ACK in PHICH For MSG3
   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

      # Send Message3 after receiving Message3 reception req for 1st UE .
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="0"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

      # Expect Message3 datReq on CCCH at RGU.
      <tapa.expset>
         <tapa.rgu.cdatind ueId="0" lcId="4"/>
      </tapa.expset>

    # Send BO for Msg4 on RGU for 1st UE.
    <tapa.send>
       <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10" ueId="0"/>
    </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Expect CStatInd For MSG4
   <tapa.expset>
      <tapa.rgu.cstaind lcId="4"/>
   </tapa.expset>

   # Send Msg4 on RGU for 1st UE.
   <tapa.send>
      <tapa.rgu.cdatreq ueId="0" lcId="4" lcType="3" />
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect Msg4 from MAC to PHY.
   <tapa.expset>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req use="1" validate="FALSE"/>
     </tapa.tfu.dat.req>
     <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   # Recv Hq Recp Req for Msg4.
   <tapa.expect>
     <tapa.tfu.recp.req expRecpReq="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   # Send ACK as feedback for Msg4 for 1st UE.
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
	<tapa.tfu.hq ueId="0" isAckLst="TRUE:FALSE:FALSE:FALSE"/>
     </tapa.tfu.hq.ind>
  </tapa.send>

   # Send UE config request for 1st UE
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue ueId="0"/>
   </tapa.send>

   # Expect success in cfg cfm for 1st UE
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>
# Send UE config request for 1st UE
   <tapa.send>
     <tapa.rgr.cfgreq.cfg.ue instId="5" ueId="0" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" prdBsrTmr="65535"
	 txModeEnum="RGR_UE_TM_4" tm="CRG_UE_TM_4" ueCatEnum="CM_LTE_UE_CAT_5" aprdModeEnumPres="TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD31"/>
   </tapa.send>
   # Send TTI to apply the config
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>
 <tapa.send>
         # Configure a dedicated logical channel for the created UE
         # lcType=5 for DCCH
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="5" dir="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm status="0"/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE
         # lcType=5 for DCCH
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="5" dir="1" instId="5"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the configuration applied.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm status="0" instId="5"/>
      </tapa.expect>
      #start second UE
      <tapa.send>
         <tapa.tfu.tti.ind numTti="7"/>
      </tapa.send>

         # Send it in the 6th frequency index 
      <tapa.send>
         <tapa.tfu.rareq.ind numRaRntis="1">
            <tapa.tfu.rareq raRnti="52" numRapId="1" rapIds="5" cqiPres="TRUE" cqis="4"/>
         </tapa.tfu.rareq.ind>
      </tapa.send>

      # Ue starts expecting raResp after 3 subframes within the raResp window.
      # In this TC, it shall expect raResp in the first DL subframe after 3 Ttis.

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      
      # Expect RaResp for the rapId sent in RaReq
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.rarsp.req raRnti="52"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
           <tapa.tfu.pdcch.cntrl.req/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="9"/>
      </tapa.send>

      # message 3 reception request afetr Ra Rsp
      <tapa.expect>
         <tapa.tfu.recp.req expRecpReq="1" spId="1">
            <tapa.tfu.msg3.recp.req ueId="1" />
         </tapa.tfu.recp.req>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   #Send CRC for Msg3 for 2st UE
   <tapa.send>
      <tapa.tfu.crc.ind>
         <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
      </tapa.tfu.crc.ind>
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Expect HARQ ACK in PHICH For MSG3
   <tapa.expect>
      <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
         <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
      </tapa.tfu.cntrl.req>
   </tapa.expect>

      # Send Message3 after receiving Message3 reception req for 2st UE .
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat  isCcchSdu="TRUE" sduSize="6" ueId="1"/>
       </tapa.tfu.dat.ind>      
      </tapa.send>   

      # Expect Message3 datReq on CCCH at RGU.
      <tapa.expset>
         <tapa.rgu.cdatind ueId="1" lcId="4"/>
      </tapa.expset>

    # Send BO for Msg4 on RGU for 1st UE.
    <tapa.send>
       <tapa.rgu.cstarsp lcId="4" lcType="3" bo="10" ueId="1"/>
    </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Expect CStatInd For MSG4
   <tapa.expset>
      <tapa.rgu.cstaind lcId="4"/>
   </tapa.expset>

   # Send Msg4 on RGU for 1st UE.
   <tapa.send>
      <tapa.rgu.cdatreq ueId="1" lcId="4" lcType="3" />
   </tapa.send>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect Msg4 from MAC to PHY.
   <tapa.expset>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req use="1" ueId="1" validate="FALSE"/>
     </tapa.tfu.dat.req>
     <tapa.tfu.cntrl.req expCntrlReq="1" spId="1">
        <tapa.tfu.pdcch.cntrl.req ueId="1"  saveTo="1"/>
     </tapa.tfu.cntrl.req>
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="4"/>
   </tapa.send>

   # Recv Hq Recp Req for Msg4.
   <tapa.expect>
     <tapa.tfu.recp.req expRecpReq="1" spId="1">
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>
   </tapa.expect>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3" />
   </tapa.send>

   # Send ACK as feedback for Msg4 for 1st UE.
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
	<tapa.tfu.hq ueId="1" isAckLst="TRUE:FALSE:FALSE:FALSE"/>
     </tapa.tfu.hq.ind>
  </tapa.send>

   # Send UE config request for 1st UE
   <tapa.send>
     <tapa.crg.cfgreq.cfg.ue ueId="1"/>
   </tapa.send>

   # Expect success in cfg cfm for 1st UE
   <tapa.expect>
      <tapa.crg.cfgcfm/>
   </tapa.expect>
# Send UE config request for 1st UE
   <tapa.send>
     <tapa.rgr.cfgreq.cfg.ue instId="5" ueId="1" ackNackModeEnum="RGR_TDD_ACKNACK_MODE_BUNDL" prdBsrTmr="65535"
	 txModeEnum="RGR_UE_TM_4" tm="CRG_UE_TM_4" ueCatEnum="CM_LTE_UE_CAT_5" aprdModeEnumPres="TRUE" aprdModeEnum="RGAC_RGR_APRD_CQI_MOD31"/>
   </tapa.send>
   # Send TTI to apply the config
   <tapa.send>
      <tapa.tfu.tti.ind numTti="1"/>
   </tapa.send>

   # Expect success in cfg cfm
   <tapa.expect>
      <tapa.rgr.cfgCfm instId="5"/>
   </tapa.expect>
 <tapa.send>
         # Configure a dedicated logical channel for the created UE
         # lcType=5 for DCCH
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="9" lcType="5" dir="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.crg.cfgcfm status="0"/>
      </tapa.expect>

      <tapa.send>
         # Configure a dedicated logical channel for the created UE
         # lcType=5 for DCCH
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="9" lcType="5" dir="1" instId="5"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the configuration applied.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect success in cfg cfm
         <tapa.rgr.cfgCfm status="0" instId="5"/>
      </tapa.expect>
      #end second UE config
      # Send CQI report with RI=2
      # Send CQI indication for Aperiodic mode 3-1
      <tapa.send>
        <tapa.tfu.dlcqi.ind>
          <tapa.tfu.dlcqi ueId="0" isPucchInfo="FALSE" isRiPres="TRUE" ri="2"
             cqiMode="4" numOfSubbands = "13" rbStartLst = "0:8:16:24:32:40:48:56:64:72:80:88:96"
             wbCqiTb0="15" wbCqiTb1="13" numRbLst = "8:8:8:8:8:8:8:8:8:8:8:8:4" pmiIdx ="1"
             cqiIdxLstTb0="13:13:13:13:13:15:15:15:15:15:13:13:13" cqiIdxLstTb1="13:13:13:13:13:15:15:15:15:15:13:13:13" />
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="9" lcType="5" bo="7000"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC
         <tapa.rgu.dstaind lchTb1Data="9" saveTo="2" numLchTb1="1" numLchTb2="1"
                           lchTb2Data="9" />
      </tapa.expect>

      <tapa.send>
         # Send data with size equal to the allocated size on RGU.
         <tapa.rgu.ddatreq ueId="0" numLchTb1="1" numLchTb2="1" lchTb1Data="9"
                           lchTb2Data="9"  lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

 # Expect Format2, mode=4, pmi = 2 and PUSCHMODE = MODE31 in pusch
      # SpaMux as TX Scheme
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req ueId="0"  use="9" lcId="9" chkSdu="TRUE"
              transMode="TFU_UE_TM_4" isTb1="TRUE" isTb2="TRUE"
              vldPuschPmiInfo="TRUE" puschMode="TFU_PUSCH_CQI_MODE_31"
              vldPuschRptUsd="TRUE" puschRptUsd="FALSE"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="9" vldDciFrmt="TRUE" isFormat2="TRUE"
              isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" vldtGrant="TRUE"
              isChkPmi="TRUE" chkPmi="1" vldtResAllocMap="TRUE" resAllocMap="128:63:240:00" 
              imcsTb0="28" imcsTb1="25"/>
        </tapa.tfu.cntrl.req>
         # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      </tapa.expset>
      <tapa.send>
         # Send 1 Tti
         <tapa.tfu.tti.ind numTti="8"/>
      </tapa.send>
   <tapa.expect>
     <tapa.tfu.recp.req expRecpReq="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>
   </tapa.expect>
   <tapa.send>
      # Send 1 Tti
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>
    <tapa.send>
      <tapa.tfu.hq.ind hqInds="1">
         <tapa.tfu.hq isAck="TRUE" isTb2="TRUE" isAckTb2="TRUE"/>
      </tapa.tfu.hq.ind>
    </tapa.send>
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
 # 2nd ACQI report
      # Send CQI report with RI=2
      # Send CQI indication for Aperiodic mode 3-1
      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="0" isPucchInfo="FALSE" isRiPres="TRUE" ri="2"
               cqiMode="4" numOfSubbands = "13" rbStartLst = "0:8:16:24:32:40:48:56:64:72:80:88:96"
               wbCqiTb0="15" wbCqiTb1="13" numRbLst = "8:8:8:8:8:8:8:8:8:8:8:8:4" pmiIdx ="1"
               cqiIdxLstTb0="15:13:15:13:15:13:15:13:15:13:15:13:15" cqiIdxLstTb1="15:13:15:13:15:13:15:13:15:13:15:13:15"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.dlcqi.ind>
            <tapa.tfu.dlcqi ueId="1" isPucchInfo="FALSE" isRiPres="TRUE" ri="2"
               cqiMode="4" numOfSubbands = "13" rbStartLst = "0:8:16:24:32:40:48:56:64:72:80:88:96"
               wbCqiTb0="15" wbCqiTb1="13" numRbLst = "8:8:8:8:8:8:8:8:8:8:8:8:4" pmiIdx ="1"
               cqiIdxLstTb0="15:13:15:13:15:13:15:13:15:13:15:13:15" cqiIdxLstTb1="15:13:15:13:15:13:15:13:15:13:15:13:15"/>
         </tapa.tfu.dlcqi.ind>
      </tapa.send>
      <tapa.send>
         # Send a Tti to get the transmission scheduled.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp lcId="9" lcType="5" bo="7000"/>
      </tapa.send>
      <tapa.send>
         # Send BO for the created logical channel on RGU.
         <tapa.rgu.dstarsp ueId="1" lcId="9" lcType="5" bo="7000"/>
      </tapa.send>

      <tapa.send>
         # Send a Tti to get the transmission scheduled.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
         # Expect staInd from MAC to RLC
         <tapa.rgu.dstaind lchTb1Data="9" saveTo="3" numLchTb1="1" numLchTb2="1" lchTb2Data="9" />
      </tapa.expect>
      <tapa.expect>
         # Expect staInd from MAC to RLC
         <tapa.rgu.dstaind ueId="1" lchTb1Data="9" saveTo="3" numLchTb1="1" numLchTb2="1" lchTb2Data="9" />
      </tapa.expect>
      <tapa.send>
         # Send data with size equal to the allocated size on RGU.
         <tapa.rgu.ddatreq numLchTb1="1" numLchTb2="1" lchTb1Data="9"
                           lchTb2Data="9"  lcType="5"/>
      </tapa.send>

      <tapa.send>
         # Send data with size equal to the allocated size on RGU.
         <tapa.rgu.ddatreq ueId="1" numLchTb1="1" numLchTb2="1" lchTb1Data="9"
                           lchTb2Data="9"  lcType="5"/>
      </tapa.send>
      <tapa.send>
         # Send 1 Tti
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
 # Expect Format2, mode=4, pmi = 2 and PUSCHMODE = MODE31 in pusch
      # SpaMux as TX Scheme
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="2">
           <tapa.tfu.pdsch.dat.req use="9" lcId="9" chkSdu="TRUE"
              transMode="TFU_UE_TM_4" isTb1="TRUE" isTb2="TRUE"
              vldPuschPmiInfo="TRUE" puschMode="TFU_PUSCH_CQI_MODE_31"
              vldPuschRptUsd="TRUE" puschRptUsd="FALSE"/>
           <tapa.tfu.pdsch.dat.req ueId="1" lcId="9" chkSdu="TRUE"
              transMode="TFU_UE_TM_4" isTb1="TRUE" isTb2="TRUE"
              vldPuschPmiInfo="TRUE" puschMode="TFU_PUSCH_CQI_MODE_31"
              vldPuschRptUsd="TRUE" puschRptUsd="FALSE"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req saveTo="9" vldDciFrmt="TRUE" isFormat2="TRUE"
              isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" vldtGrant="TRUE"
              isChkPmi="TRUE" chkPmi="1" vldtResAllocMap="TRUE" resAllocMap="204:204:200:00"
              imcsTb0="28" imcsTb1="25"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="9" vldDciFrmt="TRUE" isFormat2="TRUE"
              isTb1Pres="TRUE" isTb2Pres="TRUE" vldCWSwapFlag="FALSE" vldtGrant="TRUE"
              isChkPmi="TRUE" chkPmi="1" vldtResAllocMap="TRUE" resAllocMap="51:51:36:128"
              imcsTb0="28" imcsTb1="25"/>
        </tapa.tfu.cntrl.req>
         # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      </tapa.expset>

      <tapa.send>
         # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
         # - TFU_DELTA Ttis to expect harqrecp req from MAC.
         <tapa.tfu.tti.ind numTti="8"/>
      </tapa.send>
   <tapa.expect>
     <tapa.tfu.recp.req expRecpReq="2">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>
   </tapa.expect>

      # Send TFU_DELTA + TFU_UL_DELTA Ttis to send fdbk to MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

 # Send ACK for the received PDU
      <tapa.send>
        <tapa.tfu.hq.ind hqInds="2">
           <tapa.tfu.hq isAck="TRUE" isTb2="TRUE" isAckTb2="TRUE"/>
           <tapa.tfu.hq ueId="1" isAck="TRUE" isTb2="TRUE" isAckTb2="TRUE"/>
        </tapa.tfu.hq.ind>
      </tapa.send>

   </tapa.test>
   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

      # Layer Manager ShutDown

   </tapa.shutdown>

</tapa.testcase>

