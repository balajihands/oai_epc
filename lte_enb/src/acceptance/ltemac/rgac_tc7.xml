#
#/********************************************************************20**
#
#     Name:    SIP 
#
#     Type:    XML Test File
#
#     Desc:    XML Based Test Cases
#
#     File:    rgac_tc7.xml
#
#     Sid:      cm_xta_gen_tc_num.py@@/main/5 - Wed Jun 27 16:21:06 2007
#
#     Prg:     hn 
#
#*********************************************************************21*/

# DO NOT DELETE THIS LINE -- TC number generation script depends on it.
# xyzabcstart=7:hn:rgac_tc7.xml

#
#
#       Test:    7.1
#
#       Desc:    To test DL Scheduler for GBR SVCs Priorities
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.1">>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test DL Scheduler for GBR SVCs Priorities"
      </tapa.desc>

      <tapa.longdesc>
         "To Test if DLS gives higher priority to a SVC with greater BO
          among the configured SVCs of the UE which have same priority 
          and same GBR configuration."
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>


      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueId="0"/>
      <tapa.rg.UeInit ueId="1"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" dlGbr="1000" dlMbr="2000"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="1000"  dlMbr="2000"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" dlGbr="1000" dlMbr="2000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="1" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="1000"  dlMbr="2000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>


      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="9" lcType="4" bo="15"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="1" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Send DDatReq for UE1 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="1" lcId="9" lcType="4"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
     </tapa.tfu.cntrl.req>
   # Expect Msg4 from MAC to PHY.
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
        <tapa.tfu.pdsch.dat.req use="2" ueId="1" numSdu="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   # Send ACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.2
#
#       Desc:    To test DL Scheduler for GBR SVCs Priorities
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.2">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test DL Scheduler for GBR SVCs Priorities"
      </tapa.desc>

      <tapa.longdesc>
        "BO of UE's SVC's are same. But the SVC's are configured with 
         different GBR values but same priority. In this case the 
         higher effective GBR svc should be scheduled first."
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueCatEnum="2"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

  <tapa.send>
     <tapa.tfu.dlcqi.ind>
        <tapa.tfu.dlcqi ueId="0" cqiIdx="4"/>
     </tapa.tfu.dlcqi.ind>
  </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="8" lcType="4" dir="1" dlQci="3" />
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" />
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="8" lcType="4" dir="1" dlQci="3" dlGbr="256"  dlMbr="512" instId="5"/>
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" dlGbr="512"  dlMbr="1024" instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="8" lcType="4" bo="1024"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="1024"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for Msg4 
      # Here lcId 9 should be completely satisfied and 8 should
      # have been partially satisfied. To verify this, expect a 
      # dstaInd after 1 tti, which indicates only lcId 8 being 
      #scheduled.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" numLchTb1="2" lchTb1Data="9:8" />
      </tapa.expect>
     
      # Send data with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq  ueId="0" numLchTb1="2" lchTb1Data="9,0,1:8,0,1"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="8" />
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.rgu.ddatreq  ueId="0" numLchTb1="1" lchTb1Data="8,0,1"/>
      </tapa.send>

      # Send data with size equal to the allocated size on RGU. 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.3
#
#       Desc:    To test DL Scheduler for GBR SVCs Priorities
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.3">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test DL Scheduler for GBR SVCs Priorities"
      </tapa.desc>

      <tapa.longdesc>
         "To test if DLS satisfies GBR svc prior to any MBR service. 
         Svc1 gbr  > 0, Svc2Gbr=0 and Svc2MBR > 0 and Svc2Bo > Svc1Bo. 
         In this case Svc1 should be scheduled first."
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueCatEnum="2"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

  <tapa.send>
     <tapa.tfu.dlcqi.ind>
        <tapa.tfu.dlcqi ueId="0" cqiIdx="5"/>
     </tapa.tfu.dlcqi.ind>
  </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="8" lcType="4" dir="1" dlQci="3" dlGbr="256"  dlMbr="1024"/>
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" dlGbr="0"  dlMbr="1024"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="8" lcType="4" dir="1" dlQci="3" dlGbr="256"  dlMbr="1024" instId="5"/>
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" dlGbr="0"  dlMbr="1024" instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>


      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="8" lcType="4" bo="900"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="1000"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for Msg4 
      # Here lcId 8 should be completely satisfied and 9 should
      # have been partially satisfied. To verify this, expect a 
      # dstaInd after 1 tti, which indicates only lcId 9 being 
      #scheduled.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" numLchTb1="2" lchTb1Data="8:9" />
      </tapa.expect>
     
      # Send data with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq  ueId="0" numLchTb1="2" lchTb1Data="8,0,1:9,0,1"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="9" />
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send data with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq  ueId="0" numLchTb1="1" lchTb1Data="9,0,1"/>
      </tapa.send>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send TFU_DELTA Ttis to send fdbk to MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.4
#
#       Desc:    To test DL Scheduler for GBR SVCs Priorities
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.4">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test DL Scheduler for GBR SVCs Priorities"
      </tapa.desc>

      <tapa.longdesc>
         "To test if DLS satisfies a svc with higher priority for 2 
         configured services with same bo gbr/mbr. 
         (svc1Prio=2, svc2Prio=3). 
         If bw is available and data has to be scheduled, 
         then allocation should be in that order. To verify this set ueCatEnum
         such that on the first schd instance, svc1->bo gets completely satisfied
         and svc2 gets partially."
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit  ueCatEnum="2"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send DlCqi for the created UE  
  <tapa.send>
     <tapa.tfu.dlcqi.ind>
        <tapa.tfu.dlcqi ueId="0" cqiIdx="5"/>
     </tapa.tfu.dlcqi.ind>
  </tapa.send>

  # Configure a dedicated logical channel for the created UE 
  # Interchanged qci of lcid 8 and 9
  # with each other was Priority(Qci 2) > Priority(Qci 3)
  # after the change
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="8" lcType="4" dir="1" dlQci="3" dlGbr="256"  dlMbr="1024"/>
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="2" dlGbr="512"  dlMbr="2048"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="8" lcType="4" dir="1" dlQci="3" dlGbr="256"  dlMbr="1024" instId="5"/>
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="2" dlGbr="512"  dlMbr="2048" instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="8" lcType="4" bo="1000"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="1100"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for Msg4 
      # Here lcId 8 should be completely satisfied and 9 should
      # have been partially satisfied. To verify this, expect a 
      # dstaInd after 1 tti, which indicates only lcId 9 being 
      #scheduled.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" numLchTb1="2" lchTb1Data="8:9" />
      </tapa.expect>
     
      # Send data with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq  ueId="0" numLchTb1="2" lchTb1Data="8,0,1:9,0,1"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="9" />
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      # Send data with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq  ueId="0" numLchTb1="1" lchTb1Data="9,0,1"/>
      </tapa.send>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send TFU_DELTA Ttis to send fdbk to MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.5
#
#       Desc:    To test is DLS satisfies UE with higher ambr priority first.
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.5">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test is DLS satisfies UE with higher ambr priority first."
      </tapa.desc>

      <tapa.longdesc>
         "Configure 1 Cell and 2 UE with 1 non gbr svc each. 
         Such that UE1->svc->prio is greater than UE2's. 
         Send starsp in some tti for UE2 and then for UE1. 
         Verify that in the next TTI, staInd for UE1 is received first by RLC. 
         Scheduler schedules UE1 prior to UE2."
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>


      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueId="0" ambrPres="TRUE" dlAmbr="1024"/>
      <tapa.rg.UeInit ueId="1" ambrPres="TRUE" dlAmbr="1024"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8" />
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="9" lcType="4" dir="1"  dlQci="7" />
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8"  instId="5"/>
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="9" lcType="4" dir="1"  dlQci="7"  instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="28"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="9" lcType="4" bo="40"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="1" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Send DDatReq for UE1 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="1" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="2">
           <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
           <tapa.tfu.pdsch.dat.req  use="2" ueId="1" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req saveTo="2" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send TFU_DELTA Ttis to send fdbk to MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      #verify no further scheduling
      <tapa.send>
         <tapa.tfu.tti.ind numTti="5"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.6
#
#       Desc:    To test is DLS satisfies UE with higher ambr priority first.
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.6">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test is DLS satisfies UE with higher ambr priority first."
      </tapa.desc>

      <tapa.longdesc>

         "Configure 1 Cell and 2 UE with 1 non gbr svc each. Such that 
         UE1->svc->prio is greater than UE2's. Send starsp in some tti 
         for UE2 and then for UE1. Verify that in the next TTI, staInd 
         for UE1 is received first by RLC. Scheduler schedules UE1 prior 
         to UE2."
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>


      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueId="0" ambrPres="TRUE" dlAmbr="1024"/>
      <tapa.rg.UeInit ueId="1" ambrPres="TRUE" dlAmbr="1024"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="10" lcType="4" dir="1" dlQci="7" />
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8" />
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="8" lcType="4" dir="1"  dlQci="6" />
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="10" lcType="4" dir="1" dlQci="7" instId="5" />
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8" instId="5" />
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="8" lcType="4" dir="1"  dlQci="6"  instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="50"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="8" lcType="4" bo="20"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="10" lcType="4" bo="30"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for UE2.
      # Priorities of QCI have changed
      # to Priority(7)==Priority(6)>Priority(8)
      # Changed accordingly
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="10" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="1" lchTb1Data="8" saveTo="2"/>
      </tapa.expect>
     
      # Send DDatReq for UE1 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="8" ueId="1" lcId="8" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="10" ueId="0" lcId="10" lcType="4"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="2">
           <tapa.tfu.pdsch.dat.req use="1" ueId="1" numSdu="1" />
           <tapa.tfu.pdsch.dat.req  use="2" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req saveTo="2" ueId="0"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send TFU_DELTA Ttis to send fdbk to MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.7
#
#       Desc:    To test is DLS satisfies UE with higher effective ambr first with in
#                the priority.
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.7">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test is DLS satisfies UE with higher effective ambr first with in
         the priority."
      </tapa.desc>

      <tapa.longdesc>
         "Configure 1 Cell and 2 UE with 1 non gbr svc each. 
         Such that UE1->svc->prio == UE2->svc->prio and 
         UE1->svcAmbr > UE2->svcAmbr. All these AMBrs are 
         sufficient enough. Send starsp in some tti for UE2 
         and then for UE1 such that BO2 > BO1. Verify that 
         in the next TTI, staInd for UE2 is received first by RLC. 
         Scheduler schedules UE2 prior to UE1."
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueId="0" ambrPres="TRUE" dlAmbr="512"/>
      <tapa.rg.UeInit ueId="1" ambrPres="TRUE" dlAmbr="256"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="10" lcType="4" dir="1" dlQci="7" />
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="8" lcType="4" dir="1"  dlQci="7" />
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="10" lcType="4" dir="1" dlQci="7"  instId="5"/>
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="8" lcType="4" dir="1"  dlQci="7"  instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="8" lcType="4" bo="30"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="10" lcType="4" bo="20"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="1" lchTb1Data="8" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="10" saveTo="2"/>
      </tapa.expect>
     
      # Send DDatReq for UE1 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="8" ueId="1" lcId="8" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="10" ueId="0" lcId="10" lcType="4"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="2">
           <tapa.tfu.pdsch.dat.req use="1" ueId="1" numSdu="1" />
           <tapa.tfu.pdsch.dat.req  use="2" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" ueId="1"/>
           <tapa.tfu.pdcch.cntrl.req saveTo="2" ueId="0"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send TFU_DELTA Ttis to send fdbk to MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.8
#
#       Desc:    To test is DLS satisfies UE with higher effective ambr first with in
#                the priority.
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.8">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test is DLS satisfies UE with higher effective ambr first with in
         the priority."
      </tapa.desc>

      <tapa.longdesc>
         "Configure 1 Cell and 2 UE with 1 non gbr svc each. 
         Such that UE1->svc->prio == UE2->svc->prio and 
         UE1->svcAmbr > UE2->svcAmbr.Send starsp in some tti for UE2 
         and then for UE1 such that BO2(>UE2->svcAmbr) > BO1. Verify that 
         in the next TTI, staInd for UE1 is received first by RLC. 
         Scheduler schedules UE1 prior to UE2."
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueId="0" ambrPres="TRUE" dlAmbr="32"/>
      <tapa.rg.UeInit ueId="1" ambrPres="TRUE" dlAmbr="16"/>

      </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="10" lcType="4" dir="1" dlQci="7" />
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="8" lcType="4" dir="1"  dlQci="7" />
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="10" lcType="4" dir="1" dlQci="7"  instId="5"/>
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="8" lcType="4" dir="1"  dlQci="7"  instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="8" lcType="4" bo="28"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="10" lcType="4" bo="28"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="10" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="1" lchTb1Data="8" saveTo="2"/>
      </tapa.expect>
     
      # Send DDatReq for UE1 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="10" ueId="0" lcId="8" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="8" ueId="1" lcId="10" lcType="4"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="2">
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1" />
           <tapa.tfu.pdsch.dat.req use="2" ueId="1" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req saveTo="2" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send TFU_DELTA Ttis to send fdbk to MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.9
#
#       Desc:    To test if DLS considers GBR/MBR SVCs first and then AMBR.
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.9">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test if DLS considers GBR/MBR SVCs first and then AMBR."
      </tapa.desc>

      <tapa.longdesc>

         "Configure 1 Cell and 1 UE with 1 gbr svc and 1 UE with 1 
         non gbr svc each. Send starsp in some tti for UE2 and then for UE1. 
         Verify that in the next TTI, staInd for UE1 is received first by RLC. 
         Scheduler schedules UE1 prior to UE2."
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>


      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueId="0" ambrPres="TRUE" dlAmbr="1024"/>
      <tapa.rg.UeInit ueId="1" ambrPres="TRUE" dlAmbr="1024"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="10" lcType="4" dir="1" dlQci="2" dlGbr="512" dlMbr="1024"/>
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="9" lcType="4" dir="1" dlQci="9" />
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="8" lcType="4" dir="1"  dlQci="7" />
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="10" lcType="4" dir="1" dlQci="2" dlGbr="512" dlMbr="1024" instId="5"/>
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="9" lcType="4" dir="1" dlQci="9"  instId="5"/>
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="8" lcType="4" dir="1"  dlQci="7"  instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="10" lcType="4" bo="20"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="9" lcType="4" bo="40"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="8" lcType="4" bo="30"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="10" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="1" lchTb1Data="8" saveTo="2"/>
      </tapa.expect>
     
      # Send DDatReq for UE1 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="10" ueId="0" lcId="10" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="8" ueId="1" lcId="8" lcType="4"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="2">
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1" />
           <tapa.tfu.pdsch.dat.req use="2" ueId="1" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" ueId="0"/>
           <tapa.tfu.pdcch.cntrl.req saveTo="2" ueId="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send TFU_DELTA Ttis to send fdbk to MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.10
#
#       Desc:    To test DL Scheduler for AMBR and GBR SVCs
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.10">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test DL Scheduler for AMBR and GBR SVCs "
      </tapa.desc>

      <tapa.longdesc>
         "Configure 8 Ues, first four with 1 GBR svc each and the next four with 1 AMBR svc each. GBR is sufficient and same (say 200). So is AMBR. Report BO for GBR SVCs are 50, 40,30,20 and follow the same for each AMBR svc. Verify the order of scheduling to be UE1,2,3,4,5,6,7,8. Now again send the staRsps, now reversing the BO. (i.e now UE1-svc shud be updated with 20). Verify the scheduling order this time to be UE4,3,2,1,8,7,6,5."
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>


      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched2
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueId="0"/>
      <tapa.rg.UeInit ueId="1"/>
      <tapa.rg.UeInit ueId="2"/>
      <tapa.rg.UeInit ueId="3"/>
      <tapa.rg.UeInit ueId="4"/>
      <tapa.rg.UeInit ueId="5"/>
      <tapa.rg.UeInit ueId="6"/>
      <tapa.rg.UeInit ueId="7"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
    
  <tapa.send>
     <tapa.tfu.dlcqi.ind>
         <tapa.tfu.dlcqi  ueId="0" cqiIdx="15"/>
         <tapa.tfu.dlcqi  ueId="1" wbCqi="15" isPucchInfo="FALSE" cqiMode="1"/>
         <tapa.tfu.dlcqi  ueId="2" isPucchInfo="FALSE" cqiMode="3" wbCqi="15" 
            numOfSubbands="0"/>
         <tapa.tfu.dlcqi  ueId="3" cqiIdx="15"/>
         <tapa.tfu.dlcqi  ueId="4" cqiIdx="15"/>
         <tapa.tfu.dlcqi  ueId="5" cqiIdx="15"/>
         <tapa.tfu.dlcqi  ueId="6" cqiIdx="15"/>
         <tapa.tfu.dlcqi  ueId="7" cqiIdx="15"/>
     </tapa.tfu.dlcqi.ind>
  </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" dlGbr="300"  dlMbr="2000"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="300"  dlMbr="2000"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="300"  dlMbr="2000"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="3" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="300"  dlMbr="2000"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>


      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="4" lcId="9" lcType="4" dir="1"  dlQci="7"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
        <tapa.crg.cfgreq.cfg.lch ueId="5" lcId="9" lcType="4" dir="1"  dlQci="7"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="6" lcId="9" lcType="4" dir="1"  dlQci="7"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="7" lcId="9" lcType="4" dir="1"  dlQci="7"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>



      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" dlGbr="300"  dlMbr="2000"
         instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="300" instId="5"  dlMbr="2000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="2" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="300"  dlMbr="2000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="3" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="300"  dlMbr="2000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>


      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="4" lcId="9" lcType="4" dir="1"  dlQci="7"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="5" lcId="9" lcType="4" dir="1"  dlQci="7"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="6" lcId="9" lcType="4" dir="1"  dlQci="7"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

     # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="7" lcId="9" lcType="4" dir="1"  dlQci="7"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="50"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="9" lcType="4" bo="40"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="2" lcId="9" lcType="4" bo="30"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="3" lcId="9" lcType="4" bo="20"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="4" lcId="9" lcType="4" bo="50"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="5" lcId="9" lcType="4" bo="40"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="6" lcId="9" lcType="4" bo="30"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="7" lcId="9" lcType="4" bo="20"/>
      </tapa.send>
      

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="1" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="2" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="3" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>

      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="4" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="5" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="6" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="7" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
      
     # Send DDatReq for UE1 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="1" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="2" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="3" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="4" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="5" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="6" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="7" lcId="9" lcType="4"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="8">
         <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req use="2" ueId="1" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req use="3" ueId="2" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req use="4" ueId="3" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req use="5" ueId="4" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req use="6" ueId="5" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req use="7" ueId="6" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req use="8" ueId="7" numSdu="1" />
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="8">
         <tapa.tfu.pdcch.cntrl.req  saveTo="1" ueId="0"/>
         <tapa.tfu.pdcch.cntrl.req  saveTo="2" ueId="1"/>
         <tapa.tfu.pdcch.cntrl.req  saveTo="3" ueId="2"/>
         <tapa.tfu.pdcch.cntrl.req  saveTo="4" ueId="3"/>
         <tapa.tfu.pdcch.cntrl.req  saveTo="5" ueId="4"/>
         <tapa.tfu.pdcch.cntrl.req  saveTo="6" ueId="5"/>
         <tapa.tfu.pdcch.cntrl.req  saveTo="7" ueId="6"/>
         <tapa.tfu.pdcch.cntrl.req  saveTo="8" ueId="7"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="8">
         <tapa.tfu.hq.recp.req ueId="0"/>
         <tapa.tfu.hq.recp.req ueId="1"/>
         <tapa.tfu.hq.recp.req ueId="2"/>
         <tapa.tfu.hq.recp.req ueId="3"/>
         <tapa.tfu.hq.recp.req ueId="4"/>
         <tapa.tfu.hq.recp.req ueId="5"/>
         <tapa.tfu.hq.recp.req ueId="6"/>
         <tapa.tfu.hq.recp.req ueId="7"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="8">
         <tapa.tfu.hq  ueId="0" isAck="TRUE"/>
         <tapa.tfu.hq  ueId="1" isAck="TRUE"/>
         <tapa.tfu.hq  ueId="2" isAck="TRUE"/>
         <tapa.tfu.hq  ueId="3" isAck="TRUE"/>
         <tapa.tfu.hq  ueId="4" isAck="TRUE"/>
         <tapa.tfu.hq  ueId="5" isAck="TRUE"/>
         <tapa.tfu.hq  ueId="6" isAck="TRUE"/>
         <tapa.tfu.hq  ueId="7" isAck="TRUE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

     ##########################################################     
     # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="20"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="9" lcType="4" bo="30"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="2" lcId="9" lcType="4" bo="40"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="3" lcId="9" lcType="4" bo="50"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="4" lcId="9" lcType="4" bo="20"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="5" lcId="9" lcType="4" bo="30"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="6" lcId="9" lcType="4" bo="40"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="7" lcId="9" lcType="4" bo="50"/>
      </tapa.send>
      

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="3" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="2" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="1" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>

      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="7" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="6" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="5" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="4" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>

###################################################################################     
     # Send DDatReq for UE1 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="1" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="2" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="3" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="4" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="5" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="6" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="7" lcId="9" lcType="4"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="8">
         <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req use="2" ueId="1" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req use="3" ueId="2" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req use="4" ueId="3" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req use="5" ueId="4" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req use="6" ueId="5" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req use="7" ueId="6" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req use="8" ueId="7" numSdu="1" />
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="8">
         <tapa.tfu.pdcch.cntrl.req  saveTo="1" ueId="0"/>
         <tapa.tfu.pdcch.cntrl.req  saveTo="2" ueId="1"/>
         <tapa.tfu.pdcch.cntrl.req  saveTo="3" ueId="2"/>
         <tapa.tfu.pdcch.cntrl.req  saveTo="4" ueId="3"/>
         <tapa.tfu.pdcch.cntrl.req  saveTo="5" ueId="4"/>
         <tapa.tfu.pdcch.cntrl.req  saveTo="6" ueId="5"/>
         <tapa.tfu.pdcch.cntrl.req  saveTo="7" ueId="6"/>
         <tapa.tfu.pdcch.cntrl.req  saveTo="8" ueId="7"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="8">
         <tapa.tfu.hq.recp.req ueId="0"/>
         <tapa.tfu.hq.recp.req ueId="1"/>
         <tapa.tfu.hq.recp.req ueId="2"/>
         <tapa.tfu.hq.recp.req ueId="3"/>
         <tapa.tfu.hq.recp.req ueId="4"/>
         <tapa.tfu.hq.recp.req ueId="5"/>
         <tapa.tfu.hq.recp.req ueId="6"/>
         <tapa.tfu.hq.recp.req ueId="7"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>


      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="8">
         <tapa.tfu.hq  ueId="0"/>
         <tapa.tfu.hq  ueId="1"/>
         <tapa.tfu.hq  ueId="2"/>
         <tapa.tfu.hq  ueId="3"/>
         <tapa.tfu.hq  ueId="4"/>
         <tapa.tfu.hq  ueId="5"/>
         <tapa.tfu.hq  ueId="6"/>
         <tapa.tfu.hq  ueId="7"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

    
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.11
#
#       Desc:    To test DL Scheduler for RB Alignment 
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.11">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test DL Scheduler for RB Alignment"
      </tapa.desc>

      <tapa.longdesc>
         Send staRsp for BCCH and PCCH channel data at Nth TTI with timing as N+4. At N+1 th TTI send
         BO's for SVCs for 2 UE(adopt any 2 UE ded allocation TC). Verify that N+4 th subframe is
         scheduled for transmission of common and Dedicated channel data. Validate the RB alignment
         (rbStart and rbNum). Needs precomputation for expected RB Alignment.
         UE Cqi is 0 Hence as per the eficiency computation it takes 10 Rbs for the given ue1 BO 15
         and 8 for ue0 BO 10. The cmn ch bo of 41 would take 3 RBs. Hence rbAlignment for bcch is 0 and
         3, pcch is 3 and 3, UE1 (since scheduled first) is 6 and 2, UE0 is 8 and 2.
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      # Modified for SI Enhancement*/
      <tapa.ifndef>
         <tapa.flag id="RGR_SI_SCH"/>
         <tapa.flag id="LTEMAC_HDFDD"/>
      </tapa.ifndef>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueId="0"/>
      <tapa.rg.UeInit ueId="1"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

   # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" dlGbr="1000" dlMbr="2000"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="1000"  dlMbr="2000"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

   # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" dlGbr="1000" dlMbr="2000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="1" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="1000"  dlMbr="2000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

   <tapa.send>
         # Send BO for BCCH-DLSCH logical channel on RGU.
         # Chk the bo here! 
         <tapa.rgu.cstarsp lcId="2" lcType="1" bo="41" sfOffset="7"/>
      </tapa.send>

      <tapa.send>
         # Send BO for PCCH logical channel on RGU.
         # Chk the bo here! 
         <tapa.rgu.cstarsp lcId="3" lcType="2" bo="49" sfOffset="7"/>
      </tapa.send>

      <tapa.send>
         # Send 4 Ttis to get the transmission scheduled.
         # Send them individually so that if staInd comes in between, it will
         # fail. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
   
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="9" lcType="4" bo="15"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC 
         <tapa.rgu.cstaind lcId="3" boSatisfied="TRUE" maxRb="3" saveTo="2"/>
         <tapa.rgu.cstaind lcId="2" boSatisfied="TRUE" maxRb="3" saveTo="1"/>
      </tapa.expset>

      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="1" lchTb1Data="9" saveTo="3"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="4"/>
      </tapa.expect>
     
      # Send DDatReq for UE1 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="1" lcId="9" lcType="4"/>
      </tapa.send>

      <tapa.send>
         # Send BCCH-DLSCH data to MAC on RGU. 
         <tapa.rgu.cdatreq bcchIdx="1" lcId="2" lcType="1" use="1"/>
      </tapa.send>

      <tapa.send>
         # Send PCCH data to MAC on RGU. 
         <tapa.rgu.cdatreq bcchIdx="2" lcId="3" lcType="2" use="2"/>
      </tapa.send>

      <tapa.send>
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="4">
         <tapa.tfu.pdsch.dat.req use="1" bcchIdx="1" lcId="2" vldtBcch="TRUE"/>
         <tapa.tfu.pdsch.dat.req use="2" bcchIdx="2" lcId="3" vldtPcch="TRUE"/>
         <tapa.tfu.pdsch.dat.req use="4" ueId="1" numSdu="1" />
      # Expect PDU from MAC to PHY for UE1. UeId to check rnti sent by MAC.
         <tapa.tfu.pdsch.dat.req  use="3" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="4">
         <tapa.tfu.pdcch.cntrl.req saveTo="1"  vldtRbAlign="TRUE" rbStart="0" numRb="3" vldtNprb="2"/>
         <tapa.tfu.pdcch.cntrl.req saveTo="2" vldtRbAlign="TRUE" rbStart="3" numRb="3" vldtNprb="3"/>
         <tapa.tfu.pdcch.cntrl.req saveTo="3" ueId="0" vldtRbAlign="TRUE" rbStart="8" numRb="2" />
         <tapa.tfu.pdcch.cntrl.req saveTo="4" ueId="1" vldtRbAlign="TRUE" rbStart="6" numRb="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="2">
         <tapa.tfu.hq.recp.req ueId="0"/>
         <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
         <tapa.tfu.hq  ueId="0"/>
         <tapa.tfu.hq  ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.12
#
#       Desc:    Successful data path on BCCH-DLSCH and PCCH channels
#
#       Notes:   None
#              
#       Module:  
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.12">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "Successful data path on BCCH-DLSCH and PCCH channels" 
      </tapa.desc>

      <tapa.longdesc>
         make cell->nCce = 8. Set the pdcchCodeRate such that cmnChannel uses aggrLvl=8. Send StaRsp for
         BCCH with BO != Any valid TB size. In the same tti send a staRsp for PCCH with BO == Any valid
         TB size. Allocation for BCCH should fail, hence the only available CCE set of this subframe
         should be reused for PCCH allocation. 
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef>
         <tapa.flag id="LTEMAC_HDFDD"/>
      </tapa.ifndef>
   
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="50" pdcchCodeRate="50"
         dlSchdType="0" ulSchdType="0"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         # Send BO for BCCH-DLSCH logical channel on RGU.
         # Chk the bo here! 
         <tapa.rgu.cstarsp lcId="2" lcType="1" bo="400" sfOffset="7"/>
      </tapa.send>

      <tapa.send>
         # Send BO for PCCH logical channel on RGU.
         # Chk the bo here! 
         <tapa.rgu.cstarsp lcId="3" lcType="2" bo="41" sfOffset="7"/>
      </tapa.send>

      <tapa.send>
         # Send 4 Ttis to get the transmission scheduled.
         # Send them individually so that if staInd comes in between, it will
         # fail. 
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
   
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC 
         <tapa.rgu.cstaind lcId="3" boSatisfied="TRUE" maxRb="3" saveTo="2"/>
      </tapa.expset>

      <tapa.send>
         # Send PCCH data to MAC on RGU. 
         <tapa.rgu.cdatreq bcchIdx="1" lcId="3" lcType="2" use="2"/>
      </tapa.send>

      <tapa.send>
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
     </tapa.tfu.cntrl.req>
   # Expect Msg4 from MAC to PHY.
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req use="1" lcId="3" bcchIdx="1" vldtPcch="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

      # Layer Manager ShutDown

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.13
#
#       Desc:    Common channel and ded channel data in same subframe verify PDCCH allocations.
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.13">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "Common channel and ded channel data in same subframe verify PDCCH allocations."
      </tapa.desc>

      <tapa.longdesc>
         Send staRsp for BCCH and PCCH channel data at Nth TTI with timing as N+4. At N+1 th TTI send
         BO's for SVCs for 2 UE(adopt any 2 UE ded allocation TC). DL BW is configured such that 
         all CCE are occupied by the CMN channels whose aggrLvl should be made as 8. In this case both
         the UEs will not be scheduled for transmission for that subframe. Verify that in the next
         subframe these 2 UEs get scheduled, also check if the Alignment is correct.
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
# Disabling this TC, does not work with MIMO code
      <tapa.ifdef>
      </tapa.ifdef>
# Added MIMO Dependancy
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="50" pdcchCodeRate="50"
         dlSchdType="0" ulSchdType="0" cfi="1"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueId="0"/>
      <tapa.rg.UeInit ueId="1"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

   # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" dlGbr="1000" dlMbr="2000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="1000"  dlMbr="2000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

   # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" dlGbr="1000" dlMbr="2000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="1" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="1000"  dlMbr="2000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      <tapa.send>
         # Send BO for PCCH logical channel on RGU.
         # Chk the bo here! 
         <tapa.rgu.cstarsp lcId="3" lcType="2" bo="41" sfOffset="7"/>
      </tapa.send>
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="9" lcType="4" bo="15"/>
      </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
         # Expect staInd from MAC to RLC 
         <tapa.rgu.cstaind lcId="3" boSatisfied="TRUE" maxRb="3" saveTo="2"/>
      </tapa.expset>
      <tapa.send>
         # Send PCCH data to MAC on RGU. 
         <tapa.rgu.cdatreq bcchIdx="2" lcId="3" lcType="2" use="2"/>
      </tapa.send>

      <tapa.send>
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
      # Separated TTI processing for DL and UL.
   <tapa.expset>
         <tapa.rgu.dstaind ueId="1" lchTb1Data="9" saveTo="2"/>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="1"/>
     <tapa.tfu.cntrl.req numCntrlReq="1">
        <tapa.tfu.pdcch.cntrl.req vldtRbAlign="TRUE" rbStart="0" numRb="3"/>
     </tapa.tfu.cntrl.req>
   # Expect Msg4 from MAC to PHY.
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req lcId="3" bcchIdx="2" vldtPcch="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      # Send DDatReq for UE1 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="1" lcId="9" lcType="4"/>
      </tapa.send>

      <tapa.send>
         # Send 1 Tti to get the MAC PDU at PHY.
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req saveTo="2" ueId="1" vldtRbAlign="TRUE" rbStart="0" numRb="2"/>
        <tapa.tfu.pdcch.cntrl.req saveTo="1" ueId="0" vldtRbAlign="TRUE" rbStart="2" numRb="2"/>
     </tapa.tfu.cntrl.req>
   # Expect Msg4 from MAC to PHY.
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
        <tapa.tfu.pdsch.dat.req use="2" ueId="1" numSdu="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

            # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   # Send ACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.14
#
#       Desc:    To test DL Scheduler for GBR SVCs Priorities
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.14">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test DL Scheduler for GBR SVCs Priorities"
      </tapa.desc>

      <tapa.longdesc>
         "Run a Dedicated CH transmission scenario for some configured CQI. Precompute the optimal BW
         that would be consumed with this CQI.Send a DLCqiInd with appropriate parameters and precompute
         the updated CQI based on this. Perform the same Ded Ch transmission, verify that the BW
         allocated this time is in sync with the updated CQI."
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
# Disabling this TC, does not work with MIMO code
<tapa.ifndef/>
      <tapa.ifdef>
      </tapa.ifdef>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>


      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      # Cell Configuration
      <tapa.rg.cellInit dlTotalBw="6" pdcchCodeRate="75"
         dlSchdType="0" ulSchdType="0" maxDlBwPerUe="6"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueId="0"/>
      <tapa.rg.UeInit ueId="1"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send DlCqi for the created UE  
  <tapa.send>
     <tapa.tfu.dlcqi.ind>
        <tapa.tfu.dlcqi cqiIdx="15" ueId="0"/>
        <tapa.tfu.dlcqi cqiIdx="15" ueId="1"/>
     </tapa.tfu.dlcqi.ind>
  </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" dlGbr="1000" dlMbr="2000"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="1000"  dlMbr="2000"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" dlGbr="1000" dlMbr="2000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="1" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="1000"  dlMbr="2000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="9" lcType="4" bo="15"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="1" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Send DDatReq for UE1 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="1" lcId="9" lcType="4"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="2">
           <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
           <tapa.tfu.pdsch.dat.req  use="2" ueId="1" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0"/>
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>
 
      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="100"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="9" lcType="4" bo="400"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="1" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Send DDatReq for UE1 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="1" lcId="9" lcType="4"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
      # Moved the order of dedicated sta indication
      # Expect staInd from MAC to RLC for UE2.
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req use="1" ueId="1" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send DDatReq for UE1 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
     # <tapa.send>
     #    <tapa.tfu.tti.ind numTti="2" op="RG_ACC_PLUS" numTfuDelta="1"/>
     # </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="1"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>


      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.15
#
#       Desc:    To test the MAX soft buffer consideration for a given UE category.
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.15">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test the MAX harq TB bits limit consideration for a given UE category."
      </tapa.desc>

      <tapa.longdesc>
        "BO of UE's SVC's are same. But the SVC's are configured with 
         different GBR values but same priority. In this case the 
         higher effective GBR svc should be scheduled first.
         Due to UE category TB bits limitation, verify that only svc 9
         is scheduled and in next scheduling svc 8 is scheduled.
         i.e for a given TTI and for a given, it is able to accomodate
         only svc 9 data. svc 8 data is allocated in next TTI in a different hqproc."
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueCatEnum="1"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send DlCqi for the created UE  
  <tapa.send>
     <tapa.tfu.dlcqi.ind>
        <tapa.tfu.dlcqi ueId="0" cqiIdx="15"/>
     </tapa.tfu.dlcqi.ind>
  </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="8" lcType="4" dir="1"
                                   dlQci="3" dlGbr="256"  dlMbr="512"/>
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1"
                                   dlQci="3" dlGbr="512"  dlMbr="1287"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="8" lcType="4" dir="1"
                        dlQci="3" dlGbr="256"  dlMbr="512" instId="5"/>
      </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1"
                     dlQci="3" dlGbr="3512"  dlMbr="6287" instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="8" lcType="4" bo="1287"/>
      </tapa.send>
      # 1287 - is the TB size limit
      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="1287"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for Msg4 
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="9" />
      </tapa.expect>
     
      # Send data with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq  ueId="0" numLchTb1="1" lchTb1Data="9,0,1"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
        </tapa.tfu.cntrl.req>      
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="8" />
      </tapa.expset>

      # Send data with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq  ueId="0" numLchTb1="1" lchTb1Data="8,0,1"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind/> 
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.16
#
#       Desc:    To test that requested BO is scheduled in 2 TTI in two different hqProc due to 
#                softbuffer limitation per harq proc.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.16">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="" section=""/>
      <tapa.module id=""/>

      <tapa.desc>
         "To test that requested BO is scheduled in 2 TTI in two different hqProc due to 
          softbuffer limitation per harq proc.."
      </tapa.desc>

      <tapa.longdesc>
         ""
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
   
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Layer Manager Configuration
      <tapa.rg.macInit/>

      # Cell Configuration
      <tapa.rg.cellInit.dlSched  maxDlHqTx="1"
         dlSchdType="0" ulSchdType="0"/>

      # UE configuration
      <tapa.rg.UeInit ueCatEnum="1"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

    # Send DlCqi for the created UE  
  <tapa.send>
     <tapa.tfu.dlcqi.ind>
        <tapa.tfu.dlcqi cqiIdx="1"/>
     </tapa.tfu.dlcqi.ind>
  </tapa.send>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1"
                                dlQci="3" dlGbr="512"  dlMbr="128700"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1"
                    dlQci="3" dlGbr="512"  dlMbr="128700" instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      

      # 1287 - is the TB size limit
      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="200"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for Msg4 
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="9" />
      </tapa.expect>
     
      # Send data with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq  ueId="0" numLchTb1="1" lchTb1Data="9,0,1"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
        </tapa.tfu.cntrl.req>      
         <tapa.rgu.dstaind ueId="0" numLchTb1="1" lchTb1Data="9" />
      </tapa.expset>

      # Send data with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq  ueId="0" numLchTb1="1" lchTb1Data="9,0,1"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind/> 
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

      # Layer Manager ShutDown

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.17
#
#       Desc:    To validate UL grant allocation by MAC scheduler for SR Indication.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.17">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
         "To validate UL grant allocation by MAC scheduler for SR Indication."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="20"
         dlSchdType="0" ulSchdType="0"/>
      #Initialize UE
      <tapa.rg.UeInit prdBsrTmr="65535"/>
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for config application
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.ulcqi.ind>
            <tapa.tfu.ulcqi ueId="0" isWideBand="TRUE" wideCqi="3"/>
         </tapa.tfu.ulcqi.ind>
      </tapa.send>

     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send  one TTI to schedule SR and expect PDCCH from MAC
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" grantMin="1" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send  4 (UL_SCHED_DELTA (=2) + 4 (for Ue to transmit) - TFU_DELTA (=2,
      # in advance in which datRecpReq shall come from MAC) TTIs
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" saveTo="2" vldtDatRecp="TRUE"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

    #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="2" lcId="3"/>
       </tapa.tfu.dat.ind>
    </tapa.send>

      <tapa.expect>
         # Expect datInd to go to RLC
         <tapa.rgu.ddatind lchTb1Data="3"/>
      </tapa.expect>

      # verify no more indications.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="10"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>


   </tapa.shutdown>

</tapa.testcase>


#
#       Test:    7.18
#
#       Desc:    To validate UL grant allocation by MAC scheduler for long BSR.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.18">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
         "To validate UL grant allocation by MAC scheduler for long BSR."
      </tapa.desc>

      <tapa.longdesc/>


   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
   
      # Initialize LTEMAC
      <tapa.rg.macInit/>
      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="20"
         dlSchdType="0" ulSchdType="0"/>
      #Initialize UE
      <tapa.rg.UeInit ueBr="6000"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/>
      
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
    ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="1" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="5" lcgId="2" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="6" lcgId="3" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
      </tapa.expset>

      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
    ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="4" lcgId="1" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="5" lcgId="2" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="6" lcgId="3" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="1" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="2" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="3" instId="5"/>
      </tapa.send>

      # Send TTI indication for config application
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send one TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

    #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

    <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="2" addLongBsr="TRUE" bsr0="5"
            bsr1="12" bsr2="45" bsr3="60"/>
       </tapa.tfu.dat.ind>
    </tapa.send>

      
       # Send one TTI  (4 (TTIs to get the feedback) - TFU_DELTA (=2) - 1
       # (TFU_UL_DELTA that elapsed in giving datInd to MAC from PHY)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

     <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="2"/>
        </tapa.tfu.cntrl.req>
     </tapa.expect>

      # Send 4 TTIs (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      # But because of long bsr, we will get pdcchReqs every TTI till the
      # bsr is satisfied
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="3"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="4"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="5"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="6"/>
        </tapa.tfu.cntrl.req>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" saveTo="10"/>
       </tapa.tfu.recp.req>        
      </tapa.expset>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      # Because of earlier pdcch Reqs, datRecpReqs would have come in these 3
      # TTIs. And pdcchReqs would have come for the remaining BSR.
      # So expect them as well giving individual TTIs
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="7"/>
        </tapa.tfu.cntrl.req>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="3" vldtDatRecp="TRUE"/>
       </tapa.tfu.recp.req>        
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="8"/>
        </tapa.tfu.cntrl.req>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="4" vldtDatRecp="TRUE"/>
       </tapa.tfu.recp.req>        
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="5" vldtDatRecp="TRUE"/>
       </tapa.tfu.recp.req>        
      </tapa.expset>

       #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="6" vldtDatRecp="TRUE"/>
       </tapa.tfu.recp.req>        
      </tapa.expset>

      # Send data indication using TB size recieved in the grant
     <tapa.send>
        <tapa.tfu.dat.ind datInds="1">
           <tapa.tfu.dat lcId="3" use="10" bufIdx="0"/>
        </tapa.tfu.dat.ind>
     </tapa.send>      

      <tapa.expect>
         # Expect datInd to go to RLC
         <tapa.rgu.ddatind lchTb1Data="3,1,0"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.19
#
#       Desc:    To validate UL grant allocation by MAC scheduler for short BSR.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.19">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
         "To validate UL grant allocation by MAC scheduler for short BSR."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="20"
         dlSchdType="0" ulSchdType="0"/>
      #Initialize UE
      <tapa.rg.UeInit maxUlHqTx="3"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      # Configure bi-directional DTCH for default UE (non-GBR) 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="1" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="5" lcgId="2" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="6" lcgId="3" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
      </tapa.expset>

      # Configure bi-directional DTCH for default UE (non-GBR) 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="4" lcgId="1" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="5" lcgId="2" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="6" lcgId="3" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="1" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="2" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="3" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>
      
      # Send one TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

     <tapa.send>
        <tapa.tfu.dat.ind datInds="1">
           <tapa.tfu.dat  use="2" lcId="3" addShortBsr="TRUE" bsr="6"/>
        </tapa.tfu.dat.ind>
     </tapa.send>

      <tapa.expect>
         # Expect DatInd at RLC
         <tapa.rgu.ddatind lchTb1Data="3,1"/>
      </tapa.expect>

      # Send one TTI  (4 (TTIs to get the feedback) - TFU_DELTA (=2) - 1
      # (TFU_UL_DELTA that elapsed in giving datInd to MAC from PHY)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="3"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 TTIs (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expset>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req vldtDatRecp="TRUE" saveTo="3"/>
       </tapa.tfu.recp.req>        
      </tapa.expset>

      # Ideally, a datInd should be sent in this TTI based on the allocation.
      # But as it is not sent expect a harq NACK in next TTI (as UL DELTA is
      # also considered)

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

    <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="2" addLongBsr="TRUE" bsr0="5"
            bsr1="12" bsr2="45" bsr3="60"/>
       </tapa.tfu.dat.ind>
    </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.20
#
#       Desc:    To validate UL grant allocation by MAC scheduler for truncated BSR.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.20">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
         "To validate UL grant allocation by MAC scheduler for truncated BSR."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="20"
         dlSchdType="0" ulSchdType="0"/>
      #Initialize UE
      <tapa.rg.UeInit/>
      #Intialize 2 bi-directional DCCHs

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
     
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      # Configure bi-directional DTCH for default UE (non-GBR) 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="1" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="5" lcgId="2" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="6" lcgId="3" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
      </tapa.expset>

      # Configure bi-directional DTCH for default UE (non-GBR) 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="4" lcgId="1" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="5" lcgId="2" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="6" lcgId="3" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="1" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="2" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="3" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" saveTo="1" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send data indication using TB size recieved in the grant
      <tapa.send>
        <tapa.tfu.dat.ind datInds="1">
           <tapa.tfu.dat use="2" lcId="4" addTruncBsr="TRUE" lcgId="2" bsr="6"/>
        </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.expset>
         # Expect DatInd at RLC
         <tapa.rgu.ddatind lchTb1Data="4,1"/>
      </tapa.expset>

      # Send one TTI  (4 (TTIs to get the feedback) - TFU_DELTA (=2) - 1
      # (TFU_UL_DELTA that elapsed in giving datInd to MAC from PHY)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

     <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="1"/>
        </tapa.tfu.cntrl.req>
     </tapa.expect>

# Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

    #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

    <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="2" addLongBsr="TRUE" bsr0="5"
            bsr1="12" bsr2="45" bsr3="60"/>
       </tapa.tfu.dat.ind>
    </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    7.21
#
#       Desc:    To validate grant by MAC scheduler excludes cell wide
#                configured PUCCH, SRS, RACH resources and DMRS symbols. Also grant
#                should be a valid multiple of 2 or/and 3 or/and 5.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.21">>>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
        "To validate grant by MAC scheduler excludes cell wide
         configured PUCCH, SRS, RACH resources and DMRS symbols. Also grant
         should be a valid multiple of 2 or/and 3 or/and 5."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgInitErr/>
      #<tapa.rg.dbgInitParm/>
      #<tapa.rg.dbgInitInfo/>
      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="0" ulSchdType="0"/>
      #Initialize UE
      <tapa.rg.UeInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="5"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="5" instId="5"/>
      </tapa.send>
      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>
      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>
      # Send TTIs  (numTti = 1 + UL_SCH_DELTA(=3) - TFU_DL_DELTA(=2))
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>
      # Expect DCI format 0 and do validations of the grant
      # Validate Grant shall exclude all cell-wide configured PUCCH, SRS and
      # RACH resources
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      # Send TTIs (numTti= TFU_DL_DELTA(=2) + 4 - TFU_DL_DELTA(=2))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      # Expect data reception request
      <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
       </tapa.tfu.recp.req>        
      </tapa.expect>
      # Send TTIs (numTti = TFU_UL_DELTA(=1))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="2" lcId="3"/>
       </tapa.tfu.dat.ind>
      </tapa.send>
      # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="3,1" vldtBuf="TRUE"/>
      </tapa.expect>
      
      # Send TTIs (numTti = TFU_DL_DELTA(=2) + 4 - TFU_DL_DELTA(=2))
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.22
#
#       Desc:    To validate grant by MAC scheduler excludes cell wide
#                configured PUCCH, SRS, RACH resources and DMRS symbols. Also grant
#                should be a valid multiple of 2 or/and 3 or/and 5.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.22">>>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
        "To validate grant by MAC scheduler excludes cell wide
         configured PUCCH, SRS, RACH resources and DMRS symbols. Also grant
         should be a valid multiple of 2 or/and 3 or/and 5."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgInitErr/>
      #<tapa.rg.dbgInitParm/>
      <tapa.rg.dbgInitInfo/>
      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="0" ulSchdType="0"/>
      #Initialize UE
      <tapa.rg.UeInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="5"/>
      </tapa.send>
      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure bi-directional DTCH for default UE 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="5" instId="5"/>
      </tapa.send>
      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>
      # Expect configuration confirm after the TTI
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      <tapa.expect> 
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>
      
      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>
      # Send TTIs  (numTti = 1 + UL_SCH_DELTA(=3) - TFU_DL_DELTA(=2))
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>
      # Expect DCI format 0 and do validations of the grant
      # Validate Grant shall exclude all cell-wide configured PUCCH, SRS and
      # RACH resources
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      # Send TTIs (numTti= TFU_DL_DELTA(=2) + 4 - TFU_DL_DELTA(=2))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      # Expect data reception request
      <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
       </tapa.tfu.recp.req>        
      </tapa.expect>
      # Send TTIs (numTti = TFU_UL_DELTA(=1))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      # Send Data Indication using TB size recieved in the grant
      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="2" lcId="3" addShortBsr="TRUE" bsr="10"/>
       </tapa.tfu.dat.ind>
      </tapa.send>
      # Expect Data Indication at RLC
      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="3,1" vldtBuf="TRUE"/>
      </tapa.expect>
      # Send Cell reconfiguration request
      # New params need to be considered
      <tapa.send>
         <tapa.crg.cfgreq.recfg.cell actvTimePres="FALSE"/>
      </tapa.send>
      # TTI so that recfg and scheduling (with new params) happens
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Expect DCI format 0 and do basic validations of the grant
      # Validate if re-configured PUCCH, SRS and RACH resources are excluded
      # Expect HARQ ACK in PHICH
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req saveTo="2" isUlGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send TTIs (numTti = TFU_DL_DELTA(=2) + 4 - TFU_DL_DELTA(=2))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>
      # Expect data reception request
      <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" saveTo="3" />
       </tapa.tfu.recp.req>        
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    7.23
#
#       Desc:    To validate if UL QoS requirement of ueBr configured per UE
#                is satisfied by the scheduler.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.23">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
         "To validate if UL QoS requirement of ueBr configured per UE
          is satisfied by the scheduler."
      </tapa.desc>

      <tapa.longdesc>
         "To validate that the scheduler doesnt exceed ueBr in its ulGrant.
         Verify that for a BS larger than ueBr, scheduler shall partially allocate
         grant after the bsr report till the ueBr is expired. And then the remaining 
         BS is satisfied only after ueBr is refreshed accross refresh Cycle."
      </tapa.longdesc>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>
<!--
      <tapa.rg.dbgInitErr/>
      <tapa.rg.dbgInitParm/>
      <tapa.rg.dbgInitInfo/>
-->
      <tapa.rg.dbgDeInitAll/>
      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="25"
         dlSchdType="0" ulSchdType="0"/>
      #Initialize UE
      <tapa.rg.UeInit ueCatEnum="CM_LTE_UE_CAT_2" ueBr="2000" prdBsrTmr="65535"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      # Configure bi-directional DTCH for default UE (non-GBR) 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="4" lcgId="1" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="5" lcgId="2" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch lcId="6" lcgId="3" dir="2" lcType="4" ulQci="8"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
      </tapa.expset>

      # Configure bi-directional DTCH for default UE (non-GBR) 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="4" lcgId="1" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="5" lcgId="2" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure uplink DTCH for default UE  (non-GBR)
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch lcId="6" lcgId="3" dir="2" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="1" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="2" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="3" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr/>
        </tapa.tfu.sr.ind>
     </tapa.send>
      
      # Send one TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="2"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

     <tapa.send>
        <tapa.tfu.dat.ind datInds="1">
           <tapa.tfu.dat  use="2" lcId="3" addShortBsr="TRUE" lcgId="2" bsr="33"/>
        </tapa.tfu.dat.ind>
     </tapa.send>

      <tapa.expect>
         # Expect DatInd at RLC
         <tapa.rgu.ddatind lchTb1Data="3,1"/>
      </tapa.expect>

      # Send one TTI  (4 (TTIs to get the feedback) - TFU_DELTA (=2) - 1
      # (TFU_UL_DELTA that elapsed in giving datInd to MAC from PHY)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="2"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      
      <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="3"/>
       </tapa.tfu.recp.req>        
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" saveTo="4"/>
       </tapa.tfu.recp.req>        
      </tapa.expect>
      # Ideally, a datInd should be sent in this TTI based on the allocation.
      # But as it is not sent expect a harq NACK in next TTI (as UL DELTA is
      # also considered)

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
     #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
     <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" lcId="3"/>
       </tapa.tfu.dat.ind>
    </tapa.send>

      <tapa.expect>
         # Expect DatInd at RLC
         <tapa.rgu.ddatind lchTb1Data="3,1"/>
      </tapa.expect>

       
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>
    <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="4" lcId="3"/>
       </tapa.tfu.dat.ind>
    </tapa.send>

      <tapa.expect>
         # Expect DatInd at RLC
         <tapa.rgu.ddatind lchTb1Data="3,1"/>
      </tapa.expect>

      # Separated TTI processing for DL and UL.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="279"/>
      </tapa.send>

      <tapa.expset>
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="1"/>
         </tapa.tfu.cntrl.req>
       </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

       <tapa.expset>
         <tapa.tfu.cntrl.req numCntrlReq="1">
            <tapa.tfu.pdcch.cntrl.req isUlGrant="TRUE" vldtTx="TRUE" saveTo="2"/>
         </tapa.tfu.cntrl.req>
       </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="1" vldtDatRecp="TRUE" saveTo="3"/>
       </tapa.tfu.recp.req>        
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req use="2" vldtDatRecp="TRUE" saveTo="4"/>
       </tapa.tfu.recp.req>        
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="3" lcId="3"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="3,1" vldtBuf="TRUE"/>
      </tapa.expect>
      
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

      <tapa.send>
       <tapa.tfu.dat.ind datInds="1">
          <tapa.tfu.dat use="4" lcId="3"/>
       </tapa.tfu.dat.ind>
      </tapa.send>

      <tapa.expect>
         <tapa.rgu.ddatind lchTb1Data="3,1" vldtBuf="TRUE"/>
      </tapa.expect>
      
      # see no further grant
      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.24
#
#       Desc:    To verify that UEs with lcg0 bs are satisfied in the descending order of 
#                their bs values irrespective of the configured ueBr. bandwidth is limited
#                to 30, so as to restrict some ue from getting scheduled in a schdling instance.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.24">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
         "To verify that UEs with lcg0 bs are satisfied in the descending order of 
          their bs values irrespective of the configured ueBr. bandwidth is limited
          to 30, so as to restrict some ue from getting scheduled in a schdling instance."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>
<!--
      <tapa.rg.dbgInitErr/>
      <tapa.rg.dbgInitParm/>
      <tapa.rg.dbgInitInfo/>
-->
      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="30" maxUlUeNewTxPerTti="4"
         dlSchdType="0" ulSchdType="0"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0" ueBr="1000"/>
      <tapa.rg.UeInit ueId="1" ueBr="2000"/>
      <tapa.rg.UeInit ueId="2" ueBr="3000"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      # Configure bi-directional DTCH for default UE0 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
      </tapa.expset>

      # Configure bi-directional DTCH for default UE0 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="2" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="0" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="0" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="2" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
           <tapa.tfu.sr ueId="2"/>
        </tapa.tfu.sr.ind>
     </tapa.send>
      
      # Send one TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="3" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="4"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="5"/>
        <tapa.tfu.pusch.recp.req ueId="2" use="3" vldtDatRecp="TRUE" saveTo="6"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="2" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="2" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

     <tapa.send>
        <tapa.tfu.dat.ind datInds="1">
           <tapa.tfu.dat ueId="0" use="4" lcId="3" addShortBsr="TRUE" lcgId="0" bsr="41"/>
           <tapa.tfu.dat ueId="1" use="5" lcId="3" addShortBsr="TRUE" lcgId="0" bsr="40"/>
           <tapa.tfu.dat ueId="2" use="6" lcId="3" addShortBsr="TRUE" lcgId="0" bsr="42"/>
        </tapa.tfu.dat.ind>
     </tapa.send>

      <tapa.expset>
         # Expect DatInd at RLC
         <tapa.rgu.ddatind ueId="0" lchTb1Data="3,1"/>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="3,1"/>
         <tapa.rgu.ddatind ueId="2" lchTb1Data="3,1"/>
      </tapa.expset>

      # Send one TTI  (4 (TTIs to get the feedback) - TFU_DELTA (=2) - 1
      # (TFU_UL_DELTA that elapsed in giving datInd to MAC from PHY)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expect>
        <tapa.tfu.cntrl.req  expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req ueId="2" isUlGrant="TRUE" vldtTx="TRUE" saveTo="1"/>
           <tapa.tfu.pdcch.cntrl.req ueId="0" isUlGrant="TRUE" vldtTx="TRUE" saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.25
#
#       Desc:    To verify that UEs with non-lcg0 bs are satisfied in the descending order of 
#                their effbs values, where effBs=MIN(ueBr, nonLcg0Bs). ueBr values are configured 
#                such that nonLcg0Bs value provided are much greater than corresponding ueBr values.
#                In this case the UEs selection for scheduling shall be solely on the basis of ueBr.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.25">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
         "To verify that UEs with non-lcg0 bs are satisfied in the descending order of 
          their effbs values, where effBs=MIN(ueBr, nonLcg0Bs). ueBr values are configured 
          such that nonLcg0Bs value provided are much greater than corresponding ueBr values.
          In this case the UEs selection for scheduling shall be solely on the basis of ueBr."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>
<!--
      <tapa.rg.dbgInitErr/>
      <tapa.rg.dbgInitParm/>
      <tapa.rg.dbgInitInfo/>
-->
      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="30" maxUlUeNewTxPerTti="4"
         dlSchdType="0" ulSchdType="0"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0" ueBr="1000"/>
      <tapa.rg.UeInit ueId="1" ueBr="2000"/>
      <tapa.rg.UeInit ueId="2" ueBr="3000"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      # Configure bi-directional DTCH for default UE0 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="2" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
      </tapa.expset>

      # Configure bi-directional DTCH for default UE0 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="2" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="1" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="1" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="2" lcgId="1" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
           <tapa.tfu.sr ueId="2"/>
        </tapa.tfu.sr.ind>
     </tapa.send>
      
      # Send one TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="2" saveTo="3" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="4"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="5"/>
        <tapa.tfu.pusch.recp.req ueId="2" use="3" vldtDatRecp="TRUE" saveTo="6"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="2" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="2" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

     #bsr amount is in the order opposite to ueBr amount.
     <tapa.send>
        <tapa.tfu.dat.ind datInds="1">
           <tapa.tfu.dat ueId="0" use="4" lcId="3" addShortBsr="TRUE" lcgId="1" bsr="42"/>
           <tapa.tfu.dat ueId="1" use="5" lcId="3" addShortBsr="TRUE" lcgId="1" bsr="41"/>
           <tapa.tfu.dat ueId="2" use="6" lcId="3" addShortBsr="TRUE" lcgId="1" bsr="40"/>
        </tapa.tfu.dat.ind>
     </tapa.send>

      <tapa.expset>
         # Expect DatInd at RLC
         <tapa.rgu.ddatind ueId="0" lchTb1Data="3,1"/>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="3,1"/>
         <tapa.rgu.ddatind ueId="2" lchTb1Data="3,1"/>
      </tapa.expset>

      # Send one TTI  (4 (TTIs to get the feedback) - TFU_DELTA (=2) - 1
      # (TFU_UL_DELTA that elapsed in giving datInd to MAC from PHY)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # verify grnt is recieved for UEs in descending order of ueBr amount
      # with BW constraint restricdting grnt allocation to only 2 UEs
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req ueId="2" isUlGrant="TRUE" vldtTx="TRUE" saveTo="1"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" isUlGrant="TRUE" vldtTx="TRUE" saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.26
#
#       Desc:    To verify that UEs with lcg0Bs are given higher priority by scheduler
#                compared to UEs with nonLcg0Bs. Provide more optimal conditions for UE with
#                nonlcg0Bs than the lcg0bs Ue. Verify that irrespective of any QOS or BSR value,
#                lcg0Bs Ue is scheduled first by the scheduler.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.26">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
         "To verify that UEs with lcg0Bs are given higher priority by scheduler
          compared to UEs with nonLcg0Bs. Provide more optimal conditions for UE with
          nonlcg0Bs than the lcg0bs Ue. Verify that irrespective of any QOS or BSR value,
          lcg0Bs Ue is scheduled first by the scheduler."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>
<!--
      <tapa.rg.dbgInitErr/>
      <tapa.rg.dbgInitParm/>
      <tapa.rg.dbgInitInfo/>
-->
      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="20" maxUlUeNewTxPerTti="4"
         dlSchdType="0" ulSchdType="0"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0" ueBr="6000" ueCatEnum="4"/>
      <tapa.rg.UeInit ueId="1" ueBr="1000" ueCatEnum="2"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      # Configure bi-directional DTCH for default UE0 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
      </tapa.expset>

      # Configure bi-directional DTCH for default UE0 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="1" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>
      
      # Send one TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="4"/>
        <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE" saveTo="5"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
            <tapa.tfu.crc ueId="1" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
           <tapa.tfu.phich.cntrl.req ueId="1" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

     #Indicate higher BSR to UE0.
     <tapa.send>
        <tapa.tfu.dat.ind datInds="1">
           <tapa.tfu.dat ueId="0" use="4" lcId="3" addShortBsr="TRUE" lcgId="1" bsr="42"/>
           <tapa.tfu.dat ueId="1" use="5" lcId="3" addShortBsr="TRUE" lcgId="0" bsr="41"/>
        </tapa.tfu.dat.ind>
     </tapa.send>

      <tapa.expset>
         # Expect DatInd at RLC
         <tapa.rgu.ddatind ueId="0" lchTb1Data="3,1"/>
         <tapa.rgu.ddatind ueId="1" lchTb1Data="3,1"/>
      </tapa.expset>

      # Send one TTI  (4 (TTIs to get the feedback) - TFU_DELTA (=2) - 1
      # (TFU_UL_DELTA that elapsed in giving datInd to MAC from PHY)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # verify grnt is recieved only for lcg0Bs Ue i.e UE1
      # with BW constraint restricdting grnt allocation to only 1 UE
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="1" isUlGrant="TRUE" vldtTx="TRUE" saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    7.27
#
#       Desc:    To validate UL grant allocation for two UEs by MAC scheduler on SR Indication
#                from both UEs.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.27">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
         "To validate UL grant allocation for two UEs by MAC scheduler on SR Indication
         from both UEs."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit
         dlSchdType="0" ulSchdType="0"/>

      # Initialize two UEs
      <tapa.rg.2UeInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure bi-directional DTCH for first UE
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8"/>
      </tapa.send>

      # Configure bi-directional DTCH for second UE
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="6"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
      </tapa.expset>

      # Configure bi-directional DTCH for first UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8" instId="5"/>
      </tapa.send>

      # Configure bi-directional DTCH for second UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="6" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for config application
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for both UEs
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send  one TTI to schedule SR and expect PDCCH from MAC
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" grantMin="1" vldtTx="TRUE" />
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" grantMin="1" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send  4 (UL_SCHED_DELTA (=2) + 4 (for Ue to transmit) - TFU_DELTA (=2,
      # in advance in which datRecpReq shall come from MAC) TTIs
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
      <tapa.tfu.recp.req numRntis="2">
          <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE"/>
          <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE"/>
       </tapa.tfu.recp.req>        
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>


   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    7.28
#
#       Desc:    To validate UL grant allocation for two UEs by MAC scheduler on SR Indication
#                from both UEs. Verify grant is given in different(subsequent) TTIs.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.28">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
         "To validate UL grant allocation for two UEs by MAC scheduler on SR Indication
          from both UEs. Verify grant is given in different(subsequent) TTIs."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit maxUlUeNewTxPerTti="1"
         dlSchdType="0" ulSchdType="0"/>

      # Initialize two UEs
      <tapa.rg.2UeInit/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure bi-directional DTCH for first UE
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8"/>
      </tapa.send>

      # Configure bi-directional DTCH for second UE
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="6"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset>
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
      </tapa.expset>

      # Configure bi-directional DTCH for first UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="8" instId="5"/>
      </tapa.send>

      # Configure bi-directional DTCH for second UE
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4"
            ulQci="6" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
      </tapa.send>

      # Send TTI indication for config application
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for both UEs
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>

      # Send  one TTI to schedule SR and expect PDCCH from MAC
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" grantMin="1" vldtTx="TRUE" />
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send  4 (UL_SCHED_DELTA (=2) + 4 (for Ue to transmit) - TFU_DELTA (=2,
      # in advance in which datRecpReq shall come from MAC) TTIs
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect DCI format 0 and do basic validations of the grant
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2" isUlGrant="TRUE" vldtGrant="TRUE" grantMin="1" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>
      # Expect data reception request
      <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE"/>
       </tapa.tfu.recp.req>        
      </tapa.expect>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>
      # Expect data reception request
      <tapa.expect>
      <tapa.tfu.recp.req numRntis="1">
          <tapa.tfu.pusch.recp.req ueId="1" use="2" vldtDatRecp="TRUE"/>
       </tapa.tfu.recp.req>        
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>


   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.29
#
#       Desc:    To verify that UEs with SR are given higher priority by scheduler
#                compared to UEs with nonLcg0Bs. Provide more optimal conditions for UE with
#                nonlcg0Bs than the Ue with SR. Verify that irrespective of any QOS or BSR value,
#                SR Ue is scheduled first by the scheduler.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.29">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
         "To verify that UEs with SR are given higher priority by scheduler
          compared to UEs with nonLcg0Bs. Provide more optimal conditions for UE with
          nonlcg0Bs than the Ue with SR. Verify that irrespective of any QOS or BSR value,
          SR Ue is scheduled first by the scheduler."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>
<!--
      <tapa.rg.dbgInitErr/>
      <tapa.rg.dbgInitParm/>
      <tapa.rg.dbgInitInfo/>
-->
      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="10" maxUlUeNewTxPerTti="4" dlTotalBw="50"
         dlSchdType="0" ulSchdType="0" subbandStart="1" ngEnum="RGAC_RGR_NG_ONESIXTH"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0" ueBr="6000" ueCatEnum="4"/>
      <tapa.rg.UeInit ueId="1" ueBr="1000" ueCatEnum="2"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      # Configure bi-directional DTCH for default UE0 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
      </tapa.expset>

      # Configure bi-directional DTCH for default UE0 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="1" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="1" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
        </tapa.tfu.sr.ind>
     </tapa.send>
      
      # Send one TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="4"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>
     
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect HARQ ACK in PHICH
      <tapa.expect>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

     #Indicate higher BSR to UE0.
     <tapa.send>
        <tapa.tfu.dat.ind datInds="1">
           <tapa.tfu.dat ueId="0" use="4" lcId="3" addShortBsr="TRUE" lcgId="1" bsr="42"/>
        </tapa.tfu.dat.ind>
     </tapa.send>

      <tapa.expset>
         # Expect DatInd at RLC
         <tapa.rgu.ddatind ueId="0" lchTb1Data="3,1"/>
      </tapa.expset>

     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>
      
      # Send one TTI  (4 (TTIs to get the feedback) - TFU_DELTA (=2) - 1
      # (TFU_UL_DELTA that elapsed in giving datInd to MAC from PHY)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # verify grnt is recieved only for SR Ue i.e UE1
      # with BW constraint restricdting grnt allocation to only 1 UE
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="1" isUlGrant="TRUE" vldtTx="TRUE" saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.30
#
#       Desc:    To verify that UEs with SR are given higher priority by scheduler
#                compared to UEs with nonLcg0Bs. Provide more optimal conditions for UE with
#                nonlcg0Bs than the Ue with SR. Verify that irrespective of any QOS or BSR value,
#                SR Ue is scheduled first by the scheduler.
#                This above mentioned test scenario is modified such that UE0 deletion is triggered,
#                before SR indication is sent from it. Verify UE1 is given the grant.
#
#       Notes:   None
#              
#       Module:  scheduler
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.30">>>

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36321.830" section=""/>
      <tapa.module id="scheduler"/>

      <tapa.desc>
         "To verify that UEs with SR are given higher priority by scheduler
          compared to UEs with nonLcg0Bs. Provide more optimal conditions for UE with
          nonlcg0Bs than the Ue with SR. Verify that irrespective of any QOS or BSR value,
          SR Ue is scheduled first by the scheduler. This above mentioned test scenario is
          modified such that UE0 deletion is triggered, before SR indication is sent from it. 
          Verify UE1 is given the grant."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef/>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Initialize LTEMAC
      <tapa.rg.macInit/>
<!--
      <tapa.rg.dbgInitErr/>
      <tapa.rg.dbgInitParm/>
      <tapa.rg.dbgInitInfo/>
-->
      #Initialize CELL
      <tapa.rg.cellInit ulTotalBw="16" maxUlUeNewTxPerTti="4"
         dlSchdType="0" ulSchdType="0"/>
      #Initialize UE
      <tapa.rg.UeInit ueId="0" ueBr="6000" ueCatEnum="4"/>
      <tapa.rg.UeInit ueId="1" ueBr="1000" ueCatEnum="2"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      
      <tapa.tfu.directive ulDeltaPrsnt="TRUE"/> 
      # Configure bi-directional DTCH for default UE0 
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.crg.cfgcfm/>
         <tapa.crg.cfgcfm/>
      </tapa.expset>

      # Configure bi-directional DTCH for default UE0 
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="1" lcId="3" lcgId="0" dir="3" lcType="4" ulQci="8" instId="5"/>
      </tapa.send>

      # Configure UL LCG on RGR
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="0" lcgId="1" instId="5"/>
      </tapa.send>
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lcg ueId="1" lcgId="1" instId="5"/>
      </tapa.send>

      # Send TTI indication for default cell
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect configuration confirm after the TTI
      <tapa.expset> 
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expset>

      # Send SR Indication for default UE
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="0"/>
        </tapa.tfu.sr.ind>
     </tapa.send>
      
      # Send one TTI to schedule SR
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.cntrl.req numCntrlReq="3">
           <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1" isUlGrant="TRUE" vldtGrant="TRUE" vldtTx="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send 4 (UL_SCHED_DELTA (=2) + 4 TTIs (for Ue to transmit) - TFU_DELTA
      # (=2 in advance that we expect datRecpReq)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      # Expect data reception request
      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.pusch.recp.req ueId="0" use="1" vldtDatRecp="TRUE" saveTo="4"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send 3 TTIs (TFU_DELTA(=2) for UE to transmit + 1 (TFU_UL_DELTA))
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

      #Send CRC for Msg
      <tapa.send>
         <tapa.tfu.crc.ind>
            <tapa.tfu.crc ueId="0" isFailure="FALSE"/>
         </tapa.tfu.crc.ind>
      </tapa.send>

     #delete UE1.
     <tapa.send>
        <tapa.rgr.cfgreq.del DelType="2" ueId="1"/>
     </tapa.send>
     <tapa.send>
        <tapa.crg.cfgreq.del DelType="2" ueId="1"/>
     </tapa.send>
      
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      <tapa.expset> 
         <tapa.crg.cfgcfm/>
         <tapa.rgr.cfgCfm instId="5"/>
      # Expect HARQ ACK in PHICH
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.phich.cntrl.req ueId="0" isAck="TRUE"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

     #Indicate higher BSR to UE0.
     <tapa.send>
        <tapa.tfu.dat.ind datInds="1">
           <tapa.tfu.dat ueId="0" use="4" lcId="3" addShortBsr="TRUE" lcgId="1" bsr="42"/>
        </tapa.tfu.dat.ind>
     </tapa.send>

      <tapa.expset>
         # Expect DatInd at RLC
         <tapa.rgu.ddatind ueId="0" lchTb1Data="3,1"/>
      </tapa.expset>

     # As UE1 is deleted, this srInd should be discarded.
     <tapa.send>
        <tapa.tfu.sr.ind>
           <tapa.tfu.sr ueId="1"/>
        </tapa.tfu.sr.ind>
     </tapa.send>
      
     
      # Send one TTI  (4 (TTIs to get the feedback) - TFU_DELTA (=2) - 1
      # (TFU_UL_DELTA that elapsed in giving datInd to MAC from PHY)
      <tapa.send>
         <tapa.tfu.tti.ind numTti="1"/>
      </tapa.send>

      # verify grnt is recieved only for UE0
      <tapa.expect>
        <tapa.tfu.cntrl.req expCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req ueId="0" isUlGrant="TRUE" vldtTx="TRUE" saveTo="1"/>
        </tapa.tfu.cntrl.req>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>
   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    7.31
#
#       Desc:    To Test UEs DL Qos refreshing.
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.31">>>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To Test UEs DL Qos refreshing."
      </tapa.desc>

      <tapa.longdesc>
         "To Test UEs DL Qos refreshing."
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      <tapa.ifdef/>
      <tapa.ifndef/>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>


      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit.dlSched
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueId="0" ambrPres="TRUE" dlAmbr="50"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8" />
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="8"  instId="5"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="100"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="1">
           <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="1">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" ueId="0"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="1">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send TFU_DELTA Ttis to send fdbk to MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="1">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      # Send a Ttis to expire QOS refresh timer. 
      <tapa.send>
         <tapa.tfu.tti.ind numTti="288"/>
      </tapa.send>

    # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY. UeId to check rnti sent by MAC.
      <tapa.expset>
        <tapa.tfu.dat.req datReqs="2">
           <tapa.tfu.pdsch.dat.req  use="1" ueId="0" numSdu="1"/>
        </tapa.tfu.dat.req>
        <tapa.tfu.cntrl.req numCntrlReq="2">
           <tapa.tfu.pdcch.cntrl.req saveTo="1" ueId="0"/>
        </tapa.tfu.cntrl.req>
      </tapa.expset>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

      <tapa.expect>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
      </tapa.expect>

      # Send TFU_DELTA Ttis to send fdbk to MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>


#
#
#       Test:    7.32
#
#       Desc:    To test DL Scheduler schedules RETX as per the highest priority services. 
#
#       Notes:   None
#              
#       Module:  None
#
#       File:    rgac_tc7.xml
#
#
<tapa.testcase id="7.32">>

   # Document subsection
   <tapa.doc>
      <tapa.rfc id="" section=""/>
      <tapa.module/>

      <tapa.desc>
         "To test DL Scheduler schedules RETX as per the highest priority services."
      </tapa.desc>

      <tapa.longdesc>
         "To Test if DLS gives higher priority to a UE whose retx proc has been allocated
         for a higher priority service than that of another UE in a same subframe. Configure
         min retxBw such that only one UE gets honoured. Verify that it is UE1 which is scheduled
         first."
      </tapa.longdesc>
   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
# Disabling this TC, does not work with MIMO code
<tapa.ifndef/>
      <tapa.ifdef>
      </tapa.ifdef>
      
      <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>


      # Initialize LTEMAC
      <tapa.rg.macInit/>

      <tapa.rg.dbgDeInitAll/>

      #Initialize CELL
      <tapa.rg.cellInit dlTotalBw="100" 
         dlSchdType="0" ulSchdType="0"/>

      #Do RACH and UE Config
      <tapa.rg.UeInit ueId="0"/>
      <tapa.rg.UeInit ueId="1"/>
      
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="0" lcId="9" lcType="4" dir="1" dlQci="3" dlGbr="1000" dlMbr="2000"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.crg.cfgreq.cfg.lch ueId="1" lcId="9" lcType="4" dir="1"  dlQci="2" dlGbr="1000"  dlMbr="2000"/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.crg.cfgcfm/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="0" lcId="9" lcType="4" dir="1" dlQci="2" dlGbr="2000" dlMbr="3000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>

      # Configure a dedicated logical channel for the created UE  
      <tapa.send>
         <tapa.rgr.cfgreq.cfg.lch instId="5" ueId="1" lcId="9" lcType="4" dir="1"  dlQci="3" dlGbr="2000"  dlMbr="3000"/>
      </tapa.send>

      # Send a Tti to get the configuration applied. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect success in cfg cfm
      <tapa.expect>
         <tapa.rgr.cfgCfm instId="5"/>
      </tapa.expect>


      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="100"/>
      </tapa.send>

      # Send BO for the created logical channel on RGU. 
      <tapa.send>
         <tapa.rgu.dstarsp ueId="1" lcId="9" lcType="4" bo="90"/>
      </tapa.send>

      # Send a Tti to get the transmission scheduled. 
      <tapa.send>
         <tapa.tfu.tti.ind/>
      </tapa.send>

      # Expect staInd from MAC to RLC for UE2.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="1" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Expect staInd from MAC to RLC for UE1.
      <tapa.expect>
         <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
      </tapa.expect>
     
      # Send DDatReq for UE1 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="0" lcId="9" lcType="4"/>
      </tapa.send>

      # Send DDatReq for UE2 with size equal to the allocated size on RGU. 
     <tapa.send>
         <tapa.rgu.ddatreq lchTb1Data="9" ueId="1" lcId="9" lcType="4"/>
      </tapa.send>

      # Send 1 Tti to get the MAC PDU at PHY.
      <tapa.send>
         <tapa.tfu.tti.ind />
      </tapa.send>

      # Expect PDU from MAC to PHY for UE2. UeId to check rnti sent by MAC.
   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="2"/>
     </tapa.tfu.cntrl.req>
   # Expect Msg4 from MAC to PHY.
     <tapa.tfu.dat.req datReqs="2">
        <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1"/>
        <tapa.tfu.pdsch.dat.req use="2" ueId="1" numSdu="1"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      # Send TFU_DELTA(for transmission) + 4 (for fdbk to PHY)+
      # 1(TFU_UL_DELTA) - TFU_DELTA Ttis to expect harqrecp req from MAC.
      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="0"/>
        <tapa.tfu.hq.recp.req ueId="1"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="3"/>
      </tapa.send>

   # Send NACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="0" isAck="FALSE"/>
        <tapa.tfu.hq ueId="1" isAck="FALSE"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="2"/>
      </tapa.send>

   # Expect Retransmission only for ueId=1, as the it has the highest prio svc 
   # previously scheduled for this proc against ueId=0, and also the retxBw is 
   # configured such that only one UE gets satisfied.
   <tapa.expset>
     <tapa.tfu.cntrl.req numCntrlReq="2">
        <tapa.tfu.pdcch.cntrl.req ueId="1" saveTo="3" vldtRetx="TRUE"/>
        <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="4" vldtRetx="TRUE"/>
     </tapa.tfu.cntrl.req>
     <tapa.tfu.dat.req datReqs="1">
        <tapa.tfu.pdsch.dat.req retxUse="2" ueId="1" numSdu="1" isRetx="TRUE"/>
        <tapa.tfu.pdsch.dat.req retxUse="1" ueId="0" numSdu="1" isRetx="TRUE"/>
     </tapa.tfu.dat.req>
   </tapa.expset>

      <tapa.send>
         <tapa.tfu.tti.ind numTti="4"/>
      </tapa.send>

   <tapa.expset>
     <tapa.tfu.recp.req numRntis="2">
        <tapa.tfu.hq.recp.req ueId="1"/>
        <tapa.tfu.hq.recp.req ueId="0"/>
     </tapa.tfu.recp.req>   
   </tapa.expset>

   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>

   # Send ACK as feedback for Msg4. 
   <tapa.send>
     <tapa.tfu.hq.ind hqInds="2">
        <tapa.tfu.hq ueId="1"/>
        <tapa.tfu.hq ueId="0"/>
     </tapa.tfu.hq.ind>   
   </tapa.send>

   #verify Nothing sent after wards.
   <tapa.send>
      <tapa.tfu.tti.ind numTti="3"/>
   </tapa.send>


   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rg.macDeInit/>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>

   </tapa.shutdown>

</tapa.testcase>

###############################################################################
#
#       Test:    7.33
#
#       Desc:   "Varify that pA configuration hapens successfuly and
#                configured pA Value is received in TfuDatReq"
#
#       Notes:   None
#
#       Module:  None
#
#       File:    rgac_tc20.xml
#
################################################################################
   <tapa.testcase id="7.33" >

      # Document subsection
      <tapa.doc>

         <tapa.rfc id="" section=""/>
         <tapa.module id=""/>

         <tapa.desc>
         "Varify that pA configuration hapens successfuly and
          configured pA Value is received in TfuDatReq"
         </tapa.desc>

         <tapa.longdesc>
            "   1. Configure UE#1, Cell#1
                2. Configure DL logical Channel 1, UL logical channel group 1
                   (only one up logical channel), pA value =
                        RGAC_UE_DLPWRCNTRL_PA_DB_3
                4. RLC reports BO
                5. Expect Sts Indication from scheduler and send data from RLC
                6. Receive dat request at TFU interface with pA =
                        RGAC_UE_DLPWRCNTRL_PA_DB_3
                7. Reconfigure UE with pA = RGAC_UE_DLPWRCNTRL_PA_DB_6
                4. RLC reports BO
                5. Expect Sts Indication from scheduler and send data from RLC
                6. Receive dat request at TFU interface with pA =
                        RGAC_UE_DLPWRCNTRL_PA_DB_6"
         </tapa.longdesc>

      </tapa.doc>

      # Require features and flags subsection
      <tapa.require>

         <tapa.ifdef>
            <tapa.flag id="TFU_UPGRADE"/>
         </tapa.ifdef>

         <tapa.ifndef>
            <tapa.flag id="TFU_TDD"/>
         </tapa.ifndef>
         <tapa.mode mode="single"/>

      </tapa.require>

      # Configuration subsection
      <tapa.cfg>


         # Initialize LTEMAC
         <tapa.rg.macInit/>

         <tapa.rg.dbgDeInitAll/>
         #Initialize CELL
         <tapa.rg.cellInit numTxAntPorts ="2"/>

         #Finish RACH and then do UE Configuratrion
         <tapa.rg.rach/>

      </tapa.cfg>
      # Test Steps subsection
      <tapa.test>
        # Send UE config request at CRG
        <tapa.send>
           <tapa.crg.cfgreq.cfg.ue/>
        </tapa.send>
        # Expect success in cfg cfm from MAC
        <tapa.expect>
           <tapa.crg.cfgcfm/>
        </tapa.expect>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.crg.cfgreq.cfg.lch lcId="9" lcgId="0" dir="3"
                     lcType="4" ulQci="8"/>
         </tapa.send>

         # Expect configuration confirm after the TTI
         <tapa.expect>
            <tapa.crg.cfgcfm/>
         </tapa.expect>

        # Send UE config request at RGR
        # Configure pA = RGRUE_DLPWRCNTRL_PA_DB1
        <tapa.send>
          <tapa.rgr.cfgreq.cfg.ue pAVal="5"/>
        </tapa.send>

         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lcg lcgId="0" instId="5"/>
         </tapa.send>

         # Configure bi-directional DTCH for default UE
         <tapa.send>
            <tapa.rgr.cfgreq.cfg.lch lcId="9" lcgId="0"
                     dir="3" lcType="4" ulQci="8" instId="5"/>
         </tapa.send>

        # Send TTI to apply the config
        <tapa.send>
           <tapa.tfu.tti.ind  TTI-Identity="1" numTti="1"/>
        </tapa.send>

        # Expect success in cfg cfm from Scheduler
         <tapa.expset>
          <tapa.rgr.cfgCfm instId="5"/>
          <tapa.rgr.cfgCfm instId="5"/>
          <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="9 and 10" numTti="1"/>
         </tapa.send>

         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
          </tapa.expset>

         <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0"
                        lcId="9" lcType="4"/>
         </tapa.send>


         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="11" numTti="1"/>
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1" chkPa="TRUE"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         # Send Reconfigure for other pA Value = RGRUE_DLPWRCNTRL_PA_DB_1DOT77
         <tapa.send>
            <tapa.rgr.cfgreq.recfg.ue instId="5" ueId="0" pAVal="3"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12 and 13" numTti="1"/>
         </tapa.send>

         <tapa.expset>
            <tapa.rgr.cfgCfm instId="5"/>
         </tapa.expset>

         <tapa.send>
            <tapa.rgu.dstarsp ueId="0" lcId="9" lcType="4" bo="10"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12 and 13" numTti="1"/>
         </tapa.send>

         <tapa.expset>
            <tapa.rgu.dstaind ueId="0" lchTb1Data="9" saveTo="2"/>
         </tapa.expset>

         <tapa.send>
            <tapa.rgu.ddatreq lchTb1Data="9" ueId="0"
                        lcId="9" lcType="4"/>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12 and 13" numTti="1"/>
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.cntrl.req numCntrlReq="1">
              <tapa.tfu.pdcch.cntrl.req ueId="0" saveTo="1"/>
           </tapa.tfu.cntrl.req>
           <tapa.tfu.dat.req datReqs="1">
              <tapa.tfu.pdsch.dat.req use="1" ueId="0" numSdu="1" chkPa="TRUE"/>
           </tapa.tfu.dat.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="12 and 13" numTti="1"/>
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="16 to 18" numTti="3"/>
         </tapa.send>

         <tapa.expset>
           <tapa.tfu.recp.req numRntis="1">
              <tapa.tfu.hq.recp.req ueId="0"/>
           </tapa.tfu.recp.req>
         </tapa.expset>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0" isAck="TRUE"/>
           </tapa.tfu.hq.ind>
         </tapa.send>

         <tapa.send>
            <tapa.tfu.tti.ind TTI-Identity="16 to 18" numTti="3"/>
         </tapa.send>

         <tapa.send>
           <tapa.tfu.hq.ind hqInds="1">
              <tapa.tfu.hq ueId="0" isAck="TRUE"/>
           </tapa.tfu.hq.ind>
         </tapa.send>


      </tapa.test>
      # Clean subsection
      <tapa.clean>
         <tapa.rg.macDeInit/>
      </tapa.clean>

      # Shutdown subsection
      <tapa.shutdown>
         # Layer Manager ShutDown
      </tapa.shutdown>
   </tapa.testcase>

# DO NOT DELETE THIS LINE -- TC number generation script depends on it.
# xyzabcend

#/********************************************************************30**
#
#         End of file:     cm_xta_gen_tc_num.py@@/main/5 - Wed Jun 27 16:21:06 2007
#
#*********************************************************************31*/
#
#
#/********************************************************************40**
#
#        Notes:
#
#*********************************************************************41*/
#
#/********************************************************************50**
#
#*********************************************************************51*/
#
#
#/********************************************************************60**
#
#        Revision history:
#
#*********************************************************************61*/
#
#/********************************************************************90**
#
#     ver       pat    init                  description
#------------ -------- ---- ----------------------------------------------
#$SID$         ---      sy  1. Initial Release
#             rg004.201 rnt  1. Modified for SI Enhancement
#           rg007.201   ap  1. Protected 7.13/7.14/7.32 TC under LEMAC_MIMO flag
#                               2. Moved seperate expect statements into
#                                  single expset block for TCs 7.13 and 7.14
#             rg008.201 sd   1.Removed TCs with MIMO disabled
#$SID$        ---     gvj  1. LTE MAC 3.1 Release
#$SID$        rg002.301 asehgal  1.ccpu00109543 and ccpu00117606 changes
#$SID$        ---                2.ccpu00120621: interchanged qci as priority
                                 of qci's have changed
#$SID$      ---        rt  1. LTE MAC 4.1 Release
#*********************************************************************91*/
