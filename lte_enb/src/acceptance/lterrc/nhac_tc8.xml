#*********************************************************************17*/
#
# DO NOT DELETE THIS LINE -- TC number generation script depends on it.
# xyzabcstart=8:hn:nhac_tc8.xml

#/********************************************************************20**
#
#     Name:    RRC 
#
#     Type:    XML Test File
#
#     Desc:    XML Based Test Cases
#
#     File:    nhac_tc8.xml
#
#     Sid:      $SID$
#
#     Prg:     rer 
#
#*********************************************************************21*/


#
#
#       Test:    8.1
#
#       Desc:    Successful down link information transfer for 
#                a Ue in  Connected mode, on SRB 1. 
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.1">
   
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36.331" section="5.6.1"/>
      <tapa.module id="rrc.nit"/>

      <tapa.desc>
         "PreTest connecton Setup
         Send down link information transfer for a Ue, with UeID=1, which is in connected mode 
         from RRC User on SRB 1. RRC should encode the message and send it to Ue successfully"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      
      <tapa.ifdef>
         <tapa.flag/>
      </tapa.ifdef>
      
      <tapa.ifndef/>
      
       <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

     #Configure RRC
     <tapa.rrc.init />
   </tapa.cfg>
   
   # Test Steps subsection
   <tapa.test>

    #Perform cell configuration pre-test
    <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1"/>

   #perform RRC connection setup
    <tapa.rrc.consetup cellId="1" tCrnti="1" ueId="1"/>

   #Send downlink message
    <tapa.send>
      <tapa.nhu.datreq msgCategory="1" msgType="1" cellId="1" ueId="1" rbId="1" pdcpId="1"/>
    </tapa.send>

   #Check whether data request  is received at KWU interface
    <tapa.expect>
      <tapa.dummy.pju.datreq cellId="1" ueId="1" pdcpInstId="1"/>
    </tapa.expect>

   </tapa.test>

  # Clean subsection
  <tapa.clean>
      <tapa.rrc.conrls ueId="1" cellId="1" />
      <tapa.rrc.cellcfg.rls cellId="1" />
  </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit />      
      # Send DeInit Configuration       
   </tapa.shutdown>
</tapa.testcase>

#
#
#       Test:    8.2
#
#       Desc:    Successful down link information transfer for 
#                a Ue in  Connected mode, on SRB 2. 
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.2">
   
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36.331" section="5.6.1"/>
      <tapa.module id="rrc.nit"/>

      <tapa.desc>
         "PreTest: connecton Setup, Also configure SRB2 by connection reconfguration"
         "Send down link information transfer for a Ue, with UeID=1, which is in connected mode 
         from RRC User on SRB 2. RRC should encode the message and send it to Ue successfully"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      
      <tapa.ifdef>
         <tapa.flag/>
      </tapa.ifdef>
      
      <tapa.ifndef/>
      
       <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
   <tapa.rrc.init />
     #Configure RRC

   </tapa.cfg>
   
   # Test Steps subsection
   <tapa.test>

    #Perform cell configuration pre-test
    <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1"/>
   #perform RRC connection setup
    <tapa.rrc.consetup cellId="1" tCrnti="1" ueId="1"/>

   <tapa.rrc.security_actv ueId="1" cellId="1"/>
   #perform RRC connection reconfiguration 
    <tapa.rrc.conrecfg cellId="1" ueId="1"/>

   #Send downlink message
    <tapa.send>
      <tapa.nhu.datreq msgCategory="1" msgType="1" cellId="1" ueId="1" rbId="2" pdcpId="1"/>
    </tapa.send>

   #Check whether data request  is received at KWU interface
    <tapa.expect>
      <tapa.dummy.pju.datreq cellId="1" ueId="1" pdcpInstId="1"/>
    </tapa.expect>

   </tapa.test>

  # Clean subsection
  <tapa.clean>
      <tapa.rrc.conrls ueId="1" cellId="1" />
      <tapa.rrc.cellcfg.rls cellId="1" />
  </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit />      
      # Send DeInit Configuration       
   </tapa.shutdown>
</tapa.testcase>

#
#
#       Test:    8.3
#
#       Desc:    UnSuccessful down link information transfer for 
#                a Ue in  Connected mode, on SRB 2. 
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.3">
   
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36.331" section="5.6.1"/>
      <tapa.module id="rrc.nit"/>

      <tapa.desc>
         "PreTest: connecton Setup, SRB2 not configured."
         "Send down link information transfer for a Ue, with UeID=1, which is in connected mode 
          from RRC User on SRB 2. Since SRB 2 is not configured RRC should throw an error 
          indication to RRC user, and Drop the message."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      
      <tapa.ifdef>
         <tapa.flag/>
      </tapa.ifdef>
      
      <tapa.ifndef/>
      
       <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

   <tapa.rrc.init />
     #Configure RRC

   </tapa.cfg>
   
   # Test Steps subsection
   <tapa.test>
    #Perform cell configuration pre-test
    <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1"/>
   #perform RRC connection setup
   <tapa.rrc.consetup cellId="1" tCrnti="1" ueId="1"/>

   #Send downlink message
    <tapa.send>
      <tapa.nhu.datreq msgCategory="1" msgType="1" cellId="1" ueId="1" rbId="1" pdcpId="2"/>
    </tapa.send>

   #Check whether error indication is received at NHU interface
    <tapa.expect>
      <tapa.nhu.errind/>
    </tapa.expect>

   </tapa.test>

  # Clean subsection
  <tapa.clean>

      <tapa.rrc.conrls ueId="1" cellId="1" />
      <tapa.rrc.cellcfg.rls cellId="1" />
  </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit />      
      # Send DeInit Configuration       
   </tapa.shutdown>
</tapa.testcase>


#
#
#       Test:    8.4
#
#       Desc:    UnSuccessful down link information transfer for 
#                a Ue in  Idle mode. 
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.4">
   
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36.331" section="5.6.1"/>
      <tapa.module id="rrc.nit"/>

      <tapa.desc>
         "PreTest: None"
         "Send down link information transfer for a Ue, with UeID=1, which is in idle mode, 
          from RRC User on SRB 1. Since RRC does not find the Ue Context, RRC should throw 
          an error indication to RRC user and message is discarded."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      
      <tapa.ifdef>
         <tapa.flag/>
      </tapa.ifdef>
      
      <tapa.ifndef/>
      
       <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

   <tapa.rrc.init />
     #Configure RRC

   </tapa.cfg>
   
   # Test Steps subsection
   <tapa.test>

    #Perform cell configuration pre-test
    <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1"/>
   #Donot perform RRC connection setup

   #Send downlink message
    <tapa.send>
      <tapa.nhu.datreq msgCategory="1" msgType="1" cellId="1"/>
    </tapa.send>

   #Check whether error indication is received at NHU interface
    <tapa.expect>
      <tapa.nhu.errind/>
    </tapa.expect>


   </tapa.test>

  # Clean subsection
  <tapa.clean>

      <tapa.rrc.cellcfg.rls cellId="1" />
  </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit />      
      # Send DeInit Configuration       
   </tapa.shutdown>
</tapa.testcase>


#
#
#       Test:    8.5
#
#       Desc:    Successful down link information transfer for multiple  
#                Ues in Connected mode, on SRB 1
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.5">
   
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36.331" section="5.6.1"/>
      <tapa.module id="rrc.nit"/>

      <tapa.desc>
         "PreTest: connecton Setup for UeID 1 2 and 3"
         "Send down link information transfer for a UeId=1 from RRC User on SRB 1.
          Send down link information transfer for a UeId=2 from RRC User on SRB 1.
          Send down link information transfer for a UeId=3 from RRC User on SRB 1. 
          RRC should encode the message and send it to respective Ues successfully"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      
      <tapa.ifdef>
         <tapa.flag/>
      </tapa.ifdef>
      
      <tapa.ifndef/>
      
       <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

   <tapa.rrc.init />
     #Configure RRC

   </tapa.cfg>
   
   # Test Steps subsection
   <tapa.test>

    #Perform cell configuration pre-test
    <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1"/>
   #perform RRC connection setup for UE1
    <tapa.rrc.consetup cellId="1" tCrnti="1" ueId="1"/>
   #perform RRC connection setup for UE2
    <tapa.rrc.consetup cellId="1" tCrnti="2" ueId="2"/>
   #perform RRC connection setup for UE3
    <tapa.rrc.consetup cellId="1" tCrnti="3" ueId="3"/>
   #perform RRC connection setup

   #Send downlink message UE1
    <tapa.send>
      <tapa.nhu.datreq msgCategory="1" msgType="1" cellId="1" ueId="1" rbId="1" pdcpId="1"/>
    </tapa.send>

   #Check whether data request  is received at KWU interface
    <tapa.expect>
      <tapa.dummy.pju.datreq cellId="1" ueId="1" pdcpInstId="1"/>
    </tapa.expect>

   #Send downlink message UE2
    <tapa.send>
      <tapa.nhu.datreq msgCategory="1" msgType="1" cellId="1" ueId="2" rbId="1" pdcpId="1"/>
    </tapa.send>

   #Check whether data request  is received at KWU interface
    <tapa.expect>
      <tapa.dummy.pju.datreq cellId="1" ueId="2" pdcpInstId="1"/>
    </tapa.expect>

   #Send downlink message UE3
    <tapa.send>
      <tapa.nhu.datreq msgCategory="1" msgType="1" cellId="1" ueId="3" rbId="1" pdcpId="1"/>
    </tapa.send>

   #Check whether data request  is received at KWU interface
    <tapa.expect>
      <tapa.dummy.pju.datreq cellId="1" ueId="3" pdcpInstId="1"/>
    </tapa.expect>

   </tapa.test>

  # Clean subsection
  <tapa.clean>

      <tapa.rrc.conrls ueId="1" cellId="1" />
      <tapa.rrc.conrls ueId="2" cellId="1" />
      <tapa.rrc.conrls ueId="3" cellId="1" />
      <tapa.rrc.cellcfg.rls cellId="1" />
  </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      # Send DeInit Configuration 
      <tapa.rrc.deinit />      
   </tapa.shutdown>
</tapa.testcase>

#
#
#       Test:    8.6
#
#       Desc:    Successful up link information transfer for 
#                a Ue in  Connected mode, on SRB 1. 
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.6">
   
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36.331" section="5.6.2"/>
      <tapa.module id="rrc.nit"/>

      <tapa.desc>
         "PreTest connecton Setup
         Send up link information transfer message from Ue with UeID=1, 
         which is in connected mode, to RRC on SRB1.RRC should Decode the 
         message and send it to RRC User successfully"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      
      <tapa.ifdef>
         <tapa.flag/>
      </tapa.ifdef>
      
      <tapa.ifndef/>
      
       <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

   <tapa.rrc.init />
     #Configure RRC

   </tapa.cfg>
   
   # Test Steps subsection
   <tapa.test>
    #Perform cell configuration pre-test
    <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1"/>

   #perform RRC connection setup for UE1
   <tapa.rrc.consetup cellId="1" tCrnti="1" ueId="1"/>

   #Send uplink message from UE1 on SRB1
    <tapa.send>
      <tapa.dummy.pju.datind msgType="9"  ueId="1" cellId="1" pdcpInstId="1" />
    </tapa.send>

   #Check whether data indication is received at NHU interface
    <tapa.expect>
      <tapa.nhu.datind/>
    </tapa.expect>

   </tapa.test>

  # Clean subsection
  <tapa.clean>

      <tapa.rrc.conrls ueId="1" cellId="1" />
      <tapa.rrc.cellcfg.rls cellId="1" />
  </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit />      
      # Send DeInit Configuration       
   </tapa.shutdown>
</tapa.testcase>

#
#
#       Test:    8.7
#
#       Desc:    Successful up link information transfer for 
#                a Ue in  Connected mode, on SRB 2. 
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.7">
   
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36.331" section="5.6.2"/>
      <tapa.module id="rrc.nit"/>

      <tapa.desc>
         "PreTest: connecton Setup, Also configure SRB2 by connection reconfguration"
         "Send up link information transfer message from Ue with UeID=1, which is 
          in connected mode, to RRC, on SRB2. RRC should Decode the message and send 
          it to RRC User successfully"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      
      <tapa.ifdef>
         <tapa.flag/>
      </tapa.ifdef>
      
      <tapa.ifndef/>
      
       <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

   <tapa.rrc.init />
     #Configure RRC

   </tapa.cfg>
   
   # Test Steps subsection
   <tapa.test>
    #Perform cell configuration pre-test
    <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1"/>

   #perform RRC connection setup for UE1
   <tapa.rrc.consetup cellId="1" tCrnti="1" ueId="1"/>

   <tapa.rrc.security_actv ueId="1" cellId="1"/>
   #perform RRC connection reconfiguration 
    <tapa.rrc.conrecfg cellId="1" ueId="1"/>

   #Send uplink message from UE1 on SRB1
    <tapa.send>
      <tapa.dummy.pju.datind msgType="9"  ueId="1" cellId="1" pdcpInstId="2" />
    </tapa.send>

   #Check whether data indication is received at NHU interface
    <tapa.expect>
      <tapa.nhu.datind/>
    </tapa.expect>

   </tapa.test>

  # Clean subsection
  <tapa.clean>
      <tapa.rrc.conrls ueId="1" cellId="1" />
      <tapa.rrc.cellcfg.rls cellId="1" />
  </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit />      
      # Send DeInit Configuration       
   </tapa.shutdown>
</tapa.testcase>

#
#
#       Test:    8.8
#
#       Desc:    UnSuccessful up link information transfer for 
#                a Ue in  Connected mode, on SRB 2. 
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.8">
   
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36.331" section="5.6.2"/>
      <tapa.module id="rrc.nit"/>

      <tapa.desc>
         "PreTest: connecton Setup, SRB2 not configured."
         "Send up link information transfer from a Ue, with UeID=1, which is in 
          connected mode SRB 2. Since SRB 2 is not configured,RRC drops the message"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      
      <tapa.ifdef>
         <tapa.flag/>
      </tapa.ifdef>
      
      <tapa.ifndef/>
      
       <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

   <tapa.rrc.init />
     #Configure RRC

   </tapa.cfg>
   
   # Test Steps subsection
   <tapa.test>
    #Perform cell configuration pre-test
    <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1"/>

  #perform RRC connection setup for UE1
   <tapa.rrc.consetup cellId="1" tCrnti="1" ueId="1"/>

   #Send uplink message from UE1 on SRB1
    <tapa.send>
      <tapa.dummy.pju.datind msgType="9"  ueId="1" cellId="1" pdcpInstId="2" />
    </tapa.send>

   #Check whether data indication with error strcuture updated is received at NHU interface
    <tapa.expect>
      <tapa.nhu.datind/>
    </tapa.expect>

   </tapa.test>

  # Clean subsection
  <tapa.clean>
      <tapa.rrc.conrls ueId="1" cellId="1" />
      <tapa.rrc.cellcfg.rls cellId="1" />
  </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit />      
      # Send DeInit Configuration       
   </tapa.shutdown>
</tapa.testcase>


#
#
#       Test:    8.9
#
#       Desc:    Successful up link information transfer for 
#                multiple Ues in  connected mode. 
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.9">
   
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36.331" section="5.6.2"/>
      <tapa.module id="rrc.nit"/>

      <tapa.desc>
         "PreTest: connecton Setup establish RRC connection with 3 Ues with ueid 1, 2 and 3"
         "Send up link information transfer from a UeId=1 to RRC on SRB 1.
          Send up link information transfer from a UeId=2 to RRC on SRB 1.
          Send up link information transfer from a UeId=3 to RRC on SRB 1.
          RRC should decode the message and send it to RRC User  successfully"

      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      
      <tapa.ifdef>
         <tapa.flag/>
      </tapa.ifdef>
      
      <tapa.ifndef/>
      
       <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

   <tapa.rrc.init />
     #Configure RRC

   </tapa.cfg>
   
   # Test Steps subsection
   <tapa.test>

    #Perform cell configuration pre-test
    <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1"/>
   #perform RRC connection setup for UE1
   <tapa.rrc.consetup cellId="1" tCrnti="1" ueId="1"/>
   #perform RRC connection setup for UE2
   <tapa.rrc.consetup cellId="1" tCrnti="2" ueId="2"/>
   #perform RRC connection setup for UE3
   <tapa.rrc.consetup cellId="1" tCrnti="3" ueId="3"/>

   #Send uplink message from UE1 on SRB1
    <tapa.send>
      <tapa.dummy.pju.datind msgType="9"  ueId="1" cellId="1" pdcpInstId="1" />
    </tapa.send>

   #Check whether data indication is received at NHU interface
    <tapa.expect>
      <tapa.nhu.datind/>
    </tapa.expect>

   #Send uplink message from UE2 on SRB1
    <tapa.send>
      <tapa.dummy.pju.datind msgType="9"  ueId="2" cellId="1" pdcpInstId="1" />
    </tapa.send>

   #Check whether data indication is received at NHU interface
    <tapa.expect>
      <tapa.nhu.datind/>
    </tapa.expect>

   #Send uplink message from UE3 on SRB1
    <tapa.send>
      <tapa.dummy.pju.datind msgType="9"  ueId="3" cellId="1" pdcpInstId="1" />
    </tapa.send>

   #Check whether data indication is received at NHU interface
    <tapa.expect>
      <tapa.nhu.datind/>
    </tapa.expect>

   </tapa.test>

  # Clean subsection
  <tapa.clean>

      <tapa.rrc.conrls ueId="1" cellId="1" />
      <tapa.rrc.conrls ueId="2" cellId="1" />
      <tapa.rrc.conrls ueId="3" cellId="1" />
      <tapa.rrc.cellcfg.rls cellId="1" />
  </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit />      
      # Send DeInit Configuration       
   </tapa.shutdown>
</tapa.testcase>

#
#
#       Test:    8.10
#
#       Desc:    Unsuccessful up link information transfer for 
#                a Ue in  Connected mode, on SRB 1. 
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.10">
   
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36.331" section="5.6.2"/>
      <tapa.module id="rrc.nit"/>

      <tapa.desc>
         "PreTest connecton Setup
         Send up link information transfer message from Ue with UeID=1, 
         which is in connected mode, to RRC on SRB1.RRC should Decode the 
         message and send it to RRC User successfully"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      
      <tapa.ifdef>
         <tapa.flag/>
      </tapa.ifdef>
      
      <tapa.ifndef/>
      
       <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

   <tapa.rrc.init />
     #Configure RRC

   </tapa.cfg>
   
   # Test Steps subsection
   <tapa.test>
    #Perform cell configuration pre-test
    <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1"/>
   #Donot perform RRC connection setup for UE1

   #Send uplink message from UE1 on SRB1
    <tapa.send>
      <tapa.dummy.pju.datind msgType="9"  ueId="1" cellId="1" pdcpInstId="1" />
    </tapa.send>

   #Check whether data indication is received at NHU interface
    #<tapa.expect>
     # <tapa.nhu.datind/>
    #</tapa.expect>

   </tapa.test>

  # Clean subsection
  <tapa.clean>
      <tapa.rrc.cellcfg.rls cellId="1" />
  </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit />      
      # Send DeInit Configuration       
   </tapa.shutdown>
</tapa.testcase>

#
#
#       Test:    8.11
#
#       Desc:    Successful down link information transfer for 
#                a Ue in  Connected mode, on SRB 1. 
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.11">
   
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36.331" section="5.6.1"/>
      <tapa.module id="rrc.nit"/>

      <tapa.desc>
         "PreTest connecton Setup
         Send down link information transfer for a Ue, with UeID=1, which is in connected mode 
         from RRC User on SRB 1. RRC should encode the message and send it to Ue successfully"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      
      <tapa.ifdef>
         <tapa.flag/>
      </tapa.ifdef>
      
      <tapa.ifndef/>
      
       <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

     #Configure RRC
     <tapa.rrc.init />
   </tapa.cfg>
   
   # Test Steps subsection
   <tapa.test>

    #Perform cell configuration pre-test
    <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1"/>

   #perform RRC connection setup
    <tapa.rrc.consetup cellId="1" tCrnti="1" ueId="1"/>

   #Send downlink message
    <tapa.send>
      <tapa.nhu.datreq msgCategory="1" msgType="1" cellId="1" ueId="1" rbId="1" pdcpId="1" rrcTransIdPres="0"/>
    </tapa.send>

   #Check whether data request  is received at KWU interface
    <tapa.expect>
      <tapa.nhu.errind />
    </tapa.expect>

   </tapa.test>

  # Clean subsection
  <tapa.clean>
      <tapa.rrc.conrls ueId="1" cellId="1" />
      <tapa.rrc.cellcfg.rls cellId="1" />
  </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit />      
      # Send DeInit Configuration       
   </tapa.shutdown>
</tapa.testcase>

#################
Below test cases are for the code coverage report. This test cases will return
error from the CrgCfgReq/CkwCfgReq/CpjCfgReq primitives 
################
#
#
#       Test:    8.12
#
#       Desc:    Successful creation of a cell
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc5.xml
#
#
<tapa.testcase id="8.12">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36.321,36.331" section="5.3"/>
      <tapa.module id="lterrc"/>

      <tapa.desc>
           "To test the successful creation of a cell.
			  Configure a new cell, Send Cell Setup 
			  configuration request from NHU. Expect config request at CKW and CRG from 
			  RRC. After successful configuration of CKW and CRG, expect Cell config 
			  confirm from RRC, at RRC user."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Bring up the RRC layer using LM
     <tapa.rrc.init />
   </tapa.cfg>

   <tapa.test>
      #Send Cell config Setup Request
      <tapa.send>
         <tapa.nhu.cellcfgreq cellCfgType="1" transId="33" cellId="1" 
         cellCfgBitMask="9"
        numTxAntennas="1" numCellRb="6" rbCfgType="1"
        spId="1" dlRlcMode="1" ulRlcMode="1"  logChCfgpres="7" expMacErr="1"
        expRlcErr="1" />
      </tapa.send>

      #Insert delay delay of few ms
      <tapa.delay delay="10"/>

      #Expect config Request at RLC and MAC
      <tapa.expopt>
         <tapa.nhu.errind errorType="16" errorCause="11"/>
      </tapa.expopt>
      <tapa.expopt>
         <tapa.nhu.cellcfgcfm/>
      </tapa.expopt>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
		<tapa.rrc.deinit/>
   </tapa.shutdown>

</tapa.testcase>
#
#
#       Test:    8.13
#
#       Desc:    Successful RRC Connection Reconfiguration that 
#                includes Radio Resource Configuration
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.13">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36.331" section="5.3.5 and 6.2.2"/>
      <tapa.module id="lterrc"/>

      <tapa.desc>
          "In this case, RRC user will send RRC Connection Reconfiguration 
           message along with Reconfiguration details to RRC to send it to 
           UE in RRC_CONNECTED state." 
          "RRC will encode the Connection Reconfiguration message and send 
           it to UE."
          "UE will also do the configuration at its end and will send the 
           RRC Connection Reconfiguration Complete message to eNB."
          "On getting RRC Connection Reconfiguration Complete message from 
           PDCP, RRC will decode this message and if decode is successful, 
           RRC sends Configuration Request to RLC, MAC and PDCP. Then RRC 
           will forward the Reconfiguration Complete message to RRC user."
          "RLC, MAC and PDCP layers will do the configuration and will send 
           back configuration confirm to RRC. On getting all the 
           configuration confirm messages from RLC,MAC and PDCP, RRC will 
           send Config Confirm message to RRC user."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef>
      </tapa.ifndef>

      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      #Configure RRC
      <tapa.rrc.init />
   </tapa.cfg>

   # Test Steps subsection
  <tapa.test>

      #Cell Configuration Setup
      <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1" />

      #carry Out connection establishment for UE 1
      <tapa.rrc.consetup ueId="1" cellId="1" tCrnti="1"/>

	  <tapa.rrc.security_actv ueId="1" cellId="1"/>

	  
	  #Send Connection Reconfiguration For ueId 1, cellId=1
      #msg8ategory="1" DLDCCH, msgType="4" Connection recfg
      #expCfgBitMask=1 Only RbConfig is given
      #Adding 1 SRB, 2 DRBs rbCfgType="1"
	  #logChType="3" id logical chanel type DLDCCH=3(enum)
	  #addLcIdStr logical channels wrt to RBs added
	  #addBitMskStr direction UL/DL/PDCP for RBs added
	  #trChCfgDed=0 indicates transport channel config not present.
	  #macSchedCfg="0" indicates MAC Scheduling config not present.
	  <tapa.send>
         <tapa.nhu.datreq spId="0" bitMask="2" expCfgBitMask="1"
		 msgCategory="1" msgType="4" transId="1" rrc_transId="1"
		 cellId="1" ueId="1" pdcpId="1" numAddRb="3" addRbIdStr="2,0,3,1,4,1"
		 addLcIdStr="2,3,4" addBitMskStr="7,6,5" rbCfgType="1" logChType="3"
		 trChCfgDed="0" macSchedCfg="0"/>
      </tapa.send>

	  <tapa.delay delay="5" />
	  
      <tapa.expset>
         <tapa.dummy.crg.cfgreq  store_tid="1" ueIdPres="1" valUeId="1" rbIdx="0"/>
		 <tapa.dummy.crg.cfgreq  store_tid="1" ueIdPres="1" valUeId="1" rbIdx="1"/>
		 <tapa.dummy.crg.cfgreq  store_tid="1" ueIdPres="1" valUeId="1" rbIdx="2" cleanup="1"/>
         <tapa.dummy.ckw.cfgreq  use="1" ueIdPres="1" valUeId="1" cleanup="1"/>
		 <tapa.dummy.cpj.cfgreq  use="1" ueIdPres="1" valUeId="1" cleanup="1"/>
      </tapa.expset>
	  #Expect Conn Recfg PJU/PDCP
#      <tapa.expect>
#         <tapa.dummy.pju.datreq ueId="1" cellId="1" pdcpInstId="1"/>
#      </tapa.expect>

	  # Send Conn Recfg Complete
      # msgType="3" Conn Recfg Complete
      # cellId and ueId should be passed.
      <tapa.send>
        <tapa.dummy.pju.datind pdcpInstId="1" msgType="2" spId="0" suId="0"
         ueId="1" cellId="1" expMacErr="1" expRlcErr="1" expPdcpErr="1"/>
      </tapa.send>


	  <tapa.delay delay="5" />
      #Expect config Request at RLC and MAC
      <tapa.expopt>
         <tapa.nhu.errind errorType="15" errorCause="11"/>
      </tapa.expopt>
     <tapa.expopt>
		 <tapa.nhu.datind ueId="1" cellId="1"/>
      </tapa.expopt>
     <tapa.expopt>
        <tapa.nhu.cfgcfm/>
     </tapa.expopt>
   </tapa.test>

  # Clean subsection
   <tapa.clean>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit/>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    8.14
#
#       Desc:    RRC Security Mode Command is received with security
#                configurations and security procedure is successful
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.14">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36.331" section="5.3.3 and 6.2.2"/>
      <tapa.module id="lterrc"/>

      <tapa.desc>
         "On getting Security Mode Command with security configuration "
         "from RRC user, RRC sends integrity configuration to PDCP. After"
         "receiving configuration confirm from PDCP, RRC sends Security Mode"
         "Command to PDCP. After receiving Security Mode Complete from PDCP,"
         "RRC sends ciphering configuration to PDCP. RRC forwards the message"
         "to RRC user. When PDCP sends configuration confirm, RRC commits the"
         "security configuration and forwards the confirm to RRC user."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef>
      </tapa.ifndef>

      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Configure RRC
       <tapa.rrc.init />

      #Cell Configuration Setup
     <tapa.rrc.cellcfg cellCfgType="1" transId="30" cellId="4" />
   </tapa.cfg>

   <tapa.test>

     #RRC Connection establishment procedure
     <tapa.rrc.consetup cellId="4" ueId="32" tCrnti="32" /> 

     #Send Security Mode Command with security configuration
      <tapa.delay delay="5" />
      <tapa.send>
         <tapa.nhu.datreq spId="0" bitMask="2" expCfgBitMask="8"
          msgCategory="1" msgType="6"
          transId="64" rrc_transId="2" cellId="4"
          ueId="32" pdcpId="1" expMacErr="0" expRlcErr="0" expPdcpErr="0"/>
      </tapa.send>

      <tapa.delay delay="5" />

      #Expect integrity configuration at PDCP
      <tapa.expopt>
         <tapa.nhu.errind  errorType="15" errorCause="27" />
      </tapa.expopt>
     #Expect configuration confirm at RRC user
     <tapa.expopt>
       <tapa.nhu.cfgcfm/>
     </tapa.expopt>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rrc.conrls ueId="32" cellId="4" />
      <tapa.rrc.cellcfg.rls cellId="4" />
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit/>
   </tapa.shutdown>

</tapa.testcase>
#
#
#       Test:    8.15
#
#       Desc:    RRC Security Mode Command is received with security
#                configurations and security procedure is successful
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc4.xml
#
#
<tapa.testcase id="8.15">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36.331" section="5.3.3 and 6.2.2"/>
      <tapa.module id="lterrc"/>

      <tapa.desc>
         "On getting Security Mode Command with security configuration "
         "from RRC user, RRC sends integrity configuration to PDCP. After"
         "receiving configuration confirm from PDCP, RRC sends Security Mode"
         "Command to PDCP. After receiving Security Mode Complete from PDCP,"
         "RRC sends ciphering configuration to PDCP. RRC forwards the message"
         "to RRC user. When PDCP sends configuration confirm, RRC commits the"
         "security configuration and forwards the confirm to RRC user."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef>
      </tapa.ifndef>

      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Configure RRC
       <tapa.rrc.init />

      #Cell Configuration Setup
     <tapa.rrc.cellcfg cellCfgType="1" transId="30" cellId="4" />
   </tapa.cfg>

   <tapa.test>

     #RRC Connection establishment procedure
     <tapa.rrc.consetup cellId="4" ueId="32" tCrnti="32" /> 

     #Send Security Mode Command with security configuration
      <tapa.delay delay="5" />
      <tapa.send>
         <tapa.nhu.datreq spId="0" bitMask="2" expCfgBitMask="4"
          msgCategory="1" msgType="6"
          transId="64" rrc_transId="2" cellId="4"
          ueId="32" pdcpId="1" />
      </tapa.send>

      <tapa.delay delay="5" />

      #Expect integrity configuration at PDCP
      <tapa.expect>
         <tapa.dummy.cpj.seccfgreq  use="1" ueIdPres="1" valUeId="32"/>
      </tapa.expect>

      #Send configuration confirm from PDCP
      <tapa.send>
         <tapa.dummy.cpj.seccfgcfm   use="1" cellId="4" ueId="32" />
      </tapa.send>

      <tapa.delay delay="5" />

      #Expect Security Mode command at PDCP
      <tapa.expset>
         <tapa.dummy.pju.datreq pdcpInstId="1" ueId="32" cellId="4" />
         <tapa.nhu.cfgcfm />
      </tapa.expset>

      #Send Security Mode command confirm from PDCP
      <tapa.send>
        <tapa.dummy.pju.datcfm pdcpInstId="1" ueId="32" cellId="4" />
      </tapa.send>

      <tapa.delay delay="5" />

      #Expect Data Confirm at RRC user
     <tapa.expect>
        <tapa.nhu.datcfm />
     </tapa.expect>

      # Send Security Mode Complete from PDCP
     <tapa.send>
        <tapa.dummy.pju.datind pdcpInstId="1" msgType="6" spId="0" suId="0"
                  ueId="32" cellId="4" expMacErr="1" expPdcpErr="1"
                  expRlcErr="1"/>
     </tapa.send>

     <tapa.delay delay="5" />

      #Expect integrity configuration at PDCP
      <tapa.expopt>
         <tapa.nhu.datind  ueId="32" cellId="4" />
      </tapa.expopt>
     #Expect configuration confirm at RRC user
#     <tapa.expopt>
#       <tapa.nhu.cfgcfm/>
#     </tapa.expopt>
#     <tapa.expopt>
#        <tapa.nhu.datind ueId="32" />
#     </tapa.expopt>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rrc.conrls ueId="32" cellId="4" />
      <tapa.rrc.cellcfg.rls cellId="4" />
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit/>
   </tapa.shutdown>

</tapa.testcase>
#
#
#       Test:    8.16
#
#       Desc:    Successful RRC Connection Establishment Procedure.  
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.16">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36.331" section="5.3.3"/>
      <tapa.module id="lterrc"/>

      <tapa.desc>
          Successful RRC Connection Establishment Procedure.
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Configure RRC
      <tapa.rrc.init />
   
      #Cell Configuration Setup
      <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1" />
   </tapa.cfg>

   <tapa.test>

      # Send RRC Connection Request from RLC 
      <tapa.send >
         <tapa.dummy.kwu.datind suId="0" spId="0" rbId="1" msgType="1" 
         cellId="1" tCrnti="2" />
      </tapa.send>

      <tapa.delay delay="5" />
      #Expect RRC Connection Request at RRC user
      <tapa.expect >
         <tapa.nhu.datind cellId="1" tCrnti="2" />
      </tapa.expect>

      #Send RRC Connection Setup from RRC user
      <tapa.send>
         <tapa.nhu.datrsp spId="0" bitMask="2" expCfgBitMask="11"
          rbCfgType="1"  numAddRb="1" msgCategory="3" msgType="3"
          rrc_transId="1" transId="10" rbId="1" tCrnti="2" cellId="1" 
          addRbIdStr="1,0" pdcpId="1" 
          expMacErr="1" expRlcErr="1" expPdcpErr="1" valChk="0"/>
      </tapa.send>

      <tapa.delay delay="5" />
      #Expect integrity configuration at PDCP
      <tapa.expopt>
         <tapa.nhu.errind  errorType="15" errorCause="11" />
      </tapa.expopt>
     #Expect configuration confirm at RRC user
     <tapa.expopt>
       <tapa.nhu.cfgcfm/>
     </tapa.expopt>
   </tapa.test>

   # Clean subsection
   <tapa.clean>
      <tapa.rrc.cellcfg.rls cellId="1" />
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit/>
   </tapa.shutdown>

</tapa.testcase>
#
#
#       Test:    8.17
#
#       Desc:    Send up link information transfer other than SRB1 or SRB2.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.17">
   
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="36.331" section="5.6.2"/>
      <tapa.module id="rrc.nit"/>

      <tapa.desc>
      Send up link information transfer other than SRB1 or SRB2.
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      
      <tapa.ifdef>
         <tapa.flag/>
      </tapa.ifdef>
      
      <tapa.ifndef/>
      
       <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

   <tapa.rrc.init />
     #Configure RRC

   </tapa.cfg>
   
   # Test Steps subsection
   <tapa.test>
    #Perform cell configuration pre-test
    <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1"/>
   #perform RRC connection setup
    <tapa.rrc.consetup cellId="1" tCrnti="1" ueId="1"/>

   <tapa.rrc.security_actv ueId="1" cellId="1"/>
   #perform RRC connection reconfiguration 
	  #Send Connection Reconfiguration For ueId 1, cellId=1
      #msgCategory="1" DLDCCH, msgType="4" Connection recfg
      #expCfgBitMask=1 Only RbConfig is given
      #Adding 1 SRB, 2 DRBs rbCfgType="1"
	  #logChType="3" id logical chanel type DLDCCH=3(enum)
	  #addLcIdStr logical channels wrt to RBs added
	  #addBitMskStr direction UL/DL/PDCP for RBs added
	  #trChCfgDed=0 indicates transport channel config not present.
	  #macSchedCfg="0" indicates MAC Scheduling config not present.
	  <tapa.send>
         <tapa.nhu.datreq spId="0" bitMask="2" expCfgBitMask="1"
		 msgCategory="1" msgType="4" transId="1" rrc_transId="1"
		 cellId="1" ueId="1" pdcpId="1" numAddRb="3" addRbIdStr="2,0,3,1,4,1"
		 addLcIdStr="2,3,4" addBitMskStr="7,7,7" rbCfgType="1" logChType="3"
		 trChCfgDed="0" macSchedCfg="0" valChk="0"/>
      </tapa.send>

	  <tapa.delay delay="5" />
	  
 
     #Expect Lower Layer configurations
     #Expect Conn Recfg Complete at NHU  
      <tapa.expset>
         <tapa.dummy.crg.cfgreq  store_tid="1" ueIdPres="1" valUeId="1" rbIdx="0"/>
		 <tapa.dummy.crg.cfgreq  store_tid="1" ueIdPres="1" valUeId="1" rbIdx="1"/>
		 <tapa.dummy.crg.cfgreq  store_tid="1" ueIdPres="1" valUeId="1" rbIdx="2" cleanup="1"/>
         <tapa.dummy.ckw.cfgreq  use="1" ueIdPres="1" valUeId="1" cleanup="1"/>
		 <tapa.dummy.cpj.cfgreq  use="1" ueIdPres="1" valUeId="1" cleanup="1"/>
      </tapa.expset>
     
     <tapa.send>
         <tapa.dummy.ckw.cfgcfm   use="1" ueId="1"/>
     </tapa.send>
     
     <tapa.send>
         <tapa.dummy.crg.cfgcfm   stored_tid="1" ueId="1"/>
     </tapa.send>

	 <tapa.send>
         <tapa.dummy.crg.cfgcfm   stored_tid="1" ueId="1"/>
     </tapa.send>

	 <tapa.send>
         <tapa.dummy.crg.cfgcfm   stored_tid="1" ueId="1"/>
     </tapa.send>

     <tapa.send>
         <tapa.dummy.cpj.cfgcfm   use="1" ueId="1"/>
     </tapa.send>

     <tapa.delay delay="5" />

	  #Expect Conn Recfg PJU/PDCP
      <tapa.expect>
         <tapa.dummy.pju.datreq ueId="1" cellId="1" pdcpInstId="1"/>
      </tapa.expect>

     <tapa.expect>
        <tapa.nhu.cfgcfm/>
     </tapa.expect>

	  # Send Conn Recfg Complete
      # msgType="3" Conn Recfg Complete
      # cellId and ueId should be passed.
      <tapa.send>
        <tapa.dummy.pju.datind pdcpInstId="1" msgType="2" spId="0" suId="0"
         ueId="1" cellId="1"/>
      </tapa.send>

     <tapa.expect>
		 <tapa.nhu.datind ueId="1" cellId="1"/>
     </tapa.expect>

	  <tapa.delay delay="5" />

   #Send uplink message from UE1 on SRB1
    <tapa.send>
      <tapa.dummy.pju.datind msgType="9"  ueId="1" cellId="1" pdcpInstId="3" />
    </tapa.send>

   #Check whether data indication is received at NHU interface
    <tapa.expect>
      <tapa.nhu.datind ueId="1" cellId="1" errorType="2" errorCause="1" />
    </tapa.expect>

	  <tapa.send>
         <tapa.nhu.datreq spId="0" bitMask="0" expCfgBitMask="1"
		 msgCategory="1" msgType="4" transId="10" rrc_transId="1"
		 cellId="1" ueId="1" pdcpId="1" numAddRb="1" addRbIdStr="5,1"
		 addLcIdStr="5" addBitMskStr="7" rbCfgType="1" logChType="3"
		 trChCfgDed="0" macSchedCfg="0" valChk="0"/>
      </tapa.send>

	  <tapa.delay delay="5" />
	  
	  #Expect Conn Recfg PJU/PDCP
      <tapa.expect>
         <tapa.dummy.pju.datreq ueId="1" cellId="1" pdcpInstId="1"/>
      </tapa.expect>

	  # Send Conn Recfg Complete
      # msgType="3" Conn Recfg Complete
      # cellId and ueId should be passed.
      <tapa.send>
        <tapa.dummy.pju.datind pdcpInstId="2" msgType="2" spId="0" suId="0"
         ueId="1" cellId="1"/>
      </tapa.send>


 
     #Expect Lower Layer configurations
     #Expect Conn Recfg Complete at NHU  
      <tapa.expect>
		 <tapa.nhu.datind ueId="1" cellId="1" errorType="2" errorCause="1"/>
      </tapa.expect>
	  <tapa.delay delay="5" />
   </tapa.test>

  # Clean subsection
  <tapa.clean>

      <tapa.rrc.conrls ueId="1" cellId="1" />
      <tapa.rrc.cellcfg.rls cellId="1" />
  </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit />      
      # Send DeInit Configuration       
   </tapa.shutdown>
</tapa.testcase>
#
#
#       Test:    8.18
#
#       Desc:    RRC connection failure due to RLC configuration not
#                successful
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.18">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="36.331" section="5.3.3 and 6.2.2"/>
      <tapa.module id="lterrc"/>

      <tapa.desc>
         "On getting configuration request from RRC, RLC configures "
         "its resources. But if this configuration fails, RLC informs"
         " RRC in configuration confirm. Once RRC receives a negative"
         " configuration confirm from RLC, RRC sends a configuration "
         "confirm to RRC user indicating that the RLC configuration has"
         " failed and reverts the configuration."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Configure RRC
      <tapa.rrc.init />
   
      #Cell Configuration Setup
      <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1" />
   </tapa.cfg>

   <tapa.test>

      # Send RRC Connection Request from RLC 
      <tapa.send >
         <tapa.dummy.kwu.datind suId="0" spId="0" rbId="1" msgType="1" 
         cellId="1" tCrnti="2" />
      </tapa.send>

      <tapa.delay delay="5" />
      #Expect RRC Connection Request at RRC user
      <tapa.expect >
         <tapa.nhu.datind cellId="1" tCrnti="2" />
      </tapa.expect>

      #Send RRC Connection Setup from RRC user
      <tapa.send>
         <tapa.nhu.datrsp spId="0" bitMask="2" expCfgBitMask="11"
          rbCfgType="1"  numAddRb="1" msgCategory="3" msgType="3"
          rrc_transId="1" transId="10" rbId="1" tCrnti="2" cellId="1" 
          addRbIdStr="1,0" pdcpId="1" valChk="0"/>
      </tapa.send>

      <tapa.delay delay="5" />

      #Expect configuration RRC Connection Setup at RLC request at MAC, RLC and PDCP
      <tapa.expset>
         <tapa.dummy.crg.cfgreq  store_tid="1"  />
         <tapa.dummy.crg.cfgreq  store_tid="1"  />
         <tapa.dummy.ckw.cfgreq  use="1"  />
         <tapa.dummy.cpj.cfgreq  use="1"  />
      </tapa.expset>

     #Send configuration confirm from MAC
     <tapa.send>
         <tapa.dummy.crg.cfgcfm   stored_tid="1" ueId="2" status="15"/>
     </tapa.send>

     <tapa.send>
         <tapa.dummy.crg.cfgcfm   stored_tid="1" ueId="2" status="15"/>
     </tapa.send>

     #Send configuration confirm from RLC
     <tapa.send>
         <tapa.dummy.ckw.cfgcfm   use="1" numFailedRb="1" failedRbIdStr="1,0"
         expMacErr="1" expRlcErr="1" expPdcpErr="1" cellId="1" ueId="2" />
     </tapa.send>

     #Send configuration confirm from PDCP
     <tapa.send>
         <tapa.dummy.cpj.cfgcfm   use="1" ueId="2"/>
     </tapa.send>

      #Expect revert configuration request at MAC and PDCP
      <tapa.expopt>
         <tapa.dummy.cpj.cfgreq  use="1"  />
      </tapa.expopt>
	 #Handle the alarm
	 <tapa.expopt>
	    <tapa.lnh.staind category="3" event="4" cause="0" alarmType="2" />
	 </tapa.expopt>
      <tapa.expopt>
         <tapa.nhu.cfgcfm status="0"/>
      </tapa.expopt>


   </tapa.test>

   # Clean subsection
   <tapa.clean>
   </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit/>
   </tapa.shutdown>


</tapa.testcase>

#       Test:    8.19
#
#       Desc:    To test MAC cell revert in case of add config of cell and 
#                logical channel but failure of cell add config and success of
#                logical channel.  
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.19">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="lterrc"/>

      <tapa.desc>
          "To test cell add revert in case of failure of cell add request
          but successful logical channel add config request."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>
      # Bring up the RRC layer using LM
     <tapa.rrc.init />
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

   #Send Cell config Setup Request
      <tapa.send>
         <tapa.nhu.cellcfgreq cellCfgType="1" transId="33" cellId="1" 
         cellCfgBitMask="9"
        numTxAntennas="1" numCellRb="6" rbCfgType="1"
        spId="1" dlRlcMode="1" ulRlcMode="1"  logChCfgpres="7"/>
      </tapa.send>
   #Insert delay delay of few ms
      <tapa.delay delay="10"/>

   #Expect config request at RLC and MAC
   <tapa.expset>
      <tapa.dummy.crg.cfgreq store_tid="1"/>
      <tapa.dummy.crg.cfgreq store_tid="1"/>
      <tapa.dummy.crg.cfgreq store_tid="1"/>
      <tapa.dummy.crg.cfgreq store_tid="1"/>
      <tapa.dummy.crg.cfgreq store_tid="1"/>
      <tapa.dummy.crg.cfgreq store_tid="1"/>
      <tapa.dummy.crg.cfgreq store_tid="1"/>
      <tapa.dummy.ckw.cfgreq use="1"/>
   </tapa.expset>

   #Send Config confirm from MAC to RRC
   <tapa.send>
      <tapa.dummy.crg.cfgcfm stored_tid="1" status="15" cellId="1"/>
   </tapa.send>
   <tapa.send>
      <tapa.dummy.crg.cfgcfm stored_tid="1" status="15" cellId="1"/>
   </tapa.send>
   <tapa.send>
      <tapa.dummy.crg.cfgcfm stored_tid="1" status="15" cellId="1"/>
   </tapa.send>
   <tapa.send>
      <tapa.dummy.crg.cfgcfm stored_tid="1" status="15" cellId="1"/>
   </tapa.send>
   <tapa.send>
      <tapa.dummy.crg.cfgcfm stored_tid="1" status="15" cellId="1"/>
   </tapa.send>
   <tapa.send>
      <tapa.dummy.crg.cfgcfm stored_tid="1" status="15" cellId="1"/>
   </tapa.send>
   #send negative config confirm for cell add
   <tapa.send>
      <tapa.dummy.crg.cfgcfm stored_tid="1" status="15" cellId="1"/>
   </tapa.send>

   #Send Config confirm from RLC to RRC
   <tapa.send>
      <tapa.dummy.ckw.cfgcfm use="1" status="1" expMacErr="1" expRlcErr="1"
      expPdcpErr="1" cellId="1"/>
   </tapa.send>

   <tapa.delay delay="5"/>
	 #Handle the alarm
	 <tapa.expopt>
	    <tapa.lnh.staind category="3" event="4" cause="0" alarmType="7" />
	 </tapa.expopt>
   #MAC Logical revert cfg req
   <tapa.expopt>
      <tapa.dummy.ckw.cfgreq use="1"/>
   </tapa.expopt>
   <tapa.expopt>
      #RRC sends Cell config cfm to RRC user
      <tapa.nhu.cellcfgcfm status='0'/>
   </tapa.expopt>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit/>
   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    8.20
#
#       Desc:    Unsuccessful downlink information transfer and paging
#                due to lower SAP not available.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    nhac_tc8.xml
#
#
<tapa.testcase id="8.20">
   
   # Document subsection
   <tapa.doc>
      <tapa.rfc id="None" section="None"/>
      <tapa.module id="rrc.nit"/>

      <tapa.desc>
         "PreTest connecton Setup"
         "Send down link information transfer for a UE, with UeId=1, which is in connected mode "
         "from RRC User on SRB 1. Delete PJU SAP. RRC should encode the message and send it to Ue using PJU SAP. The procedure fails due to PJU SAP being not available."
         "Then delete KWU SAP and send a paging message using Data Req from RRC user. The sending fails due to KWU SAP being not available."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>
      
      <tapa.ifdef>
         <tapa.flag/>
      </tapa.ifdef>
      
      <tapa.ifndef/>
      
       <tapa.mode mode="single"/>
   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

     #Configure RRC
     <tapa.rrc.init />
   </tapa.cfg>
   
   # Test Steps subsection
   <tapa.test>

    #Perform cell configuration pre-test
    <tapa.rrc.cellcfg cellCfgType="1" transId="3" cellId="1"/>

   #perform RRC connection setup
    <tapa.rrc.consetup cellId="1" tCrnti="1" ueId="1"/>

   # Send Control Request to Delete PJU SAP
   <tapa.send>
       <tapa.lnh.cntrl.lsap suId="0" action="7" elem="7"/>
   </tapa.send>

   # RRC will send control confirm to LM as SAP is deleted successfully
   <tapa.expset>
      # RRC will send bind request to PJU
      <tapa.dummy.pju.unbndreq spId="0"/>
      <tapa.lnh.cntrlcfm/>
   </tapa.expset>

   #Send downlink message
    <tapa.send>
      <tapa.nhu.datreq msgCategory="1" msgType="1" cellId="1" ueId="1" rbId="1" pdcpId="1"/>
    </tapa.send>

   #Expect Error Indication at RRC user
   <tapa.expect >
      <tapa.nhu.errind errorType="14" errorCause="0" />
   </tapa.expect>

   #PJU
   # Send Lower Sap configuration request from LM to RRC (PJU)
   <tapa.send>
      <tapa.lnh.cfg.lsap elem="7" suId="0" spId="0"/>
   </tapa.send>

   # Expect Lower SAP Config confirm from RRC to LM (PJU)
   <tapa.expect>
      <tapa.lnh.cfg.cfm/>
   </tapa.expect>

   # LM will send control request to bind and enable LSAP (PJU)
   <tapa.send>
      <tapa.lnh.cntrl.lsap action="21" suId="0" spId="0" elem="7"/>
   </tapa.send>

   # RRC will send bind request to PJU
   <tapa.expset>
      <tapa.dummy.pju.bndreq/>
      <tapa.lnh.cntrlcfm/>
   </tapa.expset>

   <tapa.delay delay="1"/>

   # PDCP will send bind confirm to RRC (PJU)
   <tapa.send>
      <tapa.dummy.pju.bndcfm suId ="0" status="1"/>
   </tapa.send>

   # Expect Status Confirm
   <tapa.expect>
      <tapa.lnh.staind category="2" event="11" cause="0" alarmType="3"/>
   </tapa.expect>

   # Send Control Request to Delete KWU SAP
   <tapa.send>
       <tapa.lnh.cntrl.lsap suId="0" action="7" elem="3"/>
   </tapa.send>

   # RRC will send control confirm to LM as SAP is deleted successfully
   <tapa.expset>
      # RRC will send bind request to KWU
      <tapa.dummy.kwu.unbndreq spId="0"/>
      <tapa.lnh.cntrlcfm/>
   </tapa.expset>

   # Send Paging message to RRC. RRC will send the message to
   # RLC on KWU interface
   <tapa.send>
      <tapa.nhu.datreq spId="0" bitMask="0" msgCategory="5"
       rbId="1" sfn="10" subFrmNo="2" pagingCause="0" 
       numOfUe="1" domainIdent="0" cellId="1" ueId="1" />
   </tapa.send>

   #Expect Error Indication at RRC user
   <tapa.expect >
      <tapa.nhu.errind errorType="14" errorCause="20" />
   </tapa.expect>

   </tapa.test>

  # Clean subsection
  <tapa.clean>
      <tapa.rrc.conrls ueId="1" cellId="1" />
      <tapa.rrc.cellcfg.rls cellId="1" />
  </tapa.clean>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.rrc.deinit />      
      # Send DeInit Configuration       
   </tapa.shutdown>
</tapa.testcase>

# DO NOT DELETE THIS LINE -- TC number generation script depends on it.
# xyzabcend

#/********************************************************************30**
#
#         End of file:     nhac_tc8.xml
#
#*********************************************************************31*/
#
#^L
#/********************************************************************40**
#
#        Notes:
#
#*********************************************************************41*/
#
#/********************************************************************50**
#
#*********************************************************************51*/
#
#^L
#/********************************************************************60**
#
#        Revision history:
#
#*********************************************************************61*/
#
#/********************************************************************90**
#
#     ver       pat    init                  description
#------------ -------- ---- ----------------------------------------------
#$SID$         ---     rcs              1. LTE RRC Initial Release.
#$SID$         ---     sbalakrishna     1. Updated for Release of 3.1.
#*********************************************************************91*/
