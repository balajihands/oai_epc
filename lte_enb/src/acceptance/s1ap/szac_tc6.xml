#/********************************************************************20**
#
#     Name:    S1AP 
#
#     Type:    XML Test File
#
#     Desc:    XML Based Test Cases
#
#     File:    szac_tc6.xml
#
#     Sid:     
#
#     Prg:     Rce 
#
#*********************************************************************21*/

# DO NOT DELETE THIS LINE -- TC number generation script depends on it.
# xyzabcstart=6:rce:szac_tc6.xml

#
#
#       Test:    6.1
#
#       Desc:    Verify successful connection establishment 
#                procedure initiated by eNB.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.1">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify successful connection establishment procedure"
         "initiated by eNB"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>
  
      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>
  
      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an initial UE msg from ENB to MME
      <tapa.send>
         <tapa.szt.conreq eventType="SZT_MSG_ID_INIT_UE_MSG" procId="SZAC_ENB_PROC" peerId="2" spId="0" usrConnId="1"/>
      </tapa.send>

      # Expect initial UE at MME
      <tapa.expect>
         <tapa.szt.conind eventType="SZT_MSG_ID_INIT_UE_MSG" peerId="1" procId="SZAC_MME_PROC" suId="1" spConnId="1" usrConnId="2"/>
      </tapa.expect>

      # Send an INITIAL CONTEXT SETUP REQUEST msg from MME to ENB
      <tapa.send>
         <tapa.szt.conrsp eventType="SZT_MSG_ID_CXT_SETUP_REQ" procId="SZAC_MME_PROC" peerId="1" spId="1" usrConnId="2" spConnId="1"/>
      </tapa.send>

      # Expect initial UE at ENB
      <tapa.expect>
         <tapa.szt.concfm eventType="SZT_MSG_ID_CXT_SETUP_REQ" peerId="2" procId="SZAC_ENB_PROC" suId="0" spConnId="1" usrConnId="1"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.2
#
#       Desc:    Verify encode functionality
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.2">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify successful encoding of Initial UE request"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>
  
      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an initial UE msg from ENB to MME
      <tapa.send>
         <tapa.szt.encreq eventType="SZT_MSG_ID_INIT_UE_MSG" procId="SZAC_ENB_PROC" spId="0" />
      </tapa.send>

      # Expect initial UE at MME
      <tapa.expect>
         <tapa.szt.enccfm eventType="SZT_MSG_ID_INIT_UE_MSG"  procId="SZAC_ENB_PROC" suId="0" />
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>
      <tapa.delay delay="5"/>

      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.3
#
#       Desc:    Verify decode functionality
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.3">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify successful decoding of Initial UE request"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>
  
      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an initial UE msg from ENB to MME
      <tapa.send>
         <tapa.szt.decreq eventType="SZT_MSG_ID_INIT_UE_MSG" procId="SZAC_ENB_PROC" spId="0" />
      </tapa.send>

      # Expect initial UE at MME
      <tapa.expect>
         <tapa.szt.deccfm eventType="SZT_MSG_ID_INIT_UE_MSG"  procId="SZAC_ENB_PROC" suId="0" />
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.4
#
#       Desc:    Verify that ENB on receiving E-RAB Setup 
#                request in ESTABLISHED state will send Local error
#                indication to the user as it is not allowed to send 
#                E-RAB Setup Request.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.4">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify that ENB on receiving E-RAB Setup"
         "request in ESTABLISHED state will send Local error"
         "indication to the user."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>
  
      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an initial UE msg from ENB to MME
      <tapa.send>
         <tapa.szt.conreq eventType="SZT_MSG_ID_INIT_UE_MSG" procId="SZAC_ENB_PROC" peerId="2" spId="0" usrConnId="1"/>
      </tapa.send>

      # Expect initial UE at MME
      <tapa.expect>
         <tapa.szt.conind eventType="SZT_MSG_ID_INIT_UE_MSG" peerId="1" procId="SZAC_MME_PROC" suId="1" spConnId="1" usrConnId="2"/>
      </tapa.expect>

      # Send an INITIAL CONTEXT SETUP REQUEST msg from MME to ENB
      <tapa.send>
         <tapa.szt.conrsp eventType="SZT_MSG_ID_CXT_SETUP_REQ" procId="SZAC_MME_PROC" peerId="1" spId="1" usrConnId="2" spConnId="1"/>
      </tapa.send>

      # Expect  INITIAL CONTEXT SETUP REQUEST at ENB
      <tapa.expect>
         <tapa.szt.concfm eventType="SZT_MSG_ID_CXT_SETUP_REQ" peerId="2" procId="SZAC_ENB_PROC" suId="0" spConnId="1" usrConnId="1"/>
      </tapa.expect>

      # Send an E-RAB SETUP REQUEST msg from ENB to MME
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_ERAB_SETUP_REQ" procId="SZAC_ENB_PROC" peerId="2" spId="0" spConnId="1" usrConnId="1"/>
      </tapa.send>

      # Expect E-RAB SETUP REQUEST msg at ENB
      <tapa.expect>
         <tapa.szt.errind eventType="SZT_MSG_ID_ERR_IND" peerId="2" procId="SZAC_ENB_PROC" suId="0" usrConnId="1" spConnId="1" causeType="SZT_CAUSE_UNEXP_MSG" causeValue="0"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.5
#
#       Desc:    Verify that MME on receiving Release Complete Message
#                in ESTABLISHED state sends error indication to the
#                user.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.5">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify that MME on receiving Release Complete Message"
         "in ESTABLISHED state sends error indication to the user."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>
  
      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an initial UE msg from ENB to MME
      <tapa.send>
         <tapa.szt.conreq eventType="SZT_MSG_ID_INIT_UE_MSG" procId="SZAC_ENB_PROC" peerId="2" spId="0" usrConnId="1"/>
      </tapa.send>

      # Expect initial UE at MME
      <tapa.expect>
         <tapa.szt.conind eventType="SZT_MSG_ID_INIT_UE_MSG" peerId="1" procId="SZAC_MME_PROC" suId="1" spConnId="1" usrConnId="2"/>
      </tapa.expect>

      # Send an INITIAL CONTEXT SETUP REQUEST msg from MME to ENB
      <tapa.send>
         <tapa.szt.conrsp eventType="SZT_MSG_ID_CXT_SETUP_REQ" procId="SZAC_MME_PROC" peerId="1" spId="1" usrConnId="2" spConnId="1"/>
      </tapa.send>

      # Expect  INITIAL CONTEXT SETUP REQUEST at ENB
      <tapa.expect>
         <tapa.szt.concfm eventType="SZT_MSG_ID_CXT_SETUP_REQ" peerId="2" procId="SZAC_ENB_PROC" suId="0" spConnId="1" usrConnId="1"/>
      </tapa.expect>

      # Send Release Complete from ENB to MME
      <tapa.send>
         <tapa.szt.relrsp eventType="SZT_MSG_ID_UE_CXT_REL_CMPL" procId="SZAC_ENB_PROC" peerId="2" spId="0" spConnId="1" usrConnId="1"/>
      </tapa.send>

      # Expect Error Indication at ENB
      <tapa.expect>
         <tapa.szt.errind eventType="SZT_MSG_ID_ERR_IND" peerId="2" procId="SZAC_ENB_PROC" suId="0" usrConnId="1" spConnId="1" causeType="SZT_CAUSE_INV_STATE" causeValue="2"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.6
#
#       Desc:    verify that eNB responds with INITIAL CONTEXT 
#                SETUP FAILURE message to MME for unknown MME/eNB 
#                UE S1AP ID or invalid E-RAB ID in INITIAL 
#                CONTEXT SETUP REQUEST message. 
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.6">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify that eNB responds with INITIAL CONTEXT SETUP"
         "FAILURE message to MME for unknown MME/eNB UE S1AP"
         "ID or invalid E-RAB ID in INITIAL CONTEXT SETUP"
         "REQUEST message"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>
  
      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an initial UE msg from ENB to MME
      <tapa.send>
         <tapa.szt.conreq eventType="SZT_MSG_ID_INIT_UE_MSG" procId="SZAC_ENB_PROC" peerId="2" spId="0" usrConnId="1"/>
      </tapa.send>

      # Expect initial UE at MME
      <tapa.expect>
         <tapa.szt.conind eventType="SZT_MSG_ID_INIT_UE_MSG" peerId="1" procId="SZAC_MME_PROC" suId="1" spConnId="1" usrConnId="2"/>
      </tapa.expect>

      # Send an INITIAL CONTEXT SETUP REQUEST msg from MME to ENB
      <tapa.send>
         <tapa.szt.conrsp eventType="SZT_MSG_ID_CXT_SETUP_REQ" procId="SZAC_MME_PROC" peerId="1" spId="1" usrConnId="2" spConnId="1"/>
      </tapa.send>

      # Expect  INITIAL CONTEXT SETUP REQUEST at ENB
      <tapa.expect>
         <tapa.szt.concfm eventType="SZT_MSG_ID_CXT_SETUP_REQ" peerId="2" procId="SZAC_ENB_PROC" suId="0" spConnId="1" usrConnId="1"/>
      </tapa.expect>

      # Send an INITIAL CONTEXT SETUP FAILURE from ENB to MME
      <tapa.send>
         <tapa.szt.relreq eventType="SZT_MSG_ID_INIT_CXT_SETUP_FAIL" procId="SZAC_ENB_PROC" peerId="2" spId="0" spConnId="1" usrConnId="1"/>
      </tapa.send>

      # Expect  INITIAL CONTEXT SETUP RESPONSE at MME
      <tapa.expect>
         <tapa.szt.datind eventType="SZT_MSG_ID_INIT_CXT_SETUP_FAIL" peerId="1" procId="SZAC_MME_PROC" suId="1" usrConnId="2"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.7
#
#       Desc:    verify that when MME receives INITIAL CONTEXT 
#                SETUP REQUEST message   from service user in 
#                IDLE state, responds with error indication message 
#                with proper error code to service user.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.7">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "verify that when MME receives INITIAL CONTEXT SETUP "
         "REQUEST message from service user in IDLE state, "
         "responds with error indication message with proper "
         "error code to service user"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>
  
      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.delay delay="5"/>
      
      # Send an INITIAL CONTEXT SETUP REQUEST msg from MME to ENB
      <tapa.send>
         <tapa.szt.conrsp eventType="SZT_MSG_ID_CXT_SETUP_REQ" procId="SZAC_MME_PROC" peerId="1" spId="1" spConnId="2"/>
      </tapa.send>

      # Expect error indication at MME
      <tapa.expect>
         <tapa.szt.errind eventType="SZT_MSG_ID_ERR_IND" peerId="1" procId="SZAC_MME_PROC" suId="1" spConnId="2" causeType="SZT_CAUSE_INV_CONID" causeValue="2"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.8
#
#       Desc:    verify that eNB can receive INITIAL CONTEXT 
#                SETUP REQUEST in ESTABLISHED state.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.8">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "verify that eNB can receive INITIAL CONTEXT SETUP"
         "REQUEST in ESTABLISHED state"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>
  
      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an initial UE msg from ENB to MME
      <tapa.send>
         <tapa.szt.conreq eventType="SZT_MSG_ID_INIT_UE_MSG" procId="SZAC_ENB_PROC" peerId="2" spId="0" usrConnId="1"/>
      </tapa.send>

      # Expect initial UE at MME
      <tapa.expect>
         <tapa.szt.conind eventType="SZT_MSG_ID_INIT_UE_MSG" peerId="1" procId="SZAC_MME_PROC" suId="1" spConnId="1" usrConnId="2"/>
      </tapa.expect>

      # Send an INITIAL CONTEXT SETUP REQUEST msg from MME to ENB
      <tapa.send>
         <tapa.szt.conrsp eventType="SZT_MSG_ID_CXT_SETUP_REQ" procId="SZAC_MME_PROC" peerId="1" spId="1" usrConnId="2" spConnId="1"/>
      </tapa.send>

      # Expect INITIAL CONTEXT SETUP REQUEST cfm at ENB
      <tapa.expect>
         <tapa.szt.concfm eventType="SZT_MSG_ID_CXT_SETUP_REQ" peerId="2" procId="SZAC_ENB_PROC" suId="0" spConnId="1" usrConnId="1"/>
      </tapa.expect>

      # Send an INITIAL CONTEXT SETUP RESPONSE msg from ENB to MME 
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_CXT_SETUP_RSP" procId="SZAC_ENB_PROC" peerId="2" spId="0" spConnId="1" usrConnId="1"/>
      </tapa.send>

      # Expect INITIAL CONTEXT SETUP RESPONSE msg at MME 
      <tapa.expect>
         <tapa.szt.datind eventType="SZT_MSG_ID_CXT_SETUP_RSP" peerId="1" procId="SZAC_MME_PROC" suId="1" usrConnId="2"/>
      </tapa.expect>

      # Send second INITIAL CONTEXT SETUP REQUEST msg from MME to ENB
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_CXT_SETUP_REQ" procId="SZAC_MME_PROC" peerId="1" spId="1" spConnId="1" usrConnId="2"/>
      </tapa.send>

      # Expect INITIAL CONTEXT SETUP REQUEST at ENB
      <tapa.expect>
         <tapa.szt.datind eventType="SZT_MSG_ID_CXT_SETUP_REQ" peerId="2" procId="SZAC_ENB_PROC" suId="0" usrConnId="1"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.9
#
#       Desc:    Verify failure of connection establishment 
#                when number of Connections exceeds maximum
#                configured value.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.9">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify failure of connection establishment"
         " when number of Connections exceeds maximum"
         "configured value."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init nmbConn="1"/>

      # Bring up MME 
      <tapa.sz.mme1.init nmbConn="1"/>

      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

      # UE context procedure
      <tapa.uecxt.init/>  

   </tapa.cfg>

   <tapa.test>

      # Send an initial UE msg from ENB to MME
      <tapa.send>
         <tapa.szt.conreq eventType="SZT_MSG_ID_INIT_UE_MSG" procId="SZAC_MME_PROC" peerId="1" spId="1"/>
      </tapa.send>

      # Expect error indication at MME
      <tapa.expect>
         <tapa.szt.errind eventType="SZT_MSG_ID_ERR_IND" procId="SZAC_MME_PROC" peerId="1" suId="1" causeType="SZT_CAUSE_MEM_ALLOC_FAIL" causeValue="0"/>
      </tapa.expect>
   
   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.10
#
#       Desc:    Verify that upon reception of the UE CONTEXT 
#                RELEASE COMMAND message from MME, the eNB shall 
#                indicate with error message if pair of UE S1AP  ID 
#                is unknown.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.10">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify that upon reception of the UE CONTEXT RELEASE"
         "COMMAND message from MME, the eNB shall indicate with"
         "error message if pair of UE S1AP  ID is unknown"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>
  
      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

      # Initial UE Context setup
      <tapa.uecxt.init usrConnId="1" spConnId="1"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an UE context Release cmd from MME to ENB
      <tapa.send>
         <tapa.szt.relreq eventType="SZT_MSG_ID_UE_CXT_REL_CMD" procId="SZAC_MME_PROC" peerId="1" spId="1" spConnId="1" enbId="99" usrConnId="1"/>
      </tapa.send>

      # Expect UE context Release cmd at MME
      <tapa.expect>
         <tapa.szt.udatind eventType="SZT_MSG_ID_ERR_IND" peerId="2" procId="SZAC_MME_PROC" suId="1" usrConnId="1" choice="SZT_CAUSE_RADIONW" cause="15"/>
      </tapa.expect>
      
   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.11
#
#       Desc:    Verify sending of release request with no data
#                will release all connections
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.11">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify  sending of release request with no data"
         "will release all connections."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>

      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

      # UE context procedure
      <tapa.uecxt.init usrConnId="1" spConnId="1"/>  

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send Release msg from MME
      <tapa.send>
         <tapa.szt.relreq eventType="SZT_MSG_ID_NO_DATA" procId="SZAC_MME_PROC" peerId="1" spId="1" usrConnId="1" />
      </tapa.send>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.12
#
#       Desc:    Verify Failure in UE Context Modification Procedure.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc5.xml
#
#
<tapa.testcase id="6.12">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="S1AP"/>

      <tapa.desc>
         "Verify Failure in UE Context Modification Procedure. "
         "The MME sends UE CONTEXT MODIFICATION REQUEST Message (with invalid MME UE S1AP ID) "
         "to the peer eNB. The MME responds back with a local Error Indication. "
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>

      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

      # Initial Context Setup Procedure
      <tapa.uecxt.init usrConnId="1" spConnId="1"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an UE CONTEXT MODIFICATION REQUEST message from MME to eNB
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_UE_CXT_MOD_REQ" procId="SZAC_MME_PROC" peerId="1" spId="1" usrConnId="1" enbId="1" mmeId="99"/>
      </tapa.send>

      # Expect Local Error Indication at MME
      <tapa.expect>
         <tapa.szt.errind procId="SZAC_MME_PROC" suId="1" causeType="SZT_CAUSE_INV_CONID" causeValue="99"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.13
#
#       Desc:    Verify Failure in UE Context Modification Procedure.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc5.xml
#
#
<tapa.testcase id="6.13">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="S1AP"/>

      <tapa.desc>
         "Verify Failure in UE Context Modification Procedure. "
         "The MME sends UE CONTEXT MODIFICATION REQUEST Message "
         "(before Initial Context Setup Procedure) to the peer eNB. "
         "The MME responds back with a local Error Indication. "
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>

      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an UE CONTEXT MODIFICATION REQUEST message from MME to eNB
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_UE_CXT_MOD_REQ" procId="SZAC_ENB_PROC" peerId="2" spConnId="0" enbId="1" mmeId="1"/>
      </tapa.send>

      # Expect Local Error Indication at eNB
      <tapa.expect>
         <tapa.szt.errind procId="SZAC_ENB_PROC" suId="0" causeType="SZT_CAUSE_INV_CONID" causeValue="0"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.14
#
#       Desc:    Verify that eNB may interrupt the ongoing 
#                E-RAB Setup procedure and initiate the 
#                Handover Preparation procedure.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.14">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify that eNB may interrupt the ongoing E-RAB"
         "Setup procedure and initiate the Handover Preparation"
         "procedure"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>
  
      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  
        
      # Initial UE context procedure
      <tapa.uecxt.init usrConnId="1" spConnId="1"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>
      # Send an E-RAB SETUP REQUEST msg from MME to ENB
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_ERAB_SETUP_REQ" procId="SZAC_MME_PROC" peerId="1" spId="1" spConnId="1" usrConnId="1"/>
      </tapa.send>

      # Expect E-RAB SETUP REQUEST msg at ENB
      <tapa.expect>
         <tapa.szt.datind eventType="SZT_MSG_ID_ERAB_SETUP_REQ" peerId="2" procId="SZAC_ENB_PROC" suId="0"  usrConnId="1"/>
      </tapa.expect>

      # Send an E-RAB SETUP RESPONSE msg from ENB to MME
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_ERAB_SETUP_RSP" peerId="2" procId="SZAC_ENB_PROC" spId="0" spConnId="1" usrConnId="1"/>
      </tapa.send>

      # Expect E-RAB SETUP RESPONSE msg at MME
      <tapa.expect>
         <tapa.szt.datind eventType="SZT_MSG_ID_ERAB_SETUP_RSP" procId="SZAC_MME_PROC" peerId="1" suId="1"  usrConnId="1" handoverTrgd="1"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.15
#
#       Desc:    Verify that MME S1AP on receiving E-RAB 
#                SETUP REQUEST message from MME S1AP user in 
#                state other than ESTABLISHED state, responds 
#                with error message to MME S1AP user.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.15">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify that MME S1AP on receiving E-RAB SETUP"
         "message from MME S1AP user in state other than"
         "ESTABLISHED state, responds with error message"
         "to MME S1AP user"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>
  
      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.delay delay="5"/>
      # Send an E-RAB SETUP REQUEST msg from MME to ENB
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_ERAB_SETUP_REQ" procId="SZAC_MME_PROC" peerId="1" spId="1" spConnId="1" usrConnId="1"/>
      </tapa.send>

      # Expect E-RAB SETUP REQUEST msg at MME
      <tapa.expect>
         <tapa.szt.errind eventType="SZT_MSG_ID_ERR_IND" procId="SZAC_MME_PROC" suId="1" causeType="SZT_CAUSE_INV_CONID" causeValue="1" usrConnId="1"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.16
#
#       Desc:    Verify that eNB may interrupt the ongoing 
#                E-RAB modify procedure and initiate 
#                the Handover Preparation procedure.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.16">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify that eNB may interrupt the ongoing E-RAB"
         "modify procedure and initiate the Handover "
         "Preparation procedure"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>
  
      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

      # UE context setup
      <tapa.uecxt.init usrConnId="1" spConnId="1"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an E-RAB MODIFY REQUEST msg from MME to ENB
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_ERAB_MOD_REQ" procId="SZAC_MME_PROC" peerId="1" spId="1" spConnId="1" usrConnId="1"/>
      </tapa.send>

      # Expect E-RAB MODIFY REQUEST indication at ENB
      <tapa.expect>
         <tapa.szt.datind eventType="SZT_MSG_ID_ERAB_MOD_REQ" peerId="2" procId="SZAC_ENB_PROC" suId="0"  usrConnId="1"/>
      </tapa.expect>

      # Send an E-RAB MODIFY RESPONSE msg from ENB to MME
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_ERAB_MOD_RSP" peerId="2" procId="SZAC_ENB_PROC" spId="0" spConnId="1" usrConnId="1" handoverTrgd="1"/>
      </tapa.send>

      # Expect E-RAB MODIFY RESPONSE at MME
      <tapa.expect>
         <tapa.szt.datind eventType="SZT_MSG_ID_ERAB_MOD_RSP" procId="SZAC_MME_PROC" peerId="1" suId="1"  usrConnId="1"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.17
#
#       Desc:    Verify that MME S1AP sends error message to 
#                MME S1AP user if it receives E-RAB RELEASE 
#                COMMAND in a state other than ESTABLISHED.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.17">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify that MME S1AP sends error message to MME"
         "S1AP user if it receives E-RAB RELEASE COMMAND"
         "in a state other than ESTABLISHED"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>
  
      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  
   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.delay delay="5"/>
      # Send an E-RAB RELEASE COMMAND msg from MME to ENB
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_ERAB_REL_CMD" procId="SZAC_MME_PROC" peerId="1" spId="1" spConnId="1" usrConnId="1"/>
      </tapa.send>

      # Expect error indication at MME
      <tapa.expect>
         <tapa.szt.errind eventType="SZT_MSG_ID_ERR_IND" peerId="1" procId="SZAC_MME_PROC" suId="1"  usrConnId="1" causeType="SZT_CAUSE_INV_CONID" causeValue="1"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.18
#
#       Desc:    Verify that eNB may initiate E-RAB 
#                RELEASE REQUEST requesting the release of 
#                E-RABs to MME.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.18">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify that eNB may initiate E-RAB RELEASE"
         "REQUEST requesting the release of E-RABs "
         "to MME"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>
  
      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

      # UE context setup
      <tapa.uecxt.init usrConnId="1" spConnId="1"/>

      # E-RAB setup procedure
      <tapa.erab.init/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.delay delay="5"/>
      # Send an E-RAB RELEASE REQ from ENB to MME
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_ERAB_REL_REQ" peerId="2" procId="SZAC_ENB_PROC" spId="0"  usrConnId="1"/>
      </tapa.send>

      # Expect E-RAB RELEASE REQ at MME
      <tapa.expect>
         <tapa.szt.datind eventType="SZT_MSG_ID_ERAB_REL_REQ" procId="SZAC_MME_PROC" peerId="1" suId="1"  usrConnId="1"/>
      </tapa.expect>

      # Send an E-RAB RELEASE COMMAND msg from MME to ENB
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_ERAB_REL_CMD" procId="SZAC_MME_PROC" peerId="1" spId="1" spConnId="1" usrConnId="1"/>
      </tapa.send>

      # Expect E-RAB RELEASE COMMAND indication at ENB
      <tapa.expect>
         <tapa.szt.datind eventType="SZT_MSG_ID_ERAB_REL_CMD" peerId="2" procId="SZAC_ENB_PROC" suId="0"  usrConnId="1"/>
      </tapa.expect>

      # Send an E-RAB RELEASE COMPLETE msg from ENB to MME
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_ERAB_REL_CMPLT" peerId="2" procId="SZAC_ENB_PROC" spId="0" spConnId="1" usrConnId="1"/>
      </tapa.send>

      # Expect E-RAB RELEASE COMPLETE at MME
      <tapa.expect>
         <tapa.szt.datind eventType="SZT_MSG_ID_ERAB_REL_CMPLT" procId="SZAC_MME_PROC" peerId="1" suId="1"  usrConnId="1"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.19
#
#       Desc:    Verify that eNB S1AP user receives error 
#                indication if it sends E-RAB RELEASE 
#                REQUEST to eNB S1AP in IDLE state.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.19">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify that eNB S1AP user receives error indication"
         "if it sends E-RAB RELEASE REQUEST to eNB S1AP"
         "in IDLE state"
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>
  
      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an E-RAB RELEASE REQ from ENB to MME
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_ERAB_REL_REQ" peerId="2" procId="SZAC_ENB_PROC" spId="0"  usrConnId="4" spConnId="0"/>
      </tapa.send>

      # Expect error indication at ENB
      <tapa.expect>
         <tapa.szt.errind eventType="SZT_MSG_ID_ERR_IND" peerId="1" procId="SZAC_ENB_PROC" suId="0" usrConnId="4" causeType="SZT_CAUSE_INV_CONID" causeValue="0" />
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.20
#
#       Desc:    Verify Successful Downlink NAS Transport Procedure.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc6.xml
#
#
<tapa.testcase id="6.20">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="S1AP"/>

      <tapa.desc>
         "Verify Successful Downlink NAS Procedure where S1-Conn exists for the UE. "
         "The MME S1AP User sends DOWNLINK NAS TRANSPORT Message to "
         "the peer eNB S1AP User on existing S1-connection for the UE."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>

      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

      # Initial Context Setup Procedure
      <tapa.uecxt.init usrConnId="1" spConnId="1"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an DOWNLINK NAS TRANSPORT Message from MME to eNB
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_DL_NAS_TPT" procId="SZAC_MME_PROC" spId="1" spConnId="1" usrConnId="1" peerId="1"/>
      </tapa.send>

      # Expect DOWNLINK NAS TRANSPORT Msg at eNB
      <tapa.expect>
         <tapa.szt.datind eventType="SZT_MSG_ID_DL_NAS_TPT" procId="SZAC_ENB_PROC" suId="0" usrConnId="1"  peerId="2"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.21
#
#       Desc:    Verify Successful Downlink NAS Transport Procedure.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc6.xml
#
#
<tapa.testcase id="6.21">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="S1AP"/>

      <tapa.desc>
         "Verify Successful Downlink NAS Procedure where "
         "MME have received the eNB S1-AP UE Identity IE in an INITIAL UE MESSAGE Message "
         "The MME S1AP User sends DOWNLINK NAS TRANSPORT Message to the peer eNB S1AP User."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>

      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an initial UE msg from ENB to MME
      <tapa.send>
         <tapa.szt.conreq eventType="SZT_MSG_ID_INIT_UE_MSG" procId="SZAC_ENB_PROC" peerId="2" spId="0" usrConnId="1"/>
      </tapa.send>

      # Expect initial UE at MME
      <tapa.expect>
         <tapa.szt.conind eventType="SZT_MSG_ID_INIT_UE_MSG" peerId="1" procId="SZAC_MME_PROC" suId="1" spConnId="1" usrConnId="1" />
      </tapa.expect>

      # Send an DOWNLINK NAS TRANSPORT Message from MME to eNB
      <tapa.send>
         <tapa.szt.conrsp eventType="SZT_MSG_ID_DL_NAS_TPT" procId="SZAC_MME_PROC" peerId="1" spId="1"  usrConnId="1" spConnId="1"/>
      </tapa.send>

      # Expect DOWNLINK NAS TRANSPORT Msg at eNB
      <tapa.expect>
         <tapa.szt.concfm eventType="SZT_MSG_ID_DL_NAS_TPT" peerId="2" procId="SZAC_ENB_PROC" suId="0" spConnId="1" usrConnId="1"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.22
#
#       Desc:    Verify failure in Downlink NAS Transport Procedure.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc6.xml
#
#
<tapa.testcase id="6.22">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="S1AP"/>

      <tapa.desc>
         "Verify failure in Downlink NAS Procedure where S1-Conn exists for the UE. "
         "The MME S1AP sends DOWNLINK NAS TRANSPORT Message to eNB S1AP User with unknow mmeId."
         " The eNB sends NAS NON DELIVERY INDICATION Message to MME S1AP User.
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>

      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

      # Initial Context Setup Procedure
      <tapa.uecxt.init usrConnId="1" spConnId="1"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an DOWNLINK NAS TRANSPORT Message from MME to eNB
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_DL_NAS_TPT" procId="SZAC_MME_PROC" spId="1" spConnId="1" usrConnId="1" peerId="1" enbId="1" mmeId="99"/>
      </tapa.send>

      # Expect Local Error Indication at MME
      <tapa.expect>
         <tapa.szt.errind procId="SZAC_MME_PROC" suId="1" causeType="SZT_CAUSE_INV_CONID" causeValue="99"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.23
#
#       Desc:    Verify Successful Uplink NAS Transport Procedure.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc6.xml
#
#
<tapa.testcase id="6.23">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="S1AP"/>

      <tapa.desc>
         "Verify Successful Uplink NAS Procedure where S1-Conn exists for the UE. "
         "The eNB S1AP sends UPLINK NAS TRANSPORT Message to MME S1AP."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>

      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

      # Initial Context Setup Procedure
      <tapa.uecxt.init usrConnId="1" spConnId="1"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an UPLINK NAS TRANSPORT Message from eNB to MME
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_UL_NAS_TPT" procId="SZAC_ENB_PROC" peerId="2" spId="0" spConnId="1" usrConnId="1"/>
      </tapa.send>

      # Expect UPLINK NAS TRANSPORT Msg at MME
      <tapa.expect>
         <tapa.szt.datind eventType="SZT_MSG_ID_UL_NAS_TPT" peerId="1" procId="SZAC_MME_PROC" suId="1" usrConnId="1"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.24
#
#       Desc:    Verify failure in Uplink NAS Transport Procedure.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc6.xml
#
#
<tapa.testcase id="6.24">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="S1AP"/>

      <tapa.desc>
         "Verify failure in Uplink NAS Procedure. "
         "The eNB S1AP sends UPLINK NAS TRANSPORT Message with unknown eNB Id "
         "to MME S1AP. eNB responds with local Error Indication. "
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>

      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

      # Initial Context Setup Procedure
      <tapa.uecxt.init usrConnId="1" spConnId="1"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an UPLINK NAS TRANSPORT Message from eNB to MME
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_UL_NAS_TPT" procId="SZAC_ENB_PROC" peerId="2" spId="0" spConnId="1" usrConnId="1" enbId="99" mmeId="1"/>
      </tapa.send>

      # Expect Local Error Indication at eNb
      <tapa.expect>
         <tapa.szt.errind procId="SZAC_ENB_PROC" suId="0" causeType="SZT_CAUSE_INV_CONID" causeValue="99"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.25
#
#       Desc:    Verify Successful NAS Non Delivery Indication Procedure.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc6.xml
#
#
<tapa.testcase id="6.25">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="S1AP"/>

      <tapa.desc>
         "Verify Successful NAS Non Delivery Indication Procedure "
         "where S1-Conn exists for the UE. "
         "The eNB S1AP sends NAS NON DELIVERY INDICATION Message to "
         "the peer MME S1AP on existing S1-connection for the UE."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>

      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

      # Initial Context Setup Procedure
      <tapa.uecxt.init usrConnId="1" spConnId="1"/>

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      # Send an NAS NON DELIVERY INDICATION Message from eNB to MME
      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_NAS_NON_DEL_IND" procId="SZAC_ENB_PROC" peerId="2" spId="0" spConnId="1" usrConnId="1"/>
      </tapa.send>

      # Expect NAS NON DELIVERY INDICATION Msg at MME
      <tapa.expect>
         <tapa.szt.datind eventType="SZT_MSG_ID_NAS_NON_DEL_IND" peerId="1" procId="SZAC_MME_PROC" suId="1" usrConnId="1"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.26
#
#       Desc:    Verify failure in NAS Non Delivery Indication Procedure.
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc6.xml
#
#
<tapa.testcase id="6.26">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="S1AP"/>

      <tapa.desc>
         "Verify failure in NAS Non Delivery Indication Procedure "
         "where S1-Conn doesn't exists for the UE. "
         "The eNB S1AP sends NAS NON DELIVERY INDICATION Message to "
         "the peer MME S1AP. MME responds with a local Error Indication."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>

      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.send>
         <tapa.szt.datreq eventType="SZT_MSG_ID_NAS_NON_DEL_IND" procId="SZAC_ENB_PROC" peerId="2" spId="0" usrConnId="1" spConnId="1" enbId="99" mmeId="1"/>
      </tapa.send>

      # Expect Local Error Indication at eNb
      <tapa.expect>
         <tapa.szt.errind procId="SZAC_ENB_PROC" suId="0" causeType="SZT_CAUSE_INV_CONID" causeValue="1"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      # Configure TUCL
      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

#
#
#       Test:    6.27
#
#       Desc:    Verify sending of some unsupported message in ConReq
#                and ConRsp makes S1AP layer to send error 
#                indication. 
#
#       Notes:   None
#              
#       Module:  
#
#       File:    szac_tc2.xml
#
#
<tapa.testcase id="6.27">

   # Document subsection
   <tapa.doc>

      <tapa.rfc id="None" section="None"/>
      <tapa.module id="s1ap"/>

      <tapa.desc>
         "Verify  S1AP layer sends error indication if"
         " unsupported message is sent in ConReq and "
         "ConRsp."
      </tapa.desc>

      <tapa.longdesc/>

   </tapa.doc>

   # Require features and flags subsection
   <tapa.require>

      <tapa.ifdef>
      </tapa.ifdef>

      <tapa.ifndef/>
      <tapa.mode mode="single"/>

   </tapa.require>

   # Configuration subsection
   <tapa.cfg>

      # Configure TUCL
      <tapa.hi.init/>

      # Configure SCTP
      <tapa.sb.init/>

      # Bring up ENB
      <tapa.sz.enb0.init/>

      # Bring up MME 
      <tapa.sz.mme1.init/>

      # Send Bind Req at eNB
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_ENB_PROC" spId="0" suId="0"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at eNB 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_ENB_PROC" spId="0" suId="0" status="1"/> 
      </tapa.expect>

      # Send Bind Req at MME
      <tapa.send>
         <tapa.szt.bndreq procId="SZAC_MME_PROC" spId="1" suId="1"/> 
      </tapa.send>
  
      # Expect Bnd Cfm at MME 
      <tapa.expect>
         <tapa.szt.bndcfm procId="SZAC_MME_PROC" spId="1" suId="1" status="1"/> 
      </tapa.expect>

      # S1 setup procedure
      <tapa.s1.init/>  

   </tapa.cfg>

   # Test Steps subsection
   <tapa.test>

      <tapa.delay delay="5"/>
      # Send NO MSG DATA  
      <tapa.send>
         <tapa.szt.conreq eventType="SZT_MSG_ID_NO_DATA" procId="SZAC_MME_PROC" peerId="1" spId="1" />
      </tapa.send>

      # Expect error indication at MME
      <tapa.expect>
         <tapa.szt.errind eventType="SZT_MSG_ID_ERR_IND" procId="SZAC_MME_PROC" peerId="1" suId="1" causeType="SZT_CAUSE_UNEXP_MSG" causeValue="0"/>
      </tapa.expect>


      # Send NO MSG DATA  
      <tapa.send>
         <tapa.szt.conrsp eventType="SZT_MSG_ID_NO_DATA" procId="SZAC_MME_PROC" peerId="1" spId="1" />
      </tapa.send>

      # Expect error indication at MME
      <tapa.expect>
         <tapa.szt.errind eventType="SZT_MSG_ID_ERR_IND" procId="SZAC_MME_PROC" peerId="1" suId="1" causeType="SZT_CAUSE_UNEXP_MSG" causeValue="0"/>
      </tapa.expect>

   </tapa.test>

   # Clean subsection
   <tapa.clean/>

   # Shutdown subsection
   <tapa.shutdown>

      <tapa.delay delay="5"/>
      # Deinit ENB
      <tapa.sz.enb0.deinit/>

      # Deinit MME 
      <tapa.sz.mme1.deinit/>

      # Deinit SCTP
      <tapa.sb.deinit/>

      <tapa.hi.deinit/>

   </tapa.shutdown>

</tapa.testcase>

# DO NOT DELETE THIS LINE -- TC number generation script depends on it.
# xyzabcend

#/********************************************************************30**
#
#         End of file:     szac_tc6.xml
#
#*********************************************************************31*/
#
#
#/********************************************************************40**
#
#        Notes:
#
#*********************************************************************41*/
#
#/********************************************************************50**
#
#*********************************************************************51*/
#
#
#/********************************************************************60**
#
#        Revision history:
#
#*********************************************************************61*/
#
#/********************************************************************90**
#
#     ver       pat    init                  description
#------------ -------- ---- ----------------------------------------------
#$SID$        ---      vvashishth  1. Updated for S1AP release 3.1
#*********************************************************************91*/
